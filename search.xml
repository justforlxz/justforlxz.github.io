<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>ä½¿ç”¨ distrobox å’Œ nix åŠ é€Ÿ UOS å¼€å‘</title>
      <link href="/2025/01/02/use-docker-and-distrobx-and-nix-to-develop-uos/"/>
      <url>/2025/01/02/use-docker-and-distrobx-and-nix-to-develop-uos/</url>
      
        <content type="html"><![CDATA[<p>UOS è¿™ä»“åº“æœ‰å¤šé¬¼ç•œï¼Œå°±ä¸ç”¨æˆ‘å¤šè¯´äº†ï¼Œå¼€å‘çš„æ—¶å€™æ¯æ¬¡éƒ½è¦é‡è£…ä¸€ä¸ªä¸åŒç‰ˆæœ¬çš„ç³»ç»Ÿä¹ŸæŒºéº»çƒ¦ï¼Œæ¯”å¦‚ 1060ã€1063ã€1070ã€1070u1ã€‚ã€‚ã€‚</p><p>æ‰€ä»¥æˆ‘å°±æƒ³åˆ°ï¼Œæˆ‘å¯ä»¥ç”¨æ„å»ºç”¨çš„ rootfs åŠ ä¸Šä»“åº“ï¼Œæ•´å‡ºæ¥ä¸€ä¸ªåŸºç¡€ç¯å¢ƒï¼Œç„¶åé€šè¿‡ distrobox æ¥å¯åŠ¨ï¼Œè¿™æ ·éšæ—¶éƒ½å¯ä»¥å¿«é€Ÿå‡†å¤‡ä¸€ä¸ªç¯å¢ƒã€‚</p><p>å¹³æ—¶æˆ‘ç”¨çš„å¼€å‘å·¥å…·å°± neovim å’Œ vscode å±…å¤šï¼Œæ‰€ä»¥å†é…åˆä¸Š nix æŠŠ neovim å’Œä¸€äº› UOS ç¼ºå°‘çš„å·¥å…·éƒ½è£…ä¸Šï¼Œæƒ³æƒ³éƒ½æ˜¯ç¾æ»‹æ»‹ã€‚</p><p>è¯´å¹²å°±å¹²!</p><h2 id="æ„å»º-Docker-é•œåƒ"><a href="#æ„å»º-Docker-é•œåƒ" class="headerlink" title="æ„å»º Docker é•œåƒ"></a>æ„å»º Docker é•œåƒ</h2><p>ç”±äº UOS æœ‰å¤šä¸ªä¸åŒæ¶æ„çš„æ”¯æŒï¼Œè‚¯å®šä¸èƒ½ç»‘æ­»åˆ°ä¸€ä¸ªå¹³å°ä¸Šï¼Œæˆ‘ä½¿ç”¨ docker buildx æ¥æ„å»ºå¤šæ¶æ„é•œåƒã€‚rootfs æˆ‘å°±ä¸å…¬å¼€äº†ï¼Œç›´æ¥ä¸Š Dockerfileã€‚</p><figure class="highlight dockerfile"><table><tr><td class="code"><pre><span class="line"><span class="keyword">FROM</span> --platform=$TARGETPLATFORM scratch</span><br><span class="line"></span><br><span class="line"><span class="keyword">ARG</span> TARGETARCH</span><br><span class="line"><span class="keyword">ARG</span> UOS_VERSION</span><br><span class="line"></span><br><span class="line"><span class="keyword">ADD</span><span class="language-bash"> buster-<span class="variable">$&#123;TARGETARCH&#125;</span>-1050update4.tgz /</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">echo</span> <span class="string">&quot;deb [trusted=yes] http://pools.uniontech.com/desktop-professional <span class="variable">$&#123;UOS_VERSION:-eagle/1070&#125;</span> main contrib non-free&quot;</span> &gt; /etc/apt/sources.list</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apt-get update &amp;&amp; apt-get install -y \</span></span><br><span class="line"><span class="language-bash">    apt-utils \</span></span><br><span class="line"><span class="language-bash">    apt-transport-https \</span></span><br><span class="line"><span class="language-bash">    ca-certificates \</span></span><br><span class="line"><span class="language-bash">    curl \</span></span><br><span class="line"><span class="language-bash">    gnupg \</span></span><br><span class="line"><span class="language-bash">    lsb-release \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; apt-get dist-upgrade -y \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; apt-get clean \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; <span class="built_in">rm</span> -rf /var/lib/apt/lists/*</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> [ <span class="string">&quot;bash&quot;</span> ]</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œä¸ºäº†æ–¹ä¾¿æˆ‘æ„å»ºï¼Œæˆ‘å°†ä»“åº“çš„åç§°ä½¿ç”¨å˜é‡æ§åˆ¶äº†ã€‚</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker buildx build --platform=linux/amd64 -t linuxdeepin/1063:base --build-arg UOS_VERSION=eagle/1063 . --load</span><br></pre></td></tr></table></figure><p>åªéœ€è¦æ§åˆ¶ label å’Œ ä»“åº“åç§°ï¼Œå°±èƒ½å¿«é€Ÿçš„åˆ›å»ºå‡ºä¸€ä¸ªå¯ç”¨çš„ docker é•œåƒã€‚ä½¿ç”¨ <code>--load</code> å‚æ•°æ„å»ºå®Œä»¥åç›´æ¥å¯¼å…¥é•œåƒï¼Œå¯ä»¥åœ¨ <code>docker images</code> ä¸­çœ‹åˆ°ã€‚</p><h2 id="åˆ›å»º-Distrobox-ç¯å¢ƒ"><a href="#åˆ›å»º-Distrobox-ç¯å¢ƒ" class="headerlink" title="åˆ›å»º Distrobox ç¯å¢ƒ"></a>åˆ›å»º Distrobox ç¯å¢ƒ</h2><p>ç°åœ¨æœ‰ä¸ªå¯ç”¨çš„ docker é•œåƒï¼Œå°±å¯ä»¥ä½¿ç”¨ distrobox åˆ›å»ºç¯å¢ƒäº†ã€‚</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">distrobox create --image linuxdeepin/1063:base --name 1063 --volume /nix:/nix:rw --additional-flags &quot;--pids-limit -1&quot;</span><br></pre></td></tr></table></figure><p>å®‰è£… nix çš„è¿‡ç¨‹è¯·å‚è€ƒä¸Šä¸€ç¯‡æ–‡ç« ï¼Œè¿™é‡Œæ˜¯æŠŠ nix æŒ‚è½½åˆ°ç¯å¢ƒé‡Œäº†ã€‚</p><p>è¿è¡Œä»¥åç­‰å¾…ä¸€ä¼šå„¿ï¼Œå°±çœ‹åˆ°åˆ›å»ºæˆåŠŸäº†ã€‚</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">Creating &#x27;1063&#x27; using image linuxdeepin/1063:base        [ OK ]</span><br><span class="line">Distrobox &#x27;1063&#x27; successfully created.</span><br><span class="line">To enter, run:</span><br><span class="line"></span><br><span class="line">distrobox enter 1063</span><br><span class="line"></span><br><span class="line">Successfully copied 2.05kB to /tmp/1063.os-release</span><br></pre></td></tr></table></figure><p>æé†’æˆ‘ä»¬ç”¨ <code>distrobox enter 1063</code> è¿›å…¥ç¯å¢ƒã€‚</p><h2 id="è¿è¡Œ"><a href="#è¿è¡Œ" class="headerlink" title="è¿è¡Œ"></a>è¿è¡Œ</h2><p>è¿è¡Œçš„è¯æ²¡å•¥é—®é¢˜ï¼Œåªæ˜¯éœ€è¦è®¾ç½®ä¸€ä¸‹ç”¨æˆ·å¯†ç ï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯ distrobox æ”¹å˜ç­–ç•¥äº†ï¼Œä»¥å‰åº”è¯¥æ˜¯é¦–æ¬¡è¿›å…¥çš„æ—¶å€™å°±æé†’è®¾ç½®å¯†ç ï¼Œç°åœ¨å¿…é¡»æ‰‹åŠ¨å…ˆè¿è¡Œä¸€ä¸‹ <code>passwd</code>ï¼Œä¸ç„¶ sudo ä¹‹ç±»çš„å‘½ä»¤æ˜¯ä¸èƒ½ç”¨çš„ã€‚</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">â¯ distrobox enter 1063</span><br><span class="line">Starting container...                            [ OK ]</span><br><span class="line">Installing basic packages...                     [ OK ]</span><br><span class="line">Setting up devpts mounts...                      [ OK ]</span><br><span class="line">Setting up read-only mounts...                   [ OK ]</span><br><span class="line">Setting up read-write mounts...                  [ OK ]</span><br><span class="line">Setting up host&#x27;s sockets integration...         [ OK ]</span><br><span class="line">Integrating host&#x27;s themes, icons, fonts...       [ OK ]</span><br><span class="line">Setting up distrobox profile...                  [ OK ]</span><br><span class="line">Setting up sudo...                               [ OK ]</span><br><span class="line">Setting up user groups...                        [ OK ]</span><br><span class="line">Setting up user&#x27;s group list...                  [ OK ]</span><br><span class="line">Adding user...                                   [ OK ]</span><br><span class="line">Ensuring user&#x27;s access...                        [ OK ]</span><br><span class="line"></span><br><span class="line">Container Setup Complete!</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æŠ€æœ¯åˆ†äº« </category>
          
      </categories>
      
      
        <tags>
            
            <tag> uos </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨ VK-GL-CTS å¯¹ wayland æ‰§è¡Œä¸€è‡´æ€§æµ‹è¯•</title>
      <link href="/2024/12/27/vk-gl-cts-test-wayland/"/>
      <url>/2024/12/27/vk-gl-cts-test-wayland/</url>
      
        <content type="html"><![CDATA[<aside>ğŸ˜­ åä¸ºé‚£è¾¹ä½¿ç”¨ deqp-vk ä½œä¸ºæµ‹è¯•é¡¹ï¼Œç»“æœ kwin_wayland æœ‰ä¸ªæµ‹è¯•æ²¡é€šè¿‡ï¼Œæ²Ÿé€šäº†ä¸€æ˜ŸæœŸæ‰çŸ¥é“æ˜¯å…¬å¼€çš„æµ‹è¯•å¥—ä»¶ï¼Œä½†æ˜¯åœ¨ uos 1070 ä¸Šæ„å»ºé‡åˆ°äº†ç‚¹é—®é¢˜ï¼Œæˆ‘æŠŠå‘è®°å½•ä¸€ä¸‹ã€‚</aside><p>uos 1070 é‡Œçš„ gcc å¤ªæ—§äº†ï¼Œéœ€è¦å®‰è£… clang-13ï¼Œç„¶åæ›´æ–°è½¯é“¾ã€‚è¿˜éœ€è¦å®‰è£… libc++abi-13ï¼Œä¸èƒ½ç¢°ä»»ä½• gcc çš„ä¸œè¥¿ã€‚</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt install libwayland-dev wayland-protocols cmake ninja-build clang-13 libc++1-13 libc++-13-dev libc++abi1-13 libc++abi-13-dev </span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">sudo</span> update-alternatives --install /usr/bin/clang clang /usr/bin/clang-13 100</span><br><span class="line"><span class="built_in">sudo</span> update-alternatives --install /usr/bin/clang++ clang++ /usr/bin/clang++-13 100</span><br></pre></td></tr></table></figure><p>æ‹‰å–ä»£ç  <a href="https://github.com/KhronosGroup/VK-GL-CTS/">https://github.com/KhronosGroup/VK-GL-CTS/</a> </p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/KhronosGroup/VK-GL-CTS/</span><br></pre></td></tr></table></figure><p>æ‹‰å®Œä»£ç ä»¥åï¼Œè¿˜éœ€è¦æ‰§è¡Œè„šæœ¬æŠŠä¾èµ–é¡¹éƒ½æ‹‰å»äº†ã€‚</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python3 external/fetch_sources.py</span><br></pre></td></tr></table></figure><p>åŒæ—¶è¿˜éœ€è¦åœ¨ç³»ç»Ÿé‡Œå®‰è£… python3-lxmlã€‚</p><p>æ›´æ–°å®Œæ‰€æœ‰ä¾èµ–åï¼Œæˆ‘åªéœ€è¦ deqp-vk è¿™ä¸€ä¸ª targetï¼Œè€Œ khronosGroup ç»™ VK-GL-CTS æä¾›äº† SELECTED_BUILD_TARGETS å˜é‡ã€‚</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cmake -B build -GNinja \</span><br><span class="line">      -DSELECTED_BUILD_TARGETS=deqp-vk \</span><br><span class="line">      -DCMAKE_BUILD_TYPE=Debug \</span><br><span class="line">      -DCMAKE_CXX_STANDARD=17 \</span><br><span class="line">      -DCMAKE_CXX_STANDARD_REQUIRED=ON \</span><br><span class="line">      -DCMAKE_CXX_EXTENSIONS=OFF \</span><br><span class="line">      -DCMAKE_CXX_FLAGS=<span class="string">&quot;-stdlib=libc++&quot;</span> \</span><br><span class="line">      -DCMAKE_EXE_LINKER_FLAGS=<span class="string">&quot;-lstdc++fs&quot;</span> \</span><br><span class="line">      -DCMAKE_SHARED_LINKER_FLAGS=<span class="string">&quot;-lstdc++fs&quot;</span> \</span><br><span class="line">      -DCMAKE_C_COMPILER=clang \</span><br><span class="line">      -DCMAKE_CXX_COMPILER=clang++</span><br></pre></td></tr></table></figure><p>å°±å¯ä»¥å®Œæˆæ„å»ºç³»ç»Ÿçš„å‡†å¤‡ã€‚ä¹‹åå°±å¯ä»¥æ­£å¸¸æ„å»ºäº†ï¼Œå¤§æ¦‚éœ€è¦ç¼–è¯‘ 1331 ä¸ªå•å…ƒï¼Œ</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cmake --build build --target deqp-vk</span><br></pre></td></tr></table></figure><p>ç­‰æ„å»ºå®Œæˆåï¼Œä½¿ç”¨åä¸ºæä¾›çš„æµ‹è¯•å‘½ä»¤æ‰§è¡Œæµ‹è¯•ã€‚</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">./build/external/vulkancts/modules/vulkan/deqp-vk --deqp-case=dEQP-VK.wsi.wayland.swapchain.render.10swapchains</span><br></pre></td></tr></table></figure><p>è¿è¡Œå‰æœ€å¥½ä½¿ç”¨ vulkaninfo æµ‹è¯•ä¸€ä¸‹ vulkan ä¿¡æ¯ã€‚å¦‚æœæ²¡æœ‰æˆåŠŸè¿è¡Œï¼Œå®‰è£…ä¸€ä¸‹ mesa-vulkan-driversã€‚</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt install mesa-vulkan-drivers</span><br></pre></td></tr></table></figure><p>ä¼šçœ‹åˆ°é€šè¿‡äº† caseã€‚</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">â¯ ./build/external/vulkancts/modules/vulkan/deqp-vk --deqp-case=dEQP-VK.wsi.wayland.swapchain.render.10swapchains</span><br><span class="line">Writing <span class="built_in">test</span> <span class="built_in">log</span> into TestResults.qpa</span><br><span class="line">dEQP Core vulkan-cts-1.4.1.0-93-g7655439d7333848a59d3114ee6227a26259b2b4b (0x7655439d) starting..</span><br><span class="line">  target implementation = <span class="string">&#x27;Default&#x27;</span></span><br><span class="line">B%&lt;-------- Process name: deqp-vk. Logging ended at: Fri Dec 27 15:52:34 2024</span><br><span class="line"></span><br><span class="line">Test <span class="keyword">case</span> <span class="string">&#x27;dEQP-VK.wsi.wayland.swapchain.render.10swapchains&#x27;</span>..</span><br><span class="line">?%&lt;-------- Process name: deqp-vk. Logging ended at: Fri Dec 27 15:52:37 2024</span><br><span class="line"></span><br><span class="line">  Pass (Rendering tests succeeded)</span><br><span class="line">&lt;-------- Process name: deqp-vk. Logging ended at: Fri Dec 27 15:52:37 2024</span><br><span class="line"></span><br><span class="line">DONE!</span><br><span class="line"></span><br><span class="line">Test run totals:</span><br><span class="line">  Passed:        1/1 (100.0%)</span><br><span class="line">  Failed:        0/1 (0.0%)</span><br><span class="line">  Not supported: 0/1 (0.0%)</span><br><span class="line">  Warnings:      0/1 (0.0%)</span><br><span class="line">  Waived:        0/1 (0.0%)</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æŠ€æœ¯åˆ†äº« </category>
          
      </categories>
      
      
        <tags>
            
            <tag> UOS, Vulkan, å›¾å½¢å­¦, å¼€å‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nix home-manager ä½¿ç”¨ç¬”è®°</title>
      <link href="/2024/12/25/nix-home-manager/"/>
      <url>/2024/12/25/nix-home-manager/</url>
      
        <content type="html"><![CDATA[<aside>ğŸ˜µâ€ğŸ’« æ¯æ¬¡éƒ½å¿˜äº†è¦è¿è¡Œå•¥</aside><h2 id="å®‰è£…-nix"><a href="#å®‰è£…-nix" class="headerlink" title="å®‰è£… nix"></a>å®‰è£… nix</h2><p><code>sh &lt;(curl -L https://nixos.org/nix/install) --no-daemon</code></p><h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><p>åˆ›å»ºæ–‡ä»¶ <code>~/.config/nix/nix.conf</code>,å†™å…¥ä»¥ä¸‹å†…å®¹ï¼š</p><figure class="highlight nix"><table><tr><td class="code"><pre><span class="line">e<span class="attr">xperimental-features</span> <span class="operator">=</span> nix-command flakes</span><br></pre></td></tr></table></figure><p>åˆ›å»ºç›®å½• <code>~/.config/home-manager/</code>,éœ€è¦ä¸¤ä¸ªæ–‡ä»¶ï¼Œæˆ‘çš„é…ç½®é‡Œä½¿ç”¨ flake ä½œä¸ºè¾…åŠ©ï¼Œæ‰€ä»¥å…ˆåˆ›å»º <code>flake.nix</code> æ–‡ä»¶ï¼Œå†™å…¥ä»¥ä¸‹å†…å®¹ï¼š</p><figure class="highlight nix"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">description</span> <span class="operator">=</span> <span class="string">&quot;Home Manager configuration for Me QwQ&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="attr">inputs</span> <span class="operator">=</span> &#123;</span><br><span class="line">    <span class="attr">nixpkgs.url</span> <span class="operator">=</span> <span class="string">&quot;github:nixos/nixpkgs/nixos-unstable&quot;</span>;</span><br><span class="line">    <span class="attr">home-manager</span> <span class="operator">=</span> &#123;</span><br><span class="line">      <span class="attr">url</span> <span class="operator">=</span> <span class="string">&quot;github:nix-community/home-manager&quot;</span>;</span><br><span class="line">      <span class="attr">inputs.nixpkgs.follows</span> <span class="operator">=</span> <span class="string">&quot;nixpkgs&quot;</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="attr">flake-utils.url</span> <span class="operator">=</span> <span class="string">&quot;github:numtide/flake-utils&quot;</span>;</span><br><span class="line">    <span class="attr">neovim-nightly-overlay</span> <span class="operator">=</span> &#123;</span><br><span class="line">      <span class="attr">url</span> <span class="operator">=</span> <span class="string">&quot;github:nix-community/neovim-nightly-overlay&quot;</span>;</span><br><span class="line">      <span class="attr">inputs.nixpkgs.follows</span> <span class="operator">=</span> <span class="string">&quot;nixpkgs&quot;</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="attr">outputs</span> <span class="operator">=</span> &#123; self, flake-utils, nixpkgs, home-manager, neovim-nightly-overlay, ... &#125;@<span class="params">inputs:</span></span><br><span class="line">    flake-utils.lib.eachDefaultSystemPassThrough (<span class="params">system:</span></span><br><span class="line">      <span class="keyword">let</span></span><br><span class="line">        <span class="attr">pkgs</span> <span class="operator">=</span> nixpkgs.legacyPackages.$&#123;system&#125;;</span><br><span class="line">      <span class="keyword">in</span> &#123;</span><br><span class="line">        <span class="attr">homeConfigurations.lxz</span> <span class="operator">=</span> home-manager.lib.homeManagerConfiguration &#123;</span><br><span class="line">          <span class="keyword">inherit</span> pkgs;</span><br><span class="line"></span><br><span class="line">          <span class="comment"># Specify your home configuration modules here, for example,</span></span><br><span class="line">          <span class="comment"># the path to your home.nix.</span></span><br><span class="line">          <span class="attr">modules</span> <span class="operator">=</span> [</span><br><span class="line">            <span class="symbol">./home.nix</span></span><br><span class="line">          ];</span><br><span class="line"></span><br><span class="line">          <span class="comment"># Optionally use extraSpecialArgs</span></span><br><span class="line">          <span class="comment"># to pass through arguments to home.nix</span></span><br><span class="line">          <span class="attr">extraSpecialArgs</span> <span class="operator">=</span> &#123; <span class="keyword">inherit</span> inputs; &#125;;</span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>nix çš„è¯­æ³•å°±ä¸åœ¨è¿™é‡Œä»‹ç»äº†ï¼Œè¿˜éœ€è¦åˆ›å»ºä¸€ä¸ª <code>home.nix</code>ï¼Œå†™å…¥ä»¥ä¸‹å†…å®¹ï¼š</p><figure class="highlight nix"><table><tr><td class="code"><pre><span class="line">&#123; inputs, config, pkgs, ... &#125;:</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment"># Home Manager needs a bit of information about you and the</span></span><br><span class="line">  <span class="comment"># paths it should manage.</span></span><br><span class="line">  <span class="attr">home.username</span> <span class="operator">=</span> <span class="string">&quot;lxz&quot;</span>;</span><br><span class="line">  <span class="attr">home.homeDirectory</span> <span class="operator">=</span> <span class="string">&quot;/home/lxz&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="attr">home.packages</span> <span class="operator">=</span> <span class="keyword">with</span> pkgs; [</span><br><span class="line">    git-lfs</span><br><span class="line">    neofetch</span><br><span class="line">    htop</span><br><span class="line">    ripgrep</span><br><span class="line">    lazygit</span><br><span class="line">    gh</span><br><span class="line">    go</span><br><span class="line">    cargo</span><br><span class="line">    lemonade</span><br><span class="line">    nix-index</span><br><span class="line">    nix-update</span><br><span class="line"></span><br><span class="line">    <span class="comment"># font</span></span><br><span class="line">    noto-fonts</span><br><span class="line">    noto-fonts-cjk</span><br><span class="line">    noto-fonts-emoji</span><br><span class="line">    liberation_ttf</span><br><span class="line">    fira-code</span><br><span class="line">    fira-code-symbols</span><br><span class="line">    fira-code-nerdfont</span><br><span class="line">    sarasa-gothic</span><br><span class="line">    (nerdfonts.override &#123; <span class="attr">fonts</span> <span class="operator">=</span> [ <span class="string">&quot;FiraCode&quot;</span> <span class="string">&quot;DroidSansMono&quot;</span> ]; &#125;)</span><br><span class="line"></span><br><span class="line">    nodejs</span><br><span class="line"></span><br><span class="line">    <span class="comment"># neovim nightly</span></span><br><span class="line">    neovim</span><br><span class="line">    <span class="comment"># neovim-nightly</span></span><br><span class="line">  ];</span><br><span class="line"></span><br><span class="line">  <span class="attr">nixpkgs.overlays</span> <span class="operator">=</span> [</span><br><span class="line">    inputs.neovim-nightly-overlay.overlays.default</span><br><span class="line">  ];</span><br><span class="line"></span><br><span class="line">  <span class="attr">fonts.fontconfig.enable</span> <span class="operator">=</span> <span class="literal">true</span>; <span class="comment"># Allow fontconfig to discover fonts in home.packages</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">programs.fzf</span> <span class="operator">=</span> &#123;</span><br><span class="line">    <span class="attr">enable</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="attr">enableBashIntegration</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="attr">enableZshIntegration</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="attr">services.gpg-agent</span> <span class="operator">=</span> &#123;</span><br><span class="line">    <span class="attr">enable</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="attr">defaultCacheTtl</span> <span class="operator">=</span> <span class="number">1800</span>;</span><br><span class="line">    <span class="attr">enableSshSupport</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="attr">home.shellAliases</span> <span class="operator">=</span> &#123;</span><br><span class="line">    <span class="string">&quot;...&quot;</span> <span class="operator">=</span> <span class="string">&quot;cd ../..&quot;</span>;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="attr">home.stateVersion</span> <span class="operator">=</span> <span class="string">&quot;24.05&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment"># Let Home Manager install and manage itself.</span></span><br><span class="line">  <span class="attr">programs.home-manager.enable</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ–‡ä»¶çš„é…ç½®å°±æ˜¯å®‰è£…å’Œé…ç½®è½¯ä»¶äº†ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘å®šä¹‰äº†ä¸€äº›è·¯å¾„å’Œè½¯ä»¶åŒ…ï¼Œä»¥åŠå­—ä½“çš„ override ç­‰ï¼Œå¯ä»¥æŒ‰éœ€ä¿®æ”¹ã€‚</p><h2 id="å®‰è£…å’Œæ›´æ–°"><a href="#å®‰è£…å’Œæ›´æ–°" class="headerlink" title="å®‰è£…å’Œæ›´æ–°"></a>å®‰è£…å’Œæ›´æ–°</h2><p><code>nix flake update</code> æ›´æ–°ä¸‹ä»“åº“</p><p><code>nix-shell -p home-manager</code> å®‰è£…ä¸€ä¸ª home-managerã€‚</p><p><code>home-manager switch --flake .</code> ä½¿ç”¨å½“å‰é…ç½®å®‰è£… nix è½¯ä»¶åŒ…ï¼Œå…¶ä¸­åŒ…æ‹¬äº† home-managerã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æŠ€æœ¯åˆ†äº« </category>
          
      </categories>
      
      
        <tags>
            
            <tag> dotfile </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¼‚ä¸–ç›¸é‡ï¼Œå°½äº«ç¾å‘³</title>
      <link href="/2024/11/23/have-a-nice-day/"/>
      <url>/2024/11/23/have-a-nice-day/</url>
      
        <content type="html"><![CDATA[<p>ä»Šå¤©å‘¨äº”ï¼Œä¸‹ç­å»æ¥è€å©†ä¸‹ç­å›å®¶ï¼Œå¿«åˆ°å®¶çš„æ—¶å€™çªç„¶æœ‰ç‚¹å˜´é¦‹ï¼Œæƒ³åƒçƒ§çƒ¤ã€‚</p><p>æˆ‘ï¼šä»¥å‰å»çš„é‚£å®¶éŸ©å›½çƒ¤è‚‰åº—èŠ±äº†å¤šå°‘é’±ï¼Ÿ</p><p>è€å©†ï¼šä¸‰ç™¾å¤šã€‚</p><p>æˆ‘ï¼šä¸‰ç™¾å¤šå¤ªè´µäº†ï¼Œä¸å»ï¼ï¼ˆæ‹å¤§è…¿ï¼‰</p><p>æˆ‘ï¼šä¸‰ç™¾å—éƒ½å¤Ÿä¹°å¤šå°‘è‚‰äº†ã€‚</p><p>è€å©†ï¼šé‚£åœ¨å®¶è‡ªå·±åšï¼Ÿä¹°ç‚¹äº”èŠ±ï¼Œä¹°ç‚¹æ³¡èœï¼Œç”Ÿèœï¼Œå®¶é‡Œè¿˜æœ‰ç‰›è‚‰ã€‚</p><p>æˆ‘ï¼šå¯ä»¥ï¼Œè‡ªå·±åšä¸‹ä¹Ÿè´¹ä¸äº†å¤šå°‘åŠŸå¤«ï¼Œè¿˜èƒ½åƒåˆ°é¥±ã€‚</p><p>è€å©†ï¼šç”¨ç”µé¥¼é“›ç›´æ¥çƒ¤ã€‚</p><p>æˆ‘ï¼šç”µé¥¼é“›ç«åŠ›ä¸å¤Ÿå§ã€‚</p><p>è€å©†ï¼šå¤Ÿï¼Œä¸è¡Œè¿˜æœ‰å°çƒ¤ç›˜ï¼Œä¸“é—¨çƒ¤è‚‰çš„ã€‚</p><p>æˆ‘ï¼šå¥½ï¼Œç°åœ¨è¿‡å»ä¹°è‚‰ã€‚</p><p>æœ€ç»ˆèŠ±äº†ä¸åˆ°ä¸€ç™¾å—é’±ï¼Œä¸¤ä¸ªäººåƒåˆ°æ’‘ï¼Œè¿˜æ²¡åƒå®Œã€‚ ğŸ˜€</p><p>äº”èŠ±è‚‰ 23å…ƒ æ¥¼ä¸‹è¶…å¸‚</p><p>ç‰›è‚‰ 10å…ƒ   æ°¸æ—ºå¤œé—´æ‰“æŠ˜</p><p>ç”Ÿèœ 2å…ƒ    æ¥¼ä¸‹èœå¸‚åœºé€çš„</p><p>é”…åœˆ 40å…ƒ   åªèƒ½è‡ªå·±èŠ±é’±äº†</p><p>ğŸ˜­ æƒ³æƒ³ä»¥å‰å››äº”ç™¾å»å¤–è¾¹åƒï¼Œè¿˜åƒä¸é¥±ã€‚</p><img src="/2024/11/23/have-a-nice-day/image.png" class="" title="image.png"><img src="/2024/11/23/have-a-nice-day/IMG_5439.jpeg" class="" title="IMG_5439.jpeg"><img src="/2024/11/23/have-a-nice-day/IMG_5437.jpeg" class="" title="IMG_5437.jpeg"><img src="/2024/11/23/have-a-nice-day/IMG_5441.jpeg" class="" title="IMG_5441.jpeg"><img src="/2024/11/23/have-a-nice-day/IMG_5440.jpeg" class="" title="IMG_5440.jpeg"><img src="/2024/11/23/have-a-nice-day/IMG_5434.jpeg" class="" title="IMG_5434.jpeg"><img src="/2024/11/23/have-a-nice-day/IMG_5442.jpeg" class="" title="IMG_5442.jpeg"><img src="/2024/11/23/have-a-nice-day/IMG_5435.jpeg" class="" title="IMG_5435.jpeg"><img src="/2024/11/23/have-a-nice-day/IMG_5438.jpeg" class="" title="IMG_5438.jpeg">]]></content>
      
      
      <categories>
          
          <category> å¿ƒæƒ…éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¥åº·, æ€è€ƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Treeland Part.1 å¦‚ä½•å®ç°ä¸€ä¸ªåŸºäº wlroots çš„åˆæˆå™¨</title>
      <link href="/2024/11/09/treeland-part1-how-to-implement-a-wlroots-based-compositor/"/>
      <url>/2024/11/09/treeland-part1-how-to-implement-a-wlroots-based-compositor/</url>
      
        <content type="html"><![CDATA[<aside>ğŸ˜€ Treeland æ˜¯ä¸€ä¸ªåŸºäº wlroots å’Œ Qt çš„ Wayland åˆæˆå™¨å¹¶ä¸”æ”¯æŒå¤šç”¨æˆ·å…±ç”¨åˆæˆå™¨ã€‚</aside><h2 id="åè¯æ¦‚å¿µ"><a href="#åè¯æ¦‚å¿µ" class="headerlink" title="åè¯æ¦‚å¿µ"></a>åè¯æ¦‚å¿µ</h2><h3 id="Qt"><a href="#Qt" class="headerlink" title="Qt"></a>Qt</h3><p>Qtï¼ˆ&#x2F;ËˆkjuËt&#x2F;ï¼Œå‘éŸ³åŒâ€œcuteâ€ï¼‰æ˜¯ä¸€ä¸ªè·¨å¹³å°çš„C++åº”ç”¨ç¨‹åºå¼€å‘æ¡†æ¶ã€‚å¹¿æ³›ç”¨äºå¼€å‘GUIç¨‹åºï¼Œè¿™ç§æƒ…å†µä¸‹åˆè¢«ç§°ä¸ºéƒ¨ä»¶å·¥å…·ç®±ã€‚ä¹Ÿå¯ç”¨äºå¼€å‘éGUIç¨‹åºï¼Œä¾‹å¦‚æ§åˆ¶å°å·¥å…·å’ŒæœåŠ¡å™¨ã€‚</p><h3 id="wlroots"><a href="#wlroots" class="headerlink" title="wlroots"></a>wlroots</h3><p>ç”¨äºæ„å»º <a href="https://wayland.freedesktop.org/">Wayland</a> åˆæˆå™¨çš„æ¨¡å—åŒ–å·¥å…·é›†ï¼Œç®€åŒ–äº†çº¦ 60,000 è¡Œä»£ç çš„å¼€å‘å·¥ä½œã€‚</p><ul><li>æä¾›æŠ½è±¡åº•å±‚æ˜¾ç¤ºå’Œè¾“å…¥çš„åç«¯ï¼Œæ”¯æŒ KMS&#x2F;DRMã€libinputã€Waylandã€X11 ç­‰ï¼Œå¯åŠ¨æ€åˆ›å»ºå’Œé”€æ¯ã€‚</li><li>å®ç°å¤šç§ Wayland æ¥å£ï¼Œæ”¯æŒåè®®æ‰©å±•ï¼Œä¿ƒè¿›åˆæˆå™¨æ ‡å‡†åŒ–ã€‚</li><li>æä¾›é€šç”¨åˆæˆå™¨ç»„ä»¶ï¼Œå¦‚ç‰©ç†ç©ºé—´è¾“å‡ºç®¡ç†ã€‚</li><li>é›†æˆ Xwayland æŠ½è±¡ï¼Œç®€åŒ– X11 çª—å£ç®¡ç†ã€‚</li><li>æä¾›æ¸²æŸ“å™¨æŠ½è±¡ï¼Œæ”¯æŒç®€å•å’Œè‡ªå®šä¹‰æ¸²æŸ“éœ€æ±‚ã€‚</li></ul><h3 id="seat"><a href="#seat" class="headerlink" title="seat"></a>seat</h3><p>ç”±åˆ†é…ç»™ç‰¹å®šå·¥ä½œåœºæ™¯çš„æ‰€æœ‰ç¡¬ä»¶è®¾å¤‡ç»„æˆã€‚å®ƒè‡³å°‘åŒ…å«ä¸€ä¸ªå›¾å½¢è®¾å¤‡ï¼Œé€šå¸¸è¿˜æœ‰é”®ç›˜å’Œé¼ æ ‡ã€‚æ­¤å¤–ï¼Œå®ƒå¯èƒ½åŒ…æ‹¬æ‘„åƒå¤´ã€å£°å¡ç­‰è®¾å¤‡ã€‚åº§ä½ç”±åº§ä½åç§°æ ‡è¯†ï¼Œè¿™æ˜¯ä¸€ä¸ªçŸ­å­—ç¬¦ä¸²ï¼ˆä¸è¶…è¿‡64ä¸ªå­—ç¬¦ï¼‰ï¼Œä»¥â€seatâ€å››ä¸ªå­—ç¬¦å¼€å¤´ï¼Œåè·Ÿè‡³å°‘ä¸€ä¸ªa-zA-Z0-9èŒƒå›´å†…çš„å­—ç¬¦ï¼Œæˆ–â€_â€å’Œâ€-â€œã€‚è¿™ç§å‘½åæ–¹å¼é€‚åˆç”¨äºæ–‡ä»¶åã€‚åº§ä½åç§°å¯èƒ½æ˜¯ç¨³å®šçš„ï¼Œä¹Ÿå¯èƒ½ä¸ç¨³å®šï¼Œå¦‚æœåº§ä½å†æ¬¡å¯ç”¨ï¼Œå…¶åç§°å¯ä»¥é‡å¤ä½¿ç”¨ã€‚</p><h3 id="RHI"><a href="#RHI" class="headerlink" title="RHI"></a>RHI</h3><p>RHI æ˜¯ <code>Renderer Hardware Interface</code>ï¼ˆæ¸²æŸ“ç¡¬ä»¶æ¥å£ï¼‰çš„ç¼©å†™ï¼Œæ˜¯ä¸€å¥—å¯¹ç¡¬ä»¶çš„æŠ½è±¡ï¼Œåœ¨ä¸Šå±‚åªéœ€è¦è®¾ç½®å‚æ•°ï¼Œåº•å±‚å…·ä½“ä½¿ç”¨çš„æ˜¯ OpenGLã€Vulkanã€DX12 è¿˜æ˜¯ Metal å“ªå¥—æ¥å£ï¼Œæˆ‘ä»¬æ˜¯ä¸å¿…å…³å¿ƒçš„ã€‚</p><p>Qt6 æä¾›äº† QRHIï¼Œä¸º Qt ç¨‹åºæä¾›äº†åº•å±‚çš„ç¡¬ä»¶æŠ½è±¡ï¼Œè¿™æ ·ä¸Šå±‚çš„ QtQuick ç»„ä»¶åœ¨æ‰§è¡Œ GPU æ¸²æŸ“æ—¶ï¼Œå°±å¯ä»¥è‡ªåŠ¨è°ƒç”¨å¯¹åº”çš„é©±åŠ¨æ¥å£ã€‚</p><h3 id="QPA"><a href="#QPA" class="headerlink" title="QPA"></a>QPA</h3><p>Qt å¹³å°æŠ½è±¡ï¼ˆQPAï¼‰æ˜¯ Qt ä¸­çš„æ ¸å¿ƒå¹³å°æŠ½è±¡å±‚ã€‚</p><p>QPA çš„ API å¯é€šè¿‡ç±»å‰ç¼€â€QPlatform*â€è¯†åˆ«ï¼Œç”¨äºå®ç° <a href="https://doc.qt.io/qt-6/qtgui-index.html">Qt GUI</a> ä¸­çš„é«˜çº§ç±»ã€‚ä¾‹å¦‚ï¼Œ<code>QPlatformWindow</code> ç”¨äºçª—å£ç³»ç»Ÿé›†æˆï¼Œè€Œ <code>QPlatformTheme</code> å’Œ <code>QStyleHint</code> åˆ™ç”¨äºæ·±å±‚æ¬¡çš„å¹³å°ä¸»é¢˜å’Œé›†æˆã€‚</p><h2 id="åŸºæœ¬å·¥ä½œæµç¨‹"><a href="#åŸºæœ¬å·¥ä½œæµç¨‹" class="headerlink" title="åŸºæœ¬å·¥ä½œæµç¨‹"></a>åŸºæœ¬å·¥ä½œæµç¨‹</h2><p><code>Treeland</code> ä½¿ç”¨ <code>QQuickWindow</code> ä½œä¸ºæ¸²æŸ“çš„æ ¹ï¼Œè¿™æ ·åœ¨ <code>Treeland</code> é‡Œå¼€å‘æ—¶ï¼Œå°±å¦‚åŒå¼€å‘ä¸€ä¸ªæ™®é€š Qt ç¨‹åºä¸€æ ·ï¼Œå…ˆåˆ›å»ºä¸€ä¸ª Windowï¼Œåœ¨ Window å†…åˆ›å»º Qt æ§ä»¶ï¼Œä½¿ç”¨ QEvent å¤„ç†å„ç§äº‹ä»¶ã€‚</p><p>é‚£ä¹ˆ Treeland æ˜¯å¦‚ä½•å®ç°è¿™ä»¶äº‹çš„å‘¢ï¼Ÿ</p><p><code>QQuickWindow</code> çš„ç§æœ‰ç±»æä¾›äº†è‡ªå®šä¹‰ <code>QQuickGraphicsDevice</code> å¯¹è±¡çš„æ¥å£ï¼Œè€Œ <code>QQuickGraphicsDevice</code> å¯ä»¥ä½¿ç”¨ <code>fromOpenGLContext</code> å’Œ <code>fromPhyicalDevice</code> åˆ›å»ºæ–°çš„å¯¹è±¡ï¼Œé‚£ä¹ˆ <code>Treeland</code> åªéœ€è¦ç»§æ‰¿ <code>QQuickWindow</code>ï¼Œå¹¶ä» <code>wlroots</code> è·å– OpenGL context å’Œ phyical deviceï¼Œå°±å¯ä»¥å°† Qt QuickWindow çš„æ¸²æŸ“ï¼Œå«æ¥åˆ° <code>wlroots</code> ä¸Šã€‚</p><p>é€šè¿‡å°† <code>wlroots</code> çš„æ¸²æŸ“ä¸Šä¸‹æ–‡ä¸ Qt çš„æ¸²æŸ“ä¸Šä¸‹æ–‡è¿›è¡Œç»“åˆï¼Œå¯ä»¥å°† <code>wlroots</code> æ¸²æŸ“çš„å›¾å½¢ç»“æœåµŒå…¥åˆ° Qt åº”ç”¨ç¨‹åºçš„æ¸²æŸ“æµç¨‹ä¸­ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ <code>wlroots</code> æä¾›çš„å›¾å½¢èµ„æºå’Œè®¾å¤‡å¯¹è±¡ï¼Œå¦‚ç‰©ç†è®¾å¤‡ï¼ˆ<code>phdev</code>ï¼‰ã€é€»è¾‘è®¾å¤‡ï¼ˆ<code>dev</code>ï¼‰å’Œé˜Ÿåˆ—æ—ï¼ˆ<code>queue_family</code>ï¼‰ï¼Œä»¥å‡å°‘ä¸å¿…è¦çš„ä¸Šä¸‹æ–‡åˆ‡æ¢å’Œèµ„æºæ‹·è´ã€‚è¿™æ ·ï¼ŒQt å°±å¯ä»¥åˆ©ç”¨ <code>wlroots</code> æä¾›çš„æ¸²æŸ“èƒ½åŠ›ï¼ŒåŒæ—¶èƒ½å¤Ÿç»§ç»­ä½¿ç”¨ Qt çš„æ¸²æŸ“æ¡†æ¶å’Œ APIã€‚</p><p>ä¹‹ååœ¨ Qt QPA ä¸­å°†å±å¹•ä¿¡æ¯ï¼Œä»¥åŠè¾“å…¥ä¿¡æ¯è½¬æ¢æˆ Qt å†…éƒ¨å¯¹è±¡ï¼Œä»è€Œåˆ©ç”¨ Qt è‡ªèº«çš„äº‹ä»¶å¾ªç¯ç­‰æœºåˆ¶ç»§ç»­å¤„ç†ã€‚</p><h2 id="Qt-QPA"><a href="#Qt-QPA" class="headerlink" title="Qt QPA"></a>Qt QPA</h2><p>QPA ä¸º Qt æä¾›äº†è·¨å¹³å°çš„æ¥å£æŠ½è±¡èƒ½åŠ›ï¼Œæˆ‘ä»¬å¯ä»¥æä¾›è‡ªå·±çš„ QPA æ’ä»¶æ¥ä¸º Qt ç¨‹åºæä¾›æ–°çš„èƒ½åŠ›ï¼Œä¾‹å¦‚å°† <code>wlroots</code> çš„è¾“å…¥äº‹ä»¶è½¬æ¢æˆ Qt å†…éƒ¨äº‹ä»¶ã€‚</p><h3 id="è¾“å…¥äº‹ä»¶å¤„ç†"><a href="#è¾“å…¥äº‹ä»¶å¤„ç†" class="headerlink" title="è¾“å…¥äº‹ä»¶å¤„ç†"></a>è¾“å…¥äº‹ä»¶å¤„ç†</h3><img src="/2024/11/09/treeland-part1-how-to-implement-a-wlroots-based-compositor/waylib.png" class="" title="Treeland å¤„ç†åº•å±‚äº‹ä»¶ä¸ä¸Šå±‚äº‹ä»¶çš„æµç¨‹"><p>Treeland å¤„ç†åº•å±‚äº‹ä»¶ä¸ä¸Šå±‚äº‹ä»¶çš„æµç¨‹</p><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">WOutputRenderWindow::event</span><span class="params">(QEvent *event)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">Q_D</span>(WOutputRenderWindow);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (event-&gt;<span class="built_in">type</span>() == doRenderEventType) &#123;</span><br><span class="line">        QCoreApplication::<span class="built_in">removePostedEvents</span>(<span class="keyword">this</span>, doRenderEventType);</span><br><span class="line">        <span class="built_in">d_func</span>()-&gt;<span class="built_in">doRender</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (QW::RenderWindow::<span class="built_in">beforeDisposeEventFilter</span>(<span class="keyword">this</span>, event)) &#123;</span><br><span class="line">        event-&gt;<span class="built_in">accept</span>();</span><br><span class="line">        QW::RenderWindow::<span class="built_in">afterDisposeEventFilter</span>(<span class="keyword">this</span>, event);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">bool</span> isAccepted = QQuickWindow::<span class="built_in">event</span>(event);</span><br><span class="line">    <span class="keyword">if</span> (QW::RenderWindow::<span class="built_in">afterDisposeEventFilter</span>(<span class="keyword">this</span>, event))</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> isAccepted;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ <code>WOutputRenderWindow</code> çš„äº‹ä»¶å¤„ç†ä¸­ï¼Œä¼šé¢å¤–è°ƒç”¨ä¸‹ seat çš„äº‹ä»¶è¿‡æ»¤å™¨ï¼Œç¡®ä¿åˆæˆå™¨å¯ä»¥æ‹¦æˆªæ‰ä¸€éƒ¨åˆ†äº‹ä»¶ï¼Œä¾‹å¦‚å°†ä¸€éƒ¨åˆ†æŒ‰é”®æ‹¦æˆªä¸‹æ¥ï¼Œä¸å‘é€ç»™å®¢æˆ·ç«¯ã€‚</p><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">QWlrootsRenderWindow::beforeDisposeEventFilter</span><span class="params">(QEvent *event)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (event-&gt;<span class="built_in">isInputEvent</span>()) &#123;</span><br><span class="line">        <span class="keyword">auto</span> ie = <span class="built_in">static_cast</span>&lt;QInputEvent*&gt;(event);</span><br><span class="line">        <span class="keyword">auto</span> device = WInputDevice::<span class="built_in">from</span>(ie-&gt;<span class="built_in">device</span>());</span><br><span class="line">        <span class="built_in">Q_ASSERT</span>(device);</span><br><span class="line">        <span class="built_in">Q_ASSERT</span>(device-&gt;<span class="built_in">seat</span>());</span><br><span class="line">        lastActiveCursor = device-&gt;<span class="built_in">seat</span>()-&gt;<span class="built_in">cursor</span>();</span><br><span class="line">        <span class="keyword">return</span> device-&gt;<span class="built_in">seat</span>()-&gt;<span class="built_in">filterEventBeforeDisposeStage</span>(<span class="built_in">window</span>(), ie);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ®µä»£ç å±•ç¤ºäº†è½¬æ¢è¾“å…¥è®¾å¤‡çš„åŠŸèƒ½ï¼Œåˆ¤æ–­è¾“å…¥è®¾å¤‡çš„ç±»å‹ï¼Œåˆ›å»ºå¯¹åº”çš„ <code>QInputDevice</code> å¯¹è±¡ã€‚</p><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">QPointer&lt;QInputDevice&gt; <span class="title">QWlrootsIntegration::addInputDevice</span><span class="params">(WInputDevice *device, <span class="type">const</span> QString &amp;seatName)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    QPointer&lt;QInputDevice&gt; qtdev;</span><br><span class="line">    <span class="keyword">auto</span> qwDevice = device-&gt;<span class="built_in">handle</span>();</span><br><span class="line">    <span class="type">const</span> QString name = QString::<span class="built_in">fromUtf8</span>(qwDevice-&gt;<span class="built_in">handle</span>()-&gt;name);</span><br><span class="line">    qint64 systemId = <span class="built_in">reinterpret_cast</span>&lt;qint64&gt;(device);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">switch</span> (qwDevice-&gt;<span class="built_in">handle</span>()-&gt;type) &#123;</span><br><span class="line">    <span class="keyword">case</span> WLR_INPUT_DEVICE_KEYBOARD: &#123;</span><br><span class="line">        qtdev = <span class="keyword">new</span> <span class="built_in">QInputDevice</span>(name, systemId, QInputDevice::DeviceType::Keyboard, seatName);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> WLR_INPUT_DEVICE_POINTER: &#123;</span><br><span class="line">        qtdev = <span class="keyword">new</span> <span class="built_in">QPointingDevice</span>(name, systemId, QInputDevice::DeviceType::TouchPad, QPointingDevice::PointerType::Generic,</span><br><span class="line">                                    QInputDevice::Capability::Position | QInputDevice::Capability::Hover</span><br><span class="line">                                        | QInputDevice::Capability::Scroll | QInputDevice::Capability::MouseEmulation,</span><br><span class="line">                                    <span class="number">10</span>, <span class="number">32</span>, seatName, <span class="built_in">QPointingDeviceUniqueId</span>());</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> WLR_INPUT_DEVICE_TOUCH: &#123;</span><br><span class="line">        qtdev = <span class="keyword">new</span> <span class="built_in">QPointingDevice</span>(name, systemId, QInputDevice::DeviceType::TouchScreen, QPointingDevice::PointerType::Finger,</span><br><span class="line">                                    QInputDevice::Capability::Position | QInputDevice::Capability::Area | QInputDevice::Capability::MouseEmulation,</span><br><span class="line">                                    <span class="number">10</span>, <span class="number">32</span>, seatName, <span class="built_in">QPointingDeviceUniqueId</span>());</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> WLR_INPUT_DEVICE_TABLET_TOOL: &#123;</span><br><span class="line">        qtdev = <span class="keyword">new</span> <span class="built_in">QPointingDevice</span>(name, systemId, QInputDevice::DeviceType::Stylus, QPointingDevice::PointerType::Pen,</span><br><span class="line">                                    QInputDevice::Capability::XTilt | QInputDevice::Capability::YTilt | QInputDevice::Capability::Pressure,</span><br><span class="line">                                    <span class="number">1</span>, <span class="number">32</span>, seatName, <span class="built_in">QPointingDeviceUniqueId</span>());</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> WLR_INPUT_DEVICE_TABLET_PAD: &#123;</span><br><span class="line">        <span class="keyword">auto</span> pad = <span class="built_in">wlr_tablet_pad_from_input_device</span>(qwDevice-&gt;<span class="built_in">handle</span>());</span><br><span class="line">        qtdev = <span class="keyword">new</span> <span class="built_in">QPointingDevice</span>(name, systemId, QInputDevice::DeviceType::TouchPad, QPointingDevice::PointerType::Pen,</span><br><span class="line">                                    QInputDevice::Capability::Position | QInputDevice::Capability::Hover | QInputDevice::Capability::Pressure,</span><br><span class="line">                                    <span class="number">1</span>, pad-&gt;button_count, seatName, <span class="built_in">QPointingDeviceUniqueId</span>());</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> WLR_INPUT_DEVICE_SWITCH: &#123;</span><br><span class="line">        qtdev = <span class="keyword">new</span> <span class="built_in">QInputDevice</span>(name, systemId, QInputDevice::DeviceType::Keyboard, seatName);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (qtdev) &#123;</span><br><span class="line">        device-&gt;<span class="built_in">setQtDevice</span>(qtdev);</span><br><span class="line">        QWindowSystemInterface::<span class="built_in">registerInputDevice</span>(qtdev);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (qtdev-&gt;<span class="built_in">type</span>() == QInputDevice::DeviceType::Mouse || qtdev-&gt;<span class="built_in">type</span>() == QInputDevice::DeviceType::TouchPad) &#123;</span><br><span class="line">            <span class="keyword">auto</span> primaryQtDevice = QPointingDevice::<span class="built_in">primaryPointingDevice</span>();</span><br><span class="line">            <span class="keyword">if</span> (!WInputDevice::<span class="built_in">from</span>(primaryQtDevice)) &#123;</span><br><span class="line">                <span class="comment">// Ensure the primary pointing device is the WInputDevice</span></span><br><span class="line">                <span class="keyword">auto</span> pd = <span class="built_in">const_cast</span>&lt;QPointingDevice*&gt;(primaryQtDevice);</span><br><span class="line">                pd-&gt;<span class="built_in">setParent</span>(<span class="literal">nullptr</span>);</span><br><span class="line">                <span class="keyword">delete</span> pd;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">Q_ASSERT</span>(WInputDevice::<span class="built_in">from</span>(QPointingDevice::<span class="built_in">primaryPointingDevice</span>()));</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (qtdev-&gt;<span class="built_in">type</span>() == QInputDevice::DeviceType::Keyboard) &#123;</span><br><span class="line">            <span class="keyword">auto</span> primaryQtDevice = QInputDevice::<span class="built_in">primaryKeyboard</span>();</span><br><span class="line">            <span class="keyword">if</span> (!WInputDevice::<span class="built_in">from</span>(primaryQtDevice)) &#123;</span><br><span class="line">                <span class="comment">// Ensure the primary keyboard device is the WInputDevice</span></span><br><span class="line">                <span class="keyword">auto</span> pd = <span class="built_in">const_cast</span>&lt;QInputDevice*&gt;(primaryQtDevice);</span><br><span class="line">                pd-&gt;<span class="built_in">setParent</span>(<span class="literal">nullptr</span>);</span><br><span class="line">                <span class="keyword">delete</span> pd;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">Q_ASSERT</span>(WInputDevice::<span class="built_in">from</span>(QInputDevice::<span class="built_in">primaryKeyboard</span>()));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> qtdev;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å®¢æˆ·ç«¯äº‹ä»¶"><a href="#å®¢æˆ·ç«¯äº‹ä»¶" class="headerlink" title="å®¢æˆ·ç«¯äº‹ä»¶"></a>å®¢æˆ·ç«¯äº‹ä»¶</h3><p>åœ¨ Treeland è¿˜æœ‰ä¸€ç§äº‹ä»¶éœ€è¦å¤„ç†ï¼Œå½“ç”¨æˆ·ç‚¹å‡»ä¸€ä¸ªçª—å£ï¼Œåˆæˆå™¨éœ€è¦å‘ŠçŸ¥å®¢æˆ·ç«¯å“ªä¸ªåæ ‡ç‚¹å‡»äº†ã€‚æˆ–è€…ä½¿ç”¨é”®ç›˜è¿›è¡Œè¾“å…¥æ—¶ï¼Œéœ€è¦å‘ŠçŸ¥å®¢æˆ·ç«¯è¾“å…¥çš„å†…å®¹ã€‚</p><p>é¦–å…ˆï¼ŒTreeland ä¼šæ ‡è®°ä¸€ä¸ªçª—å£æˆä¸ºæ¿€æ´»çª—å£ï¼Œè®¾ç½®ç»™ seatï¼Œè¿™æ · <code>wlroots</code> å°±çŸ¥é“å“ªä¸ªçª—å£æ­¤æ—¶æ‹¥æœ‰ç„¦ç‚¹ã€‚</p><p>ä¹‹åå½“é”®ç›˜å‘ç”Ÿè¾“å…¥äº‹ä»¶æ—¶ï¼ŒTreeland æ²¡æœ‰è¿‡æ»¤æ‰æŒ‰é”®äº‹ä»¶ï¼Œæˆ–è€…æ˜¯æ”¾è¡ŒæŸäº›æŒ‰é”®ï¼Œè¿™äº›å‰©ä½™çš„è¾“å…¥äº‹ä»¶å°±ä¼šåœ¨ wseat çš„ sendEvent ä¸­ï¼Œå‘é€ç»™æ¿€æ´»çš„å®¢æˆ·ç«¯ã€‚</p><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// for keyboard event</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">doNotifyKey</span><span class="params">(WInputDevice *device, <span class="type">uint32_t</span> keycode, <span class="type">uint32_t</span> state, <span class="type">uint32_t</span> timestamp)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">keyboardFocusSurface</span>())</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">q_func</span>()-&gt;<span class="built_in">setKeyboard</span>(device);</span><br><span class="line">    <span class="comment">/* Send modifiers to the client. */</span></span><br><span class="line">    <span class="keyword">this</span>-&gt;<span class="built_in">handle</span>()-&gt;<span class="built_in">keyboard_notify_key</span>(timestamp, keycode, state);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å±å¹•ä¿¡æ¯"><a href="#å±å¹•ä¿¡æ¯" class="headerlink" title="å±å¹•ä¿¡æ¯"></a>å±å¹•ä¿¡æ¯</h3><p>åœ¨ QPA ä¸­è¿˜å¯¹ <code>WOutput</code> è¿›è¡Œäº†å°è£… <code>QWlrootsScreen</code>ã€‚</p><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">QWlrootsScreen *<span class="title">QWlrootsIntegration::addScreen</span><span class="params">(WOutput *output)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    m_screens &lt;&lt; <span class="keyword">new</span> <span class="built_in">QWlrootsScreen</span>(output);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">isMaster</span>()) &#123;</span><br><span class="line">        QWindowSystemInterface::<span class="built_in">handleScreenAdded</span>(m_screens.<span class="built_in">last</span>());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (m_placeholderScreen) &#123;</span><br><span class="line">            QWindowSystemInterface::<span class="built_in">handleScreenRemoved</span>(m_placeholderScreen.<span class="built_in">release</span>());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">Q_UNUSED</span>(<span class="keyword">new</span> <span class="built_in">QScreen</span>(m_screens.<span class="built_in">last</span>()))</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    m_screens.<span class="built_in">last</span>()-&gt;<span class="built_in">initialize</span>();</span><br><span class="line">    output-&gt;<span class="built_in">setScreen</span>(m_screens.<span class="built_in">last</span>());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> m_screens.<span class="built_in">last</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>QWlrootsScreen</code> ç»§æ‰¿è‡ª <code>QPlatformScreen</code>ï¼Œåšçš„äº‹æƒ…æ˜¯å°†éƒ¨åˆ†å‚æ•°è¿›è¡Œè½¬æ¢ï¼Œä¾‹å¦‚physicalSizeã€devicePixelRatioã€DPIç­‰ï¼Œä¹‹åé€šè¿‡ <code>QWindowSystemInterface::handleScreenAdded</code> å°†åˆ›å»ºå¥½çš„ <code>QWlrootsScreen</code> æ·»åŠ è¿› Qt å†…ã€‚</p><h2 id="Qt-RHI"><a href="#Qt-RHI" class="headerlink" title="Qt RHI"></a>Qt RHI</h2><p>æ‘˜æŠ„ä¸€æ®µæ¥è‡ª waylib ä¸­åˆå§‹åŒ– Qt RHI çš„ä»£ç </p><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">WOutputRenderWindowPrivate::initRCWithRhi</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">W_Q</span>(WOutputRenderWindow);</span><br><span class="line"></span><br><span class="line">    QQuickRenderControlPrivate *rcd = QQuickRenderControlPrivate::<span class="built_in">get</span>(<span class="built_in">rc</span>());</span><br><span class="line">    QSGRhiSupport *rhiSupport = QSGRhiSupport::<span class="built_in">instance</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// sanity check for Vulkan</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> ENABLE_VULKAN_RENDER</span></span><br><span class="line">    <span class="keyword">if</span> (rhiSupport-&gt;<span class="built_in">rhiBackend</span>() == QRhi::Vulkan) &#123;</span><br><span class="line">        vkInstance.<span class="built_in">reset</span>(<span class="keyword">new</span> <span class="built_in">QVulkanInstance</span>());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">auto</span> phdev = <span class="built_in">wlr_vk_renderer_get_physical_device</span>(m_renderer-&gt;<span class="built_in">handle</span>());</span><br><span class="line">        <span class="keyword">auto</span> dev = <span class="built_in">wlr_vk_renderer_get_device</span>(m_renderer-&gt;<span class="built_in">handle</span>());</span><br><span class="line">        <span class="keyword">auto</span> queue_family = <span class="built_in">wlr_vk_renderer_get_queue_family</span>(m_renderer-&gt;<span class="built_in">handle</span>());</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> QT_VERSION &gt; QT_VERSION_CHECK(6, 6, 0)</span></span><br><span class="line">        <span class="keyword">auto</span> instance = <span class="built_in">wlr_vk_renderer_get_instance</span>(m_renderer-&gt;<span class="built_in">handle</span>());</span><br><span class="line">        vkInstance-&gt;<span class="built_in">setVkInstance</span>(instance);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">        <span class="comment">//        vkInstance-&gt;setExtensions(fromCStyleList(vkRendererAttribs.extension_count, vkRendererAttribs.extensions));</span></span><br><span class="line">        <span class="comment">//        vkInstance-&gt;setLayers(fromCStyleList(vkRendererAttribs.layer_count, vkRendererAttribs.layers));</span></span><br><span class="line">        vkInstance-&gt;<span class="built_in">setApiVersion</span>(&#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>&#125;);</span><br><span class="line">        vkInstance-&gt;<span class="built_in">create</span>();</span><br><span class="line">        q-&gt;<span class="built_in">setVulkanInstance</span>(vkInstance.<span class="built_in">data</span>());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">auto</span> gd = QQuickGraphicsDevice::<span class="built_in">fromDeviceObjects</span>(phdev, dev, queue_family);</span><br><span class="line">        q-&gt;<span class="built_in">setGraphicsDevice</span>(gd);</span><br><span class="line">    &#125; <span class="keyword">else</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    <span class="keyword">if</span> (rhiSupport-&gt;<span class="built_in">rhiBackend</span>() == QRhi::OpenGLES2) &#123;</span><br><span class="line">        <span class="built_in">Q_ASSERT</span>(<span class="built_in">wlr_renderer_is_gles2</span>(m_renderer-&gt;<span class="built_in">handle</span>()));</span><br><span class="line">        <span class="keyword">auto</span> egl = <span class="built_in">wlr_gles2_renderer_get_egl</span>(m_renderer-&gt;<span class="built_in">handle</span>());</span><br><span class="line">        <span class="keyword">auto</span> display = <span class="built_in">wlr_egl_get_display</span>(egl);</span><br><span class="line">        <span class="keyword">auto</span> context = <span class="built_in">wlr_egl_get_context</span>(egl);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">this</span>-&gt;glContext = <span class="keyword">new</span> QW::<span class="built_in">OpenGLContext</span>(display, context, <span class="built_in">rc</span>());</span><br><span class="line">        <span class="type">bool</span> ok = <span class="keyword">this</span>-&gt;glContext-&gt;<span class="built_in">create</span>();</span><br><span class="line">        <span class="keyword">if</span> (!ok)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        q-&gt;<span class="built_in">setGraphicsDevice</span>(QQuickGraphicsDevice::<span class="built_in">fromOpenGLContext</span>(<span class="keyword">this</span>-&gt;glContext));</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    QOffscreenSurface *offscreenSurface = <span class="keyword">new</span> QW::<span class="built_in">OffscreenSurface</span>(<span class="literal">nullptr</span>, q);</span><br><span class="line">    offscreenSurface-&gt;<span class="built_in">create</span>();</span><br><span class="line"></span><br><span class="line">    QSGRhiSupport::RhiCreateResult result = rhiSupport-&gt;<span class="built_in">createRhi</span>(q, offscreenSurface);</span><br><span class="line">    <span class="keyword">if</span> (!result.rhi) &#123;</span><br><span class="line">        <span class="built_in">qWarning</span>(<span class="string">&quot;WOutput::initRhi: Failed to initialize QRhi&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    rcd-&gt;rhi = result.rhi;</span><br><span class="line">    <span class="comment">// Ensure the QQuickRenderControl don&#x27;t reinit the RHI</span></span><br><span class="line">    rcd-&gt;ownRhi = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">rc</span>()-&gt;<span class="built_in">initialize</span>())</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    rcd-&gt;ownRhi = result.own;</span><br><span class="line">    <span class="built_in">Q_ASSERT</span>(rcd-&gt;rhi == result.rhi);</span><br><span class="line">    <span class="built_in">Q_ASSERT</span>(!swapchain);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…ˆè·å– <code>QSGRhiSupport</code> åŠç›¸å…³æ§åˆ¶å¯¹è±¡ã€‚</p><p>åˆ¤æ–­ RHI backend çš„ç±»å‹ï¼Œéœ€è¦é€‚é… <code>vulkan</code>ã€<code>gles</code>ç­‰ã€‚</p><p>ä» <code>wlroots</code> è·å–ç‰©ç†è®¾å¤‡ç­‰å‚æ•°ï¼Œä½¿ç”¨ <code>QQuickGraphicsDevice::fromDeviceObjects</code> åˆ›å»º Qt çš„ <code>QQuickGraphicsDevice</code>ã€‚</p><p>render windowçš„ç§æœ‰ç±»æ˜¯ç»§æ‰¿è‡ª <code>QQuickWindowPrivate</code>ï¼Œåªéœ€è¦å°†è·å–åˆ°çš„ <code>QQuickGraphicsDevice</code> è®¾ç½®ç»™ <code>QQuickWindowPrivate::setGraphicsDevice</code> å³å¯ã€‚</p><p>ä¹‹ååˆ›å»ºä¸€ä¸ªç¦»å±æ¸²æŸ“è¡¨é¢ï¼Œç”¨äº RHI çš„åˆå§‹åŒ–ã€‚</p><h2 id="Qt-Viewport"><a href="#Qt-Viewport" class="headerlink" title="Qt Viewport"></a>Qt Viewport</h2><p>åœ¨ Qt ä¸­ï¼Œæƒ³è¦æŸ¥çœ‹æˆ–è€…æ¸²æŸ“ä¸€ä¸ªç»„ä»¶ï¼Œéœ€è¦ä½¿ç”¨ Viewport ç»„ä»¶ï¼Œä¿—ç§°ç…§ç›¸æœºã€‚</p><p>è§†å£ï¼ˆViewportï¼‰æ˜¯ä¸€ä¸ªå¯è§‚å¯Ÿçš„å¤šè¾¹å½¢åŒºåŸŸï¼Œåªæœ‰ Viewport èŒƒå›´å†…çš„ç”»é¢æ‰èƒ½æ˜¾ç¤ºåˆ°å±å¹•ä¸Šã€‚</p><p><code>wlroots</code> ä¸­çš„ <strong>Viewport</strong> æ˜¯ä¸€ä¸ªä¸ <code>Wayland</code> æ˜¾ç¤ºåè®®ç›¸å…³çš„æ¦‚å¿µï¼Œä¸»è¦ç”¨äºå®šä¹‰æ¸²æŸ“è¾“å‡ºåœ¨å±å¹•ä¸Šçš„æ˜¾ç¤ºåŒºåŸŸã€‚å®ƒå…è®¸åœ¨æ¸²æŸ“æ—¶å¯¹æ˜¾ç¤ºå†…å®¹è¿›è¡Œç¼©æ”¾ã€è£å‰ªæˆ–å¹³ç§»ï¼Œä»¥é€‚åº”ä¸åŒçš„åˆ†è¾¨ç‡å’Œæ˜¾ç¤ºéœ€æ±‚ã€‚</p><p>Treeland ä½¿ç”¨ <code>WOutputViewport</code> æä¾› Viewport åŠŸèƒ½ï¼Œä½¿ç”¨ <code>wlroots</code> çš„ <code>wlr_output</code> ä¸­çš„å±å¹•ä¿¡æ¯ï¼Œå¯¹ç”»é¢è¿›è¡ŒçŸ©é˜µå˜æ¢ï¼Œè¿™é‡Œä¼šæ¶‰åŠåˆ°å±å¹•çš„ç¼©æ”¾ã€DPIç­‰å‚æ•°ã€‚</p><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">QMatrix4x4 <span class="title">WOutputViewport::renderMatrix</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    QMatrix4x4 renderMatrix;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">auto</span> customTransform = <span class="built_in">viewportTransform</span>()) &#123;</span><br><span class="line">        customTransform-&gt;<span class="built_in">applyTo</span>(&amp;renderMatrix);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">parentItem</span>() &amp;&amp; !<span class="built_in">ignoreViewport</span>() &amp;&amp; <span class="built_in">input</span>() != <span class="keyword">this</span>) &#123;</span><br><span class="line">        <span class="keyword">auto</span> d = QQuickItemPrivate::<span class="built_in">get</span>(<span class="built_in">const_cast</span>&lt;WOutputViewport*&gt;(<span class="keyword">this</span>));</span><br><span class="line">        <span class="keyword">auto</span> viewportMatrix = d-&gt;<span class="built_in">itemNode</span>()-&gt;<span class="built_in">matrix</span>().<span class="built_in">inverted</span>();</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">auto</span> inputItem = <span class="built_in">input</span>()) &#123;</span><br><span class="line">            QMatrix4x4 matrix = QQuickItemPrivate::<span class="built_in">get</span>(<span class="built_in">parentItem</span>())-&gt;<span class="built_in">itemToWindowTransform</span>();</span><br><span class="line">            matrix *= QQuickItemPrivate::<span class="built_in">get</span>(inputItem)-&gt;<span class="built_in">windowToItemTransform</span>();</span><br><span class="line">            renderMatrix = viewportMatrix * matrix.<span class="built_in">inverted</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; <span class="comment">// the input item is window&#x27;s contentItem</span></span><br><span class="line">            <span class="keyword">auto</span> pd = QQuickItemPrivate::<span class="built_in">get</span>(<span class="built_in">parentItem</span>());</span><br><span class="line">            QMatrix4x4 parentMatrix = pd-&gt;<span class="built_in">itemToWindowTransform</span>().<span class="built_in">inverted</span>();</span><br><span class="line">            renderMatrix = viewportMatrix * parentMatrix;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> renderMatrix;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>WOutputViewport</code> æä¾›äº† Viewport æ‰€éœ€çš„æ‰€æœ‰å‚æ•°ï¼Œå˜æ¢çŸ©é˜µã€æºå‡ ä½•å¤§å°ã€ç›®æ ‡å‡ ä½•å¤§å°ç­‰ä¿¡æ¯ã€‚</p><p>åœ¨ <code>WOutputRenderWindow</code> çš„äº‹ä»¶ä¸­ï¼Œåˆ¤æ–­å¦‚æœæ˜¯æ¸²æŸ“çš„äº‹ä»¶ï¼Œå°±æ‰§è¡Œæ¸²æŸ“ã€‚</p><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">WOutputRenderWindow::event</span><span class="params">(QEvent *event)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">Q_D</span>(WOutputRenderWindow);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (event-&gt;<span class="built_in">type</span>() == doRenderEventType) &#123;</span><br><span class="line">        QCoreApplication::<span class="built_in">removePostedEvents</span>(<span class="keyword">this</span>, doRenderEventType);</span><br><span class="line">        <span class="built_in">d_func</span>()-&gt;<span class="built_in">doRender</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (QW::RenderWindow::<span class="built_in">beforeDisposeEventFilter</span>(<span class="keyword">this</span>, event)) &#123;</span><br><span class="line">        event-&gt;<span class="built_in">accept</span>();</span><br><span class="line">        QW::RenderWindow::<span class="built_in">afterDisposeEventFilter</span>(<span class="keyword">this</span>, event);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">bool</span> isAccepted = QQuickWindow::<span class="built_in">event</span>(event);</span><br><span class="line">    <span class="keyword">if</span> (QW::RenderWindow::<span class="built_in">afterDisposeEventFilter</span>(<span class="keyword">this</span>, event))</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> isAccepted;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ doRender ä¸­ï¼Œéå†æ‰€æœ‰çš„ Outputï¼Œæ‰§è¡Œ beginRenderï¼Œç„¶åæ‰§è¡Œ Output çš„æ¸²æŸ“ã€‚</p><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">WOutputRenderWindowPrivate::doRender</span><span class="params">(<span class="type">const</span> QList&lt;OutputHelper *&gt; &amp;outputs,</span></span></span><br><span class="line"><span class="params"><span class="function">                                          <span class="type">bool</span> forceRender, <span class="type">bool</span> doCommit)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">Q_ASSERT</span>(rendererList.<span class="built_in">isEmpty</span>());</span><br><span class="line">    <span class="built_in">Q_ASSERT</span>(!inRendering);</span><br><span class="line">    inRendering = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">W_Q</span>(WOutputRenderWindow);</span><br><span class="line">    <span class="keyword">for</span> (OutputLayer *layer : std::<span class="built_in">as_const</span>(layers)) &#123;</span><br><span class="line">        layer-&gt;<span class="built_in">beforeRender</span>(q);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">rc</span>()-&gt;<span class="built_in">polishItems</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (QSGRendererInterface::<span class="built_in">isApiRhiBased</span>(WRenderHelper::<span class="built_in">getGraphicsApi</span>()))</span><br><span class="line">        <span class="built_in">rc</span>()-&gt;<span class="built_in">beginFrame</span>();</span><br><span class="line">    <span class="built_in">rc</span>()-&gt;<span class="built_in">sync</span>();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">QQuickAnimatorController_advance</span>(animationController.<span class="built_in">get</span>());</span><br><span class="line">    Q_EMIT q-&gt;<span class="built_in">beforeRendering</span>();</span><br><span class="line">    <span class="built_in">runAndClearJobs</span>(&amp;beforeRenderingJobs);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">auto</span> needsCommit = <span class="built_in">doRenderOutputs</span>(outputs, forceRender);</span><br><span class="line"></span><br><span class="line">    Q_EMIT q-&gt;<span class="built_in">afterRendering</span>();</span><br><span class="line">    <span class="built_in">runAndClearJobs</span>(&amp;afterRenderingJobs);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (QSGRendererInterface::<span class="built_in">isApiRhiBased</span>(WRenderHelper::<span class="built_in">getGraphicsApi</span>()))</span><br><span class="line">        <span class="built_in">rc</span>()-&gt;<span class="built_in">endFrame</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (doCommit) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> i : std::<span class="built_in">as_const</span>(needsCommit)) &#123;</span><br><span class="line">            <span class="type">bool</span> ok = i.first-&gt;<span class="built_in">commit</span>(i.second);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (i.second-&gt;<span class="built_in">currentBuffer</span>()) &#123;</span><br><span class="line">                i.second-&gt;<span class="built_in">endRender</span>();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            i.first-&gt;<span class="built_in">resetState</span>(ok);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">resetGlState</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// On Intel&amp;Nvidia multi-GPU environment, wlroots using Intel card do render for all</span></span><br><span class="line">    <span class="comment">// outputs, and blit nvidia&#x27;s output buffer in drm_connector_state_update_primary_fb,</span></span><br><span class="line">    <span class="comment">// the &#x27;blit&#x27; behavior will make EGL context to Nvidia renderer. So must done current</span></span><br><span class="line">    <span class="comment">// OpenGL context here in order to ensure QtQuick always make EGL context to Intel</span></span><br><span class="line">    <span class="comment">// renderer before next frame.</span></span><br><span class="line">    <span class="keyword">if</span> (glContext)</span><br><span class="line">        glContext-&gt;<span class="built_in">doneCurrent</span>();</span><br><span class="line"></span><br><span class="line">    inRendering = <span class="literal">false</span>;</span><br><span class="line">    Q_EMIT q-&gt;<span class="built_in">renderEnd</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">qw_buffer *<span class="title">WBufferRenderer::beginRender</span><span class="params">(<span class="type">const</span> QSize &amp;pixelSize, qreal devicePixelRatio,</span></span></span><br><span class="line"><span class="params"><span class="function">                                        <span class="type">uint32_t</span> format, RenderFlags flags)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">Q_ASSERT</span>(!state.buffer);</span><br><span class="line">    <span class="built_in">Q_ASSERT</span>(m_output);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (pixelSize.<span class="built_in">isEmpty</span>())</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">Q_EMIT <span class="title">beforeRendering</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    m_damageRing.<span class="built_in">set_bounds</span>(pixelSize.<span class="built_in">width</span>(), pixelSize.<span class="built_in">height</span>());</span><br><span class="line"></span><br><span class="line">    <span class="comment">// configure swapchain</span></span><br><span class="line">    <span class="keyword">if</span> (flags.<span class="built_in">testFlag</span>(RenderFlag::DontConfigureSwapchain)) &#123;</span><br><span class="line">        <span class="keyword">auto</span> renderFormat = <span class="built_in">pickFormat</span>(m_output-&gt;<span class="built_in">renderer</span>(), format);</span><br><span class="line">        <span class="keyword">if</span> (!renderFormat) &#123;</span><br><span class="line">            <span class="built_in">qWarning</span>(<span class="string">&quot;wlr_renderer doesn&#x27;t support format 0x%s&quot;</span>, <span class="built_in">drmGetFormatName</span>(format));</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!m_swapchain || <span class="built_in">QSize</span>(m_swapchain-&gt;<span class="built_in">handle</span>()-&gt;width, m_swapchain-&gt;<span class="built_in">handle</span>()-&gt;height) != pixelSize</span><br><span class="line">            || m_swapchain-&gt;<span class="built_in">handle</span>()-&gt;format.format != renderFormat-&gt;format) &#123;</span><br><span class="line">            <span class="keyword">if</span> (m_swapchain)</span><br><span class="line">                <span class="keyword">delete</span> m_swapchain;</span><br><span class="line">            m_swapchain = qw_swapchain::<span class="built_in">create</span>(m_output-&gt;<span class="built_in">allocator</span>()-&gt;<span class="built_in">handle</span>(), pixelSize.<span class="built_in">width</span>(), pixelSize.<span class="built_in">height</span>(), renderFormat);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (flags.<span class="built_in">testFlag</span>(RenderFlag::UseCursorFormats)) &#123;</span><br><span class="line">        <span class="type">bool</span> ok = m_output-&gt;<span class="built_in">configureCursorSwapchain</span>(pixelSize, format, &amp;m_swapchain);</span><br><span class="line">        <span class="keyword">if</span> (!ok)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="type">bool</span> ok = m_output-&gt;<span class="built_in">configurePrimarySwapchain</span>(pixelSize, format, &amp;m_swapchain,</span><br><span class="line">                                                      !flags.<span class="built_in">testFlag</span>(DontTestSwapchain));</span><br><span class="line">        <span class="keyword">if</span> (!ok)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// <span class="doctag">TODO:</span> Support scanout buffer of wlr_surface(from WSurfaceItem)</span></span><br><span class="line">    <span class="type">int</span> bufferAge;</span><br><span class="line">    <span class="keyword">auto</span> wbuffer = m_swapchain-&gt;<span class="built_in">acquire</span>(&amp;bufferAge);</span><br><span class="line">    <span class="keyword">if</span> (!wbuffer)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">    <span class="keyword">auto</span> buffer = qw_buffer::<span class="built_in">from</span>(wbuffer);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!m_renderHelper)</span><br><span class="line">        m_renderHelper = <span class="keyword">new</span> <span class="built_in">WRenderHelper</span>(m_output-&gt;<span class="built_in">renderer</span>());</span><br><span class="line">    m_renderHelper-&gt;<span class="built_in">setSize</span>(pixelSize);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">auto</span> wd = QQuickWindowPrivate::<span class="built_in">get</span>(<span class="built_in">window</span>());</span><br><span class="line">    <span class="built_in">Q_ASSERT</span>(wd-&gt;renderControl);</span><br><span class="line">    <span class="keyword">auto</span> lastRT = m_renderHelper-&gt;<span class="built_in">lastRenderTarget</span>();</span><br><span class="line">    <span class="keyword">auto</span> rt = m_renderHelper-&gt;<span class="built_in">acquireRenderTarget</span>(wd-&gt;renderControl, buffer);</span><br><span class="line">    <span class="keyword">if</span> (rt.<span class="built_in">isNull</span>()) &#123;</span><br><span class="line">        buffer-&gt;<span class="built_in">unlock</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">auto</span> rtd = QQuickRenderTargetPrivate::<span class="built_in">get</span>(&amp;rt);</span><br><span class="line">    QSGRenderTarget sgRT;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (rtd-&gt;type == QQuickRenderTargetPrivate::Type::PaintDevice) &#123;</span><br><span class="line">        sgRT.paintDevice = rtd-&gt;u.paintDevice;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">Q_ASSERT</span>(rtd-&gt;type == QQuickRenderTargetPrivate::Type::RhiRenderTarget);</span><br><span class="line">        sgRT.rt = rtd-&gt;u.rhiRt;</span><br><span class="line">        sgRT.cb = wd-&gt;redirect.commandBuffer;</span><br><span class="line">        <span class="built_in">Q_ASSERT</span>(sgRT.cb);</span><br><span class="line">        sgRT.rpDesc = rtd-&gt;u.rhiRt-&gt;<span class="built_in">renderPassDescriptor</span>();</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> QT_NO_OPENGL</span></span><br><span class="line">        <span class="keyword">if</span> (wd-&gt;rhi-&gt;<span class="built_in">backend</span>() == QRhi::OpenGLES2) &#123;</span><br><span class="line">            <span class="keyword">auto</span> glRT = <span class="built_in">QRHI_RES</span>(QGles2TextureRenderTarget, rtd-&gt;u.rhiRt);</span><br><span class="line">            <span class="built_in">Q_ASSERT</span>(glRT-&gt;framebuffer &gt;= <span class="number">0</span>);</span><br><span class="line">            <span class="keyword">auto</span> glContext = QOpenGLContext::<span class="built_in">currentContext</span>();</span><br><span class="line">            <span class="built_in">Q_ASSERT</span>(glContext);</span><br><span class="line">            QOpenGLContextPrivate::<span class="built_in">get</span>(glContext)-&gt;defaultFboRedirect = glRT-&gt;framebuffer;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    state.flags = flags;</span><br><span class="line">    state.context = wd-&gt;context;</span><br><span class="line">    state.pixelSize = pixelSize;</span><br><span class="line">    state.devicePixelRatio = devicePixelRatio;</span><br><span class="line">    state.bufferAge = bufferAge;</span><br><span class="line">    state.lastRT = lastRT;</span><br><span class="line">    state.buffer = buffer;</span><br><span class="line">    state.renderTarget = rt;</span><br><span class="line">    state.sgRenderTarget = sgRT;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> buffer;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">QVector&lt;std::pair&lt;OutputHelper*, WBufferRenderer*&gt;&gt;</span><br><span class="line">WOutputRenderWindowPrivate::<span class="built_in">doRenderOutputs</span>(<span class="type">const</span> QList&lt;OutputHelper*&gt; &amp;outputs, <span class="type">bool</span> forceRender)</span><br><span class="line">&#123;</span><br><span class="line">    QVector&lt;OutputHelper*&gt; renderResults;</span><br><span class="line">    renderResults.<span class="built_in">reserve</span>(outputs.<span class="built_in">size</span>());</span><br><span class="line">    <span class="keyword">for</span> (OutputHelper *helper : std::<span class="built_in">as_const</span>(outputs)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">Q_LIKELY</span>(!forceRender)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!helper-&gt;<span class="built_in">renderable</span>()</span><br><span class="line">                || <span class="built_in">Q_UNLIKELY</span>(!WOutputViewportPrivate::<span class="built_in">get</span>(helper-&gt;<span class="built_in">output</span>())-&gt;<span class="built_in">renderable</span>())</span><br><span class="line">                || !helper-&gt;<span class="built_in">output</span>()-&gt;<span class="built_in">output</span>()-&gt;<span class="built_in">isEnabled</span>())</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (!helper-&gt;<span class="built_in">contentIsDirty</span>()) &#123;</span><br><span class="line">                <span class="keyword">if</span> (helper-&gt;<span class="built_in">needsFrame</span>())</span><br><span class="line">                    renderResults.<span class="built_in">append</span>(helper);</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">Q_ASSERT</span>(helper-&gt;<span class="built_in">output</span>()-&gt;<span class="built_in">output</span>()-&gt;<span class="built_in">scale</span>() &lt;= helper-&gt;<span class="built_in">output</span>()-&gt;<span class="built_in">devicePixelRatio</span>());</span><br><span class="line"></span><br><span class="line">        <span class="type">const</span> <span class="keyword">auto</span> &amp;format = helper-&gt;<span class="built_in">qwoutput</span>()-&gt;<span class="built_in">handle</span>()-&gt;render_format;</span><br><span class="line">        <span class="type">const</span> <span class="keyword">auto</span> renderMatrix = helper-&gt;<span class="built_in">output</span>()-&gt;<span class="built_in">renderMatrix</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// maybe using the other WOutputViewport&#x27;s QSGTextureProvider</span></span><br><span class="line">        <span class="keyword">if</span> (!helper-&gt;<span class="built_in">output</span>()-&gt;<span class="built_in">depends</span>().<span class="built_in">isEmpty</span>())</span><br><span class="line">            <span class="built_in">updateDirtyNodes</span>();</span><br><span class="line"></span><br><span class="line">        qw_buffer *buffer = helper-&gt;<span class="built_in">beginRender</span>(helper-&gt;<span class="built_in">bufferRenderer</span>(), helper-&gt;<span class="built_in">output</span>()-&gt;<span class="built_in">output</span>()-&gt;<span class="built_in">size</span>(), format,</span><br><span class="line">                                                WBufferRenderer::RedirectOpenGLContextDefaultFrameBufferObject);</span><br><span class="line">        <span class="built_in">Q_ASSERT</span>(buffer == helper-&gt;<span class="built_in">bufferRenderer</span>()-&gt;<span class="built_in">currentBuffer</span>());</span><br><span class="line">        <span class="keyword">if</span> (buffer) &#123;</span><br><span class="line">            helper-&gt;<span class="built_in">render</span>(helper-&gt;<span class="built_in">bufferRenderer</span>(), <span class="number">0</span>, renderMatrix,</span><br><span class="line">                           helper-&gt;<span class="built_in">output</span>()-&gt;<span class="built_in">effectiveSourceRect</span>(),</span><br><span class="line">                           helper-&gt;<span class="built_in">output</span>()-&gt;<span class="built_in">targetRect</span>(),</span><br><span class="line">                           helper-&gt;<span class="built_in">output</span>()-&gt;<span class="built_in">preserveColorContents</span>());</span><br><span class="line">        &#125;</span><br><span class="line">        renderResults.<span class="built_in">append</span>(helper);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    QVector&lt;std::pair&lt;OutputHelper*, WBufferRenderer*&gt;&gt; needsCommit;</span><br><span class="line">    needsCommit.<span class="built_in">reserve</span>(renderResults.<span class="built_in">size</span>());</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> helper : std::<span class="built_in">as_const</span>(renderResults)) &#123;</span><br><span class="line">        <span class="keyword">auto</span> bufferRenderer = helper-&gt;<span class="built_in">afterRender</span>();</span><br><span class="line">        <span class="keyword">if</span> (bufferRenderer)</span><br><span class="line">            needsCommit.<span class="built_in">append</span>(&#123;helper, bufferRenderer&#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    rendererList.<span class="built_in">clear</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> needsCommit;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">WBufferRenderer::render</span><span class="params">(<span class="type">int</span> sourceIndex, <span class="type">const</span> QMatrix4x4 &amp;renderMatrix,</span></span></span><br><span class="line"><span class="params"><span class="function">                             <span class="type">const</span> QRectF &amp;sourceRect, <span class="type">const</span> QRectF &amp;targetRect,</span></span></span><br><span class="line"><span class="params"><span class="function">                             <span class="type">bool</span> preserveColorContents)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">Q_ASSERT</span>(state.buffer);</span><br><span class="line"></span><br><span class="line">    <span class="type">const</span> <span class="keyword">auto</span> &amp;source = m_sourceList.<span class="built_in">at</span>(sourceIndex);</span><br><span class="line">    QSGRenderer *renderer = <span class="built_in">ensureRenderer</span>(sourceIndex, state.context);</span><br><span class="line">    <span class="keyword">auto</span> wd = QQuickWindowPrivate::<span class="built_in">get</span>(<span class="built_in">window</span>());</span><br><span class="line"></span><br><span class="line">    <span class="type">const</span> qreal devicePixelRatio = state.devicePixelRatio;</span><br><span class="line">    state.renderer = renderer;</span><br><span class="line">    state.worldTransform = renderMatrix;</span><br><span class="line">    renderer-&gt;<span class="built_in">setDevicePixelRatio</span>(devicePixelRatio);</span><br><span class="line">    renderer-&gt;<span class="built_in">setDeviceRect</span>(<span class="built_in">QRect</span>(<span class="built_in">QPoint</span>(<span class="number">0</span>, <span class="number">0</span>), state.pixelSize));</span><br><span class="line">    renderer-&gt;<span class="built_in">setRenderTarget</span>(state.sgRenderTarget);</span><br><span class="line">    <span class="type">const</span> <span class="keyword">auto</span> viewportRect = <span class="built_in">scaleToRect</span>(targetRect, devicePixelRatio);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">auto</span> softwareRenderer = <span class="built_in">dynamic_cast</span>&lt;QSGSoftwareRenderer*&gt;(renderer);</span><br><span class="line">    &#123; <span class="comment">// before render</span></span><br><span class="line">        <span class="keyword">if</span> (softwareRenderer) &#123;</span><br><span class="line">            <span class="comment">// because software renderer don&#x27;t supports viewportRect,</span></span><br><span class="line">            <span class="comment">// so use transform to simulation.</span></span><br><span class="line">            <span class="type">const</span> <span class="keyword">auto</span> mapTransform = <span class="built_in">inputMapToOutput</span>(sourceRect, targetRect,</span><br><span class="line">                                                       state.pixelSize, state.devicePixelRatio);</span><br><span class="line">            <span class="keyword">if</span> (!mapTransform.<span class="built_in">isIdentity</span>())</span><br><span class="line">                state.worldTransform = mapTransform * state.worldTransform;</span><br><span class="line">            state.worldTransform.<span class="built_in">optimize</span>();</span><br><span class="line">            <span class="keyword">auto</span> image = <span class="built_in">getImageFrom</span>(state.renderTarget);</span><br><span class="line">            image-&gt;<span class="built_in">setDevicePixelRatio</span>(devicePixelRatio);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// <span class="doctag">TODO:</span> Should set to QSGSoftwareRenderer, but it&#x27;s not support specify matrix.</span></span><br><span class="line">            <span class="comment">// If transform is changed, it will full repaint.</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">isRootItem</span>(source.source)) &#123;</span><br><span class="line">                <span class="keyword">auto</span> rootTransform = QQuickItemPrivate::<span class="built_in">get</span>(wd-&gt;contentItem)-&gt;<span class="built_in">itemNode</span>();</span><br><span class="line">                <span class="keyword">if</span> (rootTransform-&gt;<span class="built_in">matrix</span>() != state.worldTransform)</span><br><span class="line">                    rootTransform-&gt;<span class="built_in">setMatrix</span>(state.worldTransform);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">auto</span> t = state.worldTransform.<span class="built_in">toTransform</span>();</span><br><span class="line">                <span class="keyword">if</span> (t.<span class="built_in">type</span>() &gt; QTransform::TxTranslate) &#123;</span><br><span class="line">                    (image-&gt;<span class="keyword">operator</span> QImage &amp;()).<span class="built_in">fill</span>(renderer-&gt;<span class="built_in">clearColor</span>());</span><br><span class="line">                    softwareRenderer-&gt;<span class="built_in">markDirty</span>();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="built_in">applyTransform</span>(softwareRenderer, t);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            state.worldTransform.<span class="built_in">optimize</span>();</span><br><span class="line"></span><br><span class="line">            <span class="type">bool</span> flipY = wd-&gt;rhi ? !wd-&gt;rhi-&gt;<span class="built_in">isYUpInNDC</span>() : <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">if</span> (state.renderTarget.<span class="built_in">mirrorVertically</span>())</span><br><span class="line">                flipY = !flipY;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (viewportRect.<span class="built_in">isValid</span>()) &#123;</span><br><span class="line">                QRect vr = viewportRect;</span><br><span class="line">                <span class="keyword">if</span> (flipY)</span><br><span class="line">                    vr.<span class="built_in">moveTop</span>(-vr.<span class="built_in">y</span>() + state.pixelSize.<span class="built_in">height</span>() - vr.<span class="built_in">height</span>());</span><br><span class="line">                renderer-&gt;<span class="built_in">setViewportRect</span>(vr);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                renderer-&gt;<span class="built_in">setViewportRect</span>(<span class="built_in">QRect</span>(<span class="built_in">QPoint</span>(<span class="number">0</span>, <span class="number">0</span>), state.pixelSize));</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            QRectF rect = sourceRect;</span><br><span class="line">            <span class="keyword">if</span> (!rect.<span class="built_in">isValid</span>())</span><br><span class="line">                rect = <span class="built_in">QRectF</span>(<span class="built_in">QPointF</span>(<span class="number">0</span>, <span class="number">0</span>), <span class="built_in">QSizeF</span>(state.pixelSize) / devicePixelRatio);</span><br><span class="line"></span><br><span class="line">            <span class="type">const</span> <span class="type">float</span> left = rect.<span class="built_in">x</span>();</span><br><span class="line">            <span class="type">const</span> <span class="type">float</span> right = rect.<span class="built_in">x</span>() + rect.<span class="built_in">width</span>();</span><br><span class="line">            <span class="type">float</span> bottom = rect.<span class="built_in">y</span>() + rect.<span class="built_in">height</span>();</span><br><span class="line">            <span class="type">float</span> top = rect.<span class="built_in">y</span>();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (flipY)</span><br><span class="line">                std::<span class="built_in">swap</span>(top, bottom);</span><br><span class="line"></span><br><span class="line">            QMatrix4x4 matrix;</span><br><span class="line">            matrix.<span class="built_in">ortho</span>(left, right, bottom, top, <span class="number">1</span>, <span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">            QMatrix4x4 projectionMatrix, projectionMatrixWithNativeNDC;</span><br><span class="line">            projectionMatrix = matrix * state.worldTransform;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (wd-&gt;rhi &amp;&amp; !wd-&gt;rhi-&gt;<span class="built_in">isYUpInNDC</span>()) &#123;</span><br><span class="line">                std::<span class="built_in">swap</span>(top, bottom);</span><br><span class="line"></span><br><span class="line">                matrix.<span class="built_in">setToIdentity</span>();</span><br><span class="line">                matrix.<span class="built_in">ortho</span>(left, right, bottom, top, <span class="number">1</span>, <span class="number">-1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            projectionMatrixWithNativeNDC = matrix * state.worldTransform;</span><br><span class="line"></span><br><span class="line">            renderer-&gt;<span class="built_in">setProjectionMatrix</span>(projectionMatrix);</span><br><span class="line">            renderer-&gt;<span class="built_in">setProjectionMatrixWithNativeNDC</span>(projectionMatrixWithNativeNDC);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">auto</span> textureRT = <span class="built_in">static_cast</span>&lt;QRhiTextureRenderTarget*&gt;(state.sgRenderTarget.rt);</span><br><span class="line">            <span class="keyword">if</span> (preserveColorContents) &#123;</span><br><span class="line">                textureRT-&gt;<span class="built_in">setFlags</span>(textureRT-&gt;<span class="built_in">flags</span>() | QRhiTextureRenderTarget::PreserveColorContents);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                textureRT-&gt;<span class="built_in">setFlags</span>(textureRT-&gt;<span class="built_in">flags</span>() &amp; ~QRhiTextureRenderTarget::PreserveColorContents);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    state.context-&gt;<span class="built_in">renderNextFrame</span>(renderer);</span><br><span class="line"></span><br><span class="line">    &#123; <span class="comment">// after render</span></span><br><span class="line">        <span class="keyword">if</span> (!softwareRenderer) &#123;</span><br><span class="line">            <span class="comment">// <span class="doctag">TODO:</span> get damage area from QRhi renderer</span></span><br><span class="line">            m_damageRing.<span class="built_in">add_whole</span>();</span><br><span class="line">            <span class="comment">// ###: maybe Qt bug? Before executing QRhi::endOffscreenFrame, we may</span></span><br><span class="line">            <span class="comment">// use the same QSGRenderer for multiple drawings. This can lead to</span></span><br><span class="line">            <span class="comment">// rendering the same content for different QSGRhiRenderTarget instances</span></span><br><span class="line">            <span class="comment">// when using the RhiGles backend. Additionally, considering that the</span></span><br><span class="line">            <span class="comment">// result of the current drawing may be needed when drawing the next</span></span><br><span class="line">            <span class="comment">// sourceIndex, we should let the RHI (Rendering Hardware Interface)</span></span><br><span class="line">            <span class="comment">// complete the results of this drawing here to ensure the current</span></span><br><span class="line">            <span class="comment">// drawing result is available for use.</span></span><br><span class="line">            wd-&gt;rhi-&gt;<span class="built_in">finish</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">auto</span> currentImage = <span class="built_in">getImageFrom</span>(state.renderTarget);</span><br><span class="line">            <span class="built_in">Q_ASSERT</span>(currentImage &amp;&amp; currentImage == softwareRenderer-&gt;m_rt.paintDevice);</span><br><span class="line">            currentImage-&gt;<span class="built_in">setDevicePixelRatio</span>(<span class="number">1.0</span>);</span><br><span class="line">            <span class="type">const</span> <span class="keyword">auto</span> scaleTF = QTransform::<span class="built_in">fromScale</span>(devicePixelRatio, devicePixelRatio);</span><br><span class="line">            <span class="type">const</span> <span class="keyword">auto</span> scaledFlushRegion = scaleTF.<span class="built_in">map</span>(softwareRenderer-&gt;<span class="built_in">flushRegion</span>());</span><br><span class="line">            PixmanRegion scaledFlushDamage;</span><br><span class="line">            <span class="type">bool</span> ok = WTools::<span class="built_in">toPixmanRegion</span>(scaledFlushRegion, scaledFlushDamage);</span><br><span class="line">            <span class="built_in">Q_ASSERT</span>(ok);</span><br><span class="line"></span><br><span class="line">            &#123;</span><br><span class="line">                PixmanRegion damage;</span><br><span class="line">                m_damageRing.<span class="built_in">get_buffer_damage</span>(state.bufferAge, damage);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (viewportRect.<span class="built_in">isValid</span>()) &#123;</span><br><span class="line">                    QRect imageRect = (currentImage-&gt;<span class="keyword">operator</span> <span class="type">const</span> QImage &amp;()).<span class="built_in">rect</span>();</span><br><span class="line">                    <span class="function">QRegion <span class="title">invalidRegion</span><span class="params">(imageRect)</span></span>;</span><br><span class="line">                    invalidRegion -= viewportRect;</span><br><span class="line">                    <span class="keyword">if</span> (!scaledFlushRegion.<span class="built_in">isEmpty</span>())</span><br><span class="line">                        invalidRegion &amp;= scaledFlushRegion;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (!invalidRegion.<span class="built_in">isEmpty</span>()) &#123;</span><br><span class="line">                        <span class="function">QPainter <span class="title">pa</span><span class="params">(currentImage)</span></span>;</span><br><span class="line">                        <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span> r : std::<span class="built_in">as_const</span>(invalidRegion))</span><br><span class="line">                            pa.<span class="built_in">fillRect</span>(r, softwareRenderer-&gt;<span class="built_in">clearColor</span>());</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (!damage.<span class="built_in">isEmpty</span>() &amp;&amp; state.lastRT.first != state.buffer &amp;&amp; !state.lastRT.second.<span class="built_in">isNull</span>()) &#123;</span><br><span class="line">                    <span class="keyword">auto</span> image = <span class="built_in">getImageFrom</span>(state.lastRT.second);</span><br><span class="line">                    <span class="built_in">Q_ASSERT</span>(image);</span><br><span class="line">                    <span class="built_in">Q_ASSERT</span>(image-&gt;<span class="built_in">size</span>() == state.pixelSize);</span><br><span class="line"></span><br><span class="line">                    <span class="comment">// <span class="doctag">TODO:</span> Don&#x27;t use the previous render target, we can get the damage region of QtQuick</span></span><br><span class="line">                    <span class="comment">// before QQuickRenderControl::render for qw_damage_ring, and add dirty region to</span></span><br><span class="line">                    <span class="comment">// QSGAbstractSoftwareRenderer to force repaint the damage region of current render target.</span></span><br><span class="line">                    <span class="function">QPainter <span class="title">pa</span><span class="params">(currentImage)</span></span>;</span><br><span class="line"></span><br><span class="line">                    PixmanRegion remainderDamage;</span><br><span class="line">                    ok = <span class="built_in">pixman_region32_subtract</span>(remainderDamage, damage, scaledFlushDamage);</span><br><span class="line">                    <span class="built_in">Q_ASSERT</span>(ok);</span><br><span class="line"></span><br><span class="line">                    <span class="type">int</span> count = <span class="number">0</span>;</span><br><span class="line">                    <span class="keyword">auto</span> rects = <span class="built_in">pixman_region32_rectangles</span>(remainderDamage, &amp;count);</span><br><span class="line">                    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; count; ++i) &#123;</span><br><span class="line">                        <span class="keyword">auto</span> r = rects[i];</span><br><span class="line">                        pa.<span class="built_in">drawImage</span>(r.x1, r.y1, *image, r.x1, r.y1, r.x2 - r.x1, r.y2 - r.y1);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (!<span class="built_in">isRootItem</span>(source.source))</span><br><span class="line">                <span class="built_in">applyTransform</span>(softwareRenderer, state.worldTransform.<span class="built_in">inverted</span>().<span class="built_in">toTransform</span>());</span><br><span class="line">            m_damageRing.<span class="built_in">add</span>(scaledFlushDamage);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">auto</span> dr = <span class="built_in">qobject_cast</span>&lt;QSGDefaultRenderContext*&gt;(state.context)) &#123;</span><br><span class="line">        QRhiResourceUpdateBatch *resourceUpdates = wd-&gt;rhi-&gt;<span class="built_in">nextResourceUpdateBatch</span>();</span><br><span class="line">        dr-&gt;<span class="built_in">currentFrameCommandBuffer</span>()-&gt;<span class="built_in">resourceUpdate</span>(resourceUpdates);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">shouldCacheBuffer</span>())</span><br><span class="line">        <span class="built_in">wTextureProvider</span>()-&gt;<span class="built_in">setBuffer</span>(state.buffer);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¤„ç†å®Œç”»é¢ä»¥åï¼Œå¦‚æœéœ€è¦ä¸Šå±ç”»é¢ï¼Œå°±è°ƒç”¨ commit æŠŠç”»é¢é€åˆ°å±å¹•ä¸Šã€‚</p><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">OutputHelper::commit</span><span class="params">(WBufferRenderer *buffer)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">output</span>()-&gt;<span class="built_in">offscreen</span>())</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!buffer || !buffer-&gt;<span class="built_in">currentBuffer</span>()) &#123;</span><br><span class="line">        <span class="built_in">Q_ASSERT</span>(!<span class="keyword">this</span>-&gt;<span class="built_in">buffer</span>());</span><br><span class="line">        <span class="keyword">return</span> WOutputHelper::<span class="built_in">commit</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">setBuffer</span>(buffer-&gt;<span class="built_in">currentBuffer</span>());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (m_lastCommitBuffer == buffer) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">pixman_region32_not_empty</span>(&amp;buffer-&gt;<span class="built_in">damageRing</span>()-&gt;<span class="built_in">handle</span>()-&gt;current))</span><br><span class="line">            <span class="built_in">setDamage</span>(&amp;buffer-&gt;<span class="built_in">damageRing</span>()-&gt;<span class="built_in">handle</span>()-&gt;current);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    m_lastCommitBuffer = buffer;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> WOutputHelper::<span class="built_in">commit</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿˜ä¼šåˆ¤æ–­æ˜¯å¦æœ‰ç¡¬ä»¶åŠ é€Ÿï¼ˆGPUï¼‰ï¼Œä¼šä¼˜å…ˆä½¿ç”¨ç¡¬ä»¶æ¥åŠ é€Ÿè®¡ç®—è¿‡ç¨‹ã€‚</p><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    state.worldTransform.<span class="built_in">optimize</span>();</span><br><span class="line"></span><br><span class="line">    <span class="type">bool</span> flipY = wd-&gt;rhi ? !wd-&gt;rhi-&gt;<span class="built_in">isYUpInNDC</span>() : <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (state.renderTarget.<span class="built_in">mirrorVertically</span>())</span><br><span class="line">        flipY = !flipY;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (viewportRect.<span class="built_in">isValid</span>()) &#123;</span><br><span class="line">        QRect vr = viewportRect;</span><br><span class="line">        <span class="keyword">if</span> (flipY)</span><br><span class="line">            vr.<span class="built_in">moveTop</span>(-vr.<span class="built_in">y</span>() + state.pixelSize.<span class="built_in">height</span>() - vr.<span class="built_in">height</span>());</span><br><span class="line">        renderer-&gt;<span class="built_in">setViewportRect</span>(vr);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        renderer-&gt;<span class="built_in">setViewportRect</span>(<span class="built_in">QRect</span>(<span class="built_in">QPoint</span>(<span class="number">0</span>, <span class="number">0</span>), state.pixelSize));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    QRectF rect = sourceRect;</span><br><span class="line">    <span class="keyword">if</span> (!rect.<span class="built_in">isValid</span>())</span><br><span class="line">        rect = <span class="built_in">QRectF</span>(<span class="built_in">QPointF</span>(<span class="number">0</span>, <span class="number">0</span>), <span class="built_in">QSizeF</span>(state.pixelSize) / devicePixelRatio);</span><br><span class="line"></span><br><span class="line">    <span class="type">const</span> <span class="type">float</span> left = rect.<span class="built_in">x</span>();</span><br><span class="line">    <span class="type">const</span> <span class="type">float</span> right = rect.<span class="built_in">x</span>() + rect.<span class="built_in">width</span>();</span><br><span class="line">    <span class="type">float</span> bottom = rect.<span class="built_in">y</span>() + rect.<span class="built_in">height</span>();</span><br><span class="line">    <span class="type">float</span> top = rect.<span class="built_in">y</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (flipY)</span><br><span class="line">        std::<span class="built_in">swap</span>(top, bottom);</span><br><span class="line"></span><br><span class="line">    QMatrix4x4 matrix;</span><br><span class="line">    matrix.<span class="built_in">ortho</span>(left, right, bottom, top, <span class="number">1</span>, <span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">    QMatrix4x4 projectionMatrix, projectionMatrixWithNativeNDC;</span><br><span class="line">    projectionMatrix = matrix * state.worldTransform;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (wd-&gt;rhi &amp;&amp; !wd-&gt;rhi-&gt;<span class="built_in">isYUpInNDC</span>()) &#123;</span><br><span class="line">        std::<span class="built_in">swap</span>(top, bottom);</span><br><span class="line"></span><br><span class="line">        matrix.<span class="built_in">setToIdentity</span>();</span><br><span class="line">        matrix.<span class="built_in">ortho</span>(left, right, bottom, top, <span class="number">1</span>, <span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    projectionMatrixWithNativeNDC = matrix * state.worldTransform;</span><br><span class="line"></span><br><span class="line">    renderer-&gt;<span class="built_in">setProjectionMatrix</span>(projectionMatrix);</span><br><span class="line">    renderer-&gt;<span class="built_in">setProjectionMatrixWithNativeNDC</span>(projectionMatrixWithNativeNDC);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">auto</span> textureRT = <span class="built_in">static_cast</span>&lt;QRhiTextureRenderTarget*&gt;(state.sgRenderTarget.rt);</span><br><span class="line">    <span class="keyword">if</span> (preserveColorContents) &#123;</span><br><span class="line">        textureRT-&gt;<span class="built_in">setFlags</span>(textureRT-&gt;<span class="built_in">flags</span>() | QRhiTextureRenderTarget::PreserveColorContents);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        textureRT-&gt;<span class="built_in">setFlags</span>(textureRT-&gt;<span class="built_in">flags</span>() &amp; ~QRhiTextureRenderTarget::PreserveColorContents);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Surface-æ¸²æŸ“"><a href="#Surface-æ¸²æŸ“" class="headerlink" title="Surface æ¸²æŸ“"></a>Surface æ¸²æŸ“</h2><p>åœ¨ Treeland ä¸­ï¼Œä¸º Surface åˆ›å»ºäº† <code>WSurfaceItem</code>ï¼Œç”¨äºè¡¨ç¤ºä¸€ä¸ªçª—å£ï¼Œå¹¶åˆ›å»ºäº† <code>WSurfaceContent</code> ä½œä¸º <code>WSurfaceItem</code> çš„ delegateã€‚</p><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">WSurfaceItemPrivate::initForDelegate</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">Q_Q</span>(WSurfaceItem);</span><br><span class="line"></span><br><span class="line">    std::unique_ptr&lt;QQuickItem&gt; newContentContainer;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!delegate) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">getItemContent</span>()) &#123;</span><br><span class="line">            <span class="built_in">Q_ASSERT</span>(!delegateIsDirty);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        delegateIsDirty = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">auto</span> contentItem = <span class="keyword">new</span> <span class="built_in">WSurfaceItemContent</span>(q);</span><br><span class="line">        <span class="keyword">if</span> (surface)</span><br><span class="line">            contentItem-&gt;<span class="built_in">setSurface</span>(surface);</span><br><span class="line">        contentItem-&gt;<span class="built_in">setCacheLastBuffer</span>(!surfaceFlags.<span class="built_in">testFlag</span>(WSurfaceItem::DontCacheLastBuffer));</span><br><span class="line">        contentItem-&gt;<span class="built_in">setSmooth</span>(q-&gt;<span class="built_in">smooth</span>());</span><br><span class="line">        contentItem-&gt;<span class="built_in">setLive</span>(!q-&gt;<span class="built_in">flags</span>().<span class="built_in">testFlag</span>(WSurfaceItem::NonLive));</span><br><span class="line">        QObject::<span class="built_in">connect</span>(q, &amp;WSurfaceItem::smoothChanged, contentItem, &amp;WSurfaceItemContent::setSmooth);</span><br><span class="line">        newContentContainer.<span class="built_in">reset</span>(contentItem);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (delegateIsDirty) &#123;</span><br><span class="line">        <span class="keyword">auto</span> obj = delegate-&gt;<span class="built_in">createWithInitialProperties</span>(&#123;&#123;<span class="string">&quot;surface&quot;</span>, QVariant::<span class="built_in">fromValue</span>(q)&#125;&#125;, <span class="built_in">qmlContext</span>(q));</span><br><span class="line">        <span class="keyword">if</span> (!obj) &#123;</span><br><span class="line">            <span class="built_in">qWarning</span>() &lt;&lt; <span class="string">&quot;Failed on create surface item from delegate, error mssage:&quot;</span></span><br><span class="line">                       &lt;&lt; delegate-&gt;<span class="built_in">errorString</span>();</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        delegateIsDirty = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">auto</span> contentItem = <span class="built_in">qobject_cast</span>&lt;QQuickItem*&gt;(obj);</span><br><span class="line">        <span class="keyword">if</span> (!contentItem)</span><br><span class="line">            <span class="built_in">qFatal</span>() &lt;&lt; <span class="string">&quot;SurfaceItem&#x27;s delegate must is Item&quot;</span>;</span><br><span class="line"></span><br><span class="line">        newContentContainer.<span class="built_in">reset</span>(<span class="keyword">new</span> <span class="built_in">QQuickItem</span>(q));</span><br><span class="line">        QQmlEngine::<span class="built_in">setObjectOwnership</span>(contentItem, QQmlEngine::CppOwnership);</span><br><span class="line">        contentItem-&gt;<span class="built_in">setParent</span>(newContentContainer.<span class="built_in">get</span>());</span><br><span class="line">        contentItem-&gt;<span class="built_in">setParentItem</span>(newContentContainer.<span class="built_in">get</span>());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!newContentContainer)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    newContentContainer-&gt;<span class="built_in">setZ</span>(<span class="built_in">qreal</span>(WSurfaceItem::ZOrder::ContentItem));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (contentContainer) &#123;</span><br><span class="line">        newContentContainer-&gt;<span class="built_in">setPosition</span>(contentContainer-&gt;<span class="built_in">position</span>());</span><br><span class="line">        newContentContainer-&gt;<span class="built_in">setSize</span>(contentContainer-&gt;<span class="built_in">size</span>());</span><br><span class="line">        newContentContainer-&gt;<span class="built_in">setTransformOrigin</span>(contentContainer-&gt;<span class="built_in">transformOrigin</span>());</span><br><span class="line">        newContentContainer-&gt;<span class="built_in">setScale</span>(contentContainer-&gt;<span class="built_in">scale</span>());</span><br><span class="line"></span><br><span class="line">        contentContainer-&gt;<span class="built_in">disconnect</span>(q);</span><br><span class="line">        contentContainer-&gt;<span class="built_in">deleteLater</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    contentContainer = newContentContainer.<span class="built_in">release</span>();</span><br><span class="line">    <span class="built_in">updateEventItem</span>(<span class="literal">false</span>);</span><br><span class="line">    <span class="built_in">updateBoundingRect</span>();</span><br><span class="line">    <span class="keyword">if</span> (eventItem)</span><br><span class="line">        <span class="built_in">updateEventItemGeometry</span>();</span><br><span class="line"></span><br><span class="line">    Q_EMIT q-&gt;<span class="built_in">contentItemChanged</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¹‹åå½“ <code>WSurfaceItem</code> éœ€è¦æ›´æ–°ç”»é¢æ—¶ï¼Œå°±èƒ½è°ƒç”¨ <code>updatePaintNode</code> æ›´æ–°æ¸²æŸ“ã€‚</p><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">QSGNode *<span class="title">WSurfaceItemContent::updatePaintNode</span><span class="params">(QSGNode *oldNode, UpdatePaintNodeData *)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">W_D</span>(WSurfaceItemContent);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">auto</span> tp = <span class="built_in">wTextureProvider</span>();</span><br><span class="line">    <span class="keyword">if</span> (d-&gt;live || !tp-&gt;<span class="built_in">texture</span>()) &#123;</span><br><span class="line">        <span class="keyword">auto</span> texture = d-&gt;surface ? d-&gt;surface-&gt;<span class="built_in">handle</span>()-&gt;<span class="built_in">get_texture</span>() : <span class="literal">nullptr</span>;</span><br><span class="line">        <span class="keyword">if</span> (texture) &#123;</span><br><span class="line">            tp-&gt;<span class="built_in">setTexture</span>(qw_texture::<span class="built_in">from</span>(texture), d-&gt;buffer.<span class="built_in">get</span>());</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            tp-&gt;<span class="built_in">setBuffer</span>(d-&gt;buffer.<span class="built_in">get</span>());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!tp-&gt;<span class="built_in">texture</span>() || <span class="built_in">width</span>() &lt;= <span class="number">0</span> || <span class="built_in">height</span>() &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">delete</span> oldNode;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">auto</span> node = <span class="built_in">static_cast</span>&lt;QSGImageNode*&gt;(oldNode);</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">Q_UNLIKELY</span>(!node)) &#123;</span><br><span class="line">        node = <span class="built_in">window</span>()-&gt;<span class="built_in">createImageNode</span>();</span><br><span class="line">        node-&gt;<span class="built_in">setOwnsTexture</span>(<span class="literal">false</span>);</span><br><span class="line">        QSGNode *fpnode = <span class="keyword">new</span> <span class="built_in">WSGRenderFootprintNode</span>(<span class="keyword">this</span>);</span><br><span class="line">        node-&gt;<span class="built_in">appendChildNode</span>(fpnode);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">auto</span> texture = tp-&gt;<span class="built_in">texture</span>();</span><br><span class="line">    node-&gt;<span class="built_in">setTexture</span>(texture);</span><br><span class="line">    <span class="type">const</span> QRectF textureGeometry = d-&gt;bufferSourceBox;</span><br><span class="line">    node-&gt;<span class="built_in">setSourceRect</span>(textureGeometry);</span><br><span class="line">    <span class="function"><span class="type">const</span> QRectF <span class="title">targetGeometry</span><span class="params">(d-&gt;ignoreBufferOffset ? QPointF() : d-&gt;bufferOffset, size())</span></span>;</span><br><span class="line">    node-&gt;<span class="built_in">setRect</span>(targetGeometry);</span><br><span class="line">    node-&gt;<span class="built_in">setFiltering</span>(<span class="built_in">smooth</span>() ? QSGTexture::Linear : QSGTexture::Nearest);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> node;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è€Œä½¿ç”¨ delegate çš„ç›®çš„æ˜¯ä¸ºäº†èƒ½è®©å¤šä¸ª <code>WSurfaceItem</code> ä½¿ç”¨ç›¸åŒçš„çª—å£ç”»é¢ï¼Œä¾‹å¦‚æŸäº›åœºæ™¯éœ€è¦ä¸´æ—¶åˆ›å»ºä¸€ä¸ªçª—å£çš„åˆ†èº«ï¼Œçª—å£åˆ‡æ¢åˆ—è¡¨ã€å¤šä»»åŠ¡è§†å›¾ç­‰ã€‚</p><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">QSGTextureProvider *<span class="title">WSurfaceItemContent::textureProvider</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (QQuickItem::<span class="built_in">isTextureProvider</span>())</span><br><span class="line">        <span class="keyword">return</span> QQuickItem::<span class="built_in">textureProvider</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">wTextureProvider</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">WSGTextureProvider *<span class="title">WSurfaceItemContent::wTextureProvider</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">W_DC</span>(WSurfaceItemContent);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">auto</span> w = <span class="built_in">qobject_cast</span>&lt;WOutputRenderWindow*&gt;(d-&gt;window);</span><br><span class="line">    <span class="keyword">if</span> (!w || !d-&gt;<span class="built_in">sceneGraphRenderContext</span>() || QThread::<span class="built_in">currentThread</span>() != d-&gt;<span class="built_in">sceneGraphRenderContext</span>()-&gt;<span class="built_in">thread</span>()) &#123;</span><br><span class="line">        <span class="built_in">qWarning</span>(<span class="string">&quot;WQuickCursor::textureProvider: can only be queried on the rendering thread of an WOutputRenderWindow&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!d-&gt;textureProvider) &#123;</span><br><span class="line">        d-&gt;textureProvider = <span class="keyword">new</span> <span class="built_in">WSGTextureProvider</span>(w);</span><br><span class="line">        <span class="keyword">if</span> (d-&gt;surface) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">auto</span> texture = d-&gt;surface-&gt;<span class="built_in">handle</span>()-&gt;<span class="built_in">get_texture</span>()) &#123;</span><br><span class="line">                d-&gt;textureProvider-&gt;<span class="built_in">setTexture</span>(qw_texture::<span class="built_in">from</span>(texture), d-&gt;buffer.<span class="built_in">get</span>());</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                d-&gt;textureProvider-&gt;<span class="built_in">setBuffer</span>(d-&gt;buffer.<span class="built_in">get</span>());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> d-&gt;textureProvider;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Treeland ä½¿ç”¨ <code>WQuickTextureProxy</code> åˆ›å»ºçª—å£çš„ä»£ç†æ˜¾ç¤ºï¼Œè€Œå…¶ä¸­å°±æ˜¯è·å– <code>WSurfaceItem</code> çš„ textureProviderã€‚</p><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">QSGTextureProvider *<span class="title">WQuickTextureProxy::textureProvider</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (QQuickItem::<span class="built_in">isTextureProvider</span>())</span><br><span class="line">        <span class="keyword">return</span> QQuickItem::<span class="built_in">textureProvider</span>();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">W_DC</span>(WQuickTextureProxy);</span><br><span class="line">    <span class="keyword">if</span> (!d-&gt;sourceItem)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> d-&gt;sourceItem-&gt;<span class="built_in">textureProvider</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·å¤šä¸ª proxy å°±å¯ä»¥æ˜¾ç¤ºåŒä¸€ä¸ªçª—å£çš„å†…å®¹ï¼Œæ¯” QML çš„ <code>ShaderEffectSource</code> æ•ˆç‡æ›´é«˜ã€‚</p><h2 id="ç»“å°¾"><a href="#ç»“å°¾" class="headerlink" title="ç»“å°¾"></a>ç»“å°¾</h2><p>ä¸Šè¿°ä»…ä»…æ˜¯ Treeland å®ç° Qt å’Œ wlroots ç¼åˆçš„ä¸€éƒ¨åˆ†æµç¨‹ï¼Œå®é™…ä¸Šå¯¹äº‹ä»¶çš„å¤„ç†å°±ååˆ†å¤æ‚ï¼Œä¸æ­¢é”®ç›˜è¾“å…¥ï¼Œè¿˜éœ€è¦å¤„ç†å…‰æ ‡ã€è§¦æ§ã€è§¦æ‘¸ç­‰å…¶ä»–è®¾å¤‡ã€‚è¿˜æœ‰å…‰æ ‡çš„ç»˜åˆ¶ä¹Ÿéœ€è¦åŒºåˆ†ç¡¬å…‰æ ‡å’Œè½¯å…‰æ ‡ï¼Œæ¸²æŸ“ç”»é¢æ—¶çš„ç¡¬ä»¶åŠ é€ŸåŠè½¯ä»¶å®ç°ç­‰ã€‚</p><p>åç»­å‡†å¤‡å†™ä¸€ä¸‹å…‰æ ‡ç›¸å…³çš„å¤„ç†ï¼Œä»¥åŠè¿˜æ²¡ä»‹ç» Treeland çš„ç”»é¢æ˜¯æ€ä¹ˆç»˜åˆ¶çš„ã€‚</p><h2 id="ç›¸å…³æ–‡æ¡£"><a href="#ç›¸å…³æ–‡æ¡£" class="headerlink" title="ç›¸å…³æ–‡æ¡£"></a>ç›¸å…³æ–‡æ¡£</h2><aside>ğŸ’¡<p>Qt QPA <a href="https://doc.qt.io/qt-6/qpa.html">https://doc.qt.io/qt-6/qpa.html</a><br>QOffscreenSurface <a href="https://doc.qt.io/qt-6/qoffscreensurface.html">https://doc.qt.io/qt-6/qoffscreensurface.html</a></p></aside>]]></content>
      
      
      <categories>
          
          <category> æŠ€æœ¯åˆ†äº« </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++, Wayland, å›¾å½¢å­¦ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Treelandï¼šDDE è¿›æ­¥çš„é˜¶æ¢¯</title>
      <link href="/2024/11/01/treeland-go-go-go/"/>
      <url>/2024/11/01/treeland-go-go-go/</url>
      
        <content type="html"><![CDATA[<h1 id="å›é¡¾"><a href="#å›é¡¾" class="headerlink" title="å›é¡¾"></a>å›é¡¾</h1><p>DDE åœ¨ v15 æ—¶æœŸï¼Œä½¿ç”¨ Mutter ä½œä¸ºå¸¦åˆæˆå™¨çš„çª—ç®¡ï¼Œä»¥åŠ Metacity è¿™ç§ä¸å¸¦åˆæˆå™¨çš„çª—ç®¡ï¼Œä¸€ä¸ªæ˜¯åœ¨é«˜æ€§èƒ½è®¾å¤‡ä¸Šä½¿ç”¨ï¼Œä¸€ä¸ªæ˜¯ä¸ºä½æ€§èƒ½è®¾å¤‡ä¸Šä½¿ç”¨ã€‚</p><p>åœ¨ V20 æ—¶æœŸï¼ŒDDE æ›´æ¢ KWin å½“çª—å£ç®¡ç†å™¨ï¼Œç”±äº KWin è‡ªå¸¦æœ‰å…³é—­åˆæˆå™¨çš„æ¨¡å¼ï¼Œæ‰€ä»¥ DDE ä¹Ÿæ”¾å¼ƒäº† Metacity ä½œä¸ºå¤‡ç”¨çª—ç®¡çš„é€‰é¡¹ã€‚</p><h2 id="Mutter"><a href="#Mutter" class="headerlink" title="Mutter"></a>Mutter</h2><p>Mutter æ˜¯ GNOME å¼€å‘çš„å¸¦æœ‰åˆæˆå™¨åŠŸèƒ½çš„çª—å£ç®¡ç†å™¨ã€‚</p><img src="/2024/11/01/treeland-go-go-go/image.png" class="" title="Mutter"><p>Mutter</p><h2 id="Metacity"><a href="#Metacity" class="headerlink" title="Metacity"></a>Metacity</h2><p>ä¸€ä¸ªä¸å¸¦æœ‰åˆæˆå™¨åŠŸèƒ½çš„çª—å£ç®¡ç†å™¨ã€‚</p><img src="/2024/11/01/treeland-go-go-go/image%201.png" class="" title="Metacity"><p>Metacity</p><h2 id="KWin"><a href="#KWin" class="headerlink" title="KWin"></a>KWin</h2><p>KWin æ˜¯ KDE å¼€å‘çš„ï¼Œå…·æœ‰åŠ¨æ€åˆ‡æ¢æ¸²æŸ“åç«¯ï¼ŒåŠ¨æ€å¼€å…³åˆæˆå™¨åŠŸèƒ½çš„çª—å£ç®¡ç†å™¨ã€‚</p><img src="/2024/11/01/treeland-go-go-go/image%202.png" class="" title="KWin"><p>KWin</p><h1 id="éœ€æ±‚å’ŒæŒ‡æ ‡"><a href="#éœ€æ±‚å’ŒæŒ‡æ ‡" class="headerlink" title="éœ€æ±‚å’ŒæŒ‡æ ‡"></a>éœ€æ±‚å’ŒæŒ‡æ ‡</h1><p>åœ¨ä¸€ä¸ªé¢å‘ç”¨æˆ·çš„äº§å“ä¸­ï¼Œæ‹¥æœ‰å‹å¥½çš„ç•Œé¢æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„äº‹æƒ…ï¼Œæ‰€ä»¥è®¾è®¡å¸ˆç»™äº†ä¸€å¤§å †éå¸¸å¥½çœ‹çš„ç•Œé¢äº¤äº’è®¾è®¡ã€‚</p><p>ä½†æ›´å¤šçš„åŠ¨ç”»æ•ˆæœï¼Œä»¥åŠæ›´å¤šçš„ç»„ä»¶äº¤äº’ï¼Œé€šå¸¸å°±è¦æ±‚ä½¿ç”¨æ›´å¤šçš„èµ„æºï¼Œæ›´å¤šçš„å†…å­˜ï¼Œæ›´é«˜çš„åŠŸè€—ã€‚</p><p>è®¾è®¡å¸ˆè¯´è¦åŠ¨ç”»åä¸½ï¼Œè¦åŠ¨ç”»æµç•…ï¼Œè¦ä¼˜ç§€çš„ç”¨æˆ·ä½“éªŒã€‚</p><p>æ¶æ„å¸ˆè¯´è¦ä½èµ„æºå ç”¨ï¼Œä½å†…å­˜ï¼Œä¸èƒ½å¡ã€‚</p><p>è™½è¯´ä¸€åˆ‡ç›®æ ‡éƒ½æ˜¯ä¸ºäº†ç”¨æˆ·ä½“éªŒï¼Œä½†ä¸¤ä¸ªå¤§æŒ‡æ ‡åœ¨å®ç°ä¸Šç«Ÿç„¶æ˜¯å†²çªçš„ï¼Œé‚£ä¹ˆå¦‚ä½•å¹³è¡¡äºŒè€…ï¼Œå°±éœ€è¦ç ”å‘çŒ®ç¥­ä¸€äº›å¤´å‘äº†ã€‚</p><h1 id="å¯¹æ¯”"><a href="#å¯¹æ¯”" class="headerlink" title="å¯¹æ¯”"></a>å¯¹æ¯”</h1><p>åœ¨Linuxä¸‹ç›®å‰æœ‰ä¸¤ä¸ªæŠ€æœ¯æ ˆï¼Œä¸€ä¸ªæ˜¯å†å²æ‚ ä¹…çš„X11ï¼Œå¦ä¸€ä¸ªæ˜¯è¾ƒæ–°çš„ Waylandã€‚</p><p>æ¥ä¸‹æ¥ï¼Œè·Ÿéšæˆ‘ä¸€èµ·æ¥å¯¹æ¯”ä¸¤ä¸ªæŠ€æœ¯ã€‚</p><h2 id="X11"><a href="#X11" class="headerlink" title="X11"></a>X11</h2><h3 id="æ¶æ„"><a href="#æ¶æ„" class="headerlink" title="æ¶æ„"></a>æ¶æ„</h3><p>X11é‡‡ç”¨äº†æ¯”è¾ƒè€çš„å®¢æˆ·ç«¯-æœåŠ¡å™¨æ¶æ„ã€‚åº”ç”¨ç¨‹åºé€šè¿‡XæœåŠ¡å™¨ä¸ç¡¬ä»¶è®¾å¤‡è¿›è¡Œé€šä¿¡ï¼Œè¿™ç§æ¶æ„éå¸¸çµæ´»ï¼Œæ”¯æŒç½‘ç»œä¼ è¾“ï¼Œä½¿å¾—è¿œç¨‹æ˜¾ç¤ºå˜å¾—å¯èƒ½ã€‚ç„¶è€Œï¼ŒX11åè®®å¤æ‚ä¸”è¿‡æ—¶ï¼Œåœ¨å¾ˆå¤šæ–¹é¢ä¸å†ç¬¦åˆç°ä»£çš„å›¾å½¢éœ€æ±‚ã€‚</p><h3 id="æ€§èƒ½"><a href="#æ€§èƒ½" class="headerlink" title="æ€§èƒ½"></a>æ€§èƒ½</h3><p>ç”±äºå…¶è®¾è®¡è¾ƒè€ï¼ŒX11åœ¨ä¸€äº›ç°ä»£åœºæ™¯ä¸‹çš„æ€§èƒ½è¡¨ç°ä¸ä½³ã€‚å®ƒéœ€è¦ä¾èµ–å¾ˆå¤šæ‰©å±•å’Œè¡¥ä¸æ‰èƒ½å®ç°ç°ä»£å›¾å½¢æ•ˆæœï¼Œä¾‹å¦‚åˆæˆç®¡ç†å™¨ï¼ˆCompositorï¼‰ç­‰ã€‚è¿™äº›å åŠ çš„å¤æ‚æ€§å¯¼è‡´äº†é¢å¤–çš„æ€§èƒ½å¼€é”€ã€‚</p><h3 id="å®‰å…¨æ€§"><a href="#å®‰å…¨æ€§" class="headerlink" title="å®‰å…¨æ€§"></a>å®‰å…¨æ€§</h3><p>X11çš„å®‰å…¨æ€§é—®é¢˜æ¯”è¾ƒæ˜æ˜¾ï¼Œå› ä¸ºæ‰€æœ‰åº”ç”¨ç¨‹åºéƒ½å¯ä»¥è®¿é—®å½¼æ­¤çš„çª—å£ä¿¡æ¯ã€‚è¿™æ„å‘³ç€ä¸€ä¸ªæ¶æ„ç¨‹åºå¯ä»¥è¯»å–æˆ–å¹²æ‰°å…¶ä»–ç¨‹åºçš„è¾“å…¥è¾“å‡ºã€‚è™½ç„¶å¯ä»¥é€šè¿‡ä¸€äº›æ‰©å±•å’Œå·¥å…·åŠ å¼ºå®‰å…¨æ€§ï¼Œä½†è¿™å¹¶ä¸æ˜¯X11çš„è®¾è®¡åˆè¡·ã€‚</p><h3 id="å¯æ‰©å±•æ€§å’Œå…¼å®¹æ€§"><a href="#å¯æ‰©å±•æ€§å’Œå…¼å®¹æ€§" class="headerlink" title="å¯æ‰©å±•æ€§å’Œå…¼å®¹æ€§"></a><strong>å¯æ‰©å±•æ€§å’Œå…¼å®¹æ€§</strong></h3><p>ç”±äºå­˜åœ¨äº†å‡ åå¹´ï¼ŒX11æœ‰éå¸¸å¹¿æ³›çš„åº”ç”¨æ”¯æŒå’Œå…¼å®¹æ€§ã€‚è®¸å¤šè€çš„åº”ç”¨ç¨‹åºå’Œæ¡Œé¢ç¯å¢ƒä»ç„¶ä¾èµ–äºX11åè®®ï¼Œå°¤å…¶æ˜¯åœ¨è¿œç¨‹æ¡Œé¢å’ŒæŸäº›ä¸“ä¸šé¢†åŸŸã€‚</p><h3 id="è¾“å…¥è®¾å¤‡æ”¯æŒ"><a href="#è¾“å…¥è®¾å¤‡æ”¯æŒ" class="headerlink" title="è¾“å…¥è®¾å¤‡æ”¯æŒ"></a><strong>è¾“å…¥è®¾å¤‡æ”¯æŒ</strong></h3><p>ç”±äºå…¶å†å²æ‚ ä¹…ï¼ŒX11å¯¹å„ç§è¾“å…¥è®¾å¤‡çš„æ”¯æŒç›¸å½“æˆç†Ÿã€‚ä½†éšç€æ–°ç¡¬ä»¶å’Œæ–°è¾“å…¥æŠ€æœ¯çš„å‡ºç°ï¼ŒX11çš„è®¾è®¡æ˜¾å¾—æœ‰äº›ä¸çµæ´»ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤šç‚¹è§¦æ§å’Œæ‰‹åŠ¿æ”¯æŒæ–¹é¢ã€‚</p><h3 id="è¿œç¨‹æ¡Œé¢å’Œç½‘ç»œé€æ˜æ€§"><a href="#è¿œç¨‹æ¡Œé¢å’Œç½‘ç»œé€æ˜æ€§" class="headerlink" title="è¿œç¨‹æ¡Œé¢å’Œç½‘ç»œé€æ˜æ€§"></a><strong>è¿œç¨‹æ¡Œé¢å’Œç½‘ç»œé€æ˜æ€§</strong></h3><p>X11çš„ä¸€ä¸ªä¼˜åŠ¿æ˜¯å…¶å¤©ç„¶çš„ç½‘ç»œé€æ˜æ€§ã€‚å®ƒæ”¯æŒé€šè¿‡ç½‘ç»œå°†æ˜¾ç¤ºå†…å®¹è¿œç¨‹ä¼ è¾“ï¼Œè¿™æ˜¯å¾ˆå¤šä¸“ä¸šé¢†åŸŸï¼ˆå¦‚ç§‘å­¦è®¡ç®—ã€æœåŠ¡å™¨ç®¡ç†ï¼‰ä¸­éå¸¸æœ‰ç”¨çš„åŠŸèƒ½ã€‚</p><h2 id="Wayland"><a href="#Wayland" class="headerlink" title="Wayland"></a>Wayland</h2><h3 id="æ¶æ„-1"><a href="#æ¶æ„-1" class="headerlink" title="æ¶æ„"></a>æ¶æ„</h3><p>Waylandé‡‡ç”¨çš„æ˜¯æ›´ç®€å•çš„è®¾è®¡ï¼Œå»æ‰äº†XæœåŠ¡å™¨çš„å¤æ‚å±‚æ¬¡ã€‚æ¶ˆé™¤äº†å¾ˆå¤šä¸­é—´ç¯èŠ‚ï¼Œæé«˜äº†æ•ˆç‡å’Œå“åº”é€Ÿåº¦ã€‚Waylandä¸“æ³¨äºæœ¬åœ°æ˜¾ç¤ºï¼Œä¸åƒX11é‚£æ ·ç›´æ¥æ”¯æŒè¿œç¨‹æ˜¾ç¤ºã€‚</p><h3 id="æ€§èƒ½-1"><a href="#æ€§èƒ½-1" class="headerlink" title="æ€§èƒ½"></a>æ€§èƒ½</h3><p>Waylandçš„è®¾è®¡æ›´åŠ ç°ä»£åŒ–ï¼Œå®ƒç®€åŒ–äº†æ¸²æŸ“è¿‡ç¨‹ï¼Œå‡å°‘äº†ä¸­é—´å±‚ï¼Œæ€§èƒ½æå‡æ˜¾è‘—ã€‚ç‰¹åˆ«æ˜¯åœ¨åŠ¨ç”»å’Œçª—å£æ“ä½œæ–¹é¢ï¼ŒWaylandé€šå¸¸æ¯”X11æ›´ä¸ºæµç•…ã€‚</p><h3 id="å®‰å…¨æ€§-1"><a href="#å®‰å…¨æ€§-1" class="headerlink" title="å®‰å…¨æ€§"></a>å®‰å…¨æ€§</h3><p>Waylandåœ¨è®¾è®¡æ—¶è€ƒè™‘äº†å®‰å…¨æ€§ã€‚åº”ç”¨ç¨‹åºä¹‹é—´çš„éš”ç¦»æ›´å¼ºï¼Œåº”ç”¨ç¨‹åºæ— æ³•è®¿é—®å…¶ä»–ç¨‹åºçš„å›¾åƒæˆ–è¾“å…¥è¾“å‡ºï¼Œè¿™æ˜¾è‘—æé«˜äº†ç³»ç»Ÿçš„æ•´ä½“å®‰å…¨æ€§ã€‚</p><h3 id="å¯æ‰©å±•æ€§å’Œå…¼å®¹æ€§-1"><a href="#å¯æ‰©å±•æ€§å’Œå…¼å®¹æ€§-1" class="headerlink" title="å¯æ‰©å±•æ€§å’Œå…¼å®¹æ€§"></a><strong>å¯æ‰©å±•æ€§å’Œå…¼å®¹æ€§</strong></h3><p>å°½ç®¡Waylandé€æ¸è¢«ä¸»æµæ¡Œé¢ç¯å¢ƒï¼ˆå¦‚GNOMEã€KDEç­‰ï¼‰æ”¯æŒï¼Œä½†å…¶åº”ç”¨ç”Ÿæ€ä»ç„¶ä¸å¦‚X11å¹¿æ³›ã€‚åœ¨æŸäº›è€æ—§æˆ–ä¸“ä¸šçš„åº”ç”¨åœºæ™¯ä¸­ï¼Œå¯èƒ½éœ€è¦é€šè¿‡å…¼å®¹å±‚ï¼ˆå¦‚XWaylandï¼‰æ¥è¿è¡ŒåŸºäºX11çš„åº”ç”¨ç¨‹åºã€‚</p><h3 id="è¾“å…¥è®¾å¤‡æ”¯æŒ-1"><a href="#è¾“å…¥è®¾å¤‡æ”¯æŒ-1" class="headerlink" title="è¾“å…¥è®¾å¤‡æ”¯æŒ"></a><strong>è¾“å…¥è®¾å¤‡æ”¯æŒ</strong></h3><p>Waylandé’ˆå¯¹ç°ä»£ç¡¬ä»¶è¿›è¡Œäº†ä¼˜åŒ–ï¼Œå°¤å…¶æ˜¯åœ¨å¤šç‚¹è§¦æ§ã€è§¦æ‘¸æ¿æ‰‹åŠ¿ç­‰æ–¹é¢æœ‰æ›´å¥½çš„æ”¯æŒã€‚æ­¤å¤–ï¼Œå®ƒå¯¹æ˜¾ç¤ºå™¨çš„DPIç¼©æ”¾ã€åˆ·æ–°ç‡ç­‰ä¹Ÿæœ‰æ›´çµæ´»çš„å¤„ç†ã€‚</p><h3 id="è¿œç¨‹æ¡Œé¢å’Œç½‘ç»œé€æ˜æ€§-1"><a href="#è¿œç¨‹æ¡Œé¢å’Œç½‘ç»œé€æ˜æ€§-1" class="headerlink" title="è¿œç¨‹æ¡Œé¢å’Œç½‘ç»œé€æ˜æ€§"></a><strong>è¿œç¨‹æ¡Œé¢å’Œç½‘ç»œé€æ˜æ€§</strong></h3><p>Waylandé»˜è®¤æ²¡æœ‰X11é‚£æ ·çš„ç½‘ç»œé€æ˜æ€§åŠŸèƒ½ã€‚è¿™æ„å‘³ç€åŸç”Ÿçš„è¿œç¨‹æ¡Œé¢åŠŸèƒ½æ¯”è¾ƒæœ‰é™ï¼Œå°½ç®¡å¯ä»¥é€šè¿‡ä¸€äº›ç¬¬ä¸‰æ–¹å·¥å…·æˆ–åè®®ï¼ˆå¦‚VNCã€RDPï¼‰å®ç°è¿œç¨‹æ¡Œé¢ï¼Œä½†è¿™ä¸æ˜¯Waylandçš„æ ¸å¿ƒåŠŸèƒ½ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æ€»ç»“ä¸‹æ¥ï¼ŒX11å·²ç»è¿›å…¥ç»´æŠ¤é˜¶æ®µï¼Œä¸å†è¿›è¡Œå¤§å¹…æ›´æ–°ã€‚éšç€æ—¶é—´çš„æ¨ç§»ï¼Œå¼€å‘è€…å’Œç¤¾åŒºçš„æ³¨æ„åŠ›é€æ¸è½¬ç§»åˆ°Waylandä¸Šï¼ŒX11å¯èƒ½ä¼šé€æ­¥æ·¡å‡ºä¸»æµæ¡Œé¢ç¯å¢ƒã€‚Waylandæ­£åœ¨é€æ­¥æˆä¸ºLinuxæ¡Œé¢çš„æ ‡å‡†ã€‚éšç€è¶Šæ¥è¶Šå¤šçš„åº”ç”¨ç¨‹åºå’Œæ¡Œé¢ç¯å¢ƒè½¬å‘æ”¯æŒWaylandï¼Œå…¶ç”Ÿæ€ç³»ç»Ÿæ­£åœ¨ä¸æ–­æˆç†Ÿå’Œæ‰©å±•ã€‚</p><h1 id="æ¶æ„è®¾è®¡"><a href="#æ¶æ„è®¾è®¡" class="headerlink" title="æ¶æ„è®¾è®¡"></a>æ¶æ„è®¾è®¡</h1><p>ä»æŠ€æœ¯å±‚é¢ä¸Šï¼Œæˆ‘ä»¬è®¤ä¸ºæ˜¯æ—¶å€™æ›´æ–°æŠ€æœ¯æ–¹æ¡ˆäº†ï¼Œæ›¾ç»çš„X11+çª—å£ç®¡ç†å™¨+åˆæˆå™¨çš„æ¨¡å¼ï¼Œçµæ´»ä½†ä¸æ»¡è¶³éœ€æ±‚ï¼ŒWaylandä»åº•å±‚å°±å°†ä¸‰è€…èåˆåœ¨äº†ä¸€èµ·ï¼Œå¹¶ä¸”æ›´æ–°ç”»é¢æ˜¯ä»¥æ¯å¹…å®Œæ•´çš„ç”»é¢ä½œä¸ºåŸºç¡€çš„ï¼Œè¿™ç¡®ä¿äº†ç”»é¢ä¸ä¼šå› ä¸ºä¸åŒçª—å£æ›´æ–°ç•Œé¢çš„æ—¶æœºä¸ä¸€è‡´å¯¼è‡´ç”»é¢æ’•è£‚ã€‚</p><p>æ›´é‡è¦çš„ä¸€ç‚¹ï¼Œè‡ªç ”çš„çª—å£ç®¡ç†å™¨ï¼Œå®ƒæ˜¯ä»¥å®ç°DDEçš„éœ€æ±‚ä¸ºç›®çš„çš„ï¼Œè¿™æ˜¯ç¬¬ä¸‰æ–¹çª—å£ç®¡ç†å™¨ä¸èƒ½æ¯”æ‹Ÿçš„ã€‚é€šå¸¸ä½¿ç”¨ç¬¬ä¸‰æ–¹çš„é¡¹ç›®æ—¶ï¼Œéƒ½è¦è¿›è¡Œå¤§é‡ç ´åæ€§çš„è°ƒæ•´ï¼Œå¯¼è‡´forkåçš„é¡¹ç›®æ— æ³•å’Œä¸Šæ¸¸åŒæ­¥ï¼Œä¸èƒ½åŠæ—¶è·å–æ›´æ–°å’Œä¿®å¤ï¼Œå¹¶ä¸”ç¬¬ä¸‰æ–¹çš„é¡¹ç›®å·²ç»å‘å±•äº†å¾ˆé•¿æ—¶é—´ï¼Œå†…éƒ¨æœ‰è®¸å¤šDDEç”¨ä¸ä¸Šã€ç”šè‡³å†²çªçš„åŠŸèƒ½ï¼Œéƒ½éœ€è¦è¿›è¡Œå¤§é‡è°ƒæ•´ï¼Œæ›´åŠ å‰§äº†ç»´æŠ¤æˆæœ¬ã€‚</p><p>æ‰€ä»¥ DDE å†³å®šå¼€å‘ä¸€ä¸ªæ–°çš„çª—å£ç®¡ç†å™¨â€”â€”Treelandã€‚</p><p>Treelandåœ¨åº•å±‚ä½¿ç”¨ wlroots ä½œä¸º Wayland çš„åŸºç¡€åº“ï¼Œä¸ä¿®æ”¹ wlroots çš„ä»£ç ï¼Œä¹Ÿå°±æ„å‘³ç€å¯ä»¥éšæ—¶åŒæ­¥ä¸Šæ¸¸è¿›åº¦ï¼Œè·å¾—æ–°çš„åŠŸèƒ½ä¸ä¿®å¤ã€‚ä¸Šå±‚ä½¿ç”¨ Qtï¼Œå¯ä»¥å……åˆ†åˆ©ç”¨å…¬å¸å†…å¤§é‡çš„ Qt å¼€å‘è€…ï¼Œä¸å†éœ€è¦ä¸€ç›´æœ‰ä¸“äººè´Ÿè´£ç‰¹å®šé¡¹ç›®ï¼Œè®©DDEçš„æŠ€æœ¯æ ˆæ›´åŠ ç»Ÿä¸€ã€‚</p><img src="/2024/11/01/treeland-go-go-go/image%203.png" class="" title="image.png"><aside><p>è¯¥å›¾æè¿°äº† Treeland åœ¨æ•´ä½“ä¸Šä¼šä½¿ç”¨å“ªäº›é¡¹ç›®æˆ–æ¥å£å®ŒæˆåŠŸèƒ½ã€‚</p></aside><img src="/2024/11/01/treeland-go-go-go/v25-charter-treeland-treeland.drawio-2.png" class="" title="Treeland ç»“æ„å›¾"><p>Treeland ç»“æ„å›¾</p><p>ç®€å•ä»‹ç»ä¸€äº› Treeland é‡Œæ¶‰åŠçš„é‡è¦é¡¹ç›®ã€‚</p><ul><li><p>QWlroots</p><p>  wlroots çš„ Qt ç»‘å®šï¼Œå°† wayland ä¿¡å·è½¬æ¢æˆ Qt é£æ ¼çš„ä¿¡å·ã€‚</p></li><li><p>Waylib</p><p>  å°† wlroots ä¸­çš„ç»„ä»¶å°è£…æˆ QtQuick å¯¹è±¡ï¼Œä½¿ç”¨ QPA ä¸º Treeland æä¾›äº‹ä»¶è½¬æ¢ä¸åˆ†å‘ã€‚</p></li><li><p>DtkDeclarative</p><p>  DTK çš„ QtQuick ç»„ä»¶ï¼Œå°è£…äº†å¤§éƒ¨åˆ† DTK style çš„æ§ä»¶ã€‚</p></li></ul><p>åœ¨ Waylibä¸­ï¼Œä¼šä½¿ç”¨åˆ° Qt çš„ QPA åŠŸèƒ½ï¼Œå°† wlroots ä½œä¸ºä¸€ä¸ªæ–°çš„å¹³å°æ¥å¤„ç†ä¸€éƒ¨åˆ†åŠŸèƒ½ã€‚</p><p>QPA åœ¨ Treeland ä¸­æœ‰ç€ä¸¾è¶³è½»é‡çš„åœ°ä½ï¼Œæ¥è‡ªç³»ç»Ÿåº•å±‚çš„äº‹ä»¶ä¼šå…ˆè¿›å…¥åˆ° Waylibä¸­ï¼Œåœ¨ Waylib é‡Œå°†äº‹ä»¶è½¬æ¢æˆ Qt å†…éƒ¨äº‹ä»¶ï¼Œå‘é€ç»™ä¸Šå±‚ã€‚è¿™æ · Treeland å°±å¯ä»¥åœ¨ QtQuick ä¸­ç¡®å®šç”¨æˆ·çš„ç‚¹å‡»ä½ç½®ã€æŒ‰é”®äº‹ä»¶ç­‰è¡Œä¸ºã€‚å½“ç”¨æˆ·ç‚¹å‡»çš„æ˜¯çª—å£æ—¶ï¼ŒTreeland è¿˜ä¼šé€šè¿‡ Waylib ç”Ÿæˆä¸€ä¸ªäº‹ä»¶ï¼Œé€šè¿‡ seat çš„æ¥å£å‘é€ç»™å®¢æˆ·ç«¯ï¼Œå®Œæˆç•Œé¢äº¤äº’ã€‚</p><img src="/2024/11/01/treeland-go-go-go/waylib.png" class="" title="Treeland å¤„ç†åº•å±‚äº‹ä»¶ä¸ä¸Šå±‚äº‹ä»¶çš„æµç¨‹"><p>Treeland å¤„ç†åº•å±‚äº‹ä»¶ä¸ä¸Šå±‚äº‹ä»¶çš„æµç¨‹</p><h2 id="ç•Œé¢æ•ˆæœä¸ä¼˜åŒ–"><a href="#ç•Œé¢æ•ˆæœä¸ä¼˜åŒ–" class="headerlink" title="ç•Œé¢æ•ˆæœä¸ä¼˜åŒ–"></a>ç•Œé¢æ•ˆæœä¸ä¼˜åŒ–</h2><p>Treeland ä½œä¸ºä¸€ä¸ªçª—å£ç®¡ç†å™¨ï¼Œæœ€é‡è¦çš„åŠŸèƒ½è¿˜æ˜¯å¯¹çª—å£çš„ç®¡ç†åŠæ˜¾ç¤ºæ•ˆæœçš„æ§åˆ¶ï¼ŒTreeland æ‰€æœ‰çš„çª—å£éƒ½å¸¦æœ‰åœ†è§’å’Œé˜´å½±ï¼Œä»¥åŠä¸€äº›çª—å£æ¨¡ç³Šæ•ˆæœã€‚</p><h3 id="åœ†è§’"><a href="#åœ†è§’" class="headerlink" title="åœ†è§’"></a>åœ†è§’</h3><p>DDEåŠdeepinç¤¾åŒºåº”ç”¨éƒ½å¤§é‡é‡‡ç”¨äº†çª—å£åœ†è§’çš„è®¾è®¡ï¼Œç”±åˆæˆå™¨æä¾›åœ†è§’è£å‰ªå¯ä»¥å¸¦æ¥æ›´åŠ ç»Ÿä¸€çš„ç•Œé¢è®¾è®¡ã€‚</p><img src="/2024/11/01/treeland-go-go-go/image%204.png" class="" title="çº¢è‰²ä¸ºQtQuickåœ†è§’&#x2F;é»„è‰²ä¸ºTreelandåœ†è§’"><p>çº¢è‰²ä¸ºQtQuickåœ†è§’&#x2F;é»„è‰²ä¸ºTreelandåœ†è§’</p><p>QtQuick åœ†è§’æ˜¯ç”± Rectangle ç»„ä»¶æä¾›çš„ï¼Œå®ƒåªèƒ½åŒæ—¶å¯¹å››ä¸ªè§’è¿›è¡Œæ“ä½œï¼ˆçº¢è‰²å—ï¼‰ã€‚ä½† DTK ç¨‹åºå…·å¤‡å¼‚å½¢çª—å£çš„èƒ½åŠ›ï¼Œæ‰€ä»¥ Treeland æä¾›äº†è‡ªå·±çš„è£åœ†è§’æ§ä»¶ï¼ˆé»„è‰²å—ï¼‰ã€‚<br>æ–°çš„é€ å‹ç®—æ³•ã€å‡ ä½•é¡¶ç‚¹æ•°é‡æ¯” QtQuick åŸç”Ÿçš„ Rectangle å‡å°‘50%ï¼ŒGPUé¡¶ç‚¹æ¸²æŸ“å’Œä¸‰è§’ç»†åˆ†æ€§èƒ½æå‡100%ã€‚<br>é‡‡ç”¨æ–°çš„æŠ—é”¯é½¿ç®—æ³•ï¼Œæé«˜äº†GPUç‰‡å…ƒç€è‰²å™¨æ€§èƒ½ï¼Œç›¸æ¯”äºæ™®é€š 4xMSAA æŠ—é”¯é½¿ç®—æ³•ï¼Œè®¡ç®—é‡å‡å°‘1&#x2F;4ã€‚</p><h3 id="æ¨¡ç³Š"><a href="#æ¨¡ç³Š" class="headerlink" title="æ¨¡ç³Š"></a>æ¨¡ç³Š</h3><img src="/2024/11/01/treeland-go-go-go/image%205.png" class="" title="QtQuick æ¨¡ç³Šæ§ä»¶"><p>QtQuick æ¨¡ç³Šæ§ä»¶</p><p>QtQuick çš„æ¨¡ç³Šç»„ä»¶ä»…æ”¯æŒå¯¹æ§ä»¶è‡ªèº«è¿›è¡Œæ¨¡ç³Šï¼Œè¿™å¹¶ä¸ç¬¦åˆ Treeland çš„éœ€æ±‚ã€‚</p><img src="/2024/11/01/treeland-go-go-go/image%206.png" class="" title="Treeland æ¨¡ç³Šæ§ä»¶"><p>Treeland æ¨¡ç³Šæ§ä»¶</p><p>Treeland é‡æ–°å®ç°äº†æ¨¡ç³Šç»„ä»¶ï¼Œèƒ½ä»æ˜¾å­˜é‡Œè·å–ç»„ä»¶ä¸‹æ–¹å›¾åƒæ•°æ®ï¼Œå†ä½¿ç”¨èåˆçš„æ¨¡ç³Šç®—æ³•ä¼˜åŒ–æ€§èƒ½ã€‚</p><h3 id="é˜´å½±"><a href="#é˜´å½±" class="headerlink" title="é˜´å½±"></a>é˜´å½±</h3><img src="/2024/11/01/treeland-go-go-go/image%207.png" class="" title="image.png"><p>Qt Quick æœ‰ä¸€ä¸ª BorderImage ç»„ä»¶ï¼Œå®ƒèƒ½ä»¥ä¹å®«æ ¼çš„æ–¹å¼ï¼Œå››ä¸ªè§’ä¿æŒä¸å˜ï¼Œå››è¾¹å’Œä¸­é—´çš„éƒ¨åˆ†æ‹‰ä¼¸ï¼Œæ¥è¾¾åˆ°åœ¨ç»„ä»¶åº•éƒ¨å……å½“è£…é¥°çš„æ•ˆæœã€‚å¹¶é€šè¿‡ ImageProvider çš„æœºåˆ¶ï¼Œæ‰‹åŠ¨æ§åˆ¶å›¾ç‰‡èµ„æºçš„åˆ›å»ºã€‚</p><p>Treeland ä½¿ç”¨ BorderImage ä½œä¸ºçª—å£é˜´å½±è´´å›¾ï¼Œé€šè¿‡ ImageProvider æ‰‹åŠ¨åˆ›å»ºè´´å›¾æè´¨ï¼Œåœ¨ç›¸åŒå¤§å°ä¸‹å¯å¤ç”¨åŒä¸€ä»½æè´¨ã€‚</p><h3 id="åŠ¨ç”»"><a href="#åŠ¨ç”»" class="headerlink" title="åŠ¨ç”»"></a>åŠ¨ç”»</h3><p>Treeland ç›´æ¥ä½¿ç”¨ QtQuick æä¾›çš„åŠ¨ç”»ç»„ä»¶ï¼Œæ¥ä¸ºç•Œé¢æä¾›åŠ¨ç”»æ•ˆæœã€‚</p><p>ä½¿ç”¨ State å’Œ Transition ä¸ºç»„ä»¶å®šä¹‰å±æ€§å˜åŒ–ï¼Œä¾‹å¦‚çª—å£æœ€å¤§åŒ–å’Œè¿˜åŸï¼Œä¸¤ä¸ª State åˆ‡æ¢ä¼šè§¦å‘ä¸åŒçš„ Transition æ‰§è¡Œå±æ€§å˜åŒ–ï¼Œåœ¨å±æ€§å˜åŒ–æ—¶ï¼Œä½¿ç”¨ QtQuick çš„åŠ¨ç”»ç»„ä»¶å®ŒæˆåŠ¨ç”»æ’­æ”¾ã€‚</p><h2 id="å¤šç”¨æˆ·"><a href="#å¤šç”¨æˆ·" class="headerlink" title="å¤šç”¨æˆ·"></a>å¤šç”¨æˆ·</h2><p>Treeland ä½œä¸ºè§£å†³æ–¹æ¡ˆçš„ä¸€éƒ¨åˆ†ï¼Œç›®çš„ä¹‹ä¸€å°±æ˜¯å¤šç”¨æˆ·å…±ç”¨åˆæˆå™¨ã€‚åœ¨ç»å…¸æ¨¡å¼ä¸‹ï¼Œä¸åŒç”¨æˆ·çš„åˆ‡æ¢éœ€è¦åœ¨ tty å±‚é¢å‰ç«¯ç¨‹åºè½¬ç§»æ§åˆ¶æƒï¼Œæ¯ä¸ªç”¨æˆ·ç‹¬å ä¸€ä¸ª tty è¿›è¡Œç”»é¢ä¸Šå±ã€‚ä½†åˆ‡æ¢ttyæ‰€éœ€çš„å·¥ä½œé‡ä¸å°ï¼Œè¿™å¯¼è‡´åˆ‡æ¢æ—¶å±å¹•çš„ç¼“å†²åŒºè¢«ä¸åŒçš„ç¨‹åºè¦†ç›–ï¼Œç»™äººçš„è§‚æ„Ÿå°±æ˜¯å±å¹•é—ªçƒäº†ä¸€ä¸‹ï¼Œç”šè‡³æ˜¯é»‘å±ä¸€ä¼šå„¿ã€‚</p><h3 id="DDM"><a href="#DDM" class="headerlink" title="DDM"></a>DDM</h3><img src="/2024/11/01/treeland-go-go-go/image%208.png" class="" title="image.png"><img src="/2024/11/01/treeland-go-go-go/image%209.png" class="" title="image.png"><p>é€šè¿‡ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼ŒLightDMæ¨¡å¼ä¸‹ï¼Œæ¯ä¸ªç”¨æˆ·æ‹¥æœ‰å®Œæ•´çš„ä¸€å¥—è¿›ç¨‹ç»„ï¼Œéƒ½éœ€è¦è¿è¡Œçª—ç®¡ã€ä»»åŠ¡æ ã€æ–‡ä»¶ç®¡ç†å™¨ç­‰ã€‚ä¸åŒçš„ç”¨æˆ·ä¼šå•ç‹¬å ç”¨ä¸€ä¸ª ttyï¼Œé‚£ä¹ˆç”¨æˆ·åˆ‡æ¢æ—¶ï¼Œå¿…ç„¶ä¼´éšç€åº•å±‚ DRM ä»¥åŠæ˜¾å¡é©±åŠ¨ç­‰æ“ä½œçš„åˆ‡æ¢ï¼Œå¸¦æ¥çš„ç»“æœå°±æ˜¯ä¼šçœ‹åˆ°é—ªé»‘å±ï¼Œè€Œä¸”ä¸¤ä¸ªç”¨æˆ·éƒ½è¦è·‘ä¸€ä¸ªé”å±ç•Œé¢æ¥ç»´æŒâ€å‡è£…æ˜¯åŒä¸€ä¸ªç•Œé¢â€œï¼Œä¹Ÿå¸¦æ¥äº†è·¨ç”¨æˆ·è¿›ç¨‹çš„ä¿¡æ¯åŒæ­¥éš¾é¢˜ã€‚</p><p>è€Œ DDM å’Œ Treeland é‡æ–°è®¾è®¡äº†å·¥ä½œæµç¨‹ï¼Œå°† Treeland å•ç‹¬æŠ½ç¦»å‡ºæ¥ï¼Œæ¯ä¸ªç”¨æˆ·éƒ½é€šè¿‡ç›¸åŒçš„ä¸€å¥—æœºåˆ¶å°†çª—å£ç”»é¢å‘é€ç»™ Treelandï¼Œè€Œ Treeland è´Ÿè´£æœ€ç»ˆçš„ç”»é¢åˆæˆä»¥åŠä¸Šå±ã€‚</p><p>å¸¦æ¥çš„å¥½å¤„æ˜¾è€Œæ˜“è§ï¼Œå†…å­˜æ–¹é¢èŠ‚çœäº†çª—ç®¡ã€é”å±ç­‰è¿›ç¨‹ï¼Œåˆ‡æ¢ç”¨æˆ·ä¹Ÿä¸ä¼šæœ‰é»‘å±é—ªçƒï¼ŒçŠ¶æ€ä¹Ÿä¸ç”¨æƒ³åŠæ³•åŒæ­¥äº†ã€‚</p><img src="/2024/11/01/treeland-go-go-go/greeter.png" class="" title="ä¸€ä¸ªç®€åŒ–çš„ DDM ä¸ Treeland çš„å¤šç”¨æˆ·ç™»å½•æµç¨‹"><p>ä¸€ä¸ªç®€åŒ–çš„ DDM ä¸ Treeland çš„å¤šç”¨æˆ·ç™»å½•æµç¨‹</p><h3 id="ä¸-systemd-çš„é›†æˆ"><a href="#ä¸-systemd-çš„é›†æˆ" class="headerlink" title="ä¸ systemd çš„é›†æˆ"></a>ä¸ systemd çš„é›†æˆ</h3><p>DDE çš„æ¯ä¸€ä¸ªç”¨æˆ·ä¼šè¯ï¼Œéƒ½å·²åˆ‡æ¢è‡³ systemd æœåŠ¡ï¼Œè€Œéæ‰€æœ‰è¿›ç¨‹éƒ½æŒ‚è½½åˆ°ä¼šè¯å…¥å£çš„æœåŠ¡ä¸Šã€‚è¿™æ ·åšæœ‰å¾ˆå¤šå¥½å¤„ï¼ŒåŒ…æ‹¬å¿«é€Ÿé‡å¯æ¡Œé¢ç¯å¢ƒï¼Œè€Œéæ³¨é”€å†ç™»å½•ã€‚è¿œç¨‹æ¡Œé¢çš„é“ºå«ï¼Œä¼šè¯çš„å¯åŠ¨ä¸å†å±€é™äºæœ¬åœ°ä¼šè¯ã€‚</p><p>åœ¨ Treeland æ¨¡å¼ä¸‹ï¼ŒDDE ä¼šåŠ è½½ä¸€ä¸ªå•ç‹¬çš„æœåŠ¡ï¼Œç”¨äºä¸ºç”¨æˆ·ä¼šè¯æ³¨å…¥æ˜¾ç¤ºç¯å¢ƒå˜é‡ã€‚è¯¥æœåŠ¡ä½¿ç”¨ systemd æä¾›çš„ socket æœºåˆ¶å®è¡Œæ‡’åŠ è½½ï¼Œå½“ DDE éœ€è¦æ˜¾ç¤ºçª—å£æ—¶ï¼Œå³æ—¶å‘ Treeland æ³¨å†Œï¼Œå®Œæˆç”¨æˆ·æ˜¾ç¤ºæœåŠ¡çš„åˆå§‹åŒ–ã€‚å½“ Treeland å´©æºƒé‡å¯æ—¶ï¼Œè¯¥æœåŠ¡ä¹Ÿä¼šç­‰å¾… Treeland å¯åŠ¨å®Œæˆï¼Œå¹¶å†æ¬¡è¿æ¥å› Treelandï¼Œç¡®ä¿ç”¨æˆ·ä¾§çš„çª—å£èƒ½æ­£å¸¸æ˜¾ç¤ºã€‚</p><img src="/2024/11/01/treeland-go-go-go/treeland.png" class="" title="å¤šç”¨æˆ·ç™»å½•æ—¶çš„åŸºæœ¬æµç¨‹"><p>å¤šç”¨æˆ·ç™»å½•æ—¶çš„åŸºæœ¬æµç¨‹</p><h1 id="æ€»ç»“-1"><a href="#æ€»ç»“-1" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æœ¬æ–‡ä»‹ç»äº†æ·±åº¦æ“ä½œç³»ç»Ÿï¼ˆDDEï¼‰åœ¨çª—å£ç®¡ç†å™¨æ–¹é¢çš„æ¼”è¿›ï¼Œä»æ—©æœŸä½¿ç”¨Mutterå’ŒMetacityï¼Œåˆ°åæ¥é‡‡ç”¨KWinï¼Œæœ€ç»ˆå†³å®šå¼€å‘è‡ªå·±çš„çª—å£ç®¡ç†å™¨Treelandã€‚TreelandåŸºäºwlrootså’ŒQtæŠ€æœ¯æ ˆï¼Œå®ç°äº†æ›´å¥½çš„æ€§èƒ½å’Œæ›´ç»Ÿä¸€çš„æŠ€æœ¯æ¡†æ¶ã€‚</p><p>æœ¬æ–‡æ¦‚è¿°äº† Treeland çš„æŠ€æœ¯æ¶æ„ã€ç•Œé¢æ•ˆæœä¼˜åŒ–ï¼ˆå¦‚åœ†è§’ã€æ¨¡ç³Šã€é˜´å½±ç­‰ï¼‰ï¼Œä»¥åŠå…¶åœ¨å¤šç”¨æˆ·åœºæ™¯ä¸‹çš„ä¼˜åŠ¿ã€‚æ­¤å¤–ï¼Œè¿˜ä»‹ç»äº†Treelandä¸systemdçš„é›†æˆï¼Œå±•ç¤ºäº†DDEåœ¨ç³»ç»Ÿæ¶æ„å’Œç”¨æˆ·ä½“éªŒæ–¹é¢çš„æŒç»­åˆ›æ–°å’Œæ”¹è¿›ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æŠ€æœ¯åˆ†äº« </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Add macvlan net</title>
      <link href="/2024/04/15/Add-macvlan-net/"/>
      <url>/2024/04/15/Add-macvlan-net/</url>
      
        <content type="html"><![CDATA[<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=Script to enable macvlan on boot</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=oneshot</span><br><span class="line">ExecStartPre=-/usr/bin/bash -c &#x27;mount --make-rshared /&#x27; # for k3s in lxc (optional)</span><br><span class="line">ExecStartPre=-/usr/bin/bash -c &#x27;/usr/bin/ip link del mac0&#x27;</span><br><span class="line">ExecStartPre=/usr/bin/bash -c &#x27;/usr/bin/ip link set eth0 up&#x27;</span><br><span class="line">ExecStartPre=/usr/bin/bash -c &#x27;/usr/bin/ip link add link eth0 mac0 type macvlan mode bridge&#x27;</span><br><span class="line">ExecStartPre=/usr/bin/bash -c &#x27;/usr/bin/ip addr add 192.168.1.11/24 dev mac0&#x27;</span><br><span class="line">ExecStartPre=/usr/bin/bash -c &#x27;/usr/bin/ip link set mac0 up&#x27;</span><br><span class="line">ExecStartPre=-/usr/bin/bash -c &#x27;/usr/bin/ip route add 192.168.1.0/24 dev mac0&#x27;</span><br><span class="line">ExecStartPre=/usr/bin/bash -c &#x27;/usr/bin/ip route add default via 192.168.1.1&#x27;</span><br><span class="line">ExecStartPre=/usr/bin/bash -c &#x27;/usr/bin/ip route add 198.18.0.0/16 via 192.168.1.1&#x27; # for fake ip (optional)</span><br><span class="line">ExecStartPre=/usr/bin/bash -c &#x27;ip rule add to 192.168.1.0/24 priority 2500 lookup main&#x27;</span><br><span class="line">ExecStart=/usr/bin/bash -c &#x27;/usr/bin/echo done&#x27;</span><br><span class="line">Restart=on-failure</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>solved run k8s in wsl2</title>
      <link href="/2024/03/01/solved-run-k8s-in-wsl2/"/>
      <url>/2024/03/01/solved-run-k8s-in-wsl2/</url>
      
        <content type="html"><![CDATA[<p>When I use wsl2 join my k8s cluster, I have some problem. It can be start, but pod is not runing.</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Normal   Scheduled               95m                default-scheduler  Successfully assigned longhorn-system/longhorn-csi-plugin-bvnmk to company-wsl-1</span><br><span class="line">Warning  FailedCreatePodSandBox  4m                 kubelet            Failed to create pod sandbox: rpc error: code = Unknown desc = failed to setup network for sandbox &quot;a13a250444d61af44800db054a047059c66202ab9d8a47732748c7c4d380131b&quot;: plugin type=&quot;multus&quot; failed (add): Multus: [longhorn-system/longhorn-csi-plugin-bvnmk/2203cd9f-608d-42b1-82b9-dad186a9b5cb]: error waiting for pod: Get &quot;https://[10.43.0.1]:443/api/v1/namespaces/longhorn-system/pods/longhorn-csi-plugin-bvnmk?timeout=1m0s&quot;: dial tcp 10.43.0.1:443: i/o timeout</span><br><span class="line">Normal   SandboxChanged          2m (x3 over 8m1s)  kubelet            Pod sandbox changed, it will be killed and re-created.</span><br><span class="line">Warning  FailedCreatePodSandBox  2m                 kubelet            Failed to create pod sandbox: rpc error: code = Unknown desc = failed to reserve sandbox name &quot;longhorn-csi-plugin-bvnmk_longhorn-system_2203cd9f-608d-42b1-82b9-dad186a9b5cb_2&quot;: name &quot;longhorn-csi-plugin-bvnmk_longhorn-system_2203cd9f-608d-42b1-82b9-dad186a9b5cb_2&quot; is reserved for &quot;a13a250444d61af44800db054a047059c66202ab9d8a47732748c7c4d380131b&quot;</span><br></pre></td></tr></table></figure><p>Looks like network problem, but when I open journal in wsl2, I see iptables-restore can not runing.</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">Mar 01 11:26:59 DESKTOP-TH5NA7O k3s[223]: E0301 11:26:59.262472     223 proxier.go:1521] &quot;Failed to execute iptables-restore&quot; err=&lt;</span><br><span class="line">Mar 01 11:26:59 DESKTOP-TH5NA7O k3s[223]:         exit status 2: iptables-restore v1.8.7 (nf_tables): Couldn&#x27;t load match `recent&#x27;:No such file or directory</span><br><span class="line">Mar 01 11:26:59 DESKTOP-TH5NA7O k3s[223]:</span><br><span class="line">Mar 01 11:26:59 DESKTOP-TH5NA7O k3s[223]:         Error occurred at line: 145</span><br><span class="line">Mar 01 11:26:59 DESKTOP-TH5NA7O k3s[223]:         Try `iptables-restore -h&#x27; or &#x27;iptables-restore --help&#x27; for more information.</span><br><span class="line">Mar 01 11:26:59 DESKTOP-TH5NA7O k3s[223]:  &gt;</span><br><span class="line">Mar 01 11:26:59 DESKTOP-TH5NA7O k3s[223]: I0301 11:26:59.262516     223 proxier.go:801] &quot;Sync failed&quot; retryingTime=&quot;30s&quot;</span><br></pre></td></tr></table></figure><p>Now letâ€™s fix!</p><p>build before install depends.</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">apt install -y git build-essential flex bison libssl-dev libelf-dev bc dwarves python3</span><br></pre></td></tr></table></figure><ol><li>clone wsl2 kernel code.</li></ol><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git clone --depth 1 https://github.com/microsoft/WSL2-Linux-Kernel.git &amp;&amp; cd WSL2-Linux-Kernel</span><br></pre></td></tr></table></figure><ol start="2"><li>enable xt_recent.</li></ol><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sed -i &#x27;s/# CONFIG_NETFILTER_XT_MATCH_RECENT is not set/CONFIG_NETFILTER_XT_MATCH_RECENT=y/&#x27; Microsoft/config-wsl</span><br></pre></td></tr></table></figure><ol start="3"><li>build kernel.</li></ol><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">make -j2 KCONFIG_CONFIG=Microsoft/config-wsl</span><br></pre></td></tr></table></figure><ol start="4"><li>cp kernel to some path.</li></ol><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cp arch/x86/boot/bzImage /mnt/c/Users/&lt;your-user-name&gt;/wsl-kernel</span><br><span class="line">``</span><br><span class="line"></span><br><span class="line">5. Create a .wslconfig file in C:\Users\&lt;your-user-name&gt;\</span><br><span class="line"></span><br><span class="line">```text</span><br><span class="line">[wsl2]</span><br><span class="line">kernel=C:\\Users\\&lt;your-user-name&gt;\\wsl-kernel</span><br></pre></td></tr></table></figure><ol start="6"><li>reboot wsl</li></ol><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">wsl <span class="literal">--shutdown</span></span><br><span class="line"></span><br><span class="line">wsl</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>solved Could not find a declaration file for module &#39;vuex&#39;.</title>
      <link href="/2023/09/11/solved-Could-not-find-a-declaration-file-for-module-vuex/"/>
      <url>/2023/09/11/solved-Could-not-find-a-declaration-file-for-module-vuex/</url>
      
        <content type="html"><![CDATA[<p>Recently I was rewriting the email client using Vue and encountered an error when using Vuex to process data.</p><p><code>Could not find a declaration file for module &#39;vuex&#39;.</code></p><p>Vuex does not have <code>@types/vuex</code>, so it can only be solved by adding d.ts manually.</p><p>Add vuex.d.ts in the project directory and add the following content:</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">declare</span> <span class="variable language_">module</span> <span class="string">&quot;vuex&quot;</span> &#123;</span><br><span class="line">   <span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&quot;vuex/types/index.d.ts&quot;</span>;</span><br><span class="line">   <span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&quot;vuex/types/helpers.d.ts&quot;</span>;</span><br><span class="line">   <span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&quot;vuex/types/logger.d.ts&quot;</span>;</span><br><span class="line">   <span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&quot;vuex/types/vue.d.ts&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
          <category> Solution </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vuex </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>solved react-native error: SDK iphoneos cannot be located</title>
      <link href="/2023/06/29/solved-react-native-error-SDK-iphoneos-cannot-be-located/"/>
      <url>/2023/06/29/solved-react-native-error-SDK-iphoneos-cannot-be-located/</url>
      
        <content type="html"><![CDATA[<p>While initializing the project, react native has the following error.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">patching file config.sub</span><br><span class="line">checking <span class="keyword">for</span> a BSD-compatible install... /usr/bin/install -c</span><br><span class="line">checking whether build environment is sane... <span class="built_in">yes</span></span><br><span class="line">checking <span class="keyword">for</span> arm-apple-darwin-strip... no</span><br><span class="line">checking <span class="keyword">for</span> strip... strip</span><br><span class="line">checking <span class="keyword">for</span> a thread-safe <span class="built_in">mkdir</span> -p... ./install-sh -c -d</span><br><span class="line">checking <span class="keyword">for</span> gawk... no</span><br><span class="line">checking <span class="keyword">for</span> mawk... no</span><br><span class="line">checking <span class="keyword">for</span> nawk... no</span><br><span class="line">checking <span class="keyword">for</span> awk... awk</span><br><span class="line">checking whether make sets $(MAKE)... <span class="built_in">yes</span></span><br><span class="line">checking whether make supports nested variables... <span class="built_in">yes</span></span><br><span class="line">checking <span class="keyword">for</span> arm-apple-darwin-gcc... /Library/Developer/CommandLineTools/usr/bin/cc -<span class="built_in">arch</span> arm64 -isysroot</span><br><span class="line">checking whether the C compiler works... no</span><br><span class="line">xcrun: error: SDK <span class="string">&quot;iphoneos&quot;</span> cannot be located</span><br><span class="line">xcrun: error: SDK <span class="string">&quot;iphoneos&quot;</span> cannot be located</span><br><span class="line">xcrun: error: SDK <span class="string">&quot;iphoneos&quot;</span> cannot be located</span><br><span class="line">xcrun: error: unable to lookup item <span class="string">&#x27;Path&#x27;</span> <span class="keyword">in</span> SDK <span class="string">&#x27;iphoneos&#x27;</span></span><br><span class="line">/Users/lxz/Library/Caches/CocoaPods/Pods/External/glog/2263bd123499e5b93b5efe24871be317-04b94/missing: Unknown `--is-lightweight<span class="string">&#x27; option</span></span><br><span class="line"><span class="string">Try `/Users/lxz/Library/Caches/CocoaPods/Pods/External/glog/2263bd123499e5b93b5efe24871be317-04b94/missing --help&#x27;</span> <span class="keyword">for</span> more information</span><br><span class="line">configure: WARNING: <span class="string">&#x27;missing&#x27;</span> script is too old or missing</span><br><span class="line">configure: error: <span class="keyword">in</span> `/Users/lxz/Library/Caches/CocoaPods/Pods/External/glog/2263bd123499e5b93b5efe24871be317-04b94<span class="string">&#x27;:</span></span><br><span class="line"><span class="string">configure: error: C compiler cannot create executables</span></span><br><span class="line"><span class="string">See `config.log&#x27;</span> <span class="keyword">for</span> more details</span><br><span class="line">âœ– Installing CocoaPods dependencies (this may take a few minutes)</span><br><span class="line">error Looks like your iOS environment is not properly <span class="built_in">set</span>. Please go to https://reactnative.dev/docs/environment-setup?os=macos&amp;platform=android and follow the React Native CLI QuickStart guide <span class="keyword">for</span> macOS and iOS.</span><br><span class="line">info Run CLI with --verbose flag <span class="keyword">for</span> more details.</span><br></pre></td></tr></table></figure><p>Notice in the error that &#x2F;Library&#x2F;Developer&#x2F;CommandLineTools&#x2F; is being used, which should use the path of xcode.</p><p>works for me:</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">sudo</span> xcode-select --switch /Applications/Xcode.app</span><br></pre></td></tr></table></figure><p>switch to project directory.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> ios &amp;&amp; npx pod install &amp;&amp; <span class="built_in">cd</span> .. &amp;&amp; react-native run-ios</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ReactNative </category>
          
          <category> Solution </category>
          
      </categories>
      
      
        <tags>
            
            <tag> reactnative </tag>
            
            <tag> ios </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¼€å‘ä¸€ä¸ª KWin ç‰¹æ•ˆæ’ä»¶</title>
      <link href="/2023/06/25/How-to-develop-a-kwin-special-effects-plugin/"/>
      <url>/2023/06/25/How-to-develop-a-kwin-special-effects-plugin/</url>
      
        <content type="html"><![CDATA[<p>KWin æ˜¯ KDE å¼€å‘çš„çª—å£ç®¡ç†å™¨ï¼Œæä¾›äº†éå¸¸ä¸°å¯Œçš„æ’ä»¶ï¼Œå¯ä»¥å¯¹åŠŸèƒ½è¿›è¡Œå¤§é‡çš„å®šåˆ¶ã€‚</p><p>æœ¬ç¯‡æ–‡ç« æ˜¯å¯¹çª—å£ç‰¹æ•ˆæ’ä»¶çš„å¼€å‘ä»‹ç»ã€‚</p><h2 id="æ’ä»¶å¼€å‘"><a href="#æ’ä»¶å¼€å‘" class="headerlink" title="æ’ä»¶å¼€å‘"></a>æ’ä»¶å¼€å‘</h2><h3 id="æ’ä»¶å®šä¹‰"><a href="#æ’ä»¶å®šä¹‰" class="headerlink" title="æ’ä»¶å®šä¹‰"></a>æ’ä»¶å®šä¹‰</h3><p>KWin çš„æ’ä»¶é€šå¸¸å¯ä»¥ä½¿ç”¨ä¸€äº›å®è¾…åŠ©ç”Ÿæˆä»£ç ï¼Œä¾‹å¦‚ä½¿ç”¨ <code>KPluginFactory</code> è¿›è¡Œæ’ä»¶çš„å®šä¹‰ï¼Œå†…å®¹æ˜¯ç”¨æ¥ç”Ÿæˆæ’ä»¶çš„å…¥å£ç±»ã€‚</p><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> EffectPluginFactory_iid <span class="string">&quot;org.kde.kwin.EffectPluginFactory&quot;</span> KWIN_PLUGIN_VERSION_STRING</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> KWIN_PLUGIN_FACTORY_NAME KPLUGINFACTORY_PLUGIN_CLASS_INTERNAL_NAME</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> KWIN_EFFECT_FACTORY_SUPPORTED_ENABLED(className, jsonFile, supported, enabled ) \</span></span><br><span class="line"><span class="meta">    class KWIN_PLUGIN_FACTORY_NAME : public KWin::EffectPluginFactory \</span></span><br><span class="line"><span class="meta">    &#123; \</span></span><br><span class="line"><span class="meta">        Q_OBJECT \</span></span><br><span class="line"><span class="meta">        Q_PLUGIN_METADATA(IID EffectPluginFactory_iid FILE jsonFile) \</span></span><br><span class="line"><span class="meta">        Q_INTERFACES(KPluginFactory) \</span></span><br><span class="line"><span class="meta">    public: \</span></span><br><span class="line"><span class="meta">        explicit KWIN_PLUGIN_FACTORY_NAME() &#123;&#125; \</span></span><br><span class="line"><span class="meta">        ~KWIN_PLUGIN_FACTORY_NAME() &#123;&#125; \</span></span><br><span class="line"><span class="meta">        bool isSupported() const override &#123; \</span></span><br><span class="line"><span class="meta">            supported \</span></span><br><span class="line"><span class="meta">        &#125; \</span></span><br><span class="line"><span class="meta">        bool enabledByDefault() const override &#123; \</span></span><br><span class="line"><span class="meta">            enabled \</span></span><br><span class="line"><span class="meta">        &#125; \</span></span><br><span class="line"><span class="meta">        KWin::Effect *createEffect() const override &#123; \</span></span><br><span class="line"><span class="meta">            return new className(); \</span></span><br><span class="line"><span class="meta">        &#125; \</span></span><br><span class="line"><span class="meta">    &#125;;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> KWIN_EFFECT_FACTORY_ENABLED(className, jsonFile, enabled ) \</span></span><br><span class="line"><span class="meta">    KWIN_EFFECT_FACTORY_SUPPORTED_ENABLED(className, jsonFile, return true;, enabled )</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> KWIN_EFFECT_FACTORY_SUPPORTED(className, jsonFile, supported ) \</span></span><br><span class="line"><span class="meta">    KWIN_EFFECT_FACTORY_SUPPORTED_ENABLED(className, jsonFile, supported, return true; )</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> KWIN_EFFECT_FACTORY(className, jsonFile ) \</span></span><br><span class="line"><span class="meta">    KWIN_EFFECT_FACTORY_SUPPORTED_ENABLED(className, jsonFile, return true;, return true; )</span></span><br></pre></td></tr></table></figure><p>å¤§éƒ¨åˆ†å®åªæ˜¯ä¸ºäº†æ–¹ä¾¿ç»“æ„ä¿®æ”¹ï¼Œæˆ‘ä»¬åªéœ€è¦ä½¿ç”¨ <code>K_PLUGIN_FACTORY</code> è¿›è¡Œæ’ä»¶å®šä¹‰å³å¯ã€‚</p><p>å‡è®¾æˆ‘ä»¬å¼€å‘äº†ä¸€ä¸ªæ’ä»¶ï¼Œåå­—å« demoï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨ main.cpp ä¸­ä½¿ç”¨ <code>KWIN_EFFECT_FACTORY_SUPPORTED</code> å®šä¹‰</p><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="built_in">KWIN_EFFECT_FACTORY_SUPPORTED</span>(</span><br><span class="line">    Demo,</span><br><span class="line">    <span class="string">&quot;metadata.json&quot;</span>,</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>ä»£ç å±•å¼€åæ˜¯è¿™æ ·çš„ã€‚</p><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">KPLUGINFACTORY_PLUGIN_CLASS_INTERNAL_NAME</span> : <span class="keyword">public</span> KWin::EffectPluginFactory \</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function">Q_OBJECT</span></span><br><span class="line"><span class="function">    <span class="title">Q_PLUGIN_METADATA</span><span class="params">(IID EffectPluginFactory_iid FILE <span class="string">&quot;metadata.json&quot;</span>)</span></span></span><br><span class="line"><span class="function">    <span class="title">Q_INTERFACES</span><span class="params">(KPluginFactory)</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span>: \</span></span><br><span class="line"><span class="function">    explicit KPLUGINFACTORY_PLUGIN_CLASS_INTERNAL_NAME() &#123;</span>&#125;</span><br><span class="line">    ~<span class="built_in">KPLUGINFACTORY_PLUGIN_CLASS_INTERNAL_NAME</span>() &#123;&#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">isSupported</span><span class="params">()</span> <span class="type">const</span> <span class="keyword">override</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">enabledByDefault</span><span class="params">()</span> <span class="type">const</span> <span class="keyword">override</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">KWin::Effect *<span class="title">createEffect</span><span class="params">()</span> <span class="type">const</span> <span class="keyword">override</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Demo</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œå…¶å® <code>KWIN_EFFECT_FACTORY_SUPPORTED</code> åªæ˜¯ä¸ºæˆ‘ä»¬ç”Ÿæˆäº†å·¥å‚å‡½æ•°ï¼Œè¾…åŠ©ç”Ÿæˆäº†ä¸€äº›å¿…è¦çš„é‡è½½ã€‚</p><p><code>metadata.json</code> æ–‡ä»¶æ˜¯ç”¨æ¥ä½œä¸ºæ’ä»¶çš„æè¿°ä¿¡æ¯ä½¿ç”¨çš„ã€‚</p><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;KPlugin&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;Category&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Accessibility&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;Description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Allow clip of window content&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;EnabledByDefault&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;Id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;scissor&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;License&quot;</span><span class="punctuation">:</span> <span class="string">&quot;GPL&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;Name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ScissorWindow&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;Name[zh_CN]&quot;</span><span class="punctuation">:</span> <span class="string">&quot;çª—å£åœ†è§’&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;org.kde.kwin.effect&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;enabledByDefaultMethod&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="ç‰¹æ•ˆæ’ä»¶"><a href="#ç‰¹æ•ˆæ’ä»¶" class="headerlink" title="ç‰¹æ•ˆæ’ä»¶"></a>ç‰¹æ•ˆæ’ä»¶</h3><p>ç‰¹æ•ˆæ’ä»¶æ˜¯ä¸€ç±»å¯ä»¥æ”¹å˜çª—å£ç”»é¢çš„æ’ä»¶ï¼Œä¾‹å¦‚æˆ‘ä»¬å¯ä»¥åœ¨æ’ä»¶é‡Œå¯¹çª—å£è¿›è¡Œè´´å›¾ã€å˜å½¢å’Œè£åˆ‡ï¼Œåœ¨ DDE ä¸­ï¼Œå°±ä½¿ç”¨ç‰¹æ•ˆæ’ä»¶å®Œæˆäº†åœ†è§’è£åˆ‡å’Œçª—å£æ¨¡ç³Šã€‚</p><p>è¿™é‡Œä½¿ç”¨åœ†è§’è£åˆ‡æ’ä»¶ä½œä¸ºä¾‹å­ï¼Œé¦–å…ˆä½¿ç”¨ <code>KWIN_EFFECT_FACTORY_SUPPORTED</code> å®å¯¹æ’ä»¶è¿›è¡Œå®šä¹‰ï¼Œ <code>KWIN_EFFECT_FACTORY_SUPPORTED</code> æ¥å—ä¸€ä¸ª class ä½œä¸ºè¿”å›çš„æ¥å£ç±»ï¼Œå®ƒéœ€è¦ç»§æ‰¿è‡ª <code>Effect</code>ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å…ƒä¿¡æ¯çš„ json æ–‡ä»¶ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯è¿”å›æ˜¯å¦æ”¯æŒï¼Œåœ¨å¯ç”¨æ’ä»¶æ—¶å¯å¯¹å½“å‰ç¯å¢ƒè¿›è¡Œåˆ¤æ–­ï¼Œä¾‹å¦‚æ’ä»¶éœ€è¦ä½¿ç”¨ <code>OpenGL</code> å¯¹å›¾å½¢è¿›è¡Œä¸€äº›æ“ä½œï¼Œä½†æ˜¯å½“å‰ç¯å¢ƒä¸æ”¯æŒ <code>OpenGL</code>ï¼Œé‚£ä¹ˆæ’ä»¶å°±ä¸ä¼šå¯ç”¨ã€‚</p><figure class="highlight json"><table><tr><td class="code"><pre><span class="line">#include <span class="string">&quot;scissorwindow.h&quot;</span></span><br><span class="line"></span><br><span class="line">namespace KWin</span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"></span><br><span class="line">KWIN_EFFECT_FACTORY_SUPPORTED(ScissorWindow<span class="punctuation">,</span></span><br><span class="line">                              <span class="string">&quot;metadata.json.stripped&quot;</span><span class="punctuation">,</span></span><br><span class="line">                              return ScissorWindow<span class="punctuation">:</span><span class="punctuation">:</span>supported();)</span><br><span class="line"></span><br><span class="line"><span class="punctuation">&#125;</span> <span class="comment">// namespace KWin</span></span><br><span class="line"></span><br><span class="line">#include <span class="string">&quot;main.moc&quot;</span></span><br></pre></td></tr></table></figure><p>åœ¨ Effect ç±»ä¸­æœ‰å‡ ä¸ªä¸åŒé˜¶æ®µçš„æ–¹æ³•å¯ä»¥é‡è½½ã€‚</p><ul><li>prePaintScreen<ul><li>è®¾ç½®æ˜¯å¦å˜æ¢çª—å£æˆ–æ•´ä¸ªå±å¹•</li><li>æ›´æ”¹å°†è¦ç»˜åˆ¶çš„å±å¹•åŒºåŸŸ</li><li>åšå„ç§å†…åŠ¡å¤„ç†ä»»åŠ¡ï¼Œæ¯”å¦‚åˆå§‹åŒ–ä½ çš„æ•ˆæœå˜é‡<br>  ç”¨äºå³å°†åˆ°æ¥çš„ç»˜ç”»è¿‡ç¨‹æˆ–æ›´æ–°åŠ¨ç”»çš„è¿›åº¦</li></ul></li><li>paintScreen<ul><li>åœ¨çª—å£ä¸Šç”»ä¸œè¥¿ï¼ˆè°ƒç”¨åç”» effect-&gt;paintScreen())</li><li>ç»˜åˆ¶å¤šä¸ªæ¡Œé¢å’Œ&#x2F;æˆ–åŒä¸€æ¡Œé¢çš„å¤šä¸ªå‰¯æœ¬</li></ul></li><li>postPaintScreen<ul><li>åœ¨åŠ¨ç”»çš„æƒ…å†µä¸‹å®‰æ’ä¸‹ä¸€æ¬¡é‡ç»˜ï¼Œä¸åº”è¯¥åœ¨è¿™é‡Œç”»ä»»ä½•ä¸œè¥¿ã€‚</li></ul></li><li>prePaintWindow<ul><li>å¯ç”¨æˆ–ç¦ç”¨çª—å£çš„ç»˜åˆ¶ï¼ˆä¾‹å¦‚å¯ç”¨æœ€å°åŒ–çª—å£çš„ç»˜åˆ¶ï¼‰</li><li>å°†çª—å£è®¾ç½®ä¸ºåŠé€æ˜</li><li>è®¾ç½®è¦è½¬æ¢çš„çª—å£</li><li>è¯·æ±‚å°†çª—å£åˆ†æˆå¤šä¸ªéƒ¨åˆ†</li></ul></li><li>paintWindow<ul><li>åšå„ç§è½¬æ¢</li><li>æ”¹å˜çª—å£çš„ä¸é€æ˜åº¦</li><li>æ”¹å˜äº®åº¦å’Œ&#x2F;æˆ–é¥±å’Œåº¦ï¼Œå¦‚æœæ”¯æŒçš„è¯</li></ul></li><li>postPaintWindow<ul><li>åœ¨åŠ¨ç”»çš„æƒ…å†µä¸‹ä¸ºå•ä¸ªçª—å£å®‰æ’ä¸‹ä¸€æ¬¡é‡ç»˜<br>  ä¸åº”è¯¥åœ¨è¿™é‡Œç”»ä»»ä½•ä¸œè¥¿ã€‚</li></ul></li><li>paintEffectFrame<ul><li>åœ¨ç»˜åˆ¶ EffectFrame ä¹‹å‰ç›´æ¥è°ƒç”¨æ­¤æ–¹æ³•ã€‚</li><li>å¦‚æœéœ€è¦ç»‘å®šshaderæˆ–è€…æ‰§è¡Œï¼Œå¯ä»¥å®ç°è¿™ä¸ªæ–¹æ³•å¸§æ¸²æŸ“å‰çš„å…¶ä»–æ“ä½œã€‚</li></ul></li><li>drawWindow<ul><li>å¯ä»¥è°ƒç”¨ä»¥ç»˜åˆ¶ä¸€ä¸ªçª—å£çš„å¤šä¸ªå‰¯æœ¬ï¼ˆä¾‹å¦‚ç¼©ç•¥å›¾ï¼‰ã€‚</li><li>å¯ä»¥åœ¨è¿™é‡Œæ”¹å˜çª—å£çš„ä¸é€æ˜åº¦&#x2F;äº®åº¦&#x2F;ç­‰ï¼Œä½†ä¸èƒ½åšä»»ä½•è½¬æ¢ã€‚</li><li>åœ¨åŸºäº OpenGL çš„åˆæˆä¸­ï¼Œæ¡†æ¶ç¡®ä¿ä¸Šä¸‹æ–‡æ˜¯æœ€æ–°çš„</li></ul></li></ul><p>åœ¨æ–¹æ³•åç§°ä¸­å¯ä»¥çœ‹å‡ºï¼Œåœ¨åœºæ™¯åŠçª—å£ç»˜åˆ¶çš„è¿‡ç¨‹ä¸­ï¼Œåˆ†åˆ«å¯ä»¥åœ¨å®é™…ç»˜åˆ¶çš„å‰ååˆ†åˆ«æ‰§è¡Œä¸€äº›åŠ¨ä½œï¼Œåœ†è§’æ’ä»¶å°±æ˜¯åœ¨ <code>drawWindow</code> å‡½æ•°ä¸­ï¼Œä½¿ç”¨ <code>OpenGL</code> å¯¹çª—å£ä½¿ç”¨ç€è‰²å™¨è¿›è¡Œçª—å£è£åˆ‡ï¼Œå¹¶ç»˜åˆ¶åˆ°å±å¹•ä¸Šã€‚</p><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">ScissorWindow::drawWindow</span><span class="params">(EffectWindow *w, <span class="type">int</span> mask, <span class="type">const</span> QRegion&amp; region, WindowPaintData &amp;data)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (w-&gt;<span class="built_in">isDesktop</span>() || <span class="built_in">isMaximized</span>(w)) &#123;</span><br><span class="line">        <span class="keyword">return</span> effects-&gt;<span class="built_in">drawWindow</span>(w, mask, region, data);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">    QPointF cornerRadius;</span><br><span class="line">    <span class="type">const</span> QVariant valueRadius = w-&gt;<span class="built_in">data</span>(WindowRadiusRole);</span><br><span class="line">    <span class="keyword">if</span> (valueRadius.<span class="built_in">isValid</span>()) &#123;</span><br><span class="line">        cornerRadius = w-&gt;<span class="built_in">data</span>(WindowRadiusRole).<span class="built_in">toPointF</span>();</span><br><span class="line">        <span class="type">const</span> qreal xMin&#123; std::<span class="built_in">min</span>(cornerRadius.<span class="built_in">x</span>(), w-&gt;<span class="built_in">width</span>() / <span class="number">2.0</span>) &#125;;</span><br><span class="line">        <span class="type">const</span> qreal yMin&#123; std::<span class="built_in">min</span>(cornerRadius.<span class="built_in">y</span>(), w-&gt;<span class="built_in">height</span>() / <span class="number">2.0</span>) &#125;;</span><br><span class="line">        <span class="type">const</span> qreal minRadius&#123; std::<span class="built_in">min</span>(xMin, yMin) &#125;;</span><br><span class="line">        cornerRadius = <span class="built_in">QPointF</span>(minRadius, minRadius);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (cornerRadius.<span class="built_in">x</span>() &lt; <span class="number">2</span> &amp;&amp; cornerRadius.<span class="built_in">y</span>() &lt; <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> effects-&gt;<span class="built_in">drawWindow</span>(w, mask, region, data);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">const</span> QString&amp; key = <span class="built_in">QString</span>(<span class="string">&quot;%1+%2&quot;</span>).<span class="built_in">arg</span>(cornerRadius.<span class="built_in">toPoint</span>().<span class="built_in">x</span>()).<span class="built_in">arg</span>(cornerRadius.<span class="built_in">toPoint</span>().<span class="built_in">y</span>()</span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">if</span> (!m_texMaskMap.<span class="built_in">count</span>(key)) &#123;</span><br><span class="line"><span class="function">QImage <span class="title">img</span><span class="params">(QSize(radius.x() * <span class="number">2</span>, radius.y() * <span class="number">2</span>), QImage::Format_RGBA8888)</span></span>;</span><br><span class="line">    img.<span class="built_in">fill</span>(<span class="built_in">QColor</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>));</span><br><span class="line">    <span class="function">QPainter <span class="title">painter</span><span class="params">(&amp;img)</span></span>;</span><br><span class="line">    painter.<span class="built_in">setPen</span>(Qt::NoPen);</span><br><span class="line">    painter.<span class="built_in">setBrush</span>(<span class="built_in">QColor</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>));</span><br><span class="line">    painter.<span class="built_in">setRenderHint</span>(QPainter::Antialiasing);</span><br><span class="line">    painter.<span class="built_in">drawEllipse</span>(<span class="number">0</span>, <span class="number">0</span>, radius.<span class="built_in">x</span>() * <span class="number">2</span>, radius.<span class="built_in">y</span>() * <span class="number">2</span>);</span><br><span class="line">    painter.<span class="built_in">end</span>();</span><br><span class="line"></span><br><span class="line">    m_texMaskMap[key] = <span class="keyword">new</span> <span class="built_in">GLTexture</span>(img.<span class="built_in">copy</span>(<span class="number">0</span>, <span class="number">0</span>, radius.<span class="built_in">x</span>(), radius.<span class="built_in">y</span>()));</span><br><span class="line">    m_texMaskMap[key]-&gt;<span class="built_in">setFilter</span>(GL_LINEAR);</span><br><span class="line">    m_texMaskMap[key]-&gt;<span class="built_in">setWrapMode</span>(GL_CLAMP_TO_EDGE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ShaderManager::<span class="built_in">instance</span>()-&gt;<span class="built_in">pushShader</span>(m_filletOptimizeShader);</span><br><span class="line">    m_filletOptimizeShader-&gt;<span class="built_in">setUniform</span>(<span class="string">&quot;typ1&quot;</span>, <span class="number">1</span>);</span><br><span class="line">    m_filletOptimizeShader-&gt;<span class="built_in">setUniform</span>(<span class="string">&quot;sampler&quot;</span>, <span class="number">0</span>);</span><br><span class="line">    m_filletOptimizeShader-&gt;<span class="built_in">setUniform</span>(<span class="string">&quot;msk1&quot;</span>, <span class="number">1</span>);</span><br><span class="line">    m_filletOptimizeShader-&gt;<span class="built_in">setUniform</span>(<span class="string">&quot;k&quot;</span>, <span class="built_in">QVector2D</span>(w-&gt;<span class="built_in">width</span>() / cornerRadius.<span class="built_in">x</span>(), w-&gt;<span class="built_in">height</span>() / cornerRadius.<span class="built_in">y</span>()));</span><br><span class="line">    <span class="keyword">if</span> (w-&gt;<span class="built_in">hasDecoration</span>()) &#123;</span><br><span class="line">        m_filletOptimizeShader-&gt;<span class="built_in">setUniform</span>(<span class="string">&quot;typ2&quot;</span>, <span class="number">0</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        m_filletOptimizeShader-&gt;<span class="built_in">setUniform</span>(<span class="string">&quot;typ2&quot;</span>, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">auto</span> old_shader = data.shader;</span><br><span class="line">    data.shader = m_filletOptimizeShader;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">glActiveTexture</span>(GL_TEXTURE1);</span><br><span class="line">    m_texMaskMap[key]-&gt;<span class="built_in">bind</span>();</span><br><span class="line">    <span class="built_in">glActiveTexture</span>(GL_TEXTURE0);</span><br><span class="line">    effects-&gt;<span class="built_in">drawWindow</span>(w, mask, region, data);</span><br><span class="line">    ShaderManager::<span class="built_in">instance</span>()-&gt;<span class="built_in">popShader</span>();</span><br><span class="line">    data.shader = old_shader;</span><br><span class="line">    <span class="built_in">glActiveTexture</span>(GL_TEXTURE1);</span><br><span class="line">    m_texMaskMap[key]-&gt;<span class="built_in">unbind</span>();</span><br><span class="line">    <span class="built_in">glActiveTexture</span>(GL_TEXTURE0);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœçª—å£æ˜¯æ¡Œé¢ç±»å‹ï¼Œæˆ–è€…å·²ç»æœ€å¤§åŒ–äº†ï¼Œåˆ™æ— éœ€å¤„ç†ï¼Œç›´æ¥è¿”å› Effect åŸæœ¬çš„å¤„ç†å‡½æ•°ã€‚</p><p>ä¹‹åå°è¯•ä»çª—å£å±æ€§ä¸­å–å‡ºåœ†è§’å¤§å°çš„å€¼ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®åœ†è§’å¤§å°ï¼Œæˆ–è€…å€¼å°äº2ï¼Œåˆ™æ— éœ€å¤„ç†ã€‚</p><p>å°è¯•æŸ¥è¯¢ç¼“å­˜ï¼Œåœ¨è¿™é‡Œä¸ºçª—å£çš„å››ä¸ªè§’æ„å»ºä¸€ä»½é®ç½©å¯¹è±¡å¹¶ç¼“å­˜ï¼Œä½¿ç”¨ <code>OpenGL</code> å°†é®ç½©å’Œç€è‰²å™¨è¿›è¡Œå…³è”ï¼Œæ¿€æ´»ä¸¤ä¸ªæè´¨åˆ†åˆ«ç»˜åˆ¶çª—å£å†…å®¹å’Œå››ä¸ªè§’çš„é®ç½©ï¼Œåœ¨ç€è‰²å™¨ä¸­å®Œæˆçª—å£åœ†è§’çš„åŠé€æ˜æ•ˆæœã€‚</p><p>é™äºç¯‡å¹…ï¼Œæœ¬æ–‡ä¸å±•å¼€ä»‹ç»å¦‚ä½•å®ç°åœ†è§’æ’ä»¶çš„å…¨éƒ¨å®ç°è¿‡ç¨‹ï¼Œä»…æŒ‘é€‰å…³é”®æ­¥éª¤ã€‚</p><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>å°†åŠ¨æ€åº“å¤åˆ¶åˆ° <code>/usr/share/kwin/effects/plugins</code> ï¼Œå¹¶ä½¿ç”¨ <code>DBus</code> æ¿€æ´»æ’ä»¶ã€‚</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">qdbus --literal org.kde.KWin /Effects org.kde.kwin.Effects.loadEffect scissor</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> deepin </category>
          
      </categories>
      
      
        <tags>
            
            <tag> deepin </tag>
            
            <tag> kwin </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>How to count the cpu usage of a process</title>
      <link href="/2023/05/24/How-to-count-the-cpu-usage-of-a-process/"/>
      <url>/2023/05/24/How-to-count-the-cpu-usage-of-a-process/</url>
      
        <content type="html"><![CDATA[<p>Sometimes we want to collect the cpu usage of the process, and usually use a script to make simple statistics.</p><p>Under Linux, the cpu time slice of the process can be obtained through the stat provided by procfs.</p><p>Or simply use some commands to get directly.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">FULL_PATH=<span class="variable">$1</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$@</span> &gt; /dev/null 2&gt;&amp;1 &amp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">true</span> ; <span class="keyword">do</span></span><br><span class="line">    PID=$(pidof <span class="variable">$&#123;FULL_PATH&#125;</span>)</span><br><span class="line">    <span class="keyword">if</span> [ -z <span class="string">&quot;<span class="variable">$PID</span>&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">exit</span> 0</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="subst">$(date)</span> :: <span class="variable">$FULL_PATH</span>[<span class="variable">$PID</span>] <span class="subst">$(ps -C $&#123;FULL_PATH&#125; -o %cpu | tail -1)</span>%&quot;</span></span><br><span class="line">    <span class="built_in">sleep</span> 0.5</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Solution </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Bash </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>How to Solve the Module not found: Cannot resolve &#39;fs&#39; error in Next.js</title>
      <link href="/2023/04/19/How-to-Solve-the-Module-not-found-Cannot-resolve-fs-error-in-Next-js/"/>
      <url>/2023/04/19/How-to-Solve-the-Module-not-found-Cannot-resolve-fs-error-in-Next-js/</url>
      
        <content type="html"><![CDATA[<h2 id="Webpack-4-version"><a href="#Webpack-4-version" class="headerlink" title="Webpack 4 version"></a>Webpack 4 version</h2><p>To resolve the error with Webpack 4, you need to tell webpack to set the module to â€˜emptyâ€™ on the client-side (!isServer).</p><p>This is also a solution when you are working with older Next.js versions.</p><p>The configuration essentially tells Webpack to create an empty module for fs, which effectively suppresses the error.</p><p>Update your <code>next.config.js</code> with the following:</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">webpack</span>: <span class="function">(<span class="params">config, &#123; isServer &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!isServer) &#123;</span><br><span class="line">      <span class="comment">// set &#x27;fs&#x27; to an empty module on the client to prevent this error on build --&gt; Error: Can&#x27;t resolve &#x27;fs&#x27;</span></span><br><span class="line">      config.<span class="property">node</span> = &#123;</span><br><span class="line">        <span class="attr">fs</span>: <span class="string">&quot;empty&quot;</span>,</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> config;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="Webpack-5-version"><a href="#Webpack-5-version" class="headerlink" title="Webpack 5 version"></a>Webpack 5 version</h2><p>To resolve the error with Webpack 5, you need to tell webpack not to resolve the module on the client-side (!isServer).</p><p>Update your <code>next.config.js</code> with the following:</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">webpack</span>: <span class="function">(<span class="params">config, &#123; isServer &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!isServer) &#123;</span><br><span class="line">      <span class="comment">// don&#x27;t resolve &#x27;fs&#x27; module on the client to prevent this error on build --&gt; Error: Can&#x27;t resolve &#x27;fs&#x27;</span></span><br><span class="line">      config.<span class="property">resolve</span>.<span class="property">fallback</span> = &#123;</span><br><span class="line">        <span class="attr">fs</span>: <span class="literal">false</span>,</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> config;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Solution </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Next.js </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Kitty configuration for macOS</title>
      <link href="/2023/04/17/Kitty-configuration-for-macOS/"/>
      <url>/2023/04/17/Kitty-configuration-for-macOS/</url>
      
        <content type="html"><![CDATA[<p>Iâ€™ve been using Kitty for a couple of days. I use it because there is a plugin for nvim that can seamlessly switch focus with kitty, so I donâ€™t need to repeat the settings, I like it very much.</p><p>After a period of use. I have completed part of the configuration, and now I want to share it.</p><p>I use different folders for related functions. Such as themes, tabs, windows, and shortcuts.</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">lxz @ lxzMacBook-Pro <span class="keyword">in</span> ~/.dot/kitty/.config/kitty on git:master o [16:38:58]</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tree</span></span><br><span class="line">.</span><br><span class="line">â”œâ”€â”€ kitty.conf</span><br><span class="line">â”œâ”€â”€ kitty.d</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ init</span><br><span class="line">â”‚Â Â  â”‚Â Â  â””â”€â”€ init.conf</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ keybind</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ init.conf</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ nvim.conf</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ tab.conf</span><br><span class="line">â”‚Â Â  â”‚Â Â  â””â”€â”€ window.conf</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ session</span><br><span class="line">â”‚Â Â  â”‚Â Â  â””â”€â”€ init.conf</span><br><span class="line">â”‚Â Â  â””â”€â”€ theme</span><br><span class="line">â”‚Â Â      â”œâ”€â”€ background.conf</span><br><span class="line">â”‚Â Â      â”œâ”€â”€ color.conf</span><br><span class="line">â”‚Â Â      â”œâ”€â”€ font.conf</span><br><span class="line">â”‚Â Â      â”œâ”€â”€ tabbar.conf</span><br><span class="line">â”‚Â Â      â””â”€â”€ window.conf</span><br><span class="line">â””â”€â”€ session.conf</span><br><span class="line"></span><br><span class="line">6 directories, 13 files</span><br></pre></td></tr></table></figure><h2 id="Some-screenshot"><a href="#Some-screenshot" class="headerlink" title="Some screenshot"></a>Some screenshot</h2><h3 id="session-look-at-the-lower-left-corner"><a href="#session-look-at-the-lower-left-corner" class="headerlink" title="session (look at the lower left corner)"></a>session (look at the lower left corner)</h3><img src="/2023/04/17/Kitty-configuration-for-macOS/2023-04-17-17.52.14.png" class="" title="2023-04-17-17.52.14.png"><img src="/2023/04/17/Kitty-configuration-for-macOS/2023-04-17-17.59.50.png" class="" title="2023-04-17-17.59.50.png"><h3 id="multi-splits"><a href="#multi-splits" class="headerlink" title="multi splits"></a>multi splits</h3><img src="/2023/04/17/Kitty-configuration-for-macOS/2023-04-17-17.57.06.png" class="" title="2023-04-17-17.57.06.png"><h2 id="Base-settings"><a href="#Base-settings" class="headerlink" title="Base settings"></a>Base settings</h2><p>In kitty.conf, I just set to load configuration files in other directories.</p><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">globinclude kitty.d/**/*.conf</span><br></pre></td></tr></table></figure><p>I wonâ€™t show the configuration after splitting, just give a hint according to the function.</p><h2 id="Init"><a href="#Init" class="headerlink" title="Init"></a>Init</h2><p>In init.conf, I set some default variables.</p><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">term xterm-256color</span><br><span class="line">shell_integration enabled</span><br><span class="line">allow_hyperlinks yes</span><br><span class="line">editor nvim</span><br></pre></td></tr></table></figure><h2 id="Theme-settings"><a href="#Theme-settings" class="headerlink" title="Theme settings"></a>Theme settings</h2><h3 id="Tabs-settings"><a href="#Tabs-settings" class="headerlink" title="Tabs settings"></a>Tabs settings</h3><p>In tabs settings, I like <code>powerline</code> style.</p><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">tab_bar_style powerline</span><br></pre></td></tr></table></figure><h3 id="Windows-settings"><a href="#Windows-settings" class="headerlink" title="Windows settings"></a>Windows settings</h3><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">window_border_width 0.5pt</span><br><span class="line"></span><br><span class="line">window_resize_step_cells 2</span><br><span class="line">window_resize_step_lines 2</span><br><span class="line"></span><br><span class="line">initial_window_width  640</span><br><span class="line">initial_window_height 400</span><br><span class="line"></span><br><span class="line">draw_minimal_borders yes</span><br><span class="line"></span><br><span class="line">inactive_text_alpha 0.7</span><br><span class="line"></span><br><span class="line">hide_window_decorations no</span><br><span class="line"></span><br><span class="line">macos_titlebar_color background</span><br><span class="line">macos_thicken_font 0.75</span><br><span class="line"></span><br><span class="line">active_border_color none</span><br><span class="line"></span><br><span class="line"># default layout is vertical splits only</span><br><span class="line">enabled_layouts splits</span><br><span class="line"></span><br><span class="line">enable_audio_bell no</span><br></pre></td></tr></table></figure><h3 id="Fonts-settings"><a href="#Fonts-settings" class="headerlink" title="Fonts settings"></a>Fonts settings</h3><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">font_family FiraCode Nerd Font Mono Retina</span><br><span class="line">font_size 16.0</span><br></pre></td></tr></table></figure><h3 id="Color-settings"><a href="#Color-settings" class="headerlink" title="Color settings"></a>Color settings</h3><figure class="highlight text"><table><tr><td class="code"><pre><span class="line"># Dark One Nuanced by ariasuni, https://store.kde.org/p/1225908</span><br><span class="line"># Imported from KDE .colorscheme format by thematdev, https://thematdev.org</span><br><span class="line"># For migrating your schemes from Konsole format see</span><br><span class="line"># https://git.thematdev.org/thematdev/konsole-scheme-migration</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># importing Background</span><br><span class="line">background #282c34</span><br><span class="line"># importing BackgroundFaint</span><br><span class="line"># importing BackgroundIntense</span><br><span class="line"># importing Color0</span><br><span class="line">color0 #3f4451</span><br><span class="line"># importing Color0Faint</span><br><span class="line">color16 #282c34</span><br><span class="line"># importing Color0Intense</span><br><span class="line">color8 #4f5666</span><br><span class="line"># importing Color1</span><br><span class="line">color1 #e06c75</span><br><span class="line"># importing Color1Faint</span><br><span class="line">color17 #c25d66</span><br><span class="line"># importing Color1Intense</span><br><span class="line">color9 #ff7b86</span><br><span class="line"># importing Color2</span><br><span class="line">color2 #98c379</span><br><span class="line"># importing Color2Faint</span><br><span class="line">color18 #82a566</span><br><span class="line"># importing Color2Intense</span><br><span class="line">color10 #b1e18b</span><br><span class="line"># importing Color3</span><br><span class="line">color3 #d19a66</span><br><span class="line"># importing Color3Faint</span><br><span class="line">color19 #b38257</span><br><span class="line"># importing Color3Intense</span><br><span class="line">color11 #efb074</span><br><span class="line"># importing Color4</span><br><span class="line">color4 #61afef</span><br><span class="line"># importing Color4Faint</span><br><span class="line">color20 #5499d1</span><br><span class="line"># importing Color4Intense</span><br><span class="line">color12 #67cdff</span><br><span class="line"># importing Color5</span><br><span class="line">color5 #c678dd</span><br><span class="line"># importing Color5Faint</span><br><span class="line">color21 #a966bd</span><br><span class="line"># importing Color5Intense</span><br><span class="line">color13 #e48bff</span><br><span class="line"># importing Color6</span><br><span class="line">color6 #56b6c2</span><br><span class="line"># importing Color6Faint</span><br><span class="line">color22 #44919a</span><br><span class="line"># importing Color6Intense</span><br><span class="line">color14 #63d4e0</span><br><span class="line"># importing Color7</span><br><span class="line">color7 #e6e6e6</span><br><span class="line"># importing Color7Faint</span><br><span class="line">color23 #c8c8c8</span><br><span class="line"># importing Color7Intense</span><br><span class="line">color15 #ffffff</span><br><span class="line"># importing Foreground</span><br><span class="line">foreground #abb2bf</span><br><span class="line"># importing ForegroundFaint</span><br><span class="line"># importing ForegroundIntense</span><br><span class="line"># importing General</span><br></pre></td></tr></table></figure><h2 id="Shortcuts-settings"><a href="#Shortcuts-settings" class="headerlink" title="Shortcuts settings"></a>Shortcuts settings</h2><h3 id="Init-1"><a href="#Init-1" class="headerlink" title="Init"></a>Init</h3><figure class="highlight text"><table><tr><td class="code"><pre><span class="line"># clear the terminal screen</span><br><span class="line">map cmd+k combine : clear_terminal scrollback active : send_text normal,application \x0c</span><br><span class="line"></span><br><span class="line"># jump to beginning and end of word</span><br><span class="line">map alt+left send_text all \x1b\x62</span><br><span class="line">map alt+right send_text all \x1b\x66</span><br><span class="line"></span><br><span class="line"># jump to beginning and end of line</span><br><span class="line">map cmd+left send_text all \x01</span><br><span class="line">map cmd+right send_text all \x05</span><br><span class="line"></span><br><span class="line"># Map cmd + &lt;num&gt; to corresponding tabs</span><br><span class="line">map cmd+1 goto_tab 1</span><br><span class="line">map cmd+2 goto_tab 2</span><br><span class="line">map cmd+3 goto_tab 3</span><br><span class="line">map cmd+4 goto_tab 4</span><br><span class="line">map cmd+5 goto_tab 5</span><br><span class="line">map cmd+6 goto_tab 6</span><br><span class="line">map cmd+7 goto_tab 7</span><br><span class="line">map cmd+8 goto_tab 8</span><br><span class="line">map cmd+9 goto_tab 9</span><br><span class="line"></span><br><span class="line"># changing font sizes</span><br><span class="line">map cmd+equal    change_font_size all +2.0</span><br><span class="line">map cmd+minus    change_font_size all -2.0</span><br><span class="line">map cmd+0        change_font_size all 0</span><br><span class="line"></span><br><span class="line">map cmd+c        copy_to_clipboard</span><br><span class="line">map cmd+v        paste_from_clipboard</span><br></pre></td></tr></table></figure><h3 id="Tab"><a href="#Tab" class="headerlink" title="Tab"></a>Tab</h3><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">map alt+1 goto_tab 1</span><br><span class="line">map alt+2 goto_tab 2</span><br><span class="line">map alt+3 goto_tab 3</span><br><span class="line">map alt+4 goto_tab 4</span><br><span class="line">map alt+5 goto_tab 5</span><br><span class="line">map alt+6 goto_tab 6</span><br><span class="line">map alt+7 goto_tab 7</span><br><span class="line">map alt+8 goto_tab 8</span><br><span class="line">map alt+9 goto_tab 9</span><br><span class="line">map alt+0 goto_tab 0</span><br><span class="line"></span><br><span class="line"># open new tab with cmd+t</span><br><span class="line">map cmd+t new_tab</span><br><span class="line"></span><br><span class="line"># switch between next and previous splits</span><br><span class="line">map cmd+]        next_window</span><br><span class="line">map cmd+[        previous_window</span><br></pre></td></tr></table></figure><h3 id="Window"><a href="#Window" class="headerlink" title="Window"></a>Window</h3><figure class="highlight text"><table><tr><td class="code"><pre><span class="line"># open new split (window) with cmd+d retaining the cwd</span><br><span class="line">map cmd+w close_window</span><br><span class="line">map cmd+shif+n new_os_window</span><br><span class="line">map cmd+d launch --location=hsplit --cwd=current</span><br><span class="line">map cmd+shift+d launch --location=vsplit --cwd=current</span><br></pre></td></tr></table></figure><h3 id="Neovim"><a href="#Neovim" class="headerlink" title="Neovim"></a>Neovim</h3><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">map ctrl+j kitten pass_keys.py neighboring_window bottom ctrl+j &quot;^.* - nvim$&quot;</span><br><span class="line">map ctrl+k kitten pass_keys.py neighboring_window top    ctrl+k &quot;^.* - nvim$&quot;</span><br><span class="line">map ctrl+h kitten pass_keys.py neighboring_window left   ctrl+h &quot;^.* - nvim$&quot;</span><br><span class="line">map ctrl+l kitten pass_keys.py neighboring_window right  ctrl+l &quot;^.* - nvim$&quot;</span><br><span class="line"></span><br><span class="line"># the 3 here is the resize amount, adjust as needed</span><br><span class="line">map alt+j kitten pass_keys.py relative_resize down  3 alt+j &quot;^.* - nvim$&quot;</span><br><span class="line">map alt+k kitten pass_keys.py relative_resize up    3 alt+k &quot;^.* - nvim$&quot;</span><br><span class="line">map alt+h kitten pass_keys.py relative_resize left  3 alt+h &quot;^.* - nvim$&quot;</span><br><span class="line">map alt+l kitten pass_keys.py relative_resize right 3 alt+l &quot;^.* - nvim$&quot;</span><br></pre></td></tr></table></figure><p>Moving in shell and nvim.</p><img src="/2023/04/17/Kitty-configuration-for-macOS/nvim-integration.gif" class="" title="nvim-integration.gif"><h2 id="Session"><a href="#Session" class="headerlink" title="Session"></a>Session</h2><p>Kitty supports session management, I added some default sessions, and opened session sockets for nvim.</p><p>The session.conf at the root is the location configuration of the session.</p><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">new_tab home</span><br><span class="line">layout splits</span><br><span class="line">cd ~</span><br><span class="line">launch zsh</span><br><span class="line">focus</span><br><span class="line"></span><br><span class="line">new_tab work</span><br><span class="line">cd ~/Develop/linuxdeepin/</span><br><span class="line">launch zsh</span><br><span class="line"></span><br><span class="line">new_tab nvim</span><br><span class="line">cd ~/.config/nvim</span><br><span class="line">launch zsh</span><br></pre></td></tr></table></figure><h3 id="Init-2"><a href="#Init-2" class="headerlink" title="Init"></a>Init</h3><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">startup_session session.conf</span><br><span class="line"></span><br><span class="line"># Other unix systems:</span><br><span class="line">allow_remote_control yes</span><br><span class="line">listen_on unix:/tmp/.kitty</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> development tools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Kitty </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>How to solve parallels desktop linux usb problem</title>
      <link href="/2023/04/11/How-to-solve-parallels-desktop-linux-usb-problem/"/>
      <url>/2023/04/11/How-to-solve-parallels-desktop-linux-usb-problem/</url>
      
        <content type="html"><![CDATA[<p>I am runing a linux virtual machine macos using parallels desktop. One day when I booted normally, I got a usb error and couldnâ€™t use the keyboard and mouse in virtual machine.</p><p>An error messages like this is output on the screen.</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">usb 3-1: can&#x27;t set config #1, error -62</span><br><span class="line">xhci_hcd Error while assigning device slot ID: Command Aborted.</span><br><span class="line">xhci_hcd Max number of devices this xHCI host supports is 32.</span><br><span class="line">usb usb3-port2: couldn&#x27;t allocate usb_device</span><br></pre></td></tr></table></figure><img src="/2023/04/11/How-to-solve-parallels-desktop-linux-usb-problem/tg_image_2922023940.jpeg" class="" title="error.jpeg"><p>Finally I found a solution on the parallels desktop forum.</p><ol><li>Start your virtual machine.</li><li>Press e to edit the grub menu during the boot phase, passing a new parameter to the kernel.</li><li>Append <code>xhci_hcd.quirks=0x40</code> after quiet</li><li>F10 booting the kernel</li><li>After entering the system, open the terminal and edit the <code>/etc/default/grub</code> file</li><li>Replace that line with the following line:</li></ol><blockquote><p>GRUB_CMDLINE_LINUX_DEFAULT&#x3D;â€quiet xhci_hcd.quirks&#x3D;0x40â€</p></blockquote><ol start="7"><li>Next, execute the following command:</li></ol><blockquote><p>sudo update-grub</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Solution </category>
          
      </categories>
      
      
        <tags>
            
            <tag> parallels desktop </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>How to remove all Terminating pods</title>
      <link href="/2023/03/15/How-to-remove-all-Terminating-pods/"/>
      <url>/2023/03/15/How-to-remove-all-Terminating-pods/</url>
      
        <content type="html"><![CDATA[<p>Sometimes all pods of k8s will be in Terminating state, use this command to clean up all pods.</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">kubectl get pods --all-namespaces | grep Terminating | while read line; do</span><br><span class="line">  pod_name=$(echo $line | awk &#x27;&#123;print $2&#125;&#x27; ) \</span><br><span class="line">  name_space=$(echo $line | awk &#x27;&#123;print $1&#125;&#x27; ); \</span><br><span class="line">  kubectl delete pods $pod_name -n $name_space --grace-period=0 --force</span><br><span class="line">done</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Solution </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>solved duplicate hostname or contents</title>
      <link href="/2023/02/01/solved-duplicate-hostname-or-contents/"/>
      <url>/2023/02/01/solved-duplicate-hostname-or-contents/</url>
      
        <content type="html"><![CDATA[<img src="/2023/02/01/solved-duplicate-hostname-or-contents/tg_image_1176326230.jpeg" class=""><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">Feb 01 05:40:37 fv-az406-375 k3s[5352]: time=&quot;2023-02-01T05:40:37Z&quot; level=info msg=&quot;Waiting to retrieve agent configuration; server is not ready: Node password rejected, duplicate hostname or contents of &#x27;/etc/rancher/node/password&#x27; may not match server node-passwd entry, try enabling a unique node name with the --with-node-id flag&quot;</span><br></pre></td></tr></table></figure><p>When you join a cluster, you are reminded that it already exists, but the same node does not exist in the cluster.</p><p>you can do this.</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">kubectl -n kube-system delete secrets &lt;node name&gt;.node-password.k3s</span><br></pre></td></tr></table></figure><p>example:</p><p>first, we list all node to check, if the node exists, we should not continue the operation, we need to modify the name of the node that is joining the cluster to avoid conflicts with existing ones.</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">kubectl get node</span><br></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">rpi4                    Ready    control-plane,master   2d3h   v1.25.6+k3s1</span><br></pre></td></tr></table></figure><p>Now the homenas-vm node does not exist. But the logs tell us that the cluster already has the password, it doesnâ€™t match the current one.</p><p>Then we need to manually delete the old password in the cluster and let the new node join.</p><p>you can use this command to show all secrets, the node password in here.</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">kubectl get -n kube-system secrets</span><br></pre></td></tr></table></figure><p>then you will see all secrets.</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">NAME                                      TYPE                 DATA   AGE</span><br><span class="line">company-laptop.node-password.k3s          Opaque               1      2d1h</span><br><span class="line">company-pc.node-password.k3s              Opaque               1      2d2h</span><br><span class="line">homenas-vm.node-password.k3s              Opaque               1      50m</span><br><span class="line">k3s-serving                               kubernetes.io/tls    2      2d3h</span><br><span class="line">rpi4.node-password.k3s                    Opaque               1      2d3h</span><br><span class="line">sh.helm.release.v1.traefik-crd.v1         helm.sh/release.v1   1      2d3h</span><br><span class="line">sh.helm.release.v1.traefik.v1             helm.sh/release.v1   1      2d3h</span><br></pre></td></tr></table></figure><p>if the homenas-vm is invalid, we need to delete it manually.</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">kubectl -n kube-system delete secrets homenas-vm.node-password.k3s</span><br></pre></td></tr></table></figure><p>itâ€™s done!</p>]]></content>
      
      
      <categories>
          
          <category> Solution </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>how to use nvim dap to debug cpp</title>
      <link href="/2022/12/08/how-to-use-nvim-dap-to-debug-cpp/"/>
      <url>/2022/12/08/how-to-use-nvim-dap-to-debug-cpp/</url>
      
        <content type="html"><![CDATA[<p>åœ¨ä¹‹å‰æˆ‘å·²ç»åˆ†äº«è¿‡äº†ä¸€ä»½ç®€å•çš„ nvim é…ç½®ï¼Œå®ƒå·²ç»å®ç°äº†ç¼–ç¨‹æ‰€éœ€çš„æ™ºèƒ½æç¤ºï¼Œè¯­æ³•é«˜äº®ï¼Œä»£ç è·³è½¬ç­‰åŠŸèƒ½ï¼Œä»Šå¤©æˆ‘æ‰“ç®—æ•´ä¸€ä¸‹ nvim çš„è°ƒè¯•æ¡†æ¶ dapã€‚</p><p>dap æ˜¯ä¸€ä¸ªæ¡†æ¶ï¼Œå®¢æˆ·ç«¯è´Ÿè´£åœ¨ nvim ä¸Šæ˜¾ç¤ºå„ç§è°ƒè¯•ä¿¡æ¯ï¼Œæ¯”å¦‚æ˜¾ç¤ºæ–­ç‚¹ã€è°ƒç”¨æ ˆã€å¯¹è±¡å†…å­˜ä¿¡æ¯ç­‰ï¼ŒæœåŠ¡ç«¯åˆ™æä¾›å®¢æˆ·ç«¯æ‰€éœ€çš„åŠŸèƒ½ï¼ŒæœåŠ¡ç«¯é€šå¸¸æ˜¯ä¸€ä¸ªè°ƒè¯•å™¨ï¼Œæˆ–è€…æ˜¯è°ƒè¯•å™¨åŒ…è£…ã€‚</p><p>æœ¬ç¯‡ä¼šç”¨åˆ° Mason è¿™ä¸ªæ’ä»¶å»å®‰è£… dap çš„æœåŠ¡ç«¯ï¼Œæœ¬ç¯‡ä¸ä¼šå±•å¼€ Masonï¼Œå°†æ¥æœ‰æœºä¼šè¯¦ç»†è¯´ä¸€ä¸‹ã€‚</p><p>é¦–å…ˆå…ˆçœ‹å‡ å¼ æ­£å¸¸å·¥ä½œçš„å›¾:</p><center><img src="/2022/12/08/how-to-use-nvim-dap-to-debug-cpp/tg_image_3574429301.jpeg" class=""><p>è¿è¡Œç•Œé¢</p><img src="/2022/12/08/how-to-use-nvim-dap-to-debug-cpp/tg_image_3358891712.jpeg" class=""><p>æŸ¥çœ‹å˜é‡ä¿¡æ¯</p><img src="/2022/12/08/how-to-use-nvim-dap-to-debug-cpp/tg_image_3913027219.jpeg" class=""><p>å¿«æ·é”®</p><img src="/2022/12/08/how-to-use-nvim-dap-to-debug-cpp/tg_image_1568131740.jpeg" class="" title="call stacks"><p>å‡½æ•°è°ƒç”¨æ ˆ</p></center><h2 id="å®‰è£…-dap"><a href="#å®‰è£…-dap" class="headerlink" title="å®‰è£… dap"></a>å®‰è£… dap</h2><p>åœ¨ Mason çš„å®‰è£…åˆ—è¡¨ä¸­æ·»åŠ ä¸Š codelldbï¼Œcodelldb æ˜¯ vscode ç”¨çš„è°ƒè¯•æœåŠ¡ç«¯ï¼Œè´Ÿè´£ç»™ vscode æä¾›è°ƒè¯•ä¿¡æ¯ï¼Œæœ‰äº†è¿™ä¸ªåç«¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ–¹ä¾¿çš„å®ç°å’Œ vscode ç›¸åŒçš„è°ƒè¯•åŠŸèƒ½ã€‚</p><h2 id="é…ç½®-dap"><a href="#é…ç½®-dap" class="headerlink" title="é…ç½® dap"></a>é…ç½® dap</h2><p>åœ¨ plugins ç›®å½•ä¸‹æ–°å»º <code>_dap.lua</code> æ–‡ä»¶ã€‚</p><figure class="highlight lua"><table><tr><td class="code"><pre><span class="line"><span class="keyword">return</span> &#123;</span><br><span class="line">  <span class="string">&quot;mfussenegger/nvim-dap&quot;</span>,</span><br><span class="line">  opt = <span class="literal">true</span>,</span><br><span class="line">  <span class="built_in">module</span> = &#123; <span class="string">&quot;dap&quot;</span> &#125;,</span><br><span class="line">  requires = &#123;</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;theHamsta/nvim-dap-virtual-text&quot;</span>,</span><br><span class="line">      <span class="built_in">module</span> = &#123; <span class="string">&quot;nvim-dap-virtual-text&quot;</span> &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;rcarriga/nvim-dap-ui&quot;</span>,</span><br><span class="line">      <span class="built_in">module</span> = &#123; <span class="string">&quot;dapui&quot;</span> &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;nvim-telescope/telescope-dap.nvim&quot;</span>,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;jbyuki/one-small-step-for-vimkind&quot;</span>,</span><br><span class="line">      <span class="built_in">module</span> = <span class="string">&quot;osv&quot;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="built_in">config</span> = <span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">    <span class="built_in">require</span>(<span class="string">&quot;config.dap&quot;</span>).setup()</span><br><span class="line">  <span class="keyword">end</span>,</span><br><span class="line">  disable = <span class="literal">false</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æœ‰äº›äººä¼šåœ¨ packer é‡Œç”¨ use å®‰è£…ï¼ŒæŠŠ return æ”¹æˆ use å°±å¯ä»¥äº†ã€‚</p></blockquote><p>packer çš„ä»£ç å·²ç»å†™å¥½äº†ï¼Œç°åœ¨å†™ config å‡½æ•°ï¼Œåœ¨æˆ‘çš„ä¾‹å­ä¸­ï¼Œæˆ‘æŠŠæ–‡ä»¶æ”¾åœ¨äº† <code>lua/config/dap/</code> ç›®å½•ä¸‹ï¼Œå› ä¸ºè¦é…ç½®ä¸åŒçš„è¯­è¨€ï¼Œè¿™æ ·ä¼šæ–¹ä¾¿ç®¡ç†ä¸€äº›ã€‚</p><p>é¦–å…ˆè¦å…ˆåœ¨ dap ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª init.luaï¼Œè¿™é‡Œæ˜¯æ¨¡å—å…¥å£ï¼Œåˆå§‹åŒ–çš„å·¥ä½œä»è¿™é‡Œå¼€å§‹ã€‚</p><figure class="highlight lua"><table><tr><td class="code"><pre><span class="line"><span class="keyword">local</span> M = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> <span class="function"><span class="keyword">function</span> <span class="title">configure</span><span class="params">()</span></span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> <span class="function"><span class="keyword">function</span> <span class="title">configure_exts</span><span class="params">()</span></span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> <span class="function"><span class="keyword">function</span> <span class="title">configure_debuggers</span><span class="params">()</span></span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">M.setup</span><span class="params">()</span></span></span><br><span class="line">configure() <span class="comment">-- Configuration</span></span><br><span class="line">configure_exts() <span class="comment">-- Extensions</span></span><br><span class="line">configure_debuggers() <span class="comment">-- Debugger</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">configure_debuggers()</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> M</span><br></pre></td></tr></table></figure><p>åœ¨ <code>_dap.lua</code> ä¸­è°ƒç”¨äº† <code>require(&quot;config.dap&quot;).setup()</code>ï¼Œè¿™ä¸ª setup å‡½æ•°å°±æ˜¯ <code>config/dap/init.lua</code> ä¸­çš„ <code>M.setup()</code> å‡½æ•°ã€‚</p><p>ç›®å‰åªæ˜¯å†™äº†ä¸€ä¸ªå£³å­ï¼Œç°åœ¨è®©æˆ‘ä»¬æ­£å¼é…ç½®å®ƒå§ã€‚</p><h3 id="å¿«æ·é”®"><a href="#å¿«æ·é”®" class="headerlink" title="å¿«æ·é”®"></a>å¿«æ·é”®</h3><p>åœ¨ nvim ä¸­è¿›è¡Œè°ƒè¯•ï¼Œç•Œé¢æ˜¾ç„¶è¿˜æ˜¯åœ¨ç»ˆç«¯é‡Œçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ä½¿ç”¨å¿«æ·é”®è¿›è¡Œä¸€äº›æ“ä½œï¼Œæ¯”å¦‚æ ‡è®°æ–­ç‚¹ã€å•æ­¥è¿›å…¥ã€è·³å‡ºç­‰ã€‚</p><p>åœ¨ <code>config/dap/keymaps.lua</code> ä¸­è¿›è¡Œå¿«æ·é”®çš„é…ç½®ã€‚</p><figure class="highlight lua"><table><tr><td class="code"><pre><span class="line"><span class="keyword">local</span> M = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> whichkey = <span class="built_in">require</span> <span class="string">&quot;which-key&quot;</span></span><br><span class="line"><span class="comment">-- local legendary = require &quot;legendary&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- local function keymap(lhs, rhs, desc)</span></span><br><span class="line"><span class="comment">--   vim.keymap.set(&quot;n&quot;, lhs, rhs, &#123; silent = true, desc = desc &#125;)</span></span><br><span class="line"><span class="comment">-- end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">M.setup</span><span class="params">()</span></span></span><br><span class="line">  <span class="keyword">local</span> keymap = &#123;</span><br><span class="line">    d = &#123;</span><br><span class="line">      name = <span class="string">&quot;DAP&quot;</span>,</span><br><span class="line">      R = &#123; <span class="string">&quot;&lt;cmd&gt;lua require&#x27;dap&#x27;.run_to_cursor()&lt;cr&gt;&quot;</span>, <span class="string">&quot;Run to Cursor&quot;</span> &#125;,</span><br><span class="line">      E = &#123; <span class="string">&quot;&lt;cmd&gt;lua require&#x27;dapui&#x27;.eval(vim.fn.input &#x27;[Expression] &gt; &#x27;)&lt;cr&gt;&quot;</span>, <span class="string">&quot;Evaluate Input&quot;</span> &#125;,</span><br><span class="line">      C = &#123; <span class="string">&quot;&lt;cmd&gt;lua require&#x27;dap&#x27;.set_breakpoint(vim.fn.input &#x27;[Condition] &gt; &#x27;)&lt;cr&gt;&quot;</span>, <span class="string">&quot;Conditional Breakpoint&quot;</span> &#125;,</span><br><span class="line">      U = &#123; <span class="string">&quot;&lt;cmd&gt;lua require&#x27;dapui&#x27;.toggle()&lt;cr&gt;&quot;</span>, <span class="string">&quot;Toggle UI&quot;</span> &#125;,</span><br><span class="line">      b = &#123; <span class="string">&quot;&lt;cmd&gt;lua require&#x27;dap&#x27;.step_back()&lt;cr&gt;&quot;</span>, <span class="string">&quot;Step Back&quot;</span> &#125;,</span><br><span class="line">      c = &#123; <span class="string">&quot;&lt;cmd&gt;lua require&#x27;dap&#x27;.continue()&lt;cr&gt;&quot;</span>, <span class="string">&quot;Continue&quot;</span> &#125;,</span><br><span class="line">      d = &#123; <span class="string">&quot;&lt;cmd&gt;lua require&#x27;dap&#x27;.disconnect()&lt;cr&gt;&quot;</span>, <span class="string">&quot;Disconnect&quot;</span> &#125;,</span><br><span class="line">      e = &#123; <span class="string">&quot;&lt;cmd&gt;lua require&#x27;dapui&#x27;.eval()&lt;cr&gt;&quot;</span>, <span class="string">&quot;Evaluate&quot;</span> &#125;,</span><br><span class="line">      g = &#123; <span class="string">&quot;&lt;cmd&gt;lua require&#x27;dap&#x27;.session()&lt;cr&gt;&quot;</span>, <span class="string">&quot;Get Session&quot;</span> &#125;,</span><br><span class="line">      h = &#123; <span class="string">&quot;&lt;cmd&gt;lua require&#x27;dap.ui.widgets&#x27;.hover()&lt;cr&gt;&quot;</span>, <span class="string">&quot;Hover Variables&quot;</span> &#125;,</span><br><span class="line">      S = &#123; <span class="string">&quot;&lt;cmd&gt;lua require&#x27;dap.ui.widgets&#x27;.scopes()&lt;cr&gt;&quot;</span>, <span class="string">&quot;Scopes&quot;</span> &#125;,</span><br><span class="line">      i = &#123; <span class="string">&quot;&lt;cmd&gt;lua require&#x27;dap&#x27;.step_into()&lt;cr&gt;&quot;</span>, <span class="string">&quot;Step Into&quot;</span> &#125;,</span><br><span class="line">      o = &#123; <span class="string">&quot;&lt;cmd&gt;lua require&#x27;dap&#x27;.step_over()&lt;cr&gt;&quot;</span>, <span class="string">&quot;Step Over&quot;</span> &#125;,</span><br><span class="line">      p = &#123; <span class="string">&quot;&lt;cmd&gt;lua require&#x27;dap&#x27;.pause.toggle()&lt;cr&gt;&quot;</span>, <span class="string">&quot;Pause&quot;</span> &#125;,</span><br><span class="line">      q = &#123; <span class="string">&quot;&lt;cmd&gt;lua require&#x27;dap&#x27;.close()&lt;cr&gt;&quot;</span>, <span class="string">&quot;Quit&quot;</span> &#125;,</span><br><span class="line">      r = &#123; <span class="string">&quot;&lt;cmd&gt;lua require&#x27;dap&#x27;.repl.toggle()&lt;cr&gt;&quot;</span>, <span class="string">&quot;Toggle Repl&quot;</span> &#125;,</span><br><span class="line">      s = &#123; <span class="string">&quot;&lt;cmd&gt;lua require&#x27;dap&#x27;.continue()&lt;cr&gt;&quot;</span>, <span class="string">&quot;Start&quot;</span> &#125;,</span><br><span class="line">      t = &#123; <span class="string">&quot;&lt;cmd&gt;lua require&#x27;dap&#x27;.toggle_breakpoint()&lt;cr&gt;&quot;</span>, <span class="string">&quot;Toggle Breakpoint&quot;</span> &#125;,</span><br><span class="line">      x = &#123; <span class="string">&quot;&lt;cmd&gt;lua require&#x27;dap&#x27;.terminate()&lt;cr&gt;&quot;</span>, <span class="string">&quot;Terminate&quot;</span> &#125;,</span><br><span class="line">      u = &#123; <span class="string">&quot;&lt;cmd&gt;lua require&#x27;dap&#x27;.step_out()&lt;cr&gt;&quot;</span>, <span class="string">&quot;Step Out&quot;</span> &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">local</span> opts = &#123;</span><br><span class="line">    mode = <span class="string">&quot;n&quot;</span>,</span><br><span class="line">    prefix = <span class="string">&quot;&lt;leader&gt;&quot;</span>,</span><br><span class="line">    buffer = <span class="literal">nil</span>,</span><br><span class="line">    silent = <span class="literal">true</span>,</span><br><span class="line">    noremap = <span class="literal">true</span>,</span><br><span class="line">    nowait = <span class="literal">false</span>,</span><br><span class="line">  &#125;</span><br><span class="line">  whichkey.register(keymap, opts)</span><br><span class="line">  <span class="comment">--- require(&quot;legendary.integrations.which-key&quot;).bind_whichkey(keymap, opts, false)</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">local</span> keymap_v = &#123;</span><br><span class="line">    d = &#123;</span><br><span class="line">      name = <span class="string">&quot;Debug&quot;</span>,</span><br><span class="line">      e = &#123; <span class="string">&quot;&lt;cmd&gt;lua require&#x27;dapui&#x27;.eval()&lt;cr&gt;&quot;</span>, <span class="string">&quot;Evaluate&quot;</span> &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br><span class="line">  opts = &#123;</span><br><span class="line">    mode = <span class="string">&quot;v&quot;</span>,</span><br><span class="line">    prefix = <span class="string">&quot;&lt;leader&gt;&quot;</span>,</span><br><span class="line">    buffer = <span class="literal">nil</span>,</span><br><span class="line">    silent = <span class="literal">true</span>,</span><br><span class="line">    noremap = <span class="literal">true</span>,</span><br><span class="line">    nowait = <span class="literal">false</span>,</span><br><span class="line">  &#125;</span><br><span class="line">  whichkey.register(keymap_v, opts)</span><br><span class="line">  <span class="comment">--- require(&quot;legendary.integrations.which-key&quot;).bind_whichkey(keymap_v, opts, false)</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> M</span><br></pre></td></tr></table></figure><p>åœ¨è¿™é‡Œæˆ‘å°†å¿«æ·é”®ç»‘å®šåœ¨äº† <code>&lt;leader&gt; d</code> ä¸Šé¢ã€‚</p><p>ç°åœ¨è¿”å›åˆ° <code>init.lua</code> ä¸­ï¼Œåœ¨ <code>setup</code> å‡½æ•°ä¸­è°ƒç”¨ keymapsã€‚</p><figure class="highlight lua"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">M.setup</span><span class="params">()</span></span></span><br><span class="line"><span class="built_in">require</span>(<span class="string">&quot;config.dap.keymaps&quot;</span>).setup() <span class="comment">-- Keymaps</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><h3 id="dapui"><a href="#dapui" class="headerlink" title="dapui"></a>dapui</h3><p>dapui æ˜¯ä¸€ä¸ªç¾åŒ– dap ç•Œé¢çš„æ’ä»¶ï¼Œé€šå¸¸å¤§å®¶éƒ½ä¼šé…ç½®çš„å§ï¼</p><figure class="highlight lua"><table><tr><td class="code"><pre><span class="line"><span class="keyword">local</span> <span class="function"><span class="keyword">function</span> <span class="title">configure_exts</span><span class="params">()</span></span></span><br><span class="line"><span class="built_in">require</span>(<span class="string">&quot;nvim-dap-virtual-text&quot;</span>).setup(&#123;</span><br><span class="line">commented = <span class="literal">true</span>,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> dap, dapui = <span class="built_in">require</span>(<span class="string">&quot;dap&quot;</span>), <span class="built_in">require</span>(<span class="string">&quot;dapui&quot;</span>)</span><br><span class="line">dapui.setup(&#123;</span><br><span class="line">expand_lines = <span class="literal">true</span>,</span><br><span class="line">icons = &#123; expanded = <span class="string">&quot;ïƒ&quot;</span>, collapsed = <span class="string">&quot;ïƒš&quot;</span>, circular = <span class="string">&quot;ï„&quot;</span> &#125;,</span><br><span class="line">mappings = &#123;</span><br><span class="line"><span class="comment">-- Use a table to apply multiple mappings</span></span><br><span class="line">expand = &#123; <span class="string">&quot;&lt;CR&gt;&quot;</span>, <span class="string">&quot;&lt;2-LeftMouse&gt;&quot;</span> &#125;,</span><br><span class="line"><span class="built_in">open</span> = <span class="string">&quot;o&quot;</span>,</span><br><span class="line"><span class="built_in">remove</span> = <span class="string">&quot;d&quot;</span>,</span><br><span class="line">edit = <span class="string">&quot;e&quot;</span>,</span><br><span class="line">repl = <span class="string">&quot;r&quot;</span>,</span><br><span class="line">toggle = <span class="string">&quot;t&quot;</span>,</span><br><span class="line">&#125;,</span><br><span class="line">layouts = &#123;</span><br><span class="line">&#123;</span><br><span class="line">elements = &#123;</span><br><span class="line">&#123; id = <span class="string">&quot;scopes&quot;</span>, size = <span class="number">0.33</span> &#125;,</span><br><span class="line">&#123; id = <span class="string">&quot;breakpoints&quot;</span>, size = <span class="number">0.17</span> &#125;,</span><br><span class="line">&#123; id = <span class="string">&quot;stacks&quot;</span>, size = <span class="number">0.25</span> &#125;,</span><br><span class="line">&#123; id = <span class="string">&quot;watches&quot;</span>, size = <span class="number">0.25</span> &#125;,</span><br><span class="line">&#125;,</span><br><span class="line">size = <span class="number">0.33</span>,</span><br><span class="line">position = <span class="string">&quot;right&quot;</span>,</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">elements = &#123;</span><br><span class="line">&#123; id = <span class="string">&quot;repl&quot;</span>, size = <span class="number">0.45</span> &#125;,</span><br><span class="line">&#123; id = <span class="string">&quot;console&quot;</span>, size = <span class="number">0.55</span> &#125;,</span><br><span class="line">&#125;,</span><br><span class="line">size = <span class="number">0.27</span>,</span><br><span class="line">position = <span class="string">&quot;bottom&quot;</span>,</span><br><span class="line">&#125;,</span><br><span class="line">&#125;,</span><br><span class="line">floating = &#123;</span><br><span class="line">max_height = <span class="number">0.9</span>,</span><br><span class="line">max_width = <span class="number">0.5</span>, <span class="comment">-- Floats will be treated as percentage of your screen.</span></span><br><span class="line">border = vim.g.border_chars, <span class="comment">-- Border style. Can be &#x27;single&#x27;, &#x27;double&#x27; or &#x27;rounded&#x27;</span></span><br><span class="line">mappings = &#123;</span><br><span class="line"><span class="built_in">close</span> = &#123; <span class="string">&quot;q&quot;</span>, <span class="string">&quot;&lt;Esc&gt;&quot;</span> &#125;,</span><br><span class="line">&#125;,</span><br><span class="line">&#125;,</span><br><span class="line">&#125;) <span class="comment">-- use default</span></span><br><span class="line">dap.listeners.after.event_initialized[<span class="string">&quot;dapui_config&quot;</span>] = <span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">dapui.<span class="built_in">open</span>(&#123;&#125;)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">dap.listeners.before.event_terminated[<span class="string">&quot;dapui_config&quot;</span>] = <span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">dapui.<span class="built_in">close</span>(&#123;&#125;)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">dap.listeners.before.event_exited[<span class="string">&quot;dapui_config&quot;</span>] = <span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">dapui.<span class="built_in">close</span>(&#123;&#125;)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p>é…ç½®åŸºæœ¬ä¸Šå¤§å®¶éƒ½æ²¡å·®å¤šå°‘ï¼Œè¯´ä¸å®šéƒ½æ˜¯ä»ä¸€ä¸ªäººçš„é…ç½®é‡Œæ¬è¿çš„ã€‚</p><center><img src="/2022/12/08/how-to-use-nvim-dap-to-debug-cpp/tg_image_1681120408.jpeg" class="" title="evaluate"></center><h3 id="é…ç½®-icon"><a href="#é…ç½®-icon" class="headerlink" title="é…ç½® icon"></a>é…ç½® icon</h3><p>æˆ‘è¿˜ä¿®æ”¹äº†å‡ ä¸ªé»˜è®¤çš„ iconï¼Œåœ¨ configure å‡½æ•°é‡Œã€‚</p><figure class="highlight lua"><table><tr><td class="code"><pre><span class="line"><span class="keyword">local</span> <span class="function"><span class="keyword">function</span> <span class="title">configure</span><span class="params">()</span></span></span><br><span class="line"><span class="keyword">local</span> dap_breakpoint = &#123;</span><br><span class="line">breakpoint = &#123;</span><br><span class="line">text = <span class="string">&quot;ï—£&quot;</span>,</span><br><span class="line">texthl = <span class="string">&quot;LspDiagnosticsSignError&quot;</span>,</span><br><span class="line">linehl = <span class="string">&quot;&quot;</span>,</span><br><span class="line">numhl = <span class="string">&quot;&quot;</span>,</span><br><span class="line">&#125;,</span><br><span class="line">rejected = &#123;</span><br><span class="line">text = <span class="string">&quot;ï—£&quot;</span>,</span><br><span class="line">texthl = <span class="string">&quot;LspDiagnosticsSignHint&quot;</span>,</span><br><span class="line">linehl = <span class="string">&quot;&quot;</span>,</span><br><span class="line">numhl = <span class="string">&quot;&quot;</span>,</span><br><span class="line">&#125;,</span><br><span class="line">stopped = &#123;</span><br><span class="line">text = <span class="string">&quot;ï¡&quot;</span>,</span><br><span class="line">texthl = <span class="string">&quot;LspDiagnosticsSignInformation&quot;</span>,</span><br><span class="line">linehl = <span class="string">&quot;DiagnosticUnderlineInfo&quot;</span>,</span><br><span class="line">numhl = <span class="string">&quot;LspDiagnosticsSignInformation&quot;</span>,</span><br><span class="line">&#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">vim.fn.sign_define(<span class="string">&quot;DapBreakpoint&quot;</span>, dap_breakpoint.breakpoint)</span><br><span class="line">vim.fn.sign_define(<span class="string">&quot;DapStopped&quot;</span>, dap_breakpoint.stopped)</span><br><span class="line">vim.fn.sign_define(<span class="string">&quot;DapBreakpointRejected&quot;</span>, dap_breakpoint.rejected)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><center><img src="/2022/12/08/how-to-use-nvim-dap-to-debug-cpp/tg_image_3049280764.jpeg" class="" title="breakpoint"><p>æ–­ç‚¹æ ‡è®°</p><img src="/2022/12/08/how-to-use-nvim-dap-to-debug-cpp/tg_image_3325119905.jpeg" class="" title="breakpoint"><p>å•æ­¥åœæ­¢</p></center><h3 id="é…ç½®å®¢æˆ·ç«¯"><a href="#é…ç½®å®¢æˆ·ç«¯" class="headerlink" title="é…ç½®å®¢æˆ·ç«¯"></a>é…ç½®å®¢æˆ·ç«¯</h3><p>ç°åœ¨è¿˜å·®ä¸€ä¸ªå®¢æˆ·ç«¯çš„å‡½æ•°æ²¡æœ‰å†™ï¼Œåœ¨è¿™é‡Œåªæ˜¯ä¸ºäº†è°ƒç”¨é’ˆå¯¹ä¸åŒè¯­è¨€è®¾ç½®çš„æœåŠ¡ç«¯ï¼Œå†…å®¹ä¹Ÿéå¸¸çš„ç®€å•ã€‚</p><p>æ–°å»ºä¸€ä¸ª <code>config/dap/cpp.lua</code>ï¼Œåœ¨é‡Œé¢é…ç½® c++ ç›¸å…³çš„å‚æ•°å°±è¡Œäº†ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œcodelldb å¯ä»¥è°ƒè¯• cã€c++ã€rust ç­‰è¯­è¨€ï¼Œå°±ä¸ä¼šå†æ‹†åˆ†æˆæ›´ç²¾ç»†çš„æ–‡ä»¶äº†ã€‚</p><figure class="highlight lua"><table><tr><td class="code"><pre><span class="line"><span class="keyword">local</span> M = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">M.setup</span><span class="params">()</span></span></span><br><span class="line"><span class="comment">-- local dap_install = require &quot;dap-install&quot;</span></span><br><span class="line"><span class="comment">-- dap_install.config(&quot;codelldb&quot;, &#123;&#125;)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> dap = <span class="built_in">require</span>(<span class="string">&quot;dap&quot;</span>)</span><br><span class="line"><span class="keyword">local</span> install_root_dir = vim.fn.stdpath(<span class="string">&quot;data&quot;</span>) .. <span class="string">&quot;/mason&quot;</span></span><br><span class="line"><span class="keyword">local</span> extension_path = install_root_dir .. <span class="string">&quot;/packages/codelldb/extension/&quot;</span></span><br><span class="line"><span class="keyword">local</span> codelldb_path = extension_path .. <span class="string">&quot;adapter/codelldb&quot;</span></span><br><span class="line"></span><br><span class="line">dap.adapters.codelldb = &#123;</span><br><span class="line"><span class="built_in">type</span> = <span class="string">&quot;server&quot;</span>,</span><br><span class="line">port = <span class="string">&quot;$&#123;port&#125;&quot;</span>,</span><br><span class="line">executable = &#123;</span><br><span class="line">command = codelldb_path,</span><br><span class="line">args = &#123; <span class="string">&quot;--port&quot;</span>, <span class="string">&quot;$&#123;port&#125;&quot;</span> &#125;,</span><br><span class="line"></span><br><span class="line"><span class="comment">-- On windows you may have to uncomment this:</span></span><br><span class="line"><span class="comment">-- detached = false,</span></span><br><span class="line">&#125;,</span><br><span class="line">&#125;</span><br><span class="line">dap.configurations.cpp = &#123;</span><br><span class="line">&#123;</span><br><span class="line">name = <span class="string">&quot;Launch file&quot;</span>,</span><br><span class="line"><span class="built_in">type</span> = <span class="string">&quot;codelldb&quot;</span>,</span><br><span class="line">request = <span class="string">&quot;launch&quot;</span>,</span><br><span class="line">program = <span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line"><span class="keyword">return</span> vim.fn.<span class="built_in">input</span>(<span class="string">&quot;Path to executable: &quot;</span>, vim.fn.getcwd() .. <span class="string">&quot;/&quot;</span>, <span class="string">&quot;file&quot;</span>)</span><br><span class="line"><span class="keyword">end</span>,</span><br><span class="line">cwd = <span class="string">&quot;$&#123;workspaceFolder&#125;&quot;</span>,</span><br><span class="line">stopOnEntry = <span class="literal">true</span>,</span><br><span class="line">&#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">dap.configurations.c = dap.configurations.cpp</span><br><span class="line">dap.configurations.rust = dap.configurations.cpp</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> M</span><br></pre></td></tr></table></figure><blockquote><p>Mason åœ¨è¿™é‡Œç»ˆäºéœ²é¢äº†ï¼Œä½†æ˜¯æˆ‘ä»¬åªæ˜¯çœ‹åˆ°æŸ¥æ‰¾äº† Mason å®‰è£… codelldb çš„è·¯å¾„è€Œå·²ã€‚</p></blockquote><p>é…ç½®çš„å†…å®¹æ˜¯å›ºå®šçš„ï¼Œè®¾ç½®ä¸€ä¸‹æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„å’Œå‚æ•°ï¼Œè®¾ç½®ä¸€ä¸‹è°ƒè¯•è¿™ä¸ªè¯­è¨€æ‰€éœ€çš„å¯åŠ¨å‚æ•°ï¼Œè¿™é‡Œé»˜è®¤ç»™äº†ä¸€ä¸ªè¾“å…¥å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„å¯åŠ¨è°ƒè¯•çš„ç®€å•æ–¹æ³•ã€‚</p><h2 id="é…ç½®-launch-json"><a href="#é…ç½®-launch-json" class="headerlink" title="é…ç½® launch.json"></a>é…ç½® launch.json</h2><p>ä¸Šé¢çš„å†…å®¹å°±å·²ç»è¶³å¤Ÿè°ƒè¯• c++ ç¨‹åºäº†ï¼Œä½†æ˜¯ dap è¿˜æ”¯æŒ vscode çš„ launch.jsonï¼Œå°†å¯åŠ¨é…ç½®ä½œä¸ºå›ºå®šæ¨¡æ¿å¡«å…¥å¯åŠ¨è°ƒè¯•çš„åˆ—è¡¨ï¼Œå¹¶ä¸”åœ¨ launch.json ä¸­æˆ‘ä»¬è¿˜å¯ä»¥æ§åˆ¶ç¨‹åºçš„ç¯å¢ƒå˜é‡ï¼Œå¯åŠ¨å‚æ•°ç­‰ï¼Œä¼šæ¯”è¾ƒæ–¹ä¾¿ä¸€äº›ã€‚</p><p>dap æ”¯æŒè¿™ä¸ªåªéœ€è¦åœ¨ setup å‡½æ•°åŠ ä¸Šä¸€è¡Œä»£ç å°±è¶³å¤Ÿäº†ã€‚</p><figure class="highlight lua"><table><tr><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">&quot;dap.ext.vscode&quot;</span>).load_launchjs(<span class="literal">nil</span>, &#123; codelldb = &#123; <span class="string">&quot;c&quot;</span>, <span class="string">&quot;cpp&quot;</span>, <span class="string">&quot;rust&quot;</span> &#125; &#125;)</span><br></pre></td></tr></table></figure><p>è¿™å¥è¯çš„æ„æ€æ˜¯ launch.json ä¸­çš„ç±»å‹æ˜¯ codelldb æ—¶ï¼Œä½¿ç”¨ cã€cppã€rust çš„è°ƒè¯•é…ç½®ï¼Œè€Œä¸Šé¢æˆ‘ä»¬é…ç½®äº† codelldb çš„å‚æ•° å’Œ cpp çš„å‚æ•°ï¼Œè€Œä¸”è¿˜å°† cpp çš„é…ç½®å¤åˆ¶ç»™äº† c å’Œ rustã€‚</p><p>ä½†æ˜¯æœ‰ä¸€ä¸ªéœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼Œlaunch.json ç°åœ¨ç¯å¢ƒå˜é‡æ¢æˆäº† environment å­—æ®µï¼Œå¹¶ä¸”ç»“æ„ä¹Ÿå‘ç”Ÿäº†å˜åŒ–ï¼Œdap ç›®å‰åªæ”¯æŒ env å­—æ®µï¼Œæˆ‘åœ¨è€ƒè™‘è´¡çŒ®ä¸€ä¸ª pr åšä¸€ä¸ªè‡ªåŠ¨è½¬æ¢ã€‚</p><p>è¿™é‡Œç»™ä¸€ä¸ª launch.json çš„ä¾‹å­ï¼š</p><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0.2.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;configurations&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;(codelldb) Launch&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;codelldb&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;request&quot;</span><span class="punctuation">:</span> <span class="string">&quot;launch&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;program&quot;</span><span class="punctuation">:</span> <span class="string">&quot;./build/bin/deepin-kwin_x11&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;--replace&quot;</span></span><br><span class="line">            <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;stopAtEntry&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;cwd&quot;</span><span class="punctuation">:</span> <span class="string">&quot;$&#123;workspaceFolder&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;env&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;DISPLAY&quot;</span><span class="punctuation">:</span> <span class="string">&quot;:0&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;PATH&quot;</span><span class="punctuation">:</span> <span class="string">&quot;$&#123;workspaceFolder&#125;/build/bin:$PATH&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;XDG_CURRENT_DESKTOP&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Deepin&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;QT_PLUGIN_PATH&quot;</span><span class="punctuation">:</span> <span class="string">&quot;$&#123;workspaceFolder&#125;/build&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;QT_LOGGING_RULES&quot;</span><span class="punctuation">:</span> <span class="string">&quot;kwin_*.debug=true&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;externalConsole&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;MIMode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;gdb&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;setupCommands&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Enable pretty-printing for gdb&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="string">&quot;-enable-pretty-printing&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;ignoreFailures&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œçš„ codelldb å…¶å®æ˜¯ä¸€ä¸ªæ ‡è¯†å­—ç¬¦ä¸²ï¼Œvscode é»˜è®¤æä¾›çš„ type æ˜¯ cppgdbï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ”¹æˆç›¸åŒçš„å­—æ®µã€‚</p><p>æƒ³è¦åœ¨çº¿æŸ¥çœ‹æœ€ç»ˆæ–‡ä»¶å†…å®¹ï¼Œå¯ä»¥çœ‹ä¸‹é¢å‡ ä¸ªé“¾æ¥ï¼š</p><p><a href="https://github.com/justforlxz/config.nvim/blob/master/lua/config/dap/rust.lua">cpp.lua </a><br><a href="https://github.com/justforlxz/config.nvim/blob/master/lua/config/dap/init.lua">init.lua</a><br><a href="https://github.com/justforlxz/config.nvim/blob/master/lua/config/dap/keymaps.lua">keymaps.lua</a><br><a href="https://github.com/justforlxz/config.nvim/blob/master/lua/plugins/_dap.lua">_dap.lua</a></p>]]></content>
      
      
      <categories>
          
          <category> neovim </category>
          
      </categories>
      
      
        <tags>
            
            <tag> neovim </tag>
            
            <tag> dap </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>1. init project</title>
      <link href="/2022/11/07/photo-1-init-project/"/>
      <url>/2022/11/07/photo-1-init-project/</url>
      
        <content type="html"><![CDATA[<p>è¿™æ˜¯ä¸€ä¸ªç³»åˆ—çš„æ–‡ç« ï¼Œç”¨æ¥è®°å½•æˆ‘çš„ç›¸å†Œåº”ç”¨çš„å¼€å‘è¿‡ç¨‹ï¼Œå†…å®¹å¯èƒ½ä¼šæ¯”è¾ƒæ¯ç‡¥ï¼Œè¿˜è¯·è¯»è€…è§è°…ã€‚</p><p>æˆ‘ä½¿ç”¨  NextCloud ä½œä¸ºæˆ‘çš„å­˜å‚¨ä¸­å¿ƒï¼Œä½†æ˜¯å½“æˆ‘å¤‡ä»½ç›¸å†Œçš„æ—¶å€™ï¼Œæˆ‘æ„Ÿåˆ°äº†è«åçš„è›‹ç–¼ï¼Œå®åœ¨æ˜¯å¤ªéš¾ç”¨äº†ï¼Œä¸æ”¯æŒç›¸å†Œï¼Œä¸æ”¯æŒæ ‡è®°ï¼Œä¸æ”¯æŒå„ç§è§†å›¾ï¼Œæ‰€ä»¥æˆ‘å†³å®šè‡ªå·±å†™ä¸€ä¸ªæ–°çš„å®¢æˆ·ç«¯ï¼Œåªæä¾›ç›¸å†ŒåŠŸèƒ½ã€‚</p><h2 id="æŠ€æœ¯é€‰å‹"><a href="#æŠ€æœ¯é€‰å‹" class="headerlink" title="æŠ€æœ¯é€‰å‹"></a>æŠ€æœ¯é€‰å‹</h2><p>æˆ‘ç”¨çš„æ˜¯ iPhone 12ï¼Œç†æ‰€å½“ç„¶æˆ‘ä¼šé€‰æ‹© iOS å®¢æˆ·ç«¯å¼€å‘ï¼Œåœ¨æˆ‘é¢å‰æœ‰è¿™ä¹ˆå‡ ç§æ–¹æ¡ˆå¯ä»¥é€‰æ‹©ï¼š</p><ol><li>object-c</li><li>swift</li><li>swiftui</li><li>flutter</li><li>qml</li><li>react-native</li></ol><blockquote><p>æœ¬ç€ä¸‰çŸ­ä¸€é•¿é€‰æœ€é•¿çš„åŸåˆ™ï¼Œæˆ‘è®¡åˆ’ä½¿ç”¨ react-native ä½œä¸ºé¡¹ç›®çš„æŠ€æœ¯æ–¹æ¡ˆã€‚</p></blockquote><p>object-c å·²ç»å¾ˆè€æ—§äº†ï¼Œæˆ‘åªæ˜¯æƒ³ä¸šä½™æ—¶é—´åšä¸€ä¸ªåº”ç”¨æ»¡è¶³è‡ªå·±çš„éœ€æ±‚ï¼Œæ’é™¤ã€‚</p><p>swfit å’Œ swiftui æ˜¯è‹¹æœç›®å‰ä¸»æ¨çš„ï¼Œç‰¹åˆ«æ˜¯ swfituiï¼Œç”¨æ¥å†™ç•Œé¢çœŸçš„å¾ˆæ–¹ä¾¿ï¼Œä½†æ˜¯æˆ‘ä¸æƒ³å­¦æ–°çš„ï¼Œæ’é™¤ã€‚</p><p>flutter æ˜¯è°·æ­Œåœ¨æ¨çš„ä¸€ä¸ªæ¡†æ¶ï¼Œä»æˆ‘çš„ç ”å‘è§’åº¦æ¥çœ‹ï¼Œflutter å’Œ qml æ²¡æœ‰ä»€ä¹ˆæœ¬è´¨åŒºåˆ«ï¼Œéƒ½æ˜¯è‡ªå·±å®ç°äº†ç»˜åˆ¶ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šå®Œå–„æ§ä»¶ç­‰é«˜çº§åŠŸèƒ½ï¼Œæ—¢ç„¶æˆ‘æ˜¯ä¸€ä¸ª Qt å¼€å‘è€…ï¼Œæˆ‘è‚¯å®šä¸ä¼šé€‰æ‹©å†å»å­¦ä¸€å¥—ç±»ä¼¼çš„æŠ€æœ¯äº†ï¼Œæ’é™¤ã€‚</p><p>qmlï¼ŒQt ç›®å‰ä¸»æ¨çš„ç•Œé¢å¼€å‘æ¡†æ¶ï¼Œé‡‡ç”¨ JSON like çš„æ–¹å¼æè¿°ç•Œé¢ï¼Œå¹¶ä¸”å¯ä»¥è¿è¡Œä¸€éƒ¨åˆ†çš„æ ‡å‡† js è¯­æ³•ï¼Œé…åˆ C++ åœ¨ native ç«¯æä¾›æœ¬åœ°åŠŸèƒ½ï¼ŒQt è‡ªå·±æ˜¯ä¸€å¥—å¹³å°ä¸€æ ·çš„æ¡†æ¶ï¼Œç”¨èµ·æ¥å¾ˆçˆ½ï¼Œä½†æ˜¯æˆ‘ä¸æƒ³å†™ qmlï¼Œæ’é™¤ã€‚</p><p>æœ€ç»ˆå°±åªèƒ½ç”¨ react native äº†ï¼Œæˆ‘ä¸ªäººæƒ³å­¦ä¸€ä¸‹å‰ç«¯å¼€å‘ï¼Œä½¿ç”¨ç›¸å…³çš„æŠ€æœ¯æ ˆå¯¹æˆ‘æ¥è¯´æ€§ä»·æ¯”æœ€é«˜ï¼Œé€‰æ‹©ã€‚</p><blockquote><p><del>ä¸ºäº†å†™ js è€Œæ‰¾äº†è¿™ä¹ˆå¤šå€Ÿå£ï¼ˆ</del></p></blockquote><h2 id="åŠŸèƒ½è®¾è®¡"><a href="#åŠŸèƒ½è®¾è®¡" class="headerlink" title="åŠŸèƒ½è®¾è®¡"></a>åŠŸèƒ½è®¾è®¡</h2><p>ç¡®å®šäº†æŠ€æœ¯æ–¹æ¡ˆï¼Œå°±éœ€è¦è€ƒè™‘å®ç°å“ªäº›åŠŸèƒ½äº†ï¼Œä½œä¸ºä¸€ä¸ªç›¸å†Œ Appï¼Œå®ƒæœ€åŸºæœ¬çš„åŠŸèƒ½è‚¯å®šæ˜¯ <del>èƒ½å¯åŠ¨</del>,å—¯ï¼Œçœ‹å›¾ã€‚</p><ul><li>æµè§ˆæœåŠ¡å™¨å’Œæœ¬åœ°çš„å›¾ç‰‡</li><li>ä¸Šä¼ å’Œä¸‹è½½å›¾ç‰‡</li><li>ç›¸å†Œåˆ†ç±»</li><li>æ ‡è®°ä¿¡æ¯</li><li>æŸ¥çœ‹æ–‡ä»¶è¯¦æƒ…</li></ul><p>ä¸€å¼€å§‹å…ˆä¸è€ƒè™‘é‚£ä¹ˆå¤šï¼Œåšä¸€ä¸ªåŸºæœ¬çš„ TimeLine æ ·å¼å°±å¯ä»¥äº†ã€‚</p><h2 id="ç•Œé¢è®¾è®¡"><a href="#ç•Œé¢è®¾è®¡" class="headerlink" title="ç•Œé¢è®¾è®¡"></a>ç•Œé¢è®¾è®¡</h2><p>åŠŸèƒ½ä¹Ÿå·²ç»ç¡®å®šäº†ï¼Œå…ˆå®ç°ä¸€ä¸ª TimeLine çš„åŠŸèƒ½ï¼Œé‚£ä¹ˆå°±è¦ç¡®å®šç•Œé¢çš„æ ·å¼äº†ï¼Œæˆ‘ä¸ªäººæ¯”è¾ƒæ¬£èµ Google Photo çš„è®¾è®¡ï¼Œæ‰“ç®—å°±æŒ‰åƒç´ å¤åˆ¶äº†ã€‚</p><h2 id="åˆå§‹åŒ–é¡¹ç›®"><a href="#åˆå§‹åŒ–é¡¹ç›®" class="headerlink" title="åˆå§‹åŒ–é¡¹ç›®"></a>åˆå§‹åŒ–é¡¹ç›®</h2><p>ç°åœ¨å¯ä»¥è€ƒè™‘æ€ä¹ˆå†™ä»£ç äº†ï¼Œé¦–å…ˆåˆå§‹åŒ–ä¸€ä¸‹é¡¹ç›®ã€‚</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npx react-native init photos --template react-native-template-typescript</span><br></pre></td></tr></table></figure><p>åˆå§‹åŒ–ä¸€ä¸ªå¸¦æœ‰ typescript çš„ react native é¡¹ç›®ï¼Œç„¶ååœ¨ vscode é‡Œå®‰è£…ä¸€äº› react å’Œ react native ç›¸å…³çš„æ’ä»¶å°±å¯ä»¥äº†ã€‚</p><p>åˆ æ‰åˆå§‹åŒ–é¡¹ç›®çš„ App.tsx å’Œç›¸å…³çš„æ–‡ä»¶ï¼Œæ–°å»º src ç›®å½•å’Œ App.tsx æ–‡ä»¶ï¼Œå¼€å§‹å†™æ–°çš„ç•Œé¢ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> photos å¼€å‘ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> typescript </tag>
            
            <tag> react </tag>
            
            <tag> react native </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>docker-buildx-multi-arch-images</title>
      <link href="/2022/08/25/docker-buildx-multi-arch-images/"/>
      <url>/2022/08/25/docker-buildx-multi-arch-images/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘ä¸€ç›´åœ¨æ github çš„ ciï¼Œä¸ºäº†æ–¹ä¾¿å…¬å¸çš„å¼€å‘å¿«é€Ÿä¿®å¤å…¶ä»–å‘è¡Œç‰ˆä¸Šçš„æ„å»ºé—®é¢˜ï¼Œæˆ‘ç ”ç©¶äº†ä¸€ä¸‹ distrobox å¯åŠ¨å®¹å™¨æ¥ä½œä¸ºæœ¬åœ°éªŒè¯ç¯å¢ƒçš„å¯è¡Œæ€§ï¼Œç»“æœå‘ç°è¿˜ä¸é”™ï¼Œå°±é¡ºæ‰‹åšäº†å‡ ä¸ªé•œåƒã€‚</p><p>v23 çš„ä»“åº“æ˜¯æ”¯æŒå¤šä¸ªæ¶æ„çš„ï¼Œæƒ³ç€é¡ºæ‰‹åšä¸€ä»½ v23 çš„é•œåƒæäº¤åˆ° docker hub ä¸Šï¼Œç»“æœé‡åˆ°äº†ä¸€ç‚¹å¤šå¹³å°çš„å‘ã€‚</p><h2 id="docker-buildx"><a href="#docker-buildx" class="headerlink" title="docker buildx"></a>docker buildx</h2><p>Docker Buildxæ˜¯ä¸€ä¸ªCLIæ’ä»¶ï¼Œå®ƒæ‰©å±•äº†Dockerå‘½ä»¤ï¼Œå®Œå…¨æ”¯æŒ Moby BuildKit æ„å»ºå·¥å…·åŒ…æä¾›çš„ç‰¹æ€§ã€‚å®ƒæä¾›äº†ä¸docker æ„å»ºç›¸åŒçš„ç”¨æˆ·ä½“éªŒï¼Œæä¾›äº†è®¸å¤šæ–°ç‰¹æ€§ï¼Œæ¯”å¦‚åˆ›å»ºä½œç”¨åŸŸçš„æ„å»ºå™¨å®ä¾‹å’ŒåŒæ—¶é’ˆå¯¹å¤šä¸ªèŠ‚ç‚¹æ„å»ºã€‚</p><p>Moby BuildKit æ„å»ºå·¥å…·æä¾›äº†ä¸€äº›è¯¸å¦‚è·¨å¹³å°å¯åŠ¨çš„åŠŸèƒ½ã€‚</p><h2 id="é¦–æ¬¡å°è¯•"><a href="#é¦–æ¬¡å°è¯•" class="headerlink" title="é¦–æ¬¡å°è¯•"></a>é¦–æ¬¡å°è¯•</h2><p>æœ€å¼€å§‹æˆ‘æ˜¯æ‰“ç®—ä½¿ç”¨ docker import ç›´æ¥æŠŠ base.tgz å¯¼å…¥è¿›å»çš„ï¼Œdocker import æ”¯æŒ â€“platform å‚æ•°æŒ‡å®šæ¶æ„ï¼Œæˆ‘å°±è·‘äº†ä¸¤éï¼Œç”Ÿæˆäº† linux&#x2F;arm64 å’Œ linux&#x2F;amd64 ä¸¤ä¸ªæ¶æ„çš„ã€‚</p><p>ç»“æœæˆ‘çœ‹åˆ° docker images é‡Œåªæœ‰ä¸€ä»½ï¼Œè€Œä¸”ç”¨ docker image inspect beige:base æŸ¥çœ‹å‘ç°é‡Œé¢çš„ Architecuture åªæœ‰ amd64ï¼Œæ¨é€åˆ° docker hub åä¹Ÿåªæœ‰ä¸€ä»½ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸æ­£ç¡®çš„ã€‚</p><h2 id="ä½¿ç”¨-dockerfile"><a href="#ä½¿ç”¨-dockerfile" class="headerlink" title="ä½¿ç”¨ dockerfile"></a>ä½¿ç”¨ dockerfile</h2><p>ç»è¿‡æˆ‘ä¸€ç•ªçš„æœç´¢ï¼Œæˆ‘çœ‹åˆ°äº†ä¸€ç§ä½¿ç”¨ docker buildx é…åˆ dockerfile çš„å¤šæ¶æ„æ„å»ºæ–¹å¼ï¼Œç„¶åæˆ‘å°±å¿«é€Ÿçš„å†™äº†ä¸€ä»½ dockerfileã€‚</p><figure class="highlight dockerfile"><table><tr><td class="code"><pre><span class="line"><span class="keyword">FROM</span> --platform=$TARGETPLATFORM scratch</span><br><span class="line"></span><br><span class="line"><span class="keyword">ARG</span> TARGETARCH</span><br><span class="line"></span><br><span class="line"><span class="keyword">ADD</span><span class="language-bash"> beige-<span class="variable">$&#123;TARGETARCH&#125;</span>.tgz /</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> [ <span class="string">&quot;sh&quot;</span> ]</span></span><br></pre></td></tr></table></figure><p>dockerfile éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå˜é‡éœ€è¦å…ˆä½¿ç”¨ ARG å£°æ˜ï¼Œåœ¨ build é˜¶æ®µï¼Œé‡åˆ°å˜é‡ä¼šäº§ç”Ÿä¸€æ¬¡åˆ†å‰ï¼Œè¿™æ ·å°±ä¼šåœ¨ä¸åŒçš„æ¶æ„é‡Œç»§ç»­è¿è¡Œäº†ï¼ˆè¿™ä¹Ÿæ˜¯å‘æˆ‘å¾ˆé•¿çš„æ—¶é—´ï¼Œæœ€ç»ˆæˆ‘å°†æ–‡ä»¶åä¿®æ”¹ä¸ºæ–¹ä¾¿è·å–çš„æ–¹å¼â€¦â€¦ï¼‰ã€‚</p><p>æ¥ä¸‹æ¥éœ€è¦åˆ›å»ºä¸€ä»½æ„å»ºç¯å¢ƒã€‚</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker buildx create --use</span><br></pre></td></tr></table></figure><p>è¿™æ¡å‘½ä»¤å¯ä»¥åˆ›å»ºä¸€ä¸ªåŸºæœ¬ç¯å¢ƒï¼Œå¯ä»¥ä½¿ç”¨ <code>docker buildx ls</code> æŸ¥çœ‹å½“å‰çš„ç¯å¢ƒï¼Œå¯ä»¥çœ‹åˆ°é»˜è®¤å°±æ”¯æŒçš„æœ‰å¾ˆå¤šç§æ¶æ„ã€‚</p><p>ç„¶åä½¿ç”¨ build å‘½ä»¤å¼€å§‹æ„å»ºï¼š</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker buildx build --platform=linux/amd64,linux/arm64 -t linuxdeepin/beige:base --push .</span><br></pre></td></tr></table></figure><p>ç®€å•è¯´ä¸€ä¸‹å‚æ•°ï¼Œplatform å‚æ•°è´Ÿè´£æ§åˆ¶æœ¬æ¬¡ build ä¼ å…¥æ¶æ„ï¼Œt å‚æ•°è®¾ç½® tag åç§°ï¼Œè¿™é‡Œæˆ‘ç”¨äº† â€“push ç›´æ¥æ¨é€ä¸Šå»äº†ï¼Œå®ƒé»˜è®¤ç”¨çš„ docker-compose å¤„ç†ï¼Œæ„å»ºäº§ç‰©ä¸ä¼šå‡ºç°åœ¨ docker images é‡Œï¼Œæ‰€ä»¥å°±ç›´æ¥æ¨é€äº†ã€‚</p><p>ç°åœ¨æˆ‘å°±æœ‰ä¸€ä»½ v23 çš„ docker base å¯ç”¨äº†ï¼Œå¾ˆå¼€å¿ƒã€‚</p><p>ç‚¹å‡»å‰å¾€ï¼š<br><a href="https://hub.docker.com/repository/docker/linuxdeepin/beige">https://hub.docker.com/repository/docker/linuxdeepin/beige</a></p>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>meet unity shader</title>
      <link href="/2022/07/21/meet-unity-shader/"/>
      <url>/2022/07/21/meet-unity-shader/</url>
      
        <content type="html"><![CDATA[<p>åœ¨æˆ‘è¿˜åœ¨ä¸Šé«˜ä¸­çš„æ—¶å€™ï¼Œæˆ‘å°±å¼€å§‹å­¦äº†ä¸€äº› Unityï¼Œä¹Ÿå°è¯•åˆ¶ä½œäº†ä¸€äº›ç®€å•çš„æ¸¸æˆï¼Œé‚£æ—¶å€™æ›´å¤šæ˜¯å‡ºäºå¥½ç©ï¼Œåæ¥æ²‰è¿· Linuxï¼Œå°±é€æ¸æ·¡å¿˜äº†æ¸¸æˆå¼€å‘ã€‚</p><p>æœºç¼˜å·§åˆï¼Œæˆ‘ç°åœ¨å…¥æ‰‹äº†ä¸€å° M1 mbpï¼Œæ¥è§¦åˆ°äº† Apple å®¶çš„ Metalï¼Œåˆå¿«é€Ÿè¿‡äº†ä¸€ä¸‹ Vulkanï¼Œä¹Ÿå°è¯•åšäº†ä¸€äº›å…¥é—¨çº§çš„é¡¹ç›®ï¼Œæ›´å¹»æƒ³åˆ¶ä½œä¸€ä¸ªæ¸¸æˆå¼•æ“ï¼Œæ‰€ä»¥æœ€è¿‘æœ‰æ—¶é—´æˆ‘å°±åœ¨çœ‹ Games104 çš„è¯¾ç¨‹ï¼Œè¡¥å……ä¸€ä¸‹ç›¸å…³çŸ¥è¯†ï¼Œè®¡åˆ’è·Ÿå®Œ Games104ï¼Œå°±å»çœ‹ä¸€ä¸‹é—«ä»¤çªè€å¸ˆçš„ Games101ï¼Œä¸»æ”»ä¸€ä¸‹è®¡ç®—æœºå›¾å½¢å­¦ã€‚</p><p>æœ‰å¤©ä¸­åˆæˆ‘æ— æ„é—´çœ‹åˆ°äº† onevcat å¤§ä½¬å†™çš„ä¸€ç¯‡ä»‹ç» unity shader çš„æ–‡ç« ï¼Œå¹¶ä¸”è¿˜åˆ†äº«äº†ä¸€ç¯‡ä½¿ç”¨ shader æ¨¡æ‹Ÿç‰©ä½“è¡¨é¢çš„é›ªçš„æ•ˆæœï¼Œè®©æˆ‘ä¹Ÿæƒ³è·Ÿç€åšä¸€ä¸ªã€‚</p><img src="/2022/07/21/meet-unity-shader/p1.png" class="" title="æ•ˆæœå±•ç¤º"><h2 id="Unity-shader"><a href="#Unity-shader" class="headerlink" title="Unity shader"></a>Unity shader</h2><p>Unity shader å¹¶ä¸åƒå¹³å¸¸æˆ‘ä»¬è§çš„ OpenGLã€Vulkan å’Œ Metal çš„ shader æ–‡ä»¶ä¸€æ ·ï¼ŒUnity shader æ›´åƒæ˜¯é…ç½®æ–‡ä»¶ï¼Œå®ƒä½¿ç”¨ç‰¹å®šçš„ç»“æ„è¯­æ³•ä¿å­˜å„ç§ä¿¡æ¯ï¼Œå¹¶å’Œ Unity Editor ä¸­å…¶ä»–å¯¹è±¡äº¤äº’ã€‚</p><p>ä¸€ä¸ªåŸºç¡€çš„ Unity shader çš„ç»“æ„æ˜¯è¿™æ ·çš„:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Shader &quot;Custom/myshader&quot; &#123;</span><br><span class="line">    Properties &#123;&#125;</span><br><span class="line">    SubShader &#123;&#125;</span><br><span class="line">    Fallback &quot;&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºï¼Œä¸€ä¸ªæ ‡å‡†çš„ Unity shader æ‹¥æœ‰å››ä¸ªéƒ¨åˆ†ï¼Œä¸€ä¸ª Shader çš„å‘½åï¼Œä¸€ä¸ªå±æ€§å¯¹è±¡ï¼Œä¸€ä¸ª SubShader å¯¹è±¡ï¼Œä¸€ä¸ª Fallback å­—ç¬¦ä¸²ã€‚</p><p>å±æ€§å¯¹è±¡æ˜¯ Unity Editor å’Œ shader æ²Ÿé€šçš„æ¡¥æ¢ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ Properties ä¸­å£°æ˜è¾“å…¥ï¼Œä»å¤–éƒ¨æ¥å—å‚æ•°ã€‚</p><p>SubShader å¯¹è±¡æ˜¯å¯ä»¥å¤šä¸ªé‡å¤çš„ï¼Œå½“ç¬¬ä¸€ä¸ª SubShader å¯¹è±¡ä¸­çš„ä»£ç æ— æ³•åœ¨å½“å‰çš„ GPU ä¸­è¿è¡Œæ—¶ï¼ŒUnity ä¼šåˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ª SubShader å¯¹è±¡ã€‚æˆ‘ä»¬å¯ä»¥åœ¨åŒä¸€ä»½ Shader æ–‡ä»¶ä¸­å¯¹ä¸åŒçš„ GPU å®ç°ä¸åŒçš„æ”¯æŒã€‚</p><p>Fallback å­—ç¬¦ä¸²åˆ™æ˜¯å¦‚æœ SubShader éƒ½æ— æ³•è¿è¡Œæ—¶ï¼Œé‡‡ç”¨çš„æœ€ç»ˆçš„æ¸²æŸ“æ–¹æ³•ã€‚</p><p>ä¸€ä¸ªç®€å•çš„ç†è§£å°±æ˜¯ï¼Œä»ä¸Šåˆ°ä¸‹ï¼Œç”»é¢æ•ˆæœæ˜¯ä¾æ¬¡é™ä½çš„ã€‚</p><h2 id="è‡ªå®šä¹‰å±æ€§"><a href="#è‡ªå®šä¹‰å±æ€§" class="headerlink" title="è‡ªå®šä¹‰å±æ€§"></a>è‡ªå®šä¹‰å±æ€§</h2><h2 id="SubShader"><a href="#SubShader" class="headerlink" title="SubShader"></a>SubShader</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SubShader &#123;</span><br><span class="line">    Tags &#123;&#125;</span><br><span class="line">    Pass &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Pass &#123;</span><br><span class="line">    CGPROGRAM</span><br><span class="line">    ENDCG</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="CGPROGRAM"><a href="#CGPROGRAM" class="headerlink" title="CGPROGRAM"></a>CGPROGRAM</h2><p>&#x2F;&#x2F; TODOï¼šCGPROGRAM æ˜¯å‘é€åˆ° GPU è¿è¡Œçš„ç¨‹åºï¼Œä¹Ÿæ˜¯ä¸€èˆ¬æ¦‚å¿µä¸­çš„ shaderã€‚</p><h2 id="è‡ªå®šä¹‰å…‰ç…§"><a href="#è‡ªå®šä¹‰å…‰ç…§" class="headerlink" title="è‡ªå®šä¹‰å…‰ç…§"></a>è‡ªå®šä¹‰å…‰ç…§</h2><h2 id="æ³•çº¿"><a href="#æ³•çº¿" class="headerlink" title="æ³•çº¿"></a>æ³•çº¿</h2><h2 id="Shader-ä»£ç "><a href="#Shader-ä»£ç " class="headerlink" title="Shader ä»£ç "></a>Shader ä»£ç </h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// Upgrade NOTE: replaced &#x27;_Object2World&#x27; with &#x27;unity_ObjectToWorld&#x27;</span><br><span class="line"></span><br><span class="line">Shader &quot;Custom/SnowShader&quot; &#123;</span><br><span class="line">    Properties &#123;</span><br><span class="line">        _MainTex (&quot;Base (RGB)&quot;, 2D) = &quot;white&quot; &#123;&#125;</span><br><span class="line">        _Bump (&quot;Bump&quot;, 2D) = &quot;bump&quot; &#123;&#125;</span><br><span class="line">        _Snow (&quot;Snow Level&quot;, Range(0,1) ) = 0</span><br><span class="line">        _SnowColor (&quot;Snow Color&quot;, Color) = (1.0,1.0,1.0,1.0)</span><br><span class="line">        _SnowDirection (&quot;Snow Direction&quot;, Vector) = (0,1,0)</span><br><span class="line">        _SnowDepth (&quot;Snow Depth&quot;, Range(0,0.3)) = 0.1</span><br><span class="line">    &#125;</span><br><span class="line">    SubShader &#123;</span><br><span class="line">        Tags &#123; &quot;RenderType&quot;=&quot;Opaque&quot; &#125;</span><br><span class="line">        LOD 200</span><br><span class="line"></span><br><span class="line">        CGPROGRAM</span><br><span class="line">        #pragma surface surf CustomDiffuse vertex:vert</span><br><span class="line"></span><br><span class="line">        sampler2D _MainTex;</span><br><span class="line">        sampler2D _Bump;</span><br><span class="line">        float _Snow;</span><br><span class="line">        float4 _SnowColor;</span><br><span class="line">        float4 _SnowDirection;</span><br><span class="line">        float _SnowDepth;</span><br><span class="line"></span><br><span class="line">        struct Input &#123;</span><br><span class="line">            float2 uv_MainTex;</span><br><span class="line">            float2 uv_Bump;</span><br><span class="line">            float3 worldNormal;</span><br><span class="line">            INTERNAL_DATA</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        inline float4 LightingCustomDiffuse (SurfaceOutput s, fixed3 lightDir, fixed atten) &#123;</span><br><span class="line">            float difLight = dot (s.Normal, lightDir);</span><br><span class="line">            float hLambert = difLight * 0.5 + 0.5;</span><br><span class="line">            float4 col;</span><br><span class="line">            col.rgb = s.Albedo * _LightColor0.rgb * (hLambert * atten * 2);</span><br><span class="line">            col.a = s.Alpha;</span><br><span class="line">            return col;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        void vert (inout appdata_full v) &#123;</span><br><span class="line">            float4 sn = mul(transpose(unity_ObjectToWorld) , _SnowDirection);</span><br><span class="line">            if(dot(v.normal, sn.xyz) &gt;= lerp(1,-1, (_Snow * 2) / 3)) &#123;</span><br><span class="line">                v.vertex.xyz += (sn.xyz + v.normal) * _SnowDepth * _Snow;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        void surf (Input IN, inout SurfaceOutput o) &#123;</span><br><span class="line">            half4 c = tex2D (_MainTex, IN.uv_MainTex);</span><br><span class="line"></span><br><span class="line">            o.Normal = UnpackNormal(tex2D(_Bump, IN.uv_Bump));</span><br><span class="line"></span><br><span class="line">            if (dot(WorldNormalVector(IN, o.Normal), _SnowDirection.xyz) &gt; lerp(1,-1,_Snow)) &#123;</span><br><span class="line">                o.Albedo = _SnowColor.rgb;</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                o.Albedo = c.rgb;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            o.Alpha = 1;</span><br><span class="line">        &#125;</span><br><span class="line">        ENDCG</span><br><span class="line">    &#125;</span><br><span class="line">    FallBack &quot;Diffuse&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p><strong>ç›¸å…³æ–‡ç« </strong><br><a href="https://onevcat.com/2013/07/shader-tutorial-1/">https://onevcat.com/2013/07/shader-tutorial-1/</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Game </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Game </tag>
            
            <tag> Unity </tag>
            
            <tag> Shader </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨ React çš„ JSX</title>
      <link href="/2022/07/02/jsx/"/>
      <url>/2022/07/02/jsx/</url>
      
        <content type="html"><![CDATA[<h1 id="jsx"><a href="#jsx" class="headerlink" title="jsx"></a>jsx</h1><p>JSX æ˜¯ javascript XML çš„ç¼©å†™ï¼Œå¯ä»¥åœ¨ javascript ä»£ç ä¸­ä¹¦å†™ HTML ç»“æ„çš„ä¸€ç§æ–¹å¼ã€‚</p><h2 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h2><p>é‡‡ç”¨ç±»ä¼¼äº HTML è¯­æ³•</p><p>å……åˆ†åˆ©ç”¨ js è‡ªèº«çš„å¯ç¼–ç¨‹èƒ½åŠ›åˆ›å»º HTML ç»“æ„</p><h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><h3 id="åŸºæœ¬è¯´æ˜"><a href="#åŸºæœ¬è¯´æ˜" class="headerlink" title="åŸºæœ¬è¯´æ˜"></a>åŸºæœ¬è¯´æ˜</h3><p>éœ€è¦ä½¿ç”¨ babel è¿›è¡Œè¯­æ³•è½¬æ¢ï¼Œå¯¹äº react è€Œè¨€ï¼Œä»¥ä¸‹ä»£ç æ˜¯ç­‰ä»·çš„ã€‚</p><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&#x27;d&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                 <span class="tag">&lt;<span class="name">p</span>&gt;</span>hello world<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">ReactDOM</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>,</span><br><span class="line">                                  &#123; <span class="attr">id</span>: <span class="string">&#x27;d&#x27;</span> &#125;,</span><br><span class="line">                                  <span class="title class_">ReactDOM</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;p&#x27;</span>,</span><br><span class="line">                                                         <span class="literal">null</span>,</span><br><span class="line">                                                         <span class="string">&#x27;hello world&#x27;</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¡¨è¾¾å¼"><a href="#è¡¨è¾¾å¼" class="headerlink" title="è¡¨è¾¾å¼"></a>è¡¨è¾¾å¼</h3><p>å¯ä»¥åœ¨ JSX ä¸­ä½¿ç”¨è¡¨è¾¾å¼ï¼Œè¡¨è¾¾å¼ä½¿ç”¨ä¸€å¯¹èŠ±æ‹¬å·å¯¹è¡¨è¾¾å¼è¿›è¡Œæ ‡è®°ã€‚</p><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> text = <span class="string">&#x27;hello&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> html = <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123; text &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line"><span class="keyword">const</span> flag = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">test</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;test function&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> newHtml = <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123; flag ? test() : &#x27;no&#x27; &#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br></pre></td></tr></table></figure><p>é€šè¿‡ä¸Šé¢çš„ä¾‹å­å¯ä»¥çœ‹å‡ºï¼ŒJSX çš„è¡¨è¾¾å¼æ”¯æŒä»¥ä¸‹å‡ ç§æ–¹å¼ï¼š</p><ol><li>è¯†åˆ«å¸¸è§„å˜é‡</li><li>åŸç”Ÿ js æ–¹æ³•è°ƒç”¨</li><li>ä¸‰å…ƒè¿ç®—ç¬¦</li></ol><p><strong>ç‰¹åˆ«æ³¨æ„</strong></p><p>JSX ä¸­æ— æ³•ä½¿ç”¨ if&#x2F;switch&#x2F;å˜é‡å£°æ˜ç­‰è¯­å¥ï¼Œä»–ä»¬ä¸æ˜¯è¡¨è¾¾å¼ï¼Œä¸æ”¯æŒåœ¨ jsx ä¸­ä½¿ç”¨ã€‚</p><h3 id="åˆ—è¡¨æ¸²æŸ“"><a href="#åˆ—è¡¨æ¸²æŸ“" class="headerlink" title="åˆ—è¡¨æ¸²æŸ“"></a>åˆ—è¡¨æ¸²æŸ“</h3><p>åœ¨ vue ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ v-for å¯¹ä¸€ä¸ªåˆ—è¡¨æ•°æ®è¿›è¡Œéå†ï¼Œå¯ä»¥åœ¨æ¨¡æ¿ä¸­å®ç°å…ƒç´ çš„é‡å¤ç”Ÿæˆã€‚åœ¨ angular ä¸­å¯ä»¥ä½¿ç”¨ *ngFor å®ç°ç›¸åŒçš„äº‹æƒ…ï¼Œåœ¨ JSX ä¸­æˆ‘ä»¬ä¹Ÿå¯ä»¥åšåˆ°ç›¸åŒçš„äº‹æƒ…ã€‚</p><p>å¯ä»¥ä½¿ç”¨ map æ–¹æ³•è¿”å›åŒ…å« jsx çš„è¡¨è¾¾å¼</p><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> songs = [</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">&#x27;å¯æƒœæ²¡å¦‚æœ&#x27;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="number">3</span>, <span class="attr">name</span>: <span class="string">&#x27;æˆ‘ç»§ç»­&#x27;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">name</span>: <span class="string">&#x27;é»‘å¤œé—®ç™½å¤©&#x27;</span> &#125;,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#x27;App&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">&#123;</span></span><br><span class="line"><span class="language-xml">songs.map(item =&gt; <span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&#123;</span> <span class="attr">item.id</span>&#125; &gt;</span>&#123; item.name &#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span>)</span></span><br><span class="line"><span class="language-xml">&#125;</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„äº‹é¡¹</strong></p><p>ç”±äºæ˜¯é‡å¤å…ƒç´ æ¸²æŸ“ï¼Œéœ€è¦ä¸ºç”Ÿæˆçš„å…ƒç´ åˆ†é…ä¸€ä¸ª keyï¼Œå¦åˆ™ä¼šå½±å“ virtual dom çš„æ€§èƒ½ã€‚</p><p>key åªèƒ½ä½¿ç”¨ number&#x2F;string ç±»å‹ï¼Œkey å±æ€§ä¸ä¼šå‡ºç°åœ¨çœŸå®çš„ dom å±æ€§ä¸Šï¼Œè¿›åœ¨å†…éƒ¨ä½¿ç”¨ã€‚</p><h3 id="æ¡ä»¶æ¸²æŸ“"><a href="#æ¡ä»¶æ¸²æŸ“" class="headerlink" title="æ¡ä»¶æ¸²æŸ“"></a>æ¡ä»¶æ¸²æŸ“</h3><p>JSX æ”¯æŒæ»¡è¶³æ¡ä»¶ç”Ÿæˆå¯¹åº”çš„ HTML ç»“æ„ï¼Œå¯ä»¥ä½¿ç”¨ <code>ä¸‰å…ƒè¿ç®—ç¬¦</code> å®ç°ã€‚</p><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> flag = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line"><span class="keyword">return</span> (</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">&#123; flag ? &#x27;flag is true&#x27; : &#x27;flag is false&#x27; &#125;</span></span><br><span class="line"><span class="language-xml">&#123; flag ? <span class="tag">&lt;<span class="name">div</span>&gt;</span>flag is true<span class="tag">&lt;/<span class="name">div</span>&gt;</span> : null &#125;</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ ·å¼å¤„ç†"><a href="#æ ·å¼å¤„ç†" class="headerlink" title="æ ·å¼å¤„ç†"></a>æ ·å¼å¤„ç†</h3><p>JSX æ”¯æŒ css æ ·å¼å¤„ç†</p><ul><li>è¡Œå†…æ ·å¼ - style - åœ¨å…ƒç´ å±æ€§ä¸Šç»‘å®š style å±æ€§</li></ul><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line"><span class="keyword">return</span> (</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">color:</span> <span class="attr">red</span> &#125;&#125;&gt;</span>here is a div<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>è¡Œå†…æ ·å¼ - style - æ›´ä¼˜å†™æ³•</li></ul><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> styleObj = &#123;</span><br><span class="line"><span class="attr">color</span>: <span class="string">&#x27;red&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line"><span class="keyword">return</span> (</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;</span> <span class="attr">styleObj</span> &#125;&gt;</span>here is a div<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç±»åæ ·å¼ - åœ¨å…ƒç´ èº«ä¸Šç»‘ä¸€ä¸ª className å±æ€§</li></ul><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.active</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./app.css&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line"><span class="keyword">return</span> (</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;active&quot;</span>&gt;</span>here is a div<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„äº‹é¡¹</strong></p><p>åœ¨ç¬¬ä¸€ä¸ªä¾‹å­ä¸­ï¼Œç”±äº style å±æ€§éœ€è¦çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥ç¬¬ä¸€å±‚ <code>&#123;&#125;</code> æ˜¯è¡¨è¾¾å¼ï¼Œç¬¬äºŒå±‚ <code>&#123;&#125;</code> æ˜¯å¯¹è±¡çš„å®šä¹‰æ‹¬å·ï¼Œæ‰€ä»¥é€šå¸¸ä¼šå†™æˆ Object çš„æ–¹å¼ï¼Œè¿™æ ·æ§åˆ¶ä¹Ÿæ›´åŠ æ–¹ä¾¿ã€‚</p><h3 id="åŠ¨æ€ç±»åæ§åˆ¶"><a href="#åŠ¨æ€ç±»åæ§åˆ¶" class="headerlink" title="åŠ¨æ€ç±»åæ§åˆ¶"></a>åŠ¨æ€ç±»åæ§åˆ¶</h3><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå·²ç»ä½¿ç”¨ css ä¸­çš„ç±»åæ ·å¼è¿›è¡Œäº†æ ·å¼è®¾ç½®ï¼Œä½†æ˜¯æœ‰æ—¶å€™æˆ‘ä»¬ä¼šå¸Œæœ›æ§åˆ¶ä¸€ä¸ªå…ƒç´ çš„æ ·å¼åœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œä¼šå‘ç”Ÿæ”¹å˜ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦ä½¿ç”¨åŠ¨æ€ç±»åæ§åˆ¶äº†ã€‚</p><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./app.css&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> flag = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line"><span class="keyword">return</span> (</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#123;</span> <span class="attr">flag</span> ? &quot;<span class="attr">activate</span>&quot; <span class="attr">:</span> &quot;&quot; &#125;&gt;</span>here is a div<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h2><p>JSX åœ¨å®é™…åº”ç”¨æ—¶çš„æ³¨æ„äº‹é¡¹</p><ol><li>JSX å¿…é¡»æœ‰ä¸€ä¸ªæ ¹ç»“ç‚¹ï¼Œä¹Ÿå°±æ˜¯è¯´ React æ— æ³•ä½¿ç”¨ jsx åˆ›å»ºæœ€é¡¶å±‚çš„ html å…ƒç´ ï¼Œæˆ‘ä»¬å¿…é¡»å…ˆæä¾›ä¸€ä¸ªç©ºçš„å…ƒç´ ä½œä¸º React çš„æ ¹èŠ‚ç‚¹ã€‚ï¼ˆæˆ–è€…ä½¿ç”¨å¹½çµèŠ‚ç‚¹ <code>&lt;&gt;&lt;/&gt;</code> åˆ›å»ºï¼‰</li><li>æ‰€æœ‰æ ‡ç­¾å¿…é¡»å½¢æˆé—­åˆï¼Œæˆå¯¹é—­åˆæˆ–è€…è‡ªé—­åˆå‡å¯ã€‚</li><li>JSX ä¸­çš„è¯­æ³•æ›´è´´è¿‘ javascript çš„è¯­æ³•ï¼Œå±æ€§é‡‡ç”¨å°é©¼å³°å‘½åæ³• <code>class -&gt; className</code> <code>for -&gt; htmlFor</code> ã€‚</li><li>JSX æ”¯æŒå¤šè¡Œï¼ˆæ¢è¡Œï¼‰ï¼Œå¦‚æœéœ€è¦æ¢è¡Œï¼Œå¯ä»¥ä½¿ç”¨ <code>()</code> è¿›è¡ŒåŒ…è£¹ã€‚</li></ol>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
            <tag> jsx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ ˆåˆ†é…é—®é¢˜</title>
      <link href="/2022/06/24/stack-problem/"/>
      <url>/2022/06/24/stack-problem/</url>
      
        <content type="html"><![CDATA[<p>å‰é˜µå­åœ¨å†™ä¸€ä¸ªæ–°çš„é¡¹ç›®ï¼Œä¸ºäº†æå‡ä¸€äº›é€Ÿåº¦ï¼Œæ‰€ä»¥æ²¡æœ‰ä½¿ç”¨ Qt ä¹‹ç±»çš„å¤§å‹åº“ï¼Œåœ¨åšè¿›ç¨‹ç®¡ç†çš„æ—¶å€™ï¼Œé‡åˆ°äº†å¥‡æ€ªçš„å´©æºƒé—®é¢˜ã€‚</p><p>å› ä¸ºå¹³æ—¶å¾ˆå°‘å†™è¿™æ ·çš„ä»£ç ï¼Œæ‰€ä»¥è§‰å¾—å‡ºé—®é¢˜å¾ˆæ­£å¸¸ï¼Œä½†æ˜¯æ’æŸ¥äº†å¾ˆä¹…ï¼Œéƒ½æ²¡æœ‰æ‰¾åˆ°é—®é¢˜æ‰€åœ¨ã€‚</p><p>åœ¨ @black-desk å¤§ä½¬çš„å¸®åŠ©ä¸‹ï¼Œé‡æ–°å¤ä¹ äº†ä¸€éæ“ä½œç³»ç»Ÿå¦‚ä½•ç®¡ç†è¿›ç¨‹ï¼Œæ‰¾åˆ°äº†é—®é¢˜æ‰€åœ¨ã€‚</p><p>å…ˆæ¥ä¸€ä»½ç®€å•çš„ä¾‹å­ï¼š</p><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">child</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> pid = fork();</span><br><span class="line">    <span class="keyword">switch</span> (pid) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">          std::cout &lt;&lt; <span class="string">&quot;[child] I&#x27;m child.&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">          <span class="built_in">sleep</span>(<span class="number">5</span>);</span><br><span class="line">          std::cout &lt;&lt; <span class="string">&quot;[child] I&#x27;m quit.&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">-1</span>:</span><br><span class="line">          std::cout &lt;&lt; <span class="string">&quot;fork() failed.&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">          std::cout &lt;&lt; <span class="string">&quot;[parent] I&#x27;m meself.&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">          std::cout &lt;&lt; <span class="string">&quot;[parent] I will wait child.&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">          <span class="built_in">wait</span>(<span class="literal">nullptr</span>);</span><br><span class="line">          std::cout &lt;&lt; <span class="string">&quot;[parent] I&#x27;m quit.&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> pid;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">child</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬æ¥è·‘ä¸€ä¸‹è¿™æ®µä»£ç ï¼Œå¯ä»¥çœ‹åˆ°è¿›ç¨‹çš„è¾“å‡ºã€‚</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">g++ child.cpp</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./a.out</span></span><br><span class="line">[parent] I&#x27;m meself.</span><br><span class="line">[parent] I will wait child.</span><br><span class="line">[child] I&#x27;m child.</span><br><span class="line">[child] I&#x27;m quit.</span><br><span class="line">[parent] I&#x27;m quit.</span><br></pre></td></tr></table></figure><p>ä¸Šé¢æ˜¯ä¸€ä¸ªéå¸¸ç®€å•å’ŒåŸºæœ¬çš„ fork() ç³»ç»Ÿè°ƒç”¨çš„ç”¨æ³•ï¼Œç›®å‰ä¸ºæ­¢è¿™é‡Œæ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚</p><p>é™¤äº† fork() ç³»ç»Ÿè°ƒç”¨ï¼Œè¿˜æœ‰ clone() ç³»ç»Ÿè°ƒç”¨ï¼Œä»–ä»¬çš„ä½œç”¨åˆ†åˆ«æ˜¯ï¼š</p><p>fork ä¼šåˆ›å»ºä¸€ä¸ªçˆ¶è¿›ç¨‹çš„å®Œæ•´å‰¯æœ¬ï¼Œå¤åˆ¶çˆ¶è¿›ç¨‹æ‰€æœ‰çš„èµ„æºã€‚</p><p>clone ä¹Ÿå¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„è¿›ç¨‹ï¼Œä½†æ˜¯å®ƒå¯ä»¥æ¯” fork æ›´åŠ ç²¾ç»†çš„æ§åˆ¶ä¸å­è¿›ç¨‹å…±äº«çš„èµ„æºï¼Œå› æ­¤å‚æ•°ä¼šæ›´åŠ å¤æ‚ä¸€äº›ï¼Œé€šå¸¸æˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥å®ç°çº¿ç¨‹ã€‚</p><p>åœ¨æˆ‘çš„éœ€æ±‚ä¸­ï¼Œæˆ‘éœ€è¦æ§åˆ¶å­è¿›ç¨‹è¿è¡Œåœ¨ä¸€ä¸ªæ–°çš„ proc namespace ä¸­ï¼Œæ‰€ä»¥æˆ‘ä¼šé€‰æ‹©ä½¿ç”¨ clone() ç³»ç»Ÿè°ƒç”¨æ§åˆ¶å­è¿›ç¨‹æ‰€å±çš„ namespaceã€‚</p><p>å¤§æ¦‚çš„ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sched.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/wait.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> CHILD_STACK 8192</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">child_run</span><span class="params">(<span class="type">void</span> *arg)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;count in child: %d\n&quot;</span>, ++count);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span>   pid;</span><br><span class="line">    <span class="type">int</span>   status;</span><br><span class="line">    <span class="type">void</span> *child_stack = <span class="built_in">malloc</span>(CHILD_STACK);</span><br><span class="line">    <span class="keyword">if</span> (!child_stack) &#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;failed to allocate child stack\n&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;count before clone: %d\n&quot;</span>, count);</span><br><span class="line">    <span class="comment">/* Simulate vfork */</span></span><br><span class="line">    pid = <span class="built_in">clone</span>(child_run, (<span class="type">void</span> *) ((<span class="type">char</span> *) child_stack + CHILD_STACK),</span><br><span class="line">                CLONE_NEWPID, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (pid == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;failed to clone\n&quot;</span>);</span><br><span class="line">        <span class="built_in">perror</span>(<span class="string">&quot;clone failed: &quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">waitpid</span>(pid, &amp;status, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;count after clone: %d\n&quot;</span>, count);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸€ä»½å¾ˆå¸¸è§çš„ clone() ä½¿ç”¨æ–¹æ³•ï¼Œä½œä¸ºä¸€ä¸ªä¾‹å­ï¼Œå®ƒæ²¡æ¯›ç—…ï¼Œç›´åˆ°æˆ‘è¿è¡Œäº†å¤§é‡çš„å‡½æ•°ï¼Œå®ƒå´©æºƒäº†ã€‚</p><p>gdb è·Ÿè¸ªäº†ä¸€ä¸‹ï¼Œå´©æºƒåœ¨äº† std çš„å‡½æ•°è°ƒç”¨ä¸­ï¼Œçœ‹èµ·æ¥å¾ˆå¥‡æ€ªï¼Œæˆ‘å¹¶æ²¡æœ‰å†™ä»€ä¹ˆç‰¹åˆ«å¥‡æ€ªçš„ä»£ç ï¼Œç„¶åæˆ‘å¼€å§‹ç²¾ç®€ä»£ç ï¼Œç”¨äºŒåˆ†ç®€å•å®šä½äº†ä¸€ä¸‹ï¼Œå‘ç°æœ‰ä¸€ä¸ªå‡½æ•°ä¸è°ƒç”¨ï¼Œå°±ä¸ä¼šå´©æºƒï¼Œç„¶åæˆ‘å°±è·Ÿè¿›å»çœ‹ä»£ç ï¼Œä¹Ÿæ²¡å‘ç°é‡Œé¢æœ‰ä»€ä¹ˆå¥‡æ€ªçš„ï¼Œå°±æ˜¯ä¸€äº› std çš„ä»£ç ã€‚</p><p>æ­£å½“æˆ‘å‘æ„æ€ä¹ˆå¤„ç†è¿™ä¸ªé—®é¢˜çš„æ—¶å€™ï¼Œ @black-desk å¤§ä½¬æ¥æˆ‘æ—è¾¹çœ‹æˆ‘åœ¨å¹²å•¥ï¼Œæˆ‘å°±ç»™ä»–çœ‹äº†ä¸€ä¸‹ä»£ç å’Œé—®é¢˜ï¼Œä»–ä¹Ÿè§‰å¾—å¥‡æ€ªï¼Œå°±æŒºæœ‰å…´è¶£çš„æ¥å¸®æˆ‘æ£€æŸ¥äº†ã€‚</p><p>ç»è¿‡ä¸€æ³¢ debugï¼Œæœ€åå®šä½å¯èƒ½æ˜¯ stack ç©ºé—´ä¸å¤Ÿç”¨äº†ï¼Œç„¶åè¢«æ“ä½œç³»ç»Ÿå¹²æ‰äº†ï¼Œæœ€ç»ˆå°† stack è°ƒå¤§äº†ä¸€äº›ï¼Œå‘ç°å¯ä»¥æ­£å¸¸è¿è¡Œäº†ï¼Œè¿™è¯´æ˜é—®é¢˜ç¡®å®æ˜¯è¿™é‡Œã€‚</p><p>ç„¶åæˆ‘å°±å»å¤ä¹  linux è¿›ç¨‹å†…å­˜åˆ†é…çš„çŸ¥è¯†äº†ã€‚</p><p>è¿›ç¨‹åœ°å€ç©ºé—´ä¸­æœ€é¡¶éƒ¨çš„æ®µæ˜¯æ ˆï¼Œå¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€å°†ä¹‹ç”¨äºå­˜å‚¨å‡½æ•°å‚æ•°å’Œå±€éƒ¨å˜é‡ã€‚è°ƒç”¨ä¸€ä¸ªæ–¹æ³•æˆ–å‡½æ•°ä¼šå°†ä¸€ä¸ªæ–°çš„æ ˆå¸§ï¼ˆstack frameï¼‰å‹å…¥åˆ°æ ˆä¸­ï¼Œè¿™ä¸ªæ ˆå¸§ä¼šåœ¨å‡½æ•°è¿”å›æ—¶è¢«æ¸…ç†æ‰ã€‚ç”±äºæ ˆä¸­æ•°æ®ä¸¥æ ¼çš„éµå®ˆFIFOçš„é¡ºåºï¼Œè¿™ä¸ªç®€å•çš„è®¾è®¡æ„å‘³ç€ä¸å¿…ä½¿ç”¨å¤æ‚çš„æ•°æ®ç»“æ„æ¥è¿½è¸ªæ ˆä¸­çš„å†…å®¹ï¼Œåªéœ€è¦ä¸€ä¸ªç®€å•çš„æŒ‡é’ˆæŒ‡å‘æ ˆçš„é¡¶ç«¯å³å¯ï¼Œå› æ­¤å‹æ ˆï¼ˆpushingï¼‰å’Œé€€æ ˆï¼ˆpoppingï¼‰è¿‡ç¨‹éå¸¸è¿…é€Ÿã€å‡†ç¡®ã€‚è¿›ç¨‹ä¸­çš„æ¯ä¸€ä¸ªçº¿ç¨‹éƒ½æœ‰å±äºè‡ªå·±çš„æ ˆã€‚</p><p>é€šè¿‡ä¸æ–­å‘æ ˆä¸­å‹å…¥æ•°æ®ï¼Œè¶…å‡ºå…¶å®¹é‡å°±ä¼šè€—å°½æ ˆæ‰€å¯¹åº”çš„å†…å­˜åŒºåŸŸï¼Œè¿™å°†è§¦å‘ä¸€ä¸ªé¡µæ•…éšœï¼ˆpage faultï¼‰ï¼Œè€Œè¢« Linux çš„ expand_stack() å¤„ç†ï¼Œå®ƒä¼šè°ƒç”¨ acct_stack_growth() æ¥æ£€æŸ¥æ˜¯å¦è¿˜æœ‰åˆé€‚çš„åœ°æ–¹ç”¨äºæ ˆçš„å¢é•¿ã€‚å¦‚æœæ ˆçš„å¤§å°ä½äº RLIMIT_STACKï¼ˆé€šå¸¸ä¸º8MBï¼‰ï¼Œé‚£ä¹ˆä¸€èˆ¬æƒ…å†µä¸‹æ ˆä¼šè¢«åŠ é•¿ï¼Œç¨‹åºç»§ç»­æ‰§è¡Œï¼Œæ„Ÿè§‰ä¸åˆ°å‘ç”Ÿäº†ä»€ä¹ˆäº‹æƒ…ã€‚è¿™æ˜¯ä¸€ç§å°†æ ˆæ‰©å±•åˆ°æ‰€éœ€å¤§å°çš„å¸¸è§„æœºåˆ¶ã€‚ç„¶è€Œï¼Œå¦‚æœè¾¾åˆ°äº†æœ€å¤§æ ˆç©ºé—´çš„å¤§å°ï¼Œå°±ä¼šæ ˆæº¢å‡ºï¼ˆstack overflowï¼‰ï¼Œç¨‹åºæ”¶åˆ°ä¸€ä¸ªæ®µé”™è¯¯ï¼ˆsegmentation faultï¼‰ã€‚</p><blockquote><p><strong>åŠ¨æ€æ ˆå¢é•¿æ˜¯å”¯ä¸€ä¸€ç§è®¿é—®æœªæ˜ å°„å†…å­˜åŒºåŸŸè€Œè¢«å…è®¸çš„æƒ…å½¢ï¼Œå…¶ä»–ä»»ä½•å¯¹æœªæ˜ å°„å†…å­˜åŒºåŸŸçš„è®¿é—®éƒ½ä¼šè§¦å‘é¡µé”™è¯¯ï¼Œä»è€Œå¯¼è‡´æ®µé”™è¯¯ã€‚ä¸€äº›è¢«æ˜ å°„çš„åŒºåŸŸæ˜¯åªè¯»çš„ï¼Œå› æ­¤ä¼å›¾å†™è¿™äº›åŒºåŸŸä¹Ÿä¼šå¯¼è‡´æ®µé”™è¯¯ã€‚</strong></p></blockquote><p>æœ€ç»ˆæˆ‘æ²¡æœ‰å†ä½¿ç”¨è¿™å¥—æ–¹æ¡ˆï¼Œæ‰€ä»¥é—®é¢˜ä¹Ÿå°±ä¸éœ€è¦è§£å†³äº†ï¼Œä½†æ˜¯è¿™ä¸ªé—®é¢˜è®©æˆ‘å¯¹ Linux è¿›ç¨‹çš„å†…å­˜å¸ƒå±€æœ‰äº†æ›´åŠ æ·±åˆ»çš„äº†è§£ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æŠ€æœ¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸€ä¸ªé‚ªæ¶çš„æƒ³æ³•</title>
      <link href="/2022/04/26/an-evil-idea/"/>
      <url>/2022/04/26/an-evil-idea/</url>
      
        <content type="html"><![CDATA[<p>å“ªä¸ªç”·å­©å­å¯ä»¥æŠµå¾¡æœåŠ¡å™¨é›†ç¾¤çš„è¯±æƒ‘å‘¢ï¼Ÿ</p><p>æˆ‘æœ‰å‡ å°æ€§èƒ½åå¼±çš„æœºå™¨ï¼Œå¹¶ä¸”åˆ†æ•£åœ¨ä¸åŒçš„åœ°æ–¹ï¼Œæˆ‘å°±æƒ³ç€å¦‚ä½•åˆ©ç”¨èµ·æ¥è¿™äº›åºŸæ—§è®¾å¤‡ã€‚</p><p>æˆ‘å­¦ä¹ äº†ä¸€ä¸‹ docker swarm å’Œ kubernetesï¼Œå¹¶åŠæˆåŠŸçš„ä½¿ç”¨ docker swarm éƒ¨ç½²äº†ä¸€äº›æœåŠ¡ï¼Œä½†æ˜¯é‡åˆ°äº†ä¸€äº›æ— æ³•å¤„ç†çš„éš¾é¢˜ï¼Œéƒ¨ç½² php æœåŠ¡æ—¶ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œåªèƒ½åœ¨ manager èŠ‚ç‚¹æ‰èƒ½è®¿é—®æ•°æ®åº“ï¼Œå³ä½¿ä¸¤ä¸ªæœåŠ¡éƒ½åœ¨åŒä¸€ä¸ªèŠ‚ç‚¹ä¸Šå·¥ä½œï¼Œè¿™ä¸ªé—®é¢˜å›°æ‰°æˆ‘äº†å¾ˆä¹…ï¼Œä¸€åº¦ä»¥ä¸ºæ˜¯ docker é›†ç¾¤çš„ç½‘ç»œä¸å¤ªè¡Œã€‚</p><p>kubernetes ç”±äºå¤ªè¿‡å¤æ‚ï¼Œæˆ‘ç›®å‰è¿˜å¤„äºå­¦ä¹ çš„çŠ¶æ€ï¼Œæƒ³è¦éƒ¨ç½²ä¸€äº›æœåŠ¡ç”¨ä½œç»ƒä¹ ï¼Œä½†æ˜¯æˆ‘çš„æœºå™¨éƒ½å¤ªåƒåœ¾äº†ï¼Œæƒ³è¦ä½¿ç”¨ kubernetes æœ‰ç‚¹å¤ªå›°éš¾ï¼Œæˆ‘å°±éœ€è¦å¯»æ±‚å…¶ä»–äººçš„å¸®åŠ©ï¼ˆç™½å«–ï¼‰ï¼Œæœ€ç»ˆï¼Œæˆ‘é‡åˆ°äº†æˆ‘çš„å¥½æœ‹å‹ Githubã€‚</p><p>Github æ˜¯ä¸€ä½éå¸¸çƒ­å¿ƒçš„å¥½æœ‹å‹ï¼Œå®ƒçš„å®¶åº•é›„åšï¼Œæ„¿æ„ç»™æˆ‘ä¸€äº›æˆ¿é—´ï¼Œè®©æˆ‘è¿è¡Œä¸€äº›å°çš„ä»»åŠ¡ï¼Œä½†æ˜¯å®ƒä¹Ÿè§„å®šäº†ï¼Œæ¯æ¬¡åªèƒ½ä½¿ç”¨å…­ä¸ªå°æ—¶ï¼Œå¾ˆå¤šæƒ…å†µä¸‹æˆ‘åªæ˜¯ç”¨å®ƒæ¥å¯åŠ¨ä¸€äº›æ£€æŸ¥æˆ–è€…ç¼–è¯‘ä»»åŠ¡ï¼Œæ—¶é—´ä¹Ÿä¸ä¼šå¾ˆé•¿ï¼Œä½†æ˜¯å®ƒæä¾›çš„æˆ¿é—´å®åœ¨æ˜¯å¤ªå¥½äº†ï¼Œä»¥è‡³äºæˆ‘åŠ¨äº†æ­ªè„‘ç­‹ï¼ˆ</p><p>ä¸€ä¸ªé‚ªæ¶çš„è®¡åˆ’åœ¨æˆ‘çš„è„‘æµ·ä¸­é€æ¸æˆå‹ã€‚</p><p>é¦–å…ˆï¼Œä½œä¸ºè®¡åˆ’çš„ç¬¬ä¸€æ­¥ï¼Œæˆ‘éœ€è¦æä¾›ä¸€ä¸ª VPN æœåŠ¡ï¼Œå°†æ‰€æœ‰çš„æœºå™¨éƒ½è”åˆè¿›ä¸€ä¸ªç½‘ç»œã€‚</p><p>ç¬¬äºŒæ­¥ï¼Œæˆ‘éœ€è¦æƒ³åŠæ³•å°† Github action çº³å…¥æˆ‘çš„ç®¡ç†ã€‚</p><p>ç¬¬ä¸‰æ­¥ï¼Œè‡ªåŠ¨æ›´æ¢æˆ¿é—´ï¼Œåˆ©ç”¨é›†ç¾¤çš„è‡ªåŠ¨è¿ç§»è¾¾åˆ°æœåŠ¡æ°¸ä¸åœçš„ç›®çš„ã€‚</p><p>æˆ‘æœ‰ä¸€å°é¦™æ¸¯é˜¿é‡Œäº‘çš„è½»é‡åº”ç”¨æœåŠ¡å™¨ï¼Œå®ƒçš„æ€§èƒ½éå¸¸çš„å¼±ï¼Œç”šè‡³åšæŒä¸äº†ä¸€ä¸ª go buildï¼Œä½†æ˜¯è·‘ VPN å’Œ kubernetes è¿˜æ˜¯è¶³å¤Ÿäº†ã€‚</p><p>æˆ‘éœ€è¦å†™ä¸€ä¸ªå°çš„æœåŠ¡ï¼Œæä¾› VPN é…ç½®æ± ï¼Œæ¯ä¸ª action å¯åŠ¨æ—¶éƒ½ä¼šè¯·æ±‚é…ç½®æ–‡ä»¶ï¼Œä»è€ŒåŠ å…¥é›†ç¾¤ç½‘ç»œã€‚</p><p>å¯åŠ¨çš„ action ä¼šå…ˆè¯·æ±‚ VPN é…ç½®ï¼ŒåŠ å…¥é›†ç¾¤ç½‘ç»œåï¼Œåˆå§‹åŒ– kubernetesã€‚ä½œä¸º node çš„ action åœ¨å¯åŠ¨åä¼šåŠ å…¥åˆ°é›†ç¾¤ä¸­ï¼Œæ¥å—é›†ç¾¤çš„ç®¡ç†ã€‚å¦‚æœæŸä¸ª action å³å°†è¿‡æœŸï¼Œé‚£ä¹ˆ master ä¼šæå‰å¯åŠ¨æ–°çš„ nodeï¼Œå¹¶ç­‰å¾… node è¢«é”€æ¯ï¼Œè§¦å‘é›†ç¾¤çš„ service è‡ªåŠ¨è½¬ç§»ã€‚</p><p>æœ€ç»ˆï¼Œæˆ‘å°±æ‹¥æœ‰äº†ä¸€å¥—æ€§èƒ½éå¸¸å¼ºåŠ²çš„é›†ç¾¤ï¼Œå¯ä»¥åœ¨ä¸Šé¢éƒ¨ç½²å„ç§æœåŠ¡ã€‚</p><p>å½“ç„¶ï¼Œæˆ‘è¿™ä¸ªé‚ªæ¶çš„æƒ³æ³•ï¼Œä¹Ÿä¸€å®šä¼šä¼¤äº†æˆ‘å¥½æœ‹å‹çš„å¿ƒã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> kubernetes </tag>
            
            <tag> Github Action </tag>
            
            <tag> evil </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hello-metal.5 æè´¨è´´å›¾</title>
      <link href="/2022/04/09/hello-metal-5/"/>
      <url>/2022/04/09/hello-metal-5/</url>
      
        <content type="html"><![CDATA[<p>è¿™ä¸ªç³»åˆ—æ˜¯æˆ‘ç”¨æ¥å­¦ä¹  Metal API çš„ç¬”è®°ï¼Œæˆ‘çš„æœ€ç»ˆç›®çš„æ˜¯å¸Œæœ›å®ç°ä¸€ä¸ªåŸºäº Metal çš„æ¸¸æˆå¼•æ“ã€‚</p><p>ç›®å‰ç³»åˆ—æœ‰:</p><a href="/2022/04/04/hello-metal-1/" title="hello-metal.1 çœ‹åˆ°äº†ç»¿è‰²">hello-metal.1 çœ‹åˆ°äº†ç»¿è‰²</a><br><a href="/2022/04/04/hello-metal-2/" title="hello-metal.2 ç¬¬ä¸€ä¸ªä¸‰è§’å½¢">hello-metal.2 ç¬¬ä¸€ä¸ªä¸‰è§’å½¢</a><br><a href="/2022/04/04/hello-metal-3/" title="hello-metal.3 å››è¾¹å½¢">hello-metal.3 å››è¾¹å½¢</a><br><a href="/2022/04/04/hello-metal-4/" title="hello-metal.4 åŠ¨ç”»">hello-metal.4 åŠ¨ç”»</a><br><a href="/2022/04/09/hello-metal-5/" title="hello-metal.5 æè´¨è´´å›¾">hello-metal.5 æè´¨è´´å›¾</a><hr><div><p>ç‚¹å‡»æŸ¥çœ‹ä¸Šä¸€ç¯‡ <a href="/2022/04/04/hello-metal-4/" title="hello-metal.4 åŠ¨ç”»">hello-metal.4 åŠ¨ç”»</a></p><p></div><p>ä¸Šä¸€ç¯‡æˆ‘ä»¬æˆåŠŸçš„ç»˜åˆ¶äº†ä¸€ä¸ªå››è¾¹å½¢ï¼Œå¹¶ä¸”è¿è¡Œäº†ä¸€ä¸ªç®€å•çš„åŠ¨ç”»ï¼Œä»Šå¤©æˆ‘ä»¬æ¥ä¸€èµ·æå®šæè´¨è´´å›¾ã€‚</p><p>åœ¨å‰é¢çš„æ–‡ç« é‡Œå·²ç»ä»‹ç»åˆ°äº†ï¼Œæˆ‘ä»¬é€šè¿‡ä¸¤ä¸ªä¸‰è§’å½¢ç»„åˆæˆäº†ä¸€ä¸ªçŸ©å½¢ï¼Œå¹¶ä¸”ä¸ºæ¯ä¸ªé¡¶ç‚¹éƒ½å¢åŠ åç§»ï¼Œä»¥ä¾¿æˆ‘ä»¬åœ¨å¤–éƒ¨æ§åˆ¶æ¯å¸§ç»˜åˆ¶æ—¶åæ ‡åç§»ã€‚</p><p>åœ¨å‘é€æ•°æ®ç»™ GPU æ—¶ï¼Œåœ¨ CPU ç«¯å‡†å¤‡çš„æ•°æ®ï¼Œå¿…é¡»è®¾å®šå¥½å†…å­˜å¸ƒå±€ï¼Œç„¶ååœ¨ shader ä¸­æ¥å—æ—¶ï¼Œä¹Ÿè¦ä½¿ç”¨ç›¸åŒçš„å†…å­˜å¸ƒå±€ï¼Œå¦åˆ™è¯»å–å°±ä¼šå‡ºç°é—®é¢˜ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬å¾ˆå¤šåœ°æ–¹éƒ½åœ¨è®¡ç®— offset çš„åŸå› ã€‚</p><p>è¿™æ¬¡æˆ‘ä»¬æ‹†åˆ†ä¸‹æ•°æ®ï¼Œå°†åŸæœ¬ä¸€ä¸ª buffer ä¸­çš„é¡¶ç‚¹æ•°æ®ï¼Œæ‹†åˆ†ä¸ºå¤šä¸ª bufferï¼Œä¸€åŒå‘é€ç»™ GPUã€‚</p><h2 id="å¤šæ¡-MTLBuffer"><a href="#å¤šæ¡-MTLBuffer" class="headerlink" title="å¤šæ¡ MTLBuffer"></a>å¤šæ¡ MTLBuffer</h2><p>åœ¨ MTLVertexDescriptor ä¸­æˆ‘ä»¬å¯ä»¥æ·»åŠ å¤šæ¡ attributesï¼Œéœ€è¦æŒ‡å®šä¸€ä¸ªæ–°çš„ bufferIndexï¼Œå› ä¸ºæ¯ä¸€æ¡å±æ€§å¯¹åº”äº†æ–°çš„ MTLBufferã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> vertexDescriptor <span class="operator">=</span> <span class="type">MTLVertexDescriptor</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// position</span></span><br><span class="line">vertexDescriptor.attributes[<span class="number">0</span>].format <span class="operator">=</span> .float3</span><br><span class="line">vertexDescriptor.attributes[<span class="number">0</span>].offset <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">vertexDescriptor.attributes[<span class="number">0</span>].bufferIndex <span class="operator">=</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// color</span></span><br><span class="line">vertexDescriptor.attributes[<span class="number">1</span>].format <span class="operator">=</span> .float4</span><br><span class="line">vertexDescriptor.attributes[<span class="number">1</span>].offset <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">vertexDescriptor.attributes[<span class="number">1</span>].bufferIndex <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line">vertexDescriptor.layouts[<span class="number">0</span>].stride <span class="operator">=</span> <span class="type">MemoryLayout</span>&lt;simd_float4&gt;.stride</span><br><span class="line">vertexDescriptor.layouts[<span class="number">1</span>].stride <span class="operator">=</span> <span class="type">MemoryLayout</span>&lt;simd_float4&gt;.stride</span><br></pre></td></tr></table></figure><p>æ¯æ¡ attributes è®¾ç½®å®Œæ¯•åï¼Œæˆ‘ä»¬è¿˜éœ€è¦æŒ‡å®šä¸‰æ¡å¸ƒå±€ï¼Œå’Œä¹‹å‰çš„æŒ‡ä»¤ç›¸æ¯”ï¼Œç›¸å½“äºæˆ‘ä»¬å°†æ‰€æœ‰æ•°æ®æ”¾åœ¨ä¸€æ¡ bufferä¸­ï¼Œç°åœ¨æˆ‘ä»¬æ‹†åˆ†æˆå¹¶è¡Œçš„æ•°æ®ï¼Œä¸€å—å‘é€ç»™ GPUã€‚</p><img src="/2022/04/09/hello-metal-5/interleaved-attributes.png" class="" title="å†…å­˜å¸ƒå±€"><p>åœ¨è¿™å¼ å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œå†…å­˜å¸ƒå±€æ˜¯ç”± layout å†³å®šçš„ï¼Œæ•°æ®æ˜¯ç”± attributes ç»„æˆã€‚</p><img src="/2022/04/09/hello-metal-5/noninterleaved-attributes.png" class="" title="å¤šæ¡ç¼“å†²åŒº"><p>å¤šæ¡ç¼“å†²åŒºæ˜¯å•æ¡ç¼“å†²åŒºçš„ç»“æ„å¤åˆ¶ï¼Œä¼šå¹¶è¡Œå°†æ•°æ®éƒ½å‘é€åˆ° GPUã€‚</p><img src="/2022/04/09/hello-metal-5/interleaved-noninterleaved-buffers.png" class="" title="å•æ¡å’Œå¤šæ¡ç¼“å†²åŒºå¯¹æ¯”"><p>è®¾ç½®å¥½å†…å­˜å¸ƒå±€ä»¥åï¼Œæˆ‘ä»¬å°±éœ€è¦åˆ›å»ºå¯¹åº”çš„ MTLBuffer æ¥ä¿å­˜ç‹¬ç«‹çš„é¡¶ç‚¹æ•°æ®ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> positionBuffer: <span class="type">MTLBuffer</span>?</span><br><span class="line"><span class="keyword">var</span> colorBuffer: <span class="type">MTLBuffer</span>?</span><br></pre></td></tr></table></figure><p>åœ¨æˆ‘ä»¬çš„ buildModel å‡½æ•°ä¸­å°†æ•°æ®åˆå§‹åŒ–ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line">positionBuffer <span class="operator">=</span> device.makeBuffer(bytes: positionVertices,</span><br><span class="line">                                  length: positionVertices.count <span class="operator">*</span> <span class="type">MemoryLayout</span>&lt;simd_float4&gt;.size,</span><br><span class="line">                                  options: [])</span><br><span class="line">colorBuffer <span class="operator">=</span> device.makeBuffer(bytes: colorVertices,</span><br><span class="line">                                length: colorVertices.count <span class="operator">*</span> <span class="type">MemoryLayout</span>&lt;simd_float4&gt;.size,</span><br><span class="line">                                options: [])</span><br></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬éœ€è¦å°†é¡¶ç‚¹æ•°æ®å‘é€åˆ° GPUï¼Œåœ¨ draw å‡½æ•°ä¸­ï¼Œå°†åŸæœ¬çš„ commandEncoder.setVertexBuffer åˆ é™¤ï¼Œå¹¶ä½¿ç”¨æ–°çš„ MTLBufferï¼Œè€Œä¸”éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œindex å‚æ•°éœ€è¦å’Œ MTLVertexDescriptor ä¸­çš„ index ä¿æŒä¸€è‡´ï¼Œå¦åˆ™å°±æ— æ³•æ­£ç¡®çš„è¯»å–ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line">commandEncoder.setVertexBuffer(positionBuffer,</span><br><span class="line">                                offset: <span class="number">0</span>,</span><br><span class="line">                                index: <span class="number">0</span>)</span><br><span class="line">commandEncoder.setVertexBuffer(colorBuffer,</span><br><span class="line">                                offset: <span class="number">0</span>,</span><br><span class="line">                                index: <span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆæ•°æ®å‘é€åˆ° GPU ä¹‹åï¼Œshader è¦å¦‚ä½•ä½¿ç”¨æ•°æ®å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬éœ€è¦åœ¨ shader ä¸­å¢åŠ ä¸€ä¸ªç»“æ„ä½“ï¼Œå¹¶ä½¿ç”¨ä¸€äº›è¯­æ³•æ ‡è®°ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">struct VertexIn &#123;</span><br><span class="line">    float4 position [[ attribute(0) ]];</span><br><span class="line">    float4 color [[ attribute(1) ]];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">struct VertexOut &#123;</span><br><span class="line">    float4 position [[ position ]];</span><br><span class="line">    float4 color;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><code>[[ attribute(0) ]]</code> çš„æ„æ€å°±æ˜¯ä¸ºäº†å–å¾—å¯¹åº”çš„ attributesã€‚</p><p>è¿˜éœ€è¦ä¿®æ”¹ä¸€ä¸‹é¡¶ç‚¹ç€è‰²å™¨ä»£ç ï¼Œä¼ å…¥ç»“æ„ä½“ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">vertex VertexOut vertex_shader(const VertexIn vertexIn [[ stage_in ]]) &#123;</span><br><span class="line">    VertexOut vertexOut;</span><br><span class="line">    vertexOut.position = vertexIn.position;</span><br><span class="line">    vertexOut.color = vertexIn.color;</span><br><span class="line"></span><br><span class="line">    return vertexOut;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬æ³¨æ„åˆ°ï¼Œå‚æ•°é‡Œæœ‰ä¸€ä¸ª <code>[[ stage_in ]]</code> çš„æ ‡è®°ï¼Œ<code>[[ stage_in ]]</code> å¯ä»¥ä¿®é¥°ç»“æ„ä½“ï¼Œå‚æ•°ä¸­åªå…è®¸æœ‰ä¸€ä¸ªå‚æ•°ä½¿ç”¨è¯¥æ ‡è®°è¿›è¡Œä¿®é¥°ã€‚</p><p>ç”±äºæˆ‘ä»¬çš„é¡¶ç‚¹æ˜¯åŸå§‹ä¿¡æ¯ï¼Œæ‰€ä»¥åªéœ€è¦æ­£å¸¸çš„èµ‹å€¼æ–°çš„ç»“æ„ä½“ï¼Œç„¶åè¿”å›å³å¯ã€‚</p><h2 id="ç»˜åˆ¶æè´¨"><a href="#ç»˜åˆ¶æè´¨" class="headerlink" title="ç»˜åˆ¶æè´¨"></a>ç»˜åˆ¶æè´¨</h2><p>æè´¨è´´å›¾åˆç§°ä¸ºçº¹ç†ï¼Œçº¹ç†ä¹Ÿæœ‰åƒç´ çš„ç§°å‘¼ï¼Œä½†æ˜¯éœ€è¦åŒºåˆ†ä¸€ä¸‹ï¼Œè¿™é‡Œçš„åƒç´ å¹¶ä¸æ˜¯æŒ‡å±å¹•ä¸Šçš„ç‰©ç†åƒç´ ã€‚çº¹ç†ä½¿ç”¨ä¸ä¸€æ ·çš„åæ ‡ç³»ï¼Œå…¶åŸç‚¹åœ¨å·¦ä¸Šè§’ï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨å½’ä¸€åŒ–å°†åæ ‡ç³»å‹ç¼©è‡³ (0.0, 1.0)ï¼Œå½“ç„¶ä¸å¼ºåˆ¶ä½¿ç”¨å½’ä¸€åŒ–åæ ‡ç³»ï¼Œä½†æ˜¯å½“ä½ æƒ³ä½¿ç”¨ä¸åŒåˆ†è¾¨ç‡çš„çº¹ç†æ—¶ï¼Œåªè¦æ˜ å°„å…³ç³»æ­£ç¡®ï¼Œå°±å¯ä»¥æ­£å¸¸å·¥ä½œã€‚</p><p>ç»˜åˆ¶æè´¨éœ€è¦å…ˆè¿›è¡Œé¡¶ç‚¹æ˜ å°„ï¼Œæè´¨çš„åæ ‡ç³»ä¸é¡¶ç‚¹çš„åæ ‡ç³»ä¸ç›¸åŒï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æä¾›ä¸€ç§æ˜ å°„ï¼Œåœ¨æ‰§è¡Œç‰‡å…ƒç€è‰²å™¨æ—¶ï¼Œè·å–åˆ°æŸä¸ªä½ç½®æ­£ç¡®çš„å›¾ç‰‡é¢œè‰²ã€‚</p><h3 id="åæ ‡æ˜ å°„"><a href="#åæ ‡æ˜ å°„" class="headerlink" title="åæ ‡æ˜ å°„"></a>åæ ‡æ˜ å°„</h3><p>æˆ‘ä»¬åœ¨ vertexDescriptor ä¸­å¢åŠ ä¸€æ¡æ–°çš„å±æ€§ï¼Œç”¨æ¥ä¿å­˜æ˜ å°„å…³ç³»ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">// texture</span></span><br><span class="line">vertexDescriptor.attributes[<span class="number">2</span>].format <span class="operator">=</span> .float2</span><br><span class="line">vertexDescriptor.attributes[<span class="number">2</span>].offset <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">vertexDescriptor.attributes[<span class="number">2</span>].bufferIndex <span class="operator">=</span> <span class="number">2</span></span><br><span class="line"></span><br><span class="line">vertexDescriptor.layouts[<span class="number">2</span>].stride <span class="operator">=</span> <span class="type">MemoryLayout</span>&lt;simd_float2&gt;.stride</span><br></pre></td></tr></table></figure><p>åˆ›å»ºæ–°çš„ MTLBufferï¼Œä¿å­˜æ˜ å°„å…³ç³»ã€‚ç”±äºæˆ‘ä»¬åªä½¿ç”¨äº†å››ä¸ªé¡¶ç‚¹ï¼Œä¸¤ä¸ªä¸‰è§’å½¢ç»„æˆäº†çŸ©å½¢ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦å°†å››ä¸ªç‚¹çš„åæ ‡å¯¹åº”èµ·æ¥å°±å¯ä»¥äº†ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line">textureBuffer <span class="operator">=</span> device.makeBuffer(bytes: textureVertices,</span><br><span class="line">                                  length: textureVertices.count <span class="operator">*</span> <span class="type">MemoryLayout</span>&lt;simd_float2&gt;.size,</span><br><span class="line">                                  options: [])</span><br></pre></td></tr></table></figure><p>åœ¨ draw å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬å¢åŠ æ–°çš„é¡¶ç‚¹ä¿¡æ¯ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">commandEncoder.setVertexBuffer(textureBuffer,</span><br><span class="line">                               offset: 0,</span><br><span class="line">                               index: 2)</span><br></pre></td></tr></table></figure><p>åœ¨ shader çš„ç»“æ„ä½“ä¸­å¢åŠ å±æ€§çš„æ¥æ”¶ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">VertexIn</span> &#123;</span><br><span class="line">    float4 position [[ attribute(<span class="number">0</span>) ]];</span><br><span class="line">    float4 color [[ attribute(<span class="number">1</span>) ]];</span><br><span class="line">    float2 textureCoordinates [[ attribute(<span class="number">2</span>) ]];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">VertexOut</span> &#123;</span><br><span class="line">    float4 position [[ position ]];</span><br><span class="line">    float4 color;</span><br><span class="line">    float2 textureCoordinates;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">vertex <span class="type">VertexOut</span> vertex_shader(const <span class="type">VertexIn</span> vertexIn [[ stage_in ]]) &#123;</span><br><span class="line">    <span class="type">VertexOut</span> vertexOut;</span><br><span class="line">    vertexOut.position <span class="operator">=</span> vertexIn.position;</span><br><span class="line">    vertexOut.color <span class="operator">=</span> vertexIn.color;</span><br><span class="line">    vertexOut.textureCoordinates <span class="operator">=</span> vertexIn.textureCoordinates;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> vertexOut;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¯»å–æ–‡ä»¶"><a href="#è¯»å–æ–‡ä»¶" class="headerlink" title="è¯»å–æ–‡ä»¶"></a>è¯»å–æ–‡ä»¶</h3><p>å¥½ï¼Œæˆ‘ä»¬ç°åœ¨å·²ç»æˆåŠŸçš„è®¾ç½®å¥½äº†é¡¶ç‚¹å±æ€§ï¼Œå¯æ˜¯æˆ‘ä»¬è¿˜æ²¡æœ‰è®²å¦‚ä½•è¯»å–æ–‡ä»¶å‘¢ã€‚</p><p>é¦–å…ˆï¼Œåœ¨ Metal ä¸­ï¼Œæè´¨çš„è¯»å–æ˜¯é€šè¿‡ MTKTextureLoader åˆ›å»ºä¸€ä¸ªåŠ è½½å™¨ï¼Œå¯ä»¥ä½¿ç”¨å®ƒæä¾›çš„ newTexture æ–¹æ³•åˆ›å»ºä¸€ä¸ª MTLTexture å¯¹è±¡ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">createTexture</span>(<span class="params">device</span>: <span class="type">MTLDevice</span>, <span class="params">imageName</span>: <span class="type">String</span>) -&gt; <span class="type">MTLTexture</span>? &#123;</span><br><span class="line">    <span class="keyword">let</span> textureLoader <span class="operator">=</span> <span class="type">MTKTextureLoader</span>(device: device)</span><br><span class="line">    <span class="keyword">var</span> texture: <span class="type">MTLTexture</span>? <span class="operator">=</span> <span class="literal">nil</span></span><br><span class="line">    <span class="comment">// change direction</span></span><br><span class="line">    <span class="keyword">let</span> textureLoaderOptions: [<span class="type">MTKTextureLoader</span>.<span class="type">Option</span>: <span class="keyword">Any</span>] <span class="operator">=</span> [.origin: <span class="type">MTKTextureLoader</span>.<span class="type">Origin</span>.bottomLeft]</span><br><span class="line">    <span class="comment">//let textureLoaderOptions: [MTKTextureLoader.Option: Any] = [:]</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> textureURL <span class="operator">=</span> <span class="type">Bundle</span>.main.url(forResource: imageName, withExtension: <span class="literal">nil</span>) &#123;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            texture <span class="operator">=</span> <span class="keyword">try</span> textureLoader.newTexture(URL: textureURL, options: textureLoaderOptions)</span><br><span class="line">        &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;texture not created&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> texture</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘é€šè¿‡ MTKTextureLoader.Option ä¿®æ”¹äº†åæ ‡ç³»çš„æ–¹å‘ï¼Œå°†åŸç‚¹ä»å·¦ä¸Šè§’æ”¹ä¸ºå·¦ä¸‹è§’ï¼ˆç¬¬å››è±¡é™ä½ç½®æ”¹ä¸ºç¬¬ä¸€è±¡é™ï¼‰ï¼Œå¯ä»¥ä¸ç”¨ä¿®æ”¹ï¼Œä»…ä»…æ˜¯ä¸ªäººå–œå¥½ã€‚</p><h3 id="è®¾ç½®é‡‡æ ·"><a href="#è®¾ç½®é‡‡æ ·" class="headerlink" title="è®¾ç½®é‡‡æ ·"></a>è®¾ç½®é‡‡æ ·</h3><p>æ ¹æ®ä¸€èˆ¬çš„æµç¨‹ï¼Œè¿™ä¸ªæ—¶å€™åº”è¯¥ä¼šå…ˆè¯´ç”»å‡ºæ¥ï¼Œç„¶åå‘ç°ç”»é¢æ¯”è¾ƒæ¨¡ç³Šï¼Œè¿™æ—¶å€™æ‰å¼€å§‹è¯´é‡‡æ ·éœ€è¦è°ƒæ•´ã€‚</p><p>æˆ‘ä¸æŒ‰å¥—è·¯ï¼Œæˆ‘å°±æ˜¯è¦å…ˆè®²é‡‡æ ·ï¼Œç•¥ç•¥ç•¥ã€‚</p><p>Metal ä½¿ç”¨ MTLSamplerDescriptor æ¥æ§åˆ¶é‡‡æ ·ï¼Œæˆ‘æ‰ç”¨æœ€åŸºæœ¬çš„çº¿æ€§é‡‡æ ·ã€‚Metal çš„ç€è‰²å™¨å·¥ä½œæµç¨‹æ˜¯ï¼Œå…ˆæ‰§è¡Œé¡¶ç‚¹ç€è‰²å™¨ï¼Œå¤„ç†é¡¶ç‚¹çš„åæ ‡ä¿¡æ¯ï¼Œå†æ‰§è¡Œå…‰æ …åŒ–ï¼Œç¡®å®šåƒç´ è¾¹ç•Œï¼Œè£å‰ªè¶…å‡ºçš„åƒç´ ã€‚å½“å…‰æ …åŒ–ç»“æŸåï¼Œæ‰§è¡Œç‰‡å…ƒç€è‰²å™¨ï¼Œè®¡ç®—æ¯ä¸ªåƒç´ çš„é¢œè‰²ã€‚æˆ‘ä»¬åœ¨ç‰‡å…ƒç€è‰²å™¨ä¸­ä½¿ç”¨æè´¨ï¼Œä¸ºç‰‡å…ƒç€è‰²å™¨ä¼ å…¥æè´¨ã€é¡¶ç‚¹ä¿¡æ¯å’Œé‡‡æ ·å±æ€§ï¼Œå°±å¯ä»¥å®Œæˆåƒç´ é¢œè‰²çš„è¾“å‡ºã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> samplerState: <span class="type">MTLSamplerState</span>?</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">func</span> <span class="title function_">buildSamplerState</span>(<span class="params">device</span>: <span class="type">MTLDevice</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> descriptor <span class="operator">=</span> <span class="type">MTLSamplerDescriptor</span>()</span><br><span class="line">    descriptor.minFilter <span class="operator">=</span> .linear</span><br><span class="line">    descriptor.magFilter <span class="operator">=</span> .linear</span><br><span class="line">    samplerState <span class="operator">=</span> device.makeSamplerState(descriptor: descriptor)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨æ„é€ å‡½æ•°ä¸­æ‰§è¡Œè¯¥å‡½æ•°ï¼Œå°±å¯ä»¥å®Œæˆ MTLSamplerState æ„å»ºã€‚</p><p>ç´§æ¥ç€ï¼Œæˆ‘ä»¬ä¸º MTLCommandEncoder è®¾ç½®ç‰‡å…ƒé‡‡æ ·çŠ¶æ€ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line">commandEncoder.setFragmentSamplerState(node.samplerState, index: <span class="number">0</span>)</span><br></pre></td></tr></table></figure><p>åœ¨ shader ä¸­ä¿®æ”¹ç‰‡å…ƒç€è‰²å™¨ä»£ç ï¼Œä½¿ç”¨ä¸Šé¢è®¾ç½®å¥½çš„å…¨éƒ¨ä¿¡æ¯ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">fragment half4 fragment_shader(VertexOut vertexIn [[ stage_in ]],</span><br><span class="line">                               sampler sampler2d [[ sampler(0) ]],</span><br><span class="line">                               texture2d&lt;float&gt; texture [[ texture(0) ]])</span><br><span class="line">&#123;</span><br><span class="line">    float4 color = texture.sample(sampler2d, vertexIn.textureCoordinates);</span><br><span class="line">    return half4(color.r, color.g, color.b, 1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨å‚æ•°ä¸­ä½¿ç”¨ <code>[[ sampler(0) ]]</code> æ¥è·å–ä¸º MTLCoMTLCommandEncoder è®¾ç½®çš„ samplerState çš„ indexï¼Œ<code>[[ texture(0) ]]</code> è·å– draw å‡½æ•°ä¸­ä¼ å…¥çš„æè´¨ã€‚</p><h3 id="æ¸²æŸ“"><a href="#æ¸²æŸ“" class="headerlink" title="æ¸²æŸ“"></a>æ¸²æŸ“</h3><p>ç»ˆäºåˆ°æœ€åäº†ï¼Œæˆ‘ä»¬å¥½åƒè¿˜æ²¡è¯´ textureVertices åº”è¯¥å­˜ä»€ä¹ˆæ ·çš„æ•°æ®ã€‚æˆ‘ä»¬ç°åœ¨æœ‰å››ä¸ªé¡¶ç‚¹ï¼Œæˆ‘ä»¬çš„çŸ©å½¢æ˜¯ä¸¤ä¸ªä¸‰è§’å½¢ç»„æˆçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„çš„æ•°æ®å°±æ˜¯ï¼Œå››ä¸ªè§’çš„ç‚¹ï¼Œä¸å›¾ç‰‡çš„å››ä¸ªè§’ä¿æŒä¸€è‡´å³å¯ï¼Œæˆ‘å·²ç»å°†æè´¨çš„åæ ‡ç³»åŸç‚¹æ”¹ä¸ºå·¦ä¸‹è§’ï¼Œæ‰€ä»¥æ•°æ®å°±æ˜¯ï¼š</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> textureVertices: [simd_float2] <span class="operator">=</span> [</span><br><span class="line">    simd_float2(<span class="number">0</span>, <span class="number">1</span>), <span class="comment">// å·¦ä¸Šè§’</span></span><br><span class="line">    simd_float2(<span class="number">0</span>, <span class="number">0</span>), <span class="comment">// å·¦ä¸‹è§’ï¼ˆåŸç‚¹ï¼‰</span></span><br><span class="line">    simd_float2(<span class="number">1</span>, <span class="number">0</span>), <span class="comment">// å³ä¸‹è§’</span></span><br><span class="line">    simd_float2(<span class="number">1</span>, <span class="number">1</span>), <span class="comment">// å³ä¸Šè§’</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>å¥½ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº†æ‰€æœ‰çš„å‡†å¤‡å·¥ä½œï¼Œç°åœ¨æ˜¯æ—¶å€™åŠ è½½æˆ‘è€å©†äº†ï¼</p><img src="/2022/04/09/hello-metal-5/laopo.png" class=""><img src="/2022/04/09/hello-metal-5/test.png" class=""><p>ä¹Ÿè®¸ä½ æ³¨æ„åˆ°äº†ï¼Œç…§ç‰‡çœ‹èµ·æ¥ä¼¼ä¹é¥±å’Œåº¦æœ‰ä¸€äº›ä¸å¤ªå¯¹ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬è¿˜æ²¡æœ‰è°ƒæ•´è‰²å½©ç©ºé—´ï¼Œåªæ˜¯ç®€å•çš„è¯»å–äº†åŸå§‹ä¿¡æ¯ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åšä¸€äº›å¤„ç†ï¼Œè¿™å°±ç•™åˆ°ä¸‹ä¸€ç¯‡ç« å§ï½ </p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><blockquote><p><a href="https://developer.apple.com/documentation/metal/mtlvertexdescriptor">https://developer.apple.com/documentation/metal/mtlvertexdescriptor</a><br><a href="https://developer.apple.com/metal/Metal-Shading-Language-Specification.pdf">https://developer.apple.com/metal/Metal-Shading-Language-Specification.pdf</a><br><a href="https://metalbyexample.com/vertex-descriptors/">https://metalbyexample.com/vertex-descriptors/</a><br><a href="https://metalbyexample.com/textures-and-samplers/">https://metalbyexample.com/textures-and-samplers/</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> HelloMetalç³»åˆ— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Metal </tag>
            
            <tag> GameEngine </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hello-metal.4 åŠ¨ç”»</title>
      <link href="/2022/04/04/hello-metal-4/"/>
      <url>/2022/04/04/hello-metal-4/</url>
      
        <content type="html"><![CDATA[<p>è¿™ä¸ªç³»åˆ—æ˜¯æˆ‘ç”¨æ¥å­¦ä¹  Metal API çš„ç¬”è®°ï¼Œæˆ‘çš„æœ€ç»ˆç›®çš„æ˜¯å¸Œæœ›å®ç°ä¸€ä¸ªåŸºäº Metal çš„æ¸¸æˆå¼•æ“ã€‚</p><p>ç›®å‰ç³»åˆ—æœ‰:</p><a href="/2022/04/04/hello-metal-1/" title="hello-metal.1 çœ‹åˆ°äº†ç»¿è‰²">hello-metal.1 çœ‹åˆ°äº†ç»¿è‰²</a><br><a href="/2022/04/04/hello-metal-2/" title="hello-metal.2 ç¬¬ä¸€ä¸ªä¸‰è§’å½¢">hello-metal.2 ç¬¬ä¸€ä¸ªä¸‰è§’å½¢</a><br><a href="/2022/04/04/hello-metal-3/" title="hello-metal.3 å››è¾¹å½¢">hello-metal.3 å››è¾¹å½¢</a><br><a href="/2022/04/04/hello-metal-4/" title="hello-metal.4 åŠ¨ç”»">hello-metal.4 åŠ¨ç”»</a><br><a href="/2022/04/09/hello-metal-5/" title="hello-metal.5 æè´¨è´´å›¾">hello-metal.5 æè´¨è´´å›¾</a><hr><div><p>ç‚¹å‡»æŸ¥çœ‹ä¸Šä¸€ç¯‡ <a href="/2022/04/04/hello-metal-3/" title="hello-metal.3 å››è¾¹å½¢">hello-metal.3 å››è¾¹å½¢</a></p><p></div><p>åœ¨ä¸Šä¸€ç¯‡å·²ç»å®Œæˆäº†å››è¾¹å½¢çš„ç»˜åˆ¶ï¼Œè¿™ä¸€ç¯‡æˆ‘ä»¬æ¥å®ç°ä¸€ä¸ªç®€å•çš„åŠ¨ç”»æ•ˆæœã€‚</p><h2 id="åŠ¨èµ·æ¥"><a href="#åŠ¨èµ·æ¥" class="headerlink" title="åŠ¨èµ·æ¥"></a>åŠ¨èµ·æ¥</h2><p>ç°åœ¨æˆ‘ä»¬éœ€è¦å¢åŠ ä¸€ä¸ªç»“æ„ä½“ï¼Œç”¨æ¥ä¿å­˜ç”»é¢çš„åç§»ï¼Œè¿™æ ·æ¯æ¬¡ç”»é¢æ›´æ–°çš„æ—¶å€™ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥ä½¿ç”¨åç§»æ¥æ§åˆ¶é¡¶ç‚¹çš„åæ ‡ï¼Œè¾¾åˆ°åŠ¨ç”»çš„æ•ˆæœã€‚</p><h3 id="å¢åŠ å­˜å‚¨æ•°æ®çš„ç»“æ„ä½“"><a href="#å¢åŠ å­˜å‚¨æ•°æ®çš„ç»“æ„ä½“" class="headerlink" title="å¢åŠ å­˜å‚¨æ•°æ®çš„ç»“æ„ä½“"></a>å¢åŠ å­˜å‚¨æ•°æ®çš„ç»“æ„ä½“</h3><p>åœ¨ Renderer ä¸­å¢åŠ ä¸€ä¸ªç»“æ„ä½“ï¼Œç”¨æ¥ä¿å­˜åŠ¨ç”»çš„å€¼ï¼Œå¢åŠ ä¸€ä¸ª Float ç±»å‹çš„å˜é‡ï¼Œä¿å­˜æ¯å¸§æ—¶é—´ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Constants</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> animateBy: <span class="type">Float</span> <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> constants <span class="operator">=</span> <span class="type">Constants</span>()</span><br><span class="line"><span class="keyword">var</span> time: <span class="type">Float</span> <span class="operator">=</span> <span class="number">0</span></span><br></pre></td></tr></table></figure><h3 id="è®¡ç®—æ¯å¸§ç§»åŠ¨çš„è·ç¦»"><a href="#è®¡ç®—æ¯å¸§ç§»åŠ¨çš„è·ç¦»" class="headerlink" title="è®¡ç®—æ¯å¸§ç§»åŠ¨çš„è·ç¦»"></a>è®¡ç®—æ¯å¸§ç§»åŠ¨çš„è·ç¦»</h3><p>åœ¨ draw å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ç”»é¢çš„æœ€ä½³åˆ·æ–°ç‡ä½œä¸ºç´¯åŠ å€¼ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line">time <span class="operator">+=</span> <span class="number">1</span> <span class="operator">/</span> <span class="type">Float</span>(view.preferredFramesPerSecond)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> animateBy <span class="operator">=</span> <span class="built_in">abs</span>(sin(time) <span class="operator">/</span> <span class="number">2</span> <span class="operator">+</span> <span class="number">0.5</span>)</span><br><span class="line">constants.animateBy <span class="operator">=</span> animateBy</span><br></pre></td></tr></table></figure><h3 id="å‘é€æ•°æ®åˆ°-GPU"><a href="#å‘é€æ•°æ®åˆ°-GPU" class="headerlink" title="å‘é€æ•°æ®åˆ° GPU"></a>å‘é€æ•°æ®åˆ° GPU</h3><p>ç„¶åæˆ‘ä»¬å°†ç»“æ„ä½“æ”¾è¿› GPU ä¸­ï¼ŒMTLCommandEncoder æä¾›äº† setVertexBytes å‡½æ•°æ¥ä¿å­˜æ•°æ®ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line">commandEncoder<span class="operator">?</span>.setVertexBytes(<span class="operator">&amp;</span>constants,</span><br><span class="line">                               length: <span class="type">MemoryLayout</span>&lt;<span class="type">Constants</span>&gt;.stride,</span><br><span class="line">                               index: <span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ä¸ºè¿™ä¸ªæ•°æ®è®¾ç½®ä¸€ä¸ªç´¢å¼•å€¼ 1ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨ç€è‰²å™¨ä»£ç ä¸­è®¿é—®äº†ã€‚</p><h3 id="ä¿®æ”¹ç€è‰²å™¨"><a href="#ä¿®æ”¹ç€è‰²å™¨" class="headerlink" title="ä¿®æ”¹ç€è‰²å™¨"></a>ä¿®æ”¹ç€è‰²å™¨</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Constants</span> &#123;</span><br><span class="line">    <span class="type">float</span> animateBy;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function">vertex float4 <span class="title">vertex_shader</span><span class="params">(<span class="type">const</span> device packed_float3 *vertices [[ buffer(<span class="number">0</span>) ]],</span></span></span><br><span class="line"><span class="params"><span class="function">                            constant Constants &amp;constants [[ buffer(<span class="number">1</span>) ]],</span></span></span><br><span class="line"><span class="params"><span class="function">                            uint vertexId [[ vertex_id ]])</span> </span>&#123;</span><br><span class="line">    float4 position = <span class="built_in">float4</span>(vertices[vertexId], <span class="number">1</span>);</span><br><span class="line">    position.x += constants.animateBy;</span><br><span class="line">    <span class="keyword">return</span> position;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬åªéœ€è¦åœ¨ç€è‰²å™¨ä»£ç ä¸­å¢åŠ ä¸€ä¸ª structï¼Œä¿æŒç›¸åŒçš„å†…å­˜å¸ƒå±€ï¼Œç„¶ååœ¨å‡½æ•°å‚æ•°ä¸­ä½¿ç”¨ <code>constant</code> ä¿®é¥°ç»“æ„ä½“å’Œbufferã€‚</p><p><code>const</code> å’Œ <code>constant</code> çš„ä¸åŒåœ¨äºï¼Œ<code>constant</code> æ˜¯åœ°å€ç©ºé—´ï¼Œ<code>const</code> æ˜¯ç±»å‹é™å®šç¬¦ã€‚</p><p>ç°åœ¨æˆ‘ä»¬å†è·‘ä¸€ä¸‹ï¼Œå°±å¯ä»¥çœ‹åˆ°ä¸€ä¸ªåŠ¨ç”»æ•ˆæœäº†ã€‚</p><div style="position: relative; width: 100%; height: 0; padding-bottom: 75%;"><iframe src="//player.bilibili.com/player.html?bvid=BV1e34y1x7qz" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position: absolute; width: 100%; height: 100%; Left: 0; top: 0;" ></iframe></div><h2 id="å®Œæ•´ä»£ç "><a href="#å®Œæ•´ä»£ç " class="headerlink" title="å®Œæ•´ä»£ç "></a>å®Œæ•´ä»£ç </h2><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Renderer.swift</span></span><br><span class="line"><span class="comment">//  HelloMetal</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by lxz on 2022/4/4.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> MetalKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">Colors</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">let</span> wenderlichGreen <span class="operator">=</span> <span class="type">MTLClearColor</span>(red: <span class="number">0.0</span>,</span><br><span class="line">                                               green: <span class="number">0.4</span>,</span><br><span class="line">                                               blue: <span class="number">0.21</span>,</span><br><span class="line">                                               alpha: <span class="number">1.0</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Renderer</span>: <span class="title class_ inherited__">NSObject</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> device: <span class="type">MTLDevice</span></span><br><span class="line">    <span class="keyword">let</span> commandQueue: <span class="type">MTLCommandQueue</span></span><br><span class="line">    <span class="keyword">var</span> vertices: [<span class="type">Float</span>] <span class="operator">=</span> [</span><br><span class="line">        <span class="operator">-</span><span class="number">1</span>,  <span class="number">1</span>, <span class="number">0</span>, <span class="comment">// å·¦ä¸Šè§’</span></span><br><span class="line">        <span class="operator">-</span><span class="number">1</span>, <span class="operator">-</span><span class="number">1</span>, <span class="number">0</span>, <span class="comment">// å·¦ä¸‹è§’</span></span><br><span class="line">         <span class="number">1</span>, <span class="operator">-</span><span class="number">1</span>, <span class="number">0</span>, <span class="comment">// å³ä¸‹è§’</span></span><br><span class="line">         <span class="number">1</span>,  <span class="number">1</span>, <span class="number">0</span>, <span class="comment">// å³ä¸Šè§’</span></span><br><span class="line">    ]</span><br><span class="line">    <span class="keyword">let</span> indices: [<span class="type">UInt16</span>] <span class="operator">=</span> [</span><br><span class="line">        <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="comment">// å·¦è¾¹çš„ä¸‰è§’å½¢</span></span><br><span class="line">        <span class="number">2</span>, <span class="number">3</span>, <span class="number">0</span>  <span class="comment">// å³è¾¹çš„ä¸‰è§’å½¢</span></span><br><span class="line">    ]</span><br><span class="line">    <span class="keyword">var</span> pipelineState: <span class="type">MTLRenderPipelineState</span>?</span><br><span class="line">    <span class="keyword">var</span> vertexBuffer: <span class="type">MTLBuffer</span>?</span><br><span class="line">    <span class="keyword">var</span> indexBuffer: <span class="type">MTLBuffer</span>?</span><br><span class="line"></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Constants</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> animateBy: <span class="type">Float</span> <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> constants <span class="operator">=</span> <span class="type">Constants</span>()</span><br><span class="line">    <span class="keyword">var</span> time: <span class="type">Float</span> <span class="operator">=</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(<span class="params">device</span>: <span class="type">MTLDevice</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.device <span class="operator">=</span> device</span><br><span class="line">        commandQueue <span class="operator">=</span> device.makeCommandQueue()<span class="operator">!</span></span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>()</span><br><span class="line">        buildModel()</span><br><span class="line">        buildPipelineState()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">func</span> <span class="title function_">buildModel</span>() &#123;</span><br><span class="line">        vertexBuffer <span class="operator">=</span> device.makeBuffer(bytes: vertices,</span><br><span class="line">                                         length: vertices.count <span class="operator">*</span> <span class="type">MemoryLayout</span>&lt;<span class="type">Float</span>&gt;.size,</span><br><span class="line">                                         options: [])</span><br><span class="line">        indexBuffer <span class="operator">=</span> device.makeBuffer(bytes: indices,</span><br><span class="line">                                        length: indices.count <span class="operator">*</span> <span class="type">MemoryLayout</span>&lt;<span class="type">UInt16</span>&gt;.size,</span><br><span class="line">                                        options: [])</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">func</span> <span class="title function_">buildPipelineState</span>() &#123;</span><br><span class="line">        <span class="keyword">let</span> library <span class="operator">=</span> device.makeDefaultLibrary()</span><br><span class="line">        <span class="keyword">let</span> vertexFunction <span class="operator">=</span> library<span class="operator">?</span>.makeFunction(name: <span class="string">&quot;vertex_shader&quot;</span>)</span><br><span class="line">        <span class="keyword">let</span> fragmentFunction <span class="operator">=</span> library<span class="operator">?</span>.makeFunction(name: <span class="string">&quot;fragment_shader&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> pipelineDescriptor <span class="operator">=</span> <span class="type">MTLRenderPipelineDescriptor</span>()</span><br><span class="line">        pipelineDescriptor.vertexFunction <span class="operator">=</span> vertexFunction</span><br><span class="line">        pipelineDescriptor.fragmentFunction <span class="operator">=</span> fragmentFunction</span><br><span class="line">        pipelineDescriptor.colorAttachments[<span class="number">0</span>].pixelFormat <span class="operator">=</span> .bgra8Unorm</span><br><span class="line"></span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            pipelineState <span class="operator">=</span> <span class="keyword">try</span> device.makeRenderPipelineState(descriptor: pipelineDescriptor)</span><br><span class="line">        &#125; <span class="keyword">catch</span> <span class="keyword">let</span> error <span class="keyword">as</span> <span class="type">NSError</span> &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;error: <span class="subst">\(error.localizedDescription)</span>&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">Renderer</span>: <span class="title class_ inherited__">MTKViewDelegate</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">mtkView</span>(<span class="keyword">_</span> <span class="params">view</span>: <span class="type">MTKView</span>, <span class="params">drawableSizeWillChange</span> <span class="params">size</span>: <span class="type">CGSize</span>) &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">draw</span>(<span class="params">in</span> <span class="params">view</span>: <span class="type">MTKView</span>) &#123;</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> drawable <span class="operator">=</span> view.currentDrawable,</span><br><span class="line">              <span class="keyword">let</span> pipelineState <span class="operator">=</span> pipelineState,</span><br><span class="line">              <span class="keyword">let</span> indexBuffer <span class="operator">=</span> indexBuffer,</span><br><span class="line">              <span class="keyword">let</span> descriptor <span class="operator">=</span> view.currentRenderPassDescriptor</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        time <span class="operator">+=</span> <span class="number">1</span> <span class="operator">/</span> <span class="type">Float</span>(view.preferredFramesPerSecond)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> animateBy <span class="operator">=</span> <span class="built_in">abs</span>(sin(time) <span class="operator">/</span> <span class="number">2</span> <span class="operator">+</span> <span class="number">0.5</span>)</span><br><span class="line">        constants.animateBy <span class="operator">=</span> animateBy</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> commandBuffer <span class="operator">=</span> commandQueue.makeCommandBuffer()</span><br><span class="line">        <span class="keyword">let</span> commandEncoder <span class="operator">=</span> commandBuffer<span class="operator">?</span>.makeRenderCommandEncoder(descriptor: view.currentRenderPassDescriptor<span class="operator">!</span>)</span><br><span class="line"></span><br><span class="line">        commandEncoder<span class="operator">?</span>.setRenderPipelineState(pipelineState)</span><br><span class="line">        commandEncoder<span class="operator">?</span>.setVertexBuffer(vertexBuffer,</span><br><span class="line">                                        offset: <span class="number">0</span>,</span><br><span class="line">                                        index: <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">        commandEncoder<span class="operator">?</span>.setVertexBytes(<span class="operator">&amp;</span>constants,</span><br><span class="line">                                       length: <span class="type">MemoryLayout</span>&lt;<span class="type">Constants</span>&gt;.stride,</span><br><span class="line">                                       index: <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        commandEncoder<span class="operator">?</span>.drawIndexedPrimitives(type: .triangle,</span><br><span class="line">                                              indexCount: indices.count,</span><br><span class="line">                                              indexType: .uint16,</span><br><span class="line">                                              indexBuffer: indexBuffer,</span><br><span class="line">                                              indexBufferOffset: <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">        commandEncoder<span class="operator">?</span>.endEncoding()</span><br><span class="line">        commandBuffer<span class="operator">?</span>.present(view.currentDrawable<span class="operator">!</span>)</span><br><span class="line">        commandBuffer<span class="operator">?</span>.commit()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Shader.metal</span></span><br><span class="line"><span class="comment">//  HelloMetal</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by lxz on 2022/4/4.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;metal_stdlib&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> metal;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Constants</span> &#123;</span><br><span class="line">    <span class="type">float</span> animateBy;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function">vertex float4 <span class="title">vertex_shader</span><span class="params">(<span class="type">const</span> device packed_float3 *vertices [[ buffer(<span class="number">0</span>) ]],</span></span></span><br><span class="line"><span class="params"><span class="function">                            constant Constants &amp;constants [[ buffer(<span class="number">1</span>) ]],</span></span></span><br><span class="line"><span class="params"><span class="function">                            uint vertexId [[ vertex_id ]])</span> </span>&#123;</span><br><span class="line">    float4 position = <span class="built_in">float4</span>(vertices[vertexId], <span class="number">1</span>);</span><br><span class="line">    position.x += constants.animateBy;</span><br><span class="line">    <span class="keyword">return</span> position;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">fragment half4 <span class="title">fragment_shader</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">half4</span>(<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  ViewController.swift</span></span><br><span class="line"><span class="comment">//  HelloMetal</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by lxz on 2022/4/4.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"><span class="keyword">import</span> MetalKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ViewController</span>: <span class="title class_ inherited__">UIViewController</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> metalView: <span class="type">MTKView</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> view <span class="keyword">as!</span> <span class="type">MTKView</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> renderer: <span class="type">Renderer</span>!</span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">func</span> <span class="title function_">viewDidLoad</span>() &#123;</span><br><span class="line">        <span class="keyword">super</span>.viewDidLoad()</span><br><span class="line">        metalView.device <span class="operator">=</span> <span class="type">MTLCreateSystemDefaultDevice</span>()</span><br><span class="line">        metalView.clearColor <span class="operator">=</span> <span class="type">Colors</span>.wenderlichGreen</span><br><span class="line">        renderer <span class="operator">=</span> <span class="type">Renderer</span>(device: metalView.device<span class="operator">!</span>)</span><br><span class="line">        metalView.delegate <span class="operator">=</span> renderer</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> HelloMetalç³»åˆ— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Metal </tag>
            
            <tag> GameEngine </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hello-metal.3 å››è¾¹å½¢</title>
      <link href="/2022/04/04/hello-metal-3/"/>
      <url>/2022/04/04/hello-metal-3/</url>
      
        <content type="html"><![CDATA[<p>è¿™ä¸ªç³»åˆ—æ˜¯æˆ‘ç”¨æ¥å­¦ä¹  Metal API çš„ç¬”è®°ï¼Œæˆ‘çš„æœ€ç»ˆç›®çš„æ˜¯å¸Œæœ›å®ç°ä¸€ä¸ªåŸºäº Metal çš„æ¸¸æˆå¼•æ“ã€‚</p><p>ç›®å‰ç³»åˆ—æœ‰:</p><a href="/2022/04/04/hello-metal-1/" title="hello-metal.1 çœ‹åˆ°äº†ç»¿è‰²">hello-metal.1 çœ‹åˆ°äº†ç»¿è‰²</a><br><a href="/2022/04/04/hello-metal-2/" title="hello-metal.2 ç¬¬ä¸€ä¸ªä¸‰è§’å½¢">hello-metal.2 ç¬¬ä¸€ä¸ªä¸‰è§’å½¢</a><br><a href="/2022/04/04/hello-metal-3/" title="hello-metal.3 å››è¾¹å½¢">hello-metal.3 å››è¾¹å½¢</a><br><a href="/2022/04/04/hello-metal-4/" title="hello-metal.4 åŠ¨ç”»">hello-metal.4 åŠ¨ç”»</a><br><a href="/2022/04/09/hello-metal-5/" title="hello-metal.5 æè´¨è´´å›¾">hello-metal.5 æè´¨è´´å›¾</a><hr><div><p>ç‚¹å‡»æŸ¥çœ‹ä¸Šä¸€ç¯‡ <a href="/2022/04/04/hello-metal-2/" title="hello-metal.2 ç¬¬ä¸€ä¸ªä¸‰è§’å½¢">hello-metal.2 ç¬¬ä¸€ä¸ªä¸‰è§’å½¢</a></p><p></div><p>ä¸Šä¸€ç¯‡æ–‡ç« å…¶å®å·²ç»æŠŠåŸºç¡€å†…å®¹è®²å®Œäº†ï¼Œæˆ‘ä»¬å·²ç»æŠŠç»˜åˆ¶çš„æµç¨‹èµ°é€šäº†ï¼Œè¿™ç¯‡æ–‡ç« ä¼šè¯´ä¸€ä¸‹å¦‚ä½•ç»˜åˆ¶ä¸€ä¸ªå››è¾¹å½¢ã€‚</p><h2 id="é‡æ„ä»£ç "><a href="#é‡æ„ä»£ç " class="headerlink" title="é‡æ„ä»£ç "></a>é‡æ„ä»£ç </h2><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦ç¨å¾®é‡æ„ä¸€ä¸‹ä»£ç ï¼Œç°åœ¨çš„ä»£ç éƒ½è€¦åˆåœ¨ä¸€ä¸ªå‡½æ•°é‡Œï¼Œè¿™å¯¹æˆ‘ä»¬éå¸¸çš„ä¸å¥½ï¼Œæˆ‘ä»¬æŠ½å‡ºæ¥ä¸€ä¸ª Renderer çš„æ–‡ä»¶ï¼Œä¸“é—¨å­˜æ”¾ç»˜åˆ¶ä»£ç ã€‚</p><p>é¦–å…ˆåŸºäº NSObject æ´¾ç”Ÿå‡º Renderer ç±»ï¼Œå°†å„ç§æˆå‘˜å˜é‡éƒ½è½¬ç§»åˆ°è¿™é‡Œï¼Œå¹¶åœ¨åœ¨æ„é€ å‡½æ•°æ¥å—æœ€é‡è¦çš„ MTLDevice å¯¹è±¡ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Renderer.swift</span></span><br><span class="line"><span class="comment">//  HelloMetal</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by lxz on 2022/4/4.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> MetalKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">Colors</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">let</span> wenderlichGreen <span class="operator">=</span> <span class="type">MTLClearColor</span>(red: <span class="number">0.0</span>,</span><br><span class="line">                                               green: <span class="number">0.4</span>,</span><br><span class="line">                                               blue: <span class="number">0.21</span>,</span><br><span class="line">                                               alpha: <span class="number">1.0</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Renderer</span>: <span class="title class_ inherited__">NSObject</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> device: <span class="type">MTLDevice</span></span><br><span class="line">    <span class="keyword">let</span> commandQueue: <span class="type">MTLCommandQueue</span></span><br><span class="line">    <span class="keyword">var</span> vertices: [<span class="type">Float</span>] <span class="operator">=</span> [</span><br><span class="line">        <span class="number">0</span>,  <span class="number">1</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="operator">-</span><span class="number">1</span>, <span class="operator">-</span><span class="number">1</span>, <span class="number">0</span>,</span><br><span class="line">        <span class="number">1</span>, <span class="operator">-</span><span class="number">1</span>, <span class="number">0</span></span><br><span class="line">    ]</span><br><span class="line">    <span class="keyword">var</span> pipelineState: <span class="type">MTLRenderPipelineState</span>?</span><br><span class="line">    <span class="keyword">var</span> vertexBuffer: <span class="type">MTLBuffer</span>?</span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(<span class="params">device</span>: <span class="type">MTLDevice</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.device <span class="operator">=</span> device</span><br><span class="line">        commandQueue <span class="operator">=</span> device.makeCommandQueue()<span class="operator">!</span></span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>()</span><br><span class="line">        buildModel()</span><br><span class="line">        buildPipelineState()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">func</span> <span class="title function_">buildModel</span>() &#123;</span><br><span class="line">        vertexBuffer <span class="operator">=</span> device.makeBuffer(bytes: vertices,</span><br><span class="line">                                         length: vertices.count <span class="operator">*</span> <span class="type">MemoryLayout</span>&lt;<span class="type">Float</span>&gt;.size,</span><br><span class="line">                                         options: [])</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">func</span> <span class="title function_">buildPipelineState</span>() &#123;</span><br><span class="line">        <span class="keyword">let</span> library <span class="operator">=</span> device.makeDefaultLibrary()</span><br><span class="line">        <span class="keyword">let</span> vertexFunction <span class="operator">=</span> library<span class="operator">?</span>.makeFunction(name: <span class="string">&quot;vertex_shader&quot;</span>)</span><br><span class="line">        <span class="keyword">let</span> fragmentFunction <span class="operator">=</span> library<span class="operator">?</span>.makeFunction(name: <span class="string">&quot;fragment_shader&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> pipelineDescriptor <span class="operator">=</span> <span class="type">MTLRenderPipelineDescriptor</span>()</span><br><span class="line">        pipelineDescriptor.vertexFunction <span class="operator">=</span> vertexFunction</span><br><span class="line">        pipelineDescriptor.fragmentFunction <span class="operator">=</span> fragmentFunction</span><br><span class="line">        pipelineDescriptor.colorAttachments[<span class="number">0</span>].pixelFormat <span class="operator">=</span> .bgra8Unorm</span><br><span class="line"></span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            pipelineState <span class="operator">=</span> <span class="keyword">try</span> device.makeRenderPipelineState(descriptor: pipelineDescriptor)</span><br><span class="line">        &#125; <span class="keyword">catch</span> <span class="keyword">let</span> error <span class="keyword">as</span> <span class="type">NSError</span> &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;error: <span class="subst">\(error.localizedDescription)</span>&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬æŠŠæ‰€æœ‰çš„ä»£ç éƒ½è½¬ç§»åˆ°æ–°çš„ç±»ä¸­ï¼Œåªéœ€è¦åœ¨ ViewController ä¸­ä¿ç•™ Renderer å¯¹è±¡å°±å¯ä»¥äº†ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  ViewController.swift</span></span><br><span class="line"><span class="comment">//  HelloMetal</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by lxz on 2022/4/4.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"><span class="keyword">import</span> MetalKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ViewController</span>: <span class="title class_ inherited__">UIViewController</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> metalView: <span class="type">MTKView</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> view <span class="keyword">as!</span> <span class="type">MTKView</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> renderer: <span class="type">Renderer</span>!</span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">func</span> <span class="title function_">viewDidLoad</span>() &#123;</span><br><span class="line">        <span class="keyword">super</span>.viewDidLoad()</span><br><span class="line">        metalView.device <span class="operator">=</span> <span class="type">MTLCreateSystemDefaultDevice</span>()</span><br><span class="line">        metalView.clearColor <span class="operator">=</span> <span class="type">Colors</span>.wenderlichGreen</span><br><span class="line">        renderer <span class="operator">=</span> <span class="type">Renderer</span>(device: metalView.device<span class="operator">!</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>metalView æ”¯æŒ delegateï¼Œæˆ‘ä»¬å¯ä»¥è®© Renderer æ´¾ç”Ÿè‡ª MTKViewDelegateï¼Œå°±å¯ä»¥å°†åŸæœ¬ç»˜åˆ¶ä¸‰è§’å½¢éƒ¨åˆ†çš„ä»£ç è½¬ç§»åˆ° draw å‡½æ•°ä¸­ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">extension</span> <span class="title class_">Renderer</span>: <span class="title class_ inherited__">MTKViewDelegate</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">mtkView</span>(<span class="keyword">_</span> <span class="params">view</span>: <span class="type">MTKView</span>, <span class="params">drawableSizeWillChange</span> <span class="params">size</span>: <span class="type">CGSize</span>) &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">draw</span>(<span class="params">in</span> <span class="params">view</span>: <span class="type">MTKView</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> commandBuffer <span class="operator">=</span> commandQueue.makeCommandBuffer()</span><br><span class="line">        <span class="keyword">let</span> commandEncoder <span class="operator">=</span> commandBuffer<span class="operator">?</span>.makeRenderCommandEncoder(descriptor: view.currentRenderPassDescriptor<span class="operator">!</span>)</span><br><span class="line"></span><br><span class="line">        commandEncoder<span class="operator">?</span>.setRenderPipelineState(pipelineState<span class="operator">!</span>)</span><br><span class="line">        commandEncoder<span class="operator">?</span>.setVertexBuffer(vertexBuffer,</span><br><span class="line">                                        offset: <span class="number">0</span>,</span><br><span class="line">                                        index: <span class="number">0</span>)</span><br><span class="line">        commandEncoder<span class="operator">?</span>.drawPrimitives(type: .triangle,</span><br><span class="line">                                       vertexStart: <span class="number">0</span>,</span><br><span class="line">                                       vertexCount: vertices.count)</span><br><span class="line"></span><br><span class="line">        commandEncoder<span class="operator">?</span>.endEncoding()</span><br><span class="line">        commandBuffer<span class="operator">?</span>.present(view.currentDrawable<span class="operator">!</span>)</span><br><span class="line">        commandBuffer<span class="operator">?</span>.commit()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å›åˆ° ViewController.swift ä¸­ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ viewDidLoad å‡½æ•°ä¸­å°† metalView çš„ delegate è®¾ç½®ä¸º rendererã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line">metalView.delegate <span class="operator">=</span> renderer</span><br></pre></td></tr></table></figure><p>swift æä¾›ä¸€ä¸ª guard çš„è¯­æ³•ï¼Œå¯ä»¥æ–¹ä¾¿çš„è¿›è¡Œä¸€äº›æ£€æŸ¥ï¼Œå¯ä»¥æŠŠ draw é‡Œä¸€å®šå­˜åœ¨çš„å˜é‡ç»Ÿä¸€æ£€æŸ¥ï¼Œå¦‚æœä»»ä½•ä¸€ä¸ªä¸å­˜åœ¨ï¼Œéƒ½ä¼šè¿è¡Œåˆ° else ä¸­ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">guard</span> <span class="keyword">let</span> drawable <span class="operator">=</span> view.currentDrawable,</span><br><span class="line">      <span class="keyword">let</span> pipelineState <span class="operator">=</span> pipelineState,</span><br><span class="line">      <span class="keyword">let</span> descriptor <span class="operator">=</span> view.currentRenderPassDescriptor</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="é¡¶ç‚¹ç´¢å¼•"><a href="#é¡¶ç‚¹ç´¢å¼•" class="headerlink" title="é¡¶ç‚¹ç´¢å¼•"></a>é¡¶ç‚¹ç´¢å¼•</h2><p>åœ¨ä¸Šä¸€ç¯‡è®²è¿‡ï¼Œé¡¶ç‚¹æ•°ç»„éœ€è¦å¤„ç†æˆé¡¶ç‚¹ç¼“å†²åŒºï¼Œå¦‚æœæˆ‘ä»¬å‡†å¤‡ç”»ä¸€ä¸ªå››è¾¹å½¢ï¼Œæ­£å¸¸æ¥è¯´æˆ‘ä»¬éœ€è¦å‡†å¤‡ä¸¤ä»½ä¸‰è§’å½¢çš„åæ ‡ï¼Œä½†æ˜¯ï¼æ³¨æ„äº†ï¼Œä½†æ˜¯å•Šï¼ç”±äºä¸¤ä¸ªä¸‰è§’å½¢çš„æ–œè¾¹å…¶å®æ˜¯åŒä¸€æ¡ï¼Œé‚£ä¹ˆæ„å‘³ç€ä¸¤ä¸ªä¸‰è§’å½¢çš„ä¸¤ä¸ªé¡¶ç‚¹ï¼Œå…¶å®åæ ‡æ˜¯ä¸€æ ·çš„ï¼Œä»–ä»¬æ˜¯é‡å¤çš„ï¼Œå¦‚æœæˆ‘ä»¬å®Œæ•´çš„å‘é€äº†å…¨éƒ¨é¡¶ç‚¹ä¿¡æ¯ï¼Œè™½ç„¶å¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼Œä½†æ˜¯æ•°æ®é‡æ¯”è¾ƒå¤§çš„æ—¶å€™ï¼Œå°±ä¼šæµªè´¹æ›´å¤šçš„èµ„æºã€‚</p><p>ä¸€ä¸ªæ¨¡å‹é€šå¸¸ç”±ä¸Šä¸‡ä¸ªä¸‰è§’å½¢ç»„æˆï¼Œæ¯ä¸¤ä¸ªä¸‰è§’å½¢éƒ½ä¼šæµªè´¹ä¸¤ä¸ªé¡¶ç‚¹ï¼Œé‚£ä¹ˆæµªè´¹æ‰çš„ç©ºé—´å°±ä¸èƒ½å¿½ç•¥äº†ï¼Œæ‰€ä»¥ Metalã€OpenGL è¿™äº› API éƒ½æä¾›äº†é¡¶ç‚¹ç´¢å¼•åŠŸèƒ½ï¼Œæˆ‘ä»¬åªéœ€è¦å‘é€é¡¶ç‚¹çš„åæ ‡ï¼Œç„¶åä½¿ç”¨é¡¶ç‚¹ç´¢å¼•å°†ç‚¹è”ç³»èµ·æ¥ï¼Œè¿™æ ·å°±ä¸ç”¨å‘é€é‡å¤çš„é¡¶ç‚¹ä¿¡æ¯ï¼Œåªéœ€è¦å‘Šè¯‰ GPUï¼Œå˜¿è€å…„ï¼Œè¿™ä¸ªç‚¹åˆè¢«æˆ‘ç”¨äº†ï¼Œéº»çƒ¦ä½ è¯»å–ä¸€ä¸‹å§ã€‚</p><p>æˆ‘ä»¬å°†é¡¶ç‚¹æ•°ç»„æ¢æˆè¿™æ ·çš„æ•°æ®:</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> vertices: [<span class="type">Float</span>] <span class="operator">=</span> [</span><br><span class="line">    <span class="operator">-</span><span class="number">1</span>,  <span class="number">1</span>, <span class="number">0</span>, <span class="comment">// å·¦ä¸Šè§’</span></span><br><span class="line">    <span class="operator">-</span><span class="number">1</span>, <span class="operator">-</span><span class="number">1</span>, <span class="number">0</span>, <span class="comment">// å·¦ä¸‹è§’</span></span><br><span class="line">     <span class="number">1</span>, <span class="operator">-</span><span class="number">1</span>, <span class="number">0</span>, <span class="comment">// å³ä¸‹è§’</span></span><br><span class="line">     <span class="number">1</span>,  <span class="number">1</span>, <span class="number">0</span>, <span class="comment">// å³ä¸Šè§’</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª indicesï¼Œç”¨æ¥ä¿å­˜é¡¶ç‚¹ç´¢å¼•ï¼ŒåŒæ ·æ˜¯ä¸‰ä½ä¸€ç»„ï¼Œä¸€å…±ä¸¤ç»„ï¼Œä½¿ç”¨äº†é¡¶ç‚¹æ•°ç»„ä¸­çš„ä¸‰ç»„åæ ‡ä¿¡æ¯ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> indices: [<span class="type">UInt16</span>] <span class="operator">=</span> [</span><br><span class="line">    <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="comment">// å·¦è¾¹çš„ä¸‰è§’å½¢</span></span><br><span class="line">    <span class="number">2</span>, <span class="number">3</span>, <span class="number">0</span>  <span class="comment">// å³è¾¹çš„ä¸‰è§’å½¢</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>åŒæ ·çš„ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä½¿ç”¨ä¸€ä¸ª MTLBuffer ä¿å­˜é¡¶ç‚¹ç´¢å¼•ç¼“å­˜ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> indexBuffer: <span class="type">MTLBuffer</span>?</span><br></pre></td></tr></table></figure><p>åœ¨ buildModel å‡½æ•°é‡Œåˆå§‹åŒ–é¡¶ç‚¹ç´¢å¼•ç¼“å­˜ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line">indexBuffer <span class="operator">=</span> device.makeBuffer(bytes: indices,</span><br><span class="line">                                length: indices.count <span class="operator">*</span> <span class="type">MemoryLayout</span>&lt;<span class="type">UInt16</span>&gt;.size,</span><br><span class="line">                                options: [])</span><br></pre></td></tr></table></figure><h2 id="ç»˜åˆ¶å››è¾¹å½¢"><a href="#ç»˜åˆ¶å››è¾¹å½¢" class="headerlink" title="ç»˜åˆ¶å››è¾¹å½¢"></a>ç»˜åˆ¶å››è¾¹å½¢</h2><p>æˆ‘ä»¬å·²ç»æœ‰é¡¶ç‚¹ç¼“å†²äº†ï¼Œä¹Ÿæœ‰é¡¶ç‚¹ç´¢å¼•ç¼“å†²ï¼Œå¯ä»¥å»è¯•ä¸€ä¸‹äº†ã€‚</p><p>åœ¨ guard ä¸­èµ‹å€¼ä¸€ä¸‹ï¼Œä¿è¯å®ƒä¸ä¸ºç©ºã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">guard</span> <span class="keyword">let</span> drawable <span class="operator">=</span> view.currentDrawable,</span><br><span class="line">      <span class="keyword">let</span> pipelineState <span class="operator">=</span> pipelineState,</span><br><span class="line">      <span class="keyword">let</span> indexBuffer <span class="operator">=</span> indexBuffer,</span><br><span class="line">      <span class="keyword">let</span> descriptor <span class="operator">=</span> view.currentRenderPassDescriptor</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥å°±æ˜¯æ¯”è¾ƒé‡è¦çš„éƒ¨åˆ†äº†ï¼Œæˆ‘ä»¬è¦å¦‚ä½•ä½¿ç”¨é¡¶ç‚¹ç´¢å¼•å‘¢ï¼Ÿ</p><p>MTLCommandEncoder æœ‰ä¸€ä¸ª drawIndexedPrimitives å‡½æ•°ï¼Œå¯ä»¥æ¥å—é¡¶ç‚¹ç´¢å¼•ç¼“å†²ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line">commandEncoder<span class="operator">?</span>.drawIndexedPrimitives(type: .triangle,</span><br><span class="line">                                      indexCount: indices.count,</span><br><span class="line">                                      indexType: .uint16,</span><br><span class="line">                                      indexBuffer: indexBuffer,</span><br><span class="line">                                      indexBufferOffset: <span class="number">0</span>)</span><br></pre></td></tr></table></figure><p>è®©æˆ‘ä»¬è¿è¡Œä¸€ä¸‹å§ï¼</p><img src="/2022/04/04/hello-metal-3/2022-04-04_14.22.06.png" class=""><p>éå¸¸æ£’ï¼Œæˆ‘ä»¬çœ‹åˆ°æ•´ä¸ªå±å¹•éƒ½æ˜¯çº¢è‰²äº†ã€‚</p><h2 id="å®Œæ•´ä»£ç "><a href="#å®Œæ•´ä»£ç " class="headerlink" title="å®Œæ•´ä»£ç "></a>å®Œæ•´ä»£ç </h2><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Renderer.swift</span></span><br><span class="line"><span class="comment">//  HelloMetal</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by lxz on 2022/4/4.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> MetalKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">Colors</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">let</span> wenderlichGreen <span class="operator">=</span> <span class="type">MTLClearColor</span>(red: <span class="number">0.0</span>,</span><br><span class="line">                                               green: <span class="number">0.4</span>,</span><br><span class="line">                                               blue: <span class="number">0.21</span>,</span><br><span class="line">                                               alpha: <span class="number">1.0</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Renderer</span>: <span class="title class_ inherited__">NSObject</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> device: <span class="type">MTLDevice</span></span><br><span class="line">    <span class="keyword">let</span> commandQueue: <span class="type">MTLCommandQueue</span></span><br><span class="line">    <span class="keyword">var</span> vertices: [<span class="type">Float</span>] <span class="operator">=</span> [</span><br><span class="line">        <span class="operator">-</span><span class="number">1</span>,  <span class="number">1</span>, <span class="number">0</span>, <span class="comment">// å·¦ä¸Šè§’</span></span><br><span class="line">        <span class="operator">-</span><span class="number">1</span>, <span class="operator">-</span><span class="number">1</span>, <span class="number">0</span>, <span class="comment">// å·¦ä¸‹è§’</span></span><br><span class="line">         <span class="number">1</span>, <span class="operator">-</span><span class="number">1</span>, <span class="number">0</span>, <span class="comment">// å³ä¸‹è§’</span></span><br><span class="line">         <span class="number">1</span>,  <span class="number">1</span>, <span class="number">0</span>, <span class="comment">// å³ä¸Šè§’</span></span><br><span class="line">    ]</span><br><span class="line">    <span class="keyword">let</span> indices: [<span class="type">UInt16</span>] <span class="operator">=</span> [</span><br><span class="line">        <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="comment">// å·¦è¾¹çš„ä¸‰è§’å½¢</span></span><br><span class="line">        <span class="number">2</span>, <span class="number">3</span>, <span class="number">0</span>  <span class="comment">// å³è¾¹çš„ä¸‰è§’å½¢</span></span><br><span class="line">    ]</span><br><span class="line">    <span class="keyword">var</span> pipelineState: <span class="type">MTLRenderPipelineState</span>?</span><br><span class="line">    <span class="keyword">var</span> vertexBuffer: <span class="type">MTLBuffer</span>?</span><br><span class="line">    <span class="keyword">var</span> indexBuffer: <span class="type">MTLBuffer</span>?</span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(<span class="params">device</span>: <span class="type">MTLDevice</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.device <span class="operator">=</span> device</span><br><span class="line">        commandQueue <span class="operator">=</span> device.makeCommandQueue()<span class="operator">!</span></span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>()</span><br><span class="line">        buildModel()</span><br><span class="line">        buildPipelineState()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">func</span> <span class="title function_">buildModel</span>() &#123;</span><br><span class="line">        vertexBuffer <span class="operator">=</span> device.makeBuffer(bytes: vertices,</span><br><span class="line">                                         length: vertices.count <span class="operator">*</span> <span class="type">MemoryLayout</span>&lt;<span class="type">Float</span>&gt;.size,</span><br><span class="line">                                         options: [])</span><br><span class="line">        indexBuffer <span class="operator">=</span> device.makeBuffer(bytes: indices,</span><br><span class="line">                                        length: indices.count <span class="operator">*</span> <span class="type">MemoryLayout</span>&lt;<span class="type">UInt16</span>&gt;.size,</span><br><span class="line">                                        options: [])</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">func</span> <span class="title function_">buildPipelineState</span>() &#123;</span><br><span class="line">        <span class="keyword">let</span> library <span class="operator">=</span> device.makeDefaultLibrary()</span><br><span class="line">        <span class="keyword">let</span> vertexFunction <span class="operator">=</span> library<span class="operator">?</span>.makeFunction(name: <span class="string">&quot;vertex_shader&quot;</span>)</span><br><span class="line">        <span class="keyword">let</span> fragmentFunction <span class="operator">=</span> library<span class="operator">?</span>.makeFunction(name: <span class="string">&quot;fragment_shader&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> pipelineDescriptor <span class="operator">=</span> <span class="type">MTLRenderPipelineDescriptor</span>()</span><br><span class="line">        pipelineDescriptor.vertexFunction <span class="operator">=</span> vertexFunction</span><br><span class="line">        pipelineDescriptor.fragmentFunction <span class="operator">=</span> fragmentFunction</span><br><span class="line">        pipelineDescriptor.colorAttachments[<span class="number">0</span>].pixelFormat <span class="operator">=</span> .bgra8Unorm</span><br><span class="line"></span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            pipelineState <span class="operator">=</span> <span class="keyword">try</span> device.makeRenderPipelineState(descriptor: pipelineDescriptor)</span><br><span class="line">        &#125; <span class="keyword">catch</span> <span class="keyword">let</span> error <span class="keyword">as</span> <span class="type">NSError</span> &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;error: <span class="subst">\(error.localizedDescription)</span>&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">Renderer</span>: <span class="title class_ inherited__">MTKViewDelegate</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">mtkView</span>(<span class="keyword">_</span> <span class="params">view</span>: <span class="type">MTKView</span>, <span class="params">drawableSizeWillChange</span> <span class="params">size</span>: <span class="type">CGSize</span>) &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">draw</span>(<span class="params">in</span> <span class="params">view</span>: <span class="type">MTKView</span>) &#123;</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> drawable <span class="operator">=</span> view.currentDrawable,</span><br><span class="line">              <span class="keyword">let</span> pipelineState <span class="operator">=</span> pipelineState,</span><br><span class="line">              <span class="keyword">let</span> indexBuffer <span class="operator">=</span> indexBuffer,</span><br><span class="line">              <span class="keyword">let</span> descriptor <span class="operator">=</span> view.currentRenderPassDescriptor</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> commandBuffer <span class="operator">=</span> commandQueue.makeCommandBuffer()</span><br><span class="line">        <span class="keyword">let</span> commandEncoder <span class="operator">=</span> commandBuffer<span class="operator">?</span>.makeRenderCommandEncoder(descriptor: view.currentRenderPassDescriptor<span class="operator">!</span>)</span><br><span class="line"></span><br><span class="line">        commandEncoder<span class="operator">?</span>.setRenderPipelineState(pipelineState)</span><br><span class="line">        commandEncoder<span class="operator">?</span>.setVertexBuffer(vertexBuffer,</span><br><span class="line">                                        offset: <span class="number">0</span>,</span><br><span class="line">                                        index: <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">        commandEncoder<span class="operator">?</span>.drawIndexedPrimitives(type: .triangle,</span><br><span class="line">                                              indexCount: indices.count,</span><br><span class="line">                                              indexType: .uint16,</span><br><span class="line">                                              indexBuffer: indexBuffer,</span><br><span class="line">                                              indexBufferOffset: <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">        commandEncoder<span class="operator">?</span>.endEncoding()</span><br><span class="line">        commandBuffer<span class="operator">?</span>.present(view.currentDrawable<span class="operator">!</span>)</span><br><span class="line">        commandBuffer<span class="operator">?</span>.commit()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Shader.metal</span></span><br><span class="line"><span class="comment">//  HelloMetal</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by lxz on 2022/4/4.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;metal_stdlib&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> metal;</span><br><span class="line"></span><br><span class="line"><span class="function">vertex float4 <span class="title">vertex_shader</span><span class="params">(<span class="type">const</span> device packed_float3 *vertices [[ buffer(<span class="number">0</span>) ]],</span></span></span><br><span class="line"><span class="params"><span class="function">                            uint vertexId [[ vertex_id ]])</span> </span>&#123;</span><br><span class="line">    float4 position = <span class="built_in">float4</span>(vertices[vertexId], <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> position;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">fragment half4 <span class="title">fragment_shader</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">half4</span>(<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  ViewController.swift</span></span><br><span class="line"><span class="comment">//  HelloMetal</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by lxz on 2022/4/4.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"><span class="keyword">import</span> MetalKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ViewController</span>: <span class="title class_ inherited__">UIViewController</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> metalView: <span class="type">MTKView</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> view <span class="keyword">as!</span> <span class="type">MTKView</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> renderer: <span class="type">Renderer</span>!</span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">func</span> <span class="title function_">viewDidLoad</span>() &#123;</span><br><span class="line">        <span class="keyword">super</span>.viewDidLoad()</span><br><span class="line">        metalView.device <span class="operator">=</span> <span class="type">MTLCreateSystemDefaultDevice</span>()</span><br><span class="line">        metalView.clearColor <span class="operator">=</span> <span class="type">Colors</span>.wenderlichGreen</span><br><span class="line">        renderer <span class="operator">=</span> <span class="type">Renderer</span>(device: metalView.device<span class="operator">!</span>)</span><br><span class="line">        metalView.delegate <span class="operator">=</span> renderer</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> HelloMetalç³»åˆ— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Metal </tag>
            
            <tag> GameEngine </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hello-metal.2 ç¬¬ä¸€ä¸ªä¸‰è§’å½¢</title>
      <link href="/2022/04/04/hello-metal-2/"/>
      <url>/2022/04/04/hello-metal-2/</url>
      
        <content type="html"><![CDATA[<p>è¿™ä¸ªç³»åˆ—æ˜¯æˆ‘ç”¨æ¥å­¦ä¹  Metal API çš„ç¬”è®°ï¼Œæˆ‘çš„æœ€ç»ˆç›®çš„æ˜¯å¸Œæœ›å®ç°ä¸€ä¸ªåŸºäº Metal çš„æ¸¸æˆå¼•æ“ã€‚</p><p>ç›®å‰ç³»åˆ—æœ‰:</p><a href="/2022/04/04/hello-metal-1/" title="hello-metal.1 çœ‹åˆ°äº†ç»¿è‰²">hello-metal.1 çœ‹åˆ°äº†ç»¿è‰²</a><br><a href="/2022/04/04/hello-metal-2/" title="hello-metal.2 ç¬¬ä¸€ä¸ªä¸‰è§’å½¢">hello-metal.2 ç¬¬ä¸€ä¸ªä¸‰è§’å½¢</a><br><a href="/2022/04/04/hello-metal-3/" title="hello-metal.3 å››è¾¹å½¢">hello-metal.3 å››è¾¹å½¢</a><br><a href="/2022/04/04/hello-metal-4/" title="hello-metal.4 åŠ¨ç”»">hello-metal.4 åŠ¨ç”»</a><br><a href="/2022/04/09/hello-metal-5/" title="hello-metal.5 æè´¨è´´å›¾">hello-metal.5 æè´¨è´´å›¾</a><hr><p>ä»Šå¤©å¬åˆ°äº†ä¸€å¥è¯ï¼Œè§‰å¾—å¾ˆæœ‰é“(ji)ç†(tang):</p><blockquote><p><strong>ä½ æ‰€è°“çš„é¡¿æ‚Ÿï¼Œå¯èƒ½æ˜¯åˆ«äººçš„åŸºæœ¬åŠŸ</strong></p></blockquote><p>è‡ªå‹‰!</p><div><p>ç‚¹å‡»æŸ¥çœ‹ä¸Šä¸€ç¯‡ <a href="/2022/04/04/hello-metal-1/" title="hello-metal.1 çœ‹åˆ°äº†ç»¿è‰²">hello-metal.1 çœ‹åˆ°äº†ç»¿è‰²</a></p><p></div><p>æ¥ä¸Šæ–‡ï¼Œæˆ‘ä»¬å·²ç»æˆåŠŸçš„æäº¤äº†æ¸²æŸ“å‘½ä»¤åˆ°ç®¡çº¿ä¸­ï¼ŒæˆåŠŸå¾—åˆ°äº†æ¸²æŸ“ç»“æœï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¼€å§‹å†™ç€è‰²å™¨ä»£ç ï¼Œå®Œæˆæˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªä¸‰è§’å½¢ï¼Œæ¥ä¸‹æ¥è®©æˆ‘ä»¬ç»§ç»­å§ï¼</p><h2 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h2><p>Metal çš„ç€è‰²å™¨è¯­è¨€æ˜¯åŸºäº C++ 11 çš„è¯­è¨€ï¼Œå¯¹æˆ‘æ¥è¯´æ¯” OpenGL çš„ç€è‰²å™¨è¯­è¨€æ›´åŠ ç†Ÿæ‚‰ã€‚</p><p>ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯</p><ul><li>Metal ä¸­ä¸æ”¯æŒ C++11 çš„å¦‚ä¸‹ç‰¹æ€§ï¼š<ul><li>Lambda è¡¨è¾¾å¼</li><li>é€’å½’å‡½æ•°è°ƒç”¨</li><li>åŠ¨æ€è½¬æ¢æ“ä½œç¬¦</li><li>ç±»å‹è¯†åˆ«</li><li>å¯¹è±¡åˆ›å»º new å’Œé”€æ¯ delete æ“ä½œç¬¦</li><li>æ“ä½œç¬¦ noexcept</li><li>goto</li><li>å˜é‡å­˜å‚¨ä¿®é¥°ç¬¦ register å’Œ thread_local</li><li>è™šå‡½æ•°ä¿®é¥°ç¬¦</li><li>æ´¾ç”Ÿç±»</li><li>å¼‚å¸¸å¤„ç†</li></ul></li><li>C++ æ ‡å‡†åº“åœ¨ Metal è¯­è¨€ä¸­ä¹Ÿä¸å¯ä½¿ç”¨</li><li>Metal è¯­è¨€å¯¹äºæŒ‡é’ˆä½¿ç”¨çš„é™åˆ¶</li><li>Metal å›¾å½¢å’Œå¹¶è¡Œè®¡ç®—å‡½æ•°ç”¨åˆ°çš„å…¥å‚ï¼ˆæ¯”å¦‚æŒ‡é’ˆ &#x2F; å¼•ç”¨ï¼‰ï¼Œå¦‚æœæ˜¯æŒ‡é’ˆ &#x2F; å¼•ç”¨å¿…é¡»ä½¿ç”¨åœ°å€ç©ºé—´ä¿®é¥°ç¬¦ï¼ˆæ¯”å¦‚ deviceã€threadgroupã€constantï¼‰</li><li>ä¸æ”¯æŒå‡½æ•°æŒ‡é’ˆ</li><li>å‡½æ•°åä¸èƒ½å‡ºç° main</li></ul><h2 id="ç€è‰²å™¨"><a href="#ç€è‰²å™¨" class="headerlink" title="ç€è‰²å™¨"></a>ç€è‰²å™¨</h2><p>åœ¨ xcode å·¦ä¾§å¯¹ç€ ViewController.swift å³é”®ï¼Œé€‰æ‹© New Fileï¼Œæ–°å»º Metal Fileï¼Œèµ·åä¸º Shader å°±å¯ä»¥åˆ›å»ºä¸€ä¸ªç€è‰²å™¨æ–‡ä»¶ã€‚</p><img src="/2022/04/04/hello-metal-2/2022-04-04_10.11.25.png" class=""><p>xcode ä¼šå¸®åŠ©æˆ‘ä»¬è‡ªåŠ¨ç”Ÿæˆä¸€éƒ¨åˆ†ä»£ç ï¼Œæ¯”å¦‚é»˜è®¤å¸®åŠ©æˆ‘ä»¬ include äº† metal_stdlibã€‚</p><h3 id="é¡¶ç‚¹ç€è‰²å™¨"><a href="#é¡¶ç‚¹ç€è‰²å™¨" class="headerlink" title="é¡¶ç‚¹ç€è‰²å™¨"></a>é¡¶ç‚¹ç€è‰²å™¨</h3><p>æˆ‘ä»¬é¦–å…ˆæ–°å»ºä¸€ä¸ª vertex_shader çš„å‡½æ•°ï¼Œè®©é¡¶ç‚¹ç€è‰²å™¨å»æ‰§è¡Œè¿™ä¸ªå‡½æ•°ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">vertex float4 vertex_shader(const device packed_float3 *vertices [[ buffer(0) ]],</span><br><span class="line">                           uint vertexId [[ vertex_id ]]) &#123;</span><br><span class="line">    float4 position = float4(vertices[vertexId], 1);</span><br><span class="line">    return position;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç†Ÿæ‚‰ OpenGL æˆ–è€…å…¶ä»– GPU ç¼–ç¨‹çš„äººåº”è¯¥å¾ˆç†Ÿæ‚‰ï¼Œfloat4 å°±æ˜¯ä¸€ä¸ªå‘é‡ã€‚åœ¨å‚æ•°ä¸­çš„ <code>[[ buffer(0) ]]</code>ï¼Œæ˜¯åœ¨ä»£ç éƒ¨åˆ†è®¾ç½®çš„é¡¶ç‚¹ç¼“å†²åŒº idï¼Œ<code>[[ vertex_id ]]</code> é¡¶ç‚¹id æ ‡è¯†ç¬¦ã€‚</p><h3 id="ç‰‡å…ƒç€è‰²å™¨"><a href="#ç‰‡å…ƒç€è‰²å™¨" class="headerlink" title="ç‰‡å…ƒç€è‰²å™¨"></a>ç‰‡å…ƒç€è‰²å™¨</h3><p>é™¤äº†é¡¶ç‚¹ç€è‰²å™¨å‡½æ•°ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å‡†å¤‡ä¸€ä¸ªç‰‡å…ƒç€è‰²å™¨å‡½æ•°ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">fragment half4 fragment_shader() &#123;</span><br><span class="line">    return half4(1, 0, 0, 1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å•Šè¿™ï¼Œhalf4 æ˜¯ä¸ªä»€ä¹ˆç©æ„å„¿ã€‚</p><p>æŸ¥äº†ä¸€æ³¢ Apple çš„æ–‡æ¡£ï¼Œå‘ç° half æ˜¯ 16ä½çš„æµ®ç‚¹æ•°ï¼Œæ‰€ä»¥è¿™é‡Œå…¶å®æˆ‘ä»¬ç”¨ float4 ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œ<strong>è™½è¯´æ˜¯è·Ÿç€æ•™ç¨‹è·‘ï¼Œä½†æ˜¯ä¹Ÿè¦ç†è§£ä¸€ä¸‹ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆç”¨</strong>ã€‚</p><p>ç‰‡å…ƒç€è‰²å™¨ä»£ç å…¶å®å°±è¿”å›äº†ä¸€ä¸ªçº¢è‰²ï¼Œæ²¡æœ‰ä»»ä½•çš„å‚æ•°ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬æˆåŠŸè¿è¡Œä»¥åï¼Œæˆ‘ä»¬åº”è¯¥çœ‹åˆ°çº¢è‰²ã€‚</p><h2 id="ç»˜åˆ¶"><a href="#ç»˜åˆ¶" class="headerlink" title="ç»˜åˆ¶"></a>ç»˜åˆ¶</h2><p>å·²ç»å®Œæˆäº†åŸºæœ¬çš„ç€è‰²å™¨ä»£ç ï¼Œé‚£ä¹ˆå°±å¯ä»¥å¼€å§‹ä½¿ç”¨å®ƒäº†ã€‚å›åˆ° ViewController.swiftï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦åˆ›å»ºä¸€ä¸ªé¡¶ç‚¹æ•°ç»„ï¼Œæˆ‘ä»¬ä¾èµ–è¿™äº›é¡¶ç‚¹ä¿¡æ¯å»æ„å»ºç©ºé—´ä¸­ï¼Œä»¥ä¸‰è§’å½¢ä¸ºåŸºæœ¬çš„é¢ã€‚</p><h3 id="é¡¶ç‚¹æ•°ç»„"><a href="#é¡¶ç‚¹æ•°ç»„" class="headerlink" title="é¡¶ç‚¹æ•°ç»„"></a>é¡¶ç‚¹æ•°ç»„</h3><p>æ–°å¢ä¸€ä¸ªå˜é‡ï¼Œç”¨æ¥ä¿å­˜é¡¶ç‚¹æ•°ç»„:</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> vertices: [<span class="type">Float</span>] <span class="operator">=</span> [</span><br><span class="line">    <span class="number">0</span>,  <span class="number">1</span>, <span class="number">0</span>,</span><br><span class="line">   <span class="operator">-</span><span class="number">1</span>, <span class="operator">-</span><span class="number">1</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">1</span>, <span class="operator">-</span><span class="number">1</span>, <span class="number">0</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œä¸‰ä¸ªç‚¹å¯ä»¥å½¢æˆä¸€ä¸ªé¢ï¼Œå½¢æˆçš„å°±æ˜¯ä¸‰è§’å½¢ï¼Œåœ¨è®¡ç®—æœºä¸­ä½¿ç”¨é¡¶ç‚¹ vertex æ¥ä¿å­˜ç©ºé—´ä¿¡æ¯ï¼Œå¹¶ä¸”é¡¶ç‚¹ä¸ä»…ä»…æ˜¯ç”¨æ¥ä¿å­˜åæ ‡çš„ï¼Œè¿˜å¯ä»¥ä¿å­˜å…¶ä»–ä¿¡æ¯ï¼Œæ¯”å¦‚æŸä¸ªç‚¹çš„é¢œè‰²ï¼ŒæŸä¸ªç‚¹çš„æ³•çº¿ç­‰ç­‰ã€‚</p><p>ç”±äºç©ºé—´æ˜¯ä¸‰ç»´ç©ºé—´ï¼Œæ‰€ä»¥æˆ‘ä»¬å°† Z è½´éƒ½è®¾ç½®ä¸º 0ï¼Œè¿™æ ·ä¸‰è§’å½¢å°±åªéœ€è¦å…³å¿ƒ X è½´å’Œ Y è½´äº†ã€‚</p><p>ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ­¤æ—¶æˆ‘ä»¬çš„é¡¶ç‚¹ä¿¡æ¯ï¼Œè¿˜åªæ˜¯æ²¡æœ‰æ„ä¹‰çš„ç‚¹ï¼Œç”šè‡³è¿ç‚¹éƒ½ç®—ä¸ä¸Šï¼Œå› ä¸ºæˆ‘ä»¬è¿˜æ²¡æœ‰â€œè§„å®šâ€å®ƒæ˜¯ä»€ä¹ˆã€‚</p><h3 id="é¡¶ç‚¹ç¼“å†²åŒº"><a href="#é¡¶ç‚¹ç¼“å†²åŒº" class="headerlink" title="é¡¶ç‚¹ç¼“å†²åŒº"></a>é¡¶ç‚¹ç¼“å†²åŒº</h3><p>æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ª MTLBuffer å¯¹è±¡æ¥ä¿å­˜é¡¶ç‚¹ç¼“å†²åŒºï¼Œåªæœ‰ç»è¿‡å¤„ç†çš„é¡¶ç‚¹ç¼“å†²åŒºæ‰æ˜¯æˆ‘ä»¬éœ€è¦çš„ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> vertexBuffer: <span class="type">MTLBuffer</span>?</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">func</span> <span class="title function_">buildModel</span>() &#123;</span><br><span class="line">  vertexBuffer <span class="operator">=</span> device.makeBuffer(bytes: vertices,</span><br><span class="line">                                    length: vertices.count <span class="operator">*</span> <span class="type">MemoryLayout</span>&lt;<span class="type">Float</span>&gt;.size,</span><br><span class="line">                                    options: [])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸ºäº†æ–¹ä¾¿ä½¿ç”¨ device å¯¹è±¡ï¼Œå¢åŠ ä¸€ä¸ªå˜é‡æ¥ä¿å­˜åˆå§‹åŒ–çš„ deviceã€‚åœ¨ viewDidLoad å‡½æ•°ä¸­è°ƒç”¨ buildModelï¼Œåˆå§‹åŒ–é¡¶ç‚¹ç¼“å†²åŒºã€‚</p><h3 id="PipelineState"><a href="#PipelineState" class="headerlink" title="PipelineState"></a>PipelineState</h3><p>ä¸ºäº†ä½¿ç”¨ MTLRenderCommandEncoder å¯¹è±¡æ¥ç¼–ç æ¸²æŸ“æŒ‡ä»¤ï¼Œå¿…é¡»å…ˆè®¾ç½®ä¸€ä¸ª MTLRenderPipelineState å¯¹è±¡æ¥å®šä¹‰æ¯ä¸ªç»˜åˆ¶å‘½ä»¤çš„å›¾å½¢çŠ¶æ€ã€‚</p><p>ä¸€ä¸ªæ¸²æŸ“ç®¡çº¿ state å¯¹è±¡æ˜¯ä¸€ä¸ªæ‹¥æœ‰é•¿ç”Ÿå‘½å‘¨æœŸçš„å¯¹è±¡ï¼Œå®ƒå¯ä»¥åœ¨ render command encoder å¯¹è±¡ç”Ÿæ•ˆèŒƒå›´å¤–è¢«åˆ›å»ºï¼Œæœ€åå¯ä»¥è¢«ç¼“å­˜èµ·æ¥ï¼Œç„¶åè¢«é‡ç”¨äºå¤šä¸ª render command encoder å¯¹è±¡ã€‚å½“æè¿°ç›¸åŒçš„å›¾å½¢çŠ¶æ€ï¼Œé‡ç”¨å…ˆå‰åˆ›å»ºçš„æ¸²æŸ“ç®¡çº¿ state å¯¹è±¡ï¼Œè¿™æ ·å¯ä»¥é¿å…é«˜æˆæœ¬çš„é‡æ–°è¯„ä¼°å’Œè½¬æ¢æ“ä½œï¼ˆå°†ç‰¹å®šçŠ¶æ€è½¬æ¢æˆ GPU æŒ‡ä»¤ï¼‰ã€‚</p><p>æ¸²æŸ“ç®¡çº¿ state å¯¹è±¡æ˜¯ä¸€ä¸ªä¸å¯å˜å¯¹è±¡ã€‚è¦åˆ›å»ºä¸€ä¸ªæ¸²æŸ“ç®¡çº¿ state å¯¹è±¡ï¼Œé¦–å…ˆåˆ›å»ºä¸€ä¸ªå¯å˜çš„ MTLRenderPipelineDescriptor å¯¹è±¡ï¼Œå®ƒæè¿°äº†æ¸²æŸ“ç®¡çº¿ state çš„å±æ€§ã€‚ç„¶åä½ å¯ä»¥ä½¿ç”¨è¿™ä¸ª descriptor æ¥åˆ›å»ºä¸€ä¸ª MTLRenderPipelineState å¯¹è±¡ã€‚</p><p>æˆ‘ä»¬æ–°å¢ä¸€ä¸ªå‡½æ•°ç”¨æ¥åˆå§‹åŒ– MTLRenderPipelineStateã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> pipelineState: <span class="type">MTLRenderPipelineState</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">func</span> <span class="title function_">buildPipelineState</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> library            <span class="operator">=</span> device.makeDefaultLibrary()</span><br><span class="line">    <span class="keyword">let</span> vertexFunction     <span class="operator">=</span> library<span class="operator">?</span>.makeFunction(name: <span class="string">&quot;vertex_shader&quot;</span>)</span><br><span class="line">    <span class="keyword">let</span> fragmentFunction   <span class="operator">=</span> library<span class="operator">?</span>.makeFunction(name: <span class="string">&quot;fragment_shader&quot;</span>)</span><br><span class="line">    <span class="keyword">let</span> pipelineDescriptor <span class="operator">=</span> <span class="type">MTLRenderPipelineDescriptor</span>()</span><br><span class="line"></span><br><span class="line">    pipelineDescriptor.vertexFunction                  <span class="operator">=</span> vertexFunction</span><br><span class="line">    pipelineDescriptor.fragmentFunction                <span class="operator">=</span> fragmentFunction</span><br><span class="line">    pipelineDescriptor.colorAttachments[<span class="number">0</span>].pixelFormat <span class="operator">=</span> .bgra8Unorm</span><br><span class="line"></span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        pipelineState <span class="operator">=</span> <span class="keyword">try</span> device.makeRenderPipelineState(descriptor: pipelineDescriptor)</span><br><span class="line">    &#125; <span class="keyword">catch</span> <span class="keyword">let</span> error <span class="keyword">as</span> <span class="type">NSError</span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;error: <span class="subst">\(error.localizedDescription)</span>&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ device.makeDefaultLibrary() å¯ä»¥åˆ›å»ºä¸€ä¸ª library å¯¹è±¡ï¼Œç”¨æ¥è·å–ä¸Šé¢åˆ›å»ºçš„ç€è‰²å™¨å‡½æ•°ï¼ŒMetal ä¼šåœ¨é¡¹ç›®ç¼–è¯‘æ—¶å°±å®Œæˆç€è‰²å™¨ç¼–è¯‘ï¼Œè¿™ç‚¹å’Œ OpenGL æ˜¯ä¸åŒçš„ã€‚</p><p>æˆ‘ä»¬åªéœ€è¦ä¸º MTLRenderPipelineDescriptor è®¾ç½®é¡¶ç‚¹ç€è‰²å™¨å‡½æ•°ã€ç‰‡å…ƒç€è‰²å™¨å‡½æ•°å’Œé¢œè‰²æ ¼å¼å°±è¡Œäº†ã€‚</p><p>æœ€ååœ¨ viewDidLoad ä¸­è°ƒç”¨è¯¥å‡½æ•°å³å¯ã€‚</p><h3 id="ç»˜åˆ¶ä¸‰è§’å½¢"><a href="#ç»˜åˆ¶ä¸‰è§’å½¢" class="headerlink" title="ç»˜åˆ¶ä¸‰è§’å½¢"></a>ç»˜åˆ¶ä¸‰è§’å½¢</h3><p>å‡†å¤‡å·¥ä½œå·²ç»æ¥è¿‘å°¾å£°äº†ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥å‘ commandEncoder ä¸­ç¼–ç å‘½ä»¤äº†ã€‚</p><ul><li>ä¸º commandEncoder è®¾ç½® pipelineState</li><li>ä¸º commandEncoder è®¾ç½® vertexBuffer</li><li>ä¸º commandEncoder è®¾ç½® ç»˜åˆ¶ä¸‰è§’å½¢å‘½ä»¤</li></ul><p>åœ¨ commandEncoder?.endEncoding() å‰æ’å…¥ä»£ç :</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line">commandEncoder<span class="operator">?</span>.setRenderPipelineState(pipelineState)</span><br><span class="line">commandEncoder<span class="operator">?</span>.setVertexBuffer(vertexBuffer,</span><br><span class="line">                                offset: <span class="number">0</span>,</span><br><span class="line">                                index: <span class="number">0</span>)</span><br><span class="line">commandEncoder<span class="operator">?</span>.drawPrimitives(type: .triangle,</span><br><span class="line">                                vertexStart: <span class="number">0</span>,</span><br><span class="line">                                vertexCount: vertices.count)</span><br></pre></td></tr></table></figure><p>setVertexBuffer å‡½æ•°çš„ index å‚æ•°å°±æ˜¯ç€è‰²å™¨ä¸­ï¼Œvertex_shader å‚æ•°çš„ <code>[[ buffer(0) ]]</code>ï¼Œæˆ‘ä»¬æ²¡æœ‰è®¾ç½®åç§»ï¼Œé‚£ä¹ˆåæ ‡ä¿¡æ¯å°±æ˜¯ä» 0 å¼€å§‹è¯»å–ã€‚</p><p>è¿™é‡Œæä¸€ä¸‹ä¸ºä»€ä¹ˆä¼šæœ‰ offsetï¼Œæœ‰æ—¶å€™æˆ‘ä»¬ä¼šå‡†å¤‡ä¸€ä»½é¡¶ç‚¹ä¿¡æ¯ï¼Œåªéœ€è¦é€ä¸€æ¬¡ç»™ GPUï¼Œä¸åŒçš„ç€è‰²å™¨å¯ä»¥é€šè¿‡ offset è¯»å–åŒä¸€ä»½é¡¶ç‚¹ç¼“å†²ï¼Œåªéœ€è¦æŒ‰åç§»ä½¿ç”¨å°±å¯ä»¥äº†ã€‚</p><p>drawPrimitives å‡½æ•°æ˜¯å‘Šè¯‰ GPUï¼Œå˜¿å“¥ä»¬ï¼Œæˆ‘ç»™ä½ çš„é¡¶ç‚¹æ˜¯ç”¨æ¥ç”»ä¸‰è§’å½¢çš„ï¼Œè¯·ä½ ä¸‰ä¸ªä¸€ç»„çš„ä½¿ç”¨ã€‚</p><p>æœ€ç»ˆæˆ‘ä»¬æˆåŠŸçš„ç»˜åˆ¶äº†ä¸€ä¸ªçº¢è‰²çš„ä¸‰è§’å½¢ã€‚</p><h2 id="å®Œæ•´ä»£ç "><a href="#å®Œæ•´ä»£ç " class="headerlink" title="å®Œæ•´ä»£ç "></a>å®Œæ•´ä»£ç </h2><h3 id="ViewController"><a href="#ViewController" class="headerlink" title="ViewController"></a>ViewController</h3><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  ViewController.swift</span></span><br><span class="line"><span class="comment">//  HelloMetal</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by lxz on 2022/4/4.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"><span class="keyword">import</span> MetalKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">Colors</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">let</span> wenderlichGreen <span class="operator">=</span> <span class="type">MTLClearColor</span>(red: <span class="number">0.0</span>,</span><br><span class="line">                                               green: <span class="number">0.4</span>,</span><br><span class="line">                                               blue: <span class="number">0.21</span>,</span><br><span class="line">                                               alpha: <span class="number">1.0</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ViewController</span>: <span class="title class_ inherited__">UIViewController</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> metalView: <span class="type">MTKView</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> view <span class="keyword">as!</span> <span class="type">MTKView</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> commandQueue: <span class="type">MTLCommandQueue</span>!</span><br><span class="line">    <span class="keyword">var</span> device: <span class="type">MTLDevice</span>!</span><br><span class="line">    <span class="keyword">var</span> vertexBuffer: <span class="type">MTLBuffer</span>?</span><br><span class="line">    <span class="keyword">var</span> vertices: [<span class="type">Float</span>] <span class="operator">=</span> [</span><br><span class="line">        <span class="number">0</span>,  <span class="number">1</span>, <span class="number">0</span>,</span><br><span class="line">       <span class="operator">-</span><span class="number">1</span>, <span class="operator">-</span><span class="number">1</span>, <span class="number">0</span>,</span><br><span class="line">        <span class="number">1</span>, <span class="operator">-</span><span class="number">1</span>, <span class="number">0</span></span><br><span class="line">    ]</span><br><span class="line">    <span class="keyword">var</span> pipelineState: <span class="type">MTLRenderPipelineState</span>!</span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">func</span> <span class="title function_">viewDidLoad</span>() &#123;</span><br><span class="line">        <span class="keyword">super</span>.viewDidLoad()</span><br><span class="line">        device <span class="operator">=</span> <span class="type">MTLCreateSystemDefaultDevice</span>()</span><br><span class="line">        metalView.device <span class="operator">=</span> device</span><br><span class="line">        metalView.clearColor <span class="operator">=</span> <span class="type">Colors</span>.wenderlichGreen</span><br><span class="line">        commandQueue <span class="operator">=</span> device.makeCommandQueue()</span><br><span class="line"></span><br><span class="line">        buildModel()</span><br><span class="line">        buildPipelineState()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> commandBuffer <span class="operator">=</span> commandQueue.makeCommandBuffer()</span><br><span class="line">        <span class="keyword">let</span> commandEncoder <span class="operator">=</span> commandBuffer<span class="operator">?</span>.makeRenderCommandEncoder(descriptor: metalView.currentRenderPassDescriptor<span class="operator">!</span>)</span><br><span class="line"></span><br><span class="line">        commandEncoder<span class="operator">?</span>.setRenderPipelineState(pipelineState)</span><br><span class="line">        commandEncoder<span class="operator">?</span>.setVertexBuffer(vertexBuffer,</span><br><span class="line">                                        offset: <span class="number">0</span>,</span><br><span class="line">                                        index: <span class="number">0</span>)</span><br><span class="line">        commandEncoder<span class="operator">?</span>.drawPrimitives(type: .triangle,</span><br><span class="line">                                       vertexStart: <span class="number">0</span>,</span><br><span class="line">                                       vertexCount: vertices.count)</span><br><span class="line"></span><br><span class="line">        commandEncoder<span class="operator">?</span>.endEncoding()</span><br><span class="line">        commandBuffer<span class="operator">?</span>.present(metalView.currentDrawable<span class="operator">!</span>)</span><br><span class="line">        commandBuffer<span class="operator">?</span>.commit()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">func</span> <span class="title function_">buildModel</span>() &#123;</span><br><span class="line">      vertexBuffer <span class="operator">=</span> device.makeBuffer(bytes: vertices,</span><br><span class="line">                                       length: vertices.count <span class="operator">*</span> <span class="type">MemoryLayout</span>&lt;<span class="type">Float</span>&gt;.size,</span><br><span class="line">                                       options: [])</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">func</span> <span class="title function_">buildPipelineState</span>() &#123;</span><br><span class="line">        <span class="keyword">let</span> library            <span class="operator">=</span> device.makeDefaultLibrary()</span><br><span class="line">        <span class="keyword">let</span> vertexFunction     <span class="operator">=</span> library<span class="operator">?</span>.makeFunction(name: <span class="string">&quot;vertex_shader&quot;</span>)</span><br><span class="line">        <span class="keyword">let</span> fragmentFunction   <span class="operator">=</span> library<span class="operator">?</span>.makeFunction(name: <span class="string">&quot;fragment_shader&quot;</span>)</span><br><span class="line">        <span class="keyword">let</span> pipelineDescriptor <span class="operator">=</span> <span class="type">MTLRenderPipelineDescriptor</span>()</span><br><span class="line"></span><br><span class="line">        pipelineDescriptor.vertexFunction                  <span class="operator">=</span> vertexFunction</span><br><span class="line">        pipelineDescriptor.fragmentFunction                <span class="operator">=</span> fragmentFunction</span><br><span class="line">        pipelineDescriptor.colorAttachments[<span class="number">0</span>].pixelFormat <span class="operator">=</span> .bgra8Unorm</span><br><span class="line"></span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            pipelineState <span class="operator">=</span> <span class="keyword">try</span> device.makeRenderPipelineState(descriptor: pipelineDescriptor)</span><br><span class="line">        &#125; <span class="keyword">catch</span> <span class="keyword">let</span> error <span class="keyword">as</span> <span class="type">NSError</span> &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;error: <span class="subst">\(error.localizedDescription)</span>&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Shader"><a href="#Shader" class="headerlink" title="Shader"></a>Shader</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//</span><br><span class="line">//  Shader.metal</span><br><span class="line">//  HelloMetal</span><br><span class="line">//</span><br><span class="line">//  Created by lxz on 2022/4/4.</span><br><span class="line">//</span><br><span class="line"></span><br><span class="line">#include &lt;metal_stdlib&gt;</span><br><span class="line">using namespace metal;</span><br><span class="line"></span><br><span class="line">vertex float4 vertex_shader(const device packed_float3 *vertices [[ buffer(0) ]],</span><br><span class="line">                           uint vertexId [[ vertex_id ]]) &#123;</span><br><span class="line">    float4 position = float4(vertices[vertexId], 1);</span><br><span class="line">    return position;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fragment half4 fragment_shader() &#123;</span><br><span class="line">    return half4(1, 0, 0, 1);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> HelloMetalç³»åˆ— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Metal </tag>
            
            <tag> GameEngine </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hello-metal.1 çœ‹åˆ°äº†ç»¿è‰²</title>
      <link href="/2022/04/04/hello-metal-1/"/>
      <url>/2022/04/04/hello-metal-1/</url>
      
        <content type="html"><![CDATA[<p>è¿™ä¸ªç³»åˆ—æ˜¯æˆ‘ç”¨æ¥å­¦ä¹  Metal API çš„ç¬”è®°ï¼Œæˆ‘çš„æœ€ç»ˆç›®çš„æ˜¯å¸Œæœ›å®ç°ä¸€ä¸ªåŸºäº Metal çš„æ¸¸æˆå¼•æ“ã€‚</p><p>ç›®å‰ç³»åˆ—æœ‰:</p><a href="/2022/04/04/hello-metal-1/" title="hello-metal.1 çœ‹åˆ°äº†ç»¿è‰²">hello-metal.1 çœ‹åˆ°äº†ç»¿è‰²</a><br><a href="/2022/04/04/hello-metal-2/" title="hello-metal.2 ç¬¬ä¸€ä¸ªä¸‰è§’å½¢">hello-metal.2 ç¬¬ä¸€ä¸ªä¸‰è§’å½¢</a><br><a href="/2022/04/04/hello-metal-3/" title="hello-metal.3 å››è¾¹å½¢">hello-metal.3 å››è¾¹å½¢</a><br><a href="/2022/04/04/hello-metal-4/" title="hello-metal.4 åŠ¨ç”»">hello-metal.4 åŠ¨ç”»</a><br><a href="/2022/04/09/hello-metal-5/" title="hello-metal.5 æè´¨è´´å›¾">hello-metal.5 æè´¨è´´å›¾</a><hr><p>Metal æ˜¯ç”±è‹¹æœå…¬å¸æ‰€å¼€å‘çš„ä¸€ä¸ªåº”ç”¨ç¨‹åºæ¥å£ï¼Œå…¼é¡¾å›¾å½¢ä¸è®¡ç®—åŠŸèƒ½ï¼Œé¢å‘åº•å±‚ã€ä½å¼€é”€çš„ç¡¬ä»¶åŠ é€Ÿã€‚å…¶ç±»ä¼¼äºå°†OpenGL ä¸ OpenCL çš„åŠŸèƒ½é›†æˆåˆ°äº†åŒä¸€ä¸ªAPIä¸Šã€‚Metalä¹Ÿé€šè¿‡å¼•å…¥è®¡ç®—ç€è‰²å™¨æ¥è¿›ä¸€æ­¥æé«˜GPGPUç¼–ç¨‹çš„èƒ½åŠ›ã€‚Metal ä½¿ç”¨ä¸€ç§åŸºäºC++11çš„æ–°ç€è‰²è¯­è¨€ï¼Œå…¶å®ç°å€ŸåŠ©äº† Clang å’Œ LLVMã€‚</p><p>ä»ä»Šå¤©å¼€å§‹ï¼Œæˆ‘ä¼šå¼€å§‹å†™ä¸€ä¸ª Metal çš„å…¥é—¨ç³»åˆ—ï¼Œä½œä¸ºæˆ‘å­¦ä¹  Metal çš„ç¬”è®°å’Œè¿‡ç¨‹ã€‚æˆ‘å­¦ä¹ çš„å¹³å°ä»¥ <code>raywenderlich.com</code> çš„è§†é¢‘ä¸ºä¸»ï¼Œä»£ç å’Œæµç¨‹ä¹ŸåŸºæœ¬ä¿æŒä¸€è‡´ã€‚</p><p>ç°åœ¨å°±è®©æˆ‘ä»¬å¼€å§‹å§ï¼</p><h2 id="æ–°å»ºé¡¹ç›®"><a href="#æ–°å»ºé¡¹ç›®" class="headerlink" title="æ–°å»ºé¡¹ç›®"></a>æ–°å»ºé¡¹ç›®</h2><p>é¦–å…ˆæ‰“å¼€ xcodeï¼Œæ–°å»ºä¸€ä¸ª iOS Appï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œinterface é»˜è®¤æ˜¯ swiftuiï¼Œéœ€è¦ä¿®æ”¹æˆ Storyboardï¼Œåº”è¯¥ä½¿ç”¨ swiftui ä¹Ÿæ²¡æœ‰é—®é¢˜çš„ï¼Œåªæ˜¯å…ˆæŒ‰ç…§æ•™ç¨‹ä¸€æ­¥æ­¥æ¥å§ã€‚</p><img src="/2022/04/04/hello-metal-1/2022-04-04_09.07.40.png" class=""><h3 id="è®¾ç½®-MTKView"><a href="#è®¾ç½®-MTKView" class="headerlink" title="è®¾ç½® MTKView"></a>è®¾ç½® MTKView</h3><p>å½“é¡¹ç›®æ–°å»ºå®Œæˆåï¼Œæ‰“å¼€å·¦ä¾§çš„ <code>Main.storyboard</code> æ–‡ä»¶ï¼Œåœ¨ä¸­é—´é€‰æ‹©åˆ° <code>view Controller Scene</code> -&gt; <code>View Controller</code> -&gt; <code>View</code>ï¼Œå±•å¼€åˆ° <code>View</code> èŠ‚ç‚¹ï¼Œå¹¶å•å‡»å®ƒã€‚</p><p>å³ä¾§é¢æ¿ä¼šæ˜¾ç¤ºè¯¥èŠ‚ç‚¹çš„è¯¦ç»†ä¿¡æ¯ï¼Œåœ¨æœ€å³ä¾§é€‰æ‹© <code>Show the Identity inspector</code> æŒ‰é’®ï¼Œçœ‹èµ·æ¥åƒæ˜¯åç‰‡æŒ‰é’®çš„ï¼Œå°† Class ä¿®æ”¹ä¸º <code>MTKView</code>ï¼Œå› ä¸ºæˆ‘ä»¬çš„ç•Œé¢ä¸æ˜¯æ™®é€šçš„ Viewï¼Œè€Œæ˜¯ä½¿ç”¨ Metal ç»˜åˆ¶çš„ç•Œé¢ã€‚</p><img src="/2022/04/04/hello-metal-1/2022-04-04_09.54.37.png" class=""><h2 id="å¼€å¯-Metal-ä¹‹æ—…"><a href="#å¼€å¯-Metal-ä¹‹æ—…" class="headerlink" title="å¼€å¯ Metal ä¹‹æ—…"></a>å¼€å¯ Metal ä¹‹æ—…</h2><h3 id="å¯¼å…¥-MetalKit"><a href="#å¯¼å…¥-MetalKit" class="headerlink" title="å¯¼å…¥ MetalKit"></a>å¯¼å…¥ MetalKit</h3><p>æ‰“å¼€ <code>ViewController.swift</code> æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° xcode å·²ç»è‡ªåŠ¨ç”Ÿæˆäº†ä¸€éƒ¨åˆ†ä»£ç ï¼Œæˆ‘ä»¬é¦–å…ˆåœ¨ <code>import UIKit</code> ä¸‹ä¸€è¡Œå†™å…¥ <code>import MetalKit</code>ï¼Œç”¨æ¥å¯¼å…¥ Metal API ç›¸å…³çš„æ–‡ä»¶ã€‚</p><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦è·å–åˆ°ç•Œé¢ä¸Šçš„ Viewï¼Œåœ¨ ViewController ç±»ä¸­å†™ä¸€ä¸ªå˜é‡ï¼Œç”¨æ¥è®¿é—® Viewã€‚</p><p>å¢åŠ ä»£ç :</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> metalView: <span class="type">MTKView</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> view <span class="keyword">as!</span> <span class="type">MTKView</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆä»£ç å¦‚ä¸‹:</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"><span class="keyword">import</span> MetalKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ViewController</span>: <span class="title class_ inherited__">UIViewController</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> metalView: <span class="type">MTKView</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> view <span class="keyword">as!</span> <span class="type">MTKView</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">func</span> <span class="title function_">viewDidLoad</span>() &#123;</span><br><span class="line">        <span class="keyword">super</span>.viewDidLoad()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è®¿é—® metaView å°±æ˜¯è®¿é—®ç•Œé¢ä¸Šçš„ viewã€‚</p><h3 id="åˆ›å»º-Device"><a href="#åˆ›å»º-Device" class="headerlink" title="åˆ›å»º Device"></a>åˆ›å»º Device</h3><p>æ¥ä¸‹æ¥å°±å¼€å§‹æˆ‘ä»¬çš„ Metal ä¹‹æ—…ï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªé»˜è®¤è®¾å¤‡ï¼Œè¿™ä¸ªè®¾å¤‡æ˜¯æŠ½è±¡çš„ç¡¬ä»¶èµ„æºï¼Œæœ‰äº†è¿™ä¸ªç¡¬ä»¶ï¼Œæˆ‘ä»¬æ‰å¯ä»¥å»å°†ç€è‰²å™¨ä»£ç ç­‰å„ç§ä»£ç å‘é€åˆ°çœŸæ­£çš„è®¾å¤‡ä¸Šå»ä½¿ç”¨ã€‚</p><p>åœ¨ metalView ä¸­æœ‰ä¸ª device æˆå‘˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>MTLCreateSystemDefaultDevice</code> å‡½æ•°åˆ›å»ºé»˜è®¤è®¾å¤‡ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨è¿™ä¸ª <code>device</code> äº†ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"><span class="keyword">import</span> MetalKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ViewController</span>: <span class="title class_ inherited__">UIViewController</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> metalView: <span class="type">MTKView</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> view <span class="keyword">as!</span> <span class="type">MTKView</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">func</span> <span class="title function_">viewDidLoad</span>() &#123;</span><br><span class="line">        <span class="keyword">super</span>.viewDidLoad()</span><br><span class="line">        metalView.device <span class="operator">=</span> <span class="type">MTLCreateSystemDefaultDevice</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è®¾ç½®èƒŒæ™¯æ¸…é™¤è‰²"><a href="#è®¾ç½®èƒŒæ™¯æ¸…é™¤è‰²" class="headerlink" title="è®¾ç½®èƒŒæ™¯æ¸…é™¤è‰²"></a>è®¾ç½®èƒŒæ™¯æ¸…é™¤è‰²</h3><p>æœ‰äº†è®¾å¤‡ä»¥åå‘¢ï¼Ÿ</p><p>æˆ‘ä»¬å¯ä»¥å…ˆç»™å±å¹•æ¥ä¸€ä¸ªæ¸…é™¤è‰²ï¼Œæˆ–è€…å«èƒŒæ™¯è‰²ã€‚</p><p>åœ¨ <code>ViewController.swift</code> ä¸­æ–°å¢ä¸€ä¸ªæšä¸¾ï¼Œä½¿ç”¨ <code>MTLClearColor</code> å‡½æ•°å¯ä»¥åˆ›å»ºå‡ºæ‰€éœ€çš„å€¼ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">Colors</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">let</span> wenderlichGreen <span class="operator">=</span> <span class="type">MTLClearColor</span>(red: <span class="number">0.0</span>,</span><br><span class="line">                                               green: <span class="number">0.4</span>,</span><br><span class="line">                                               blue: <span class="number">0.21</span>,</span><br><span class="line">                                               alpha: <span class="number">1.0</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ viewDidLoad ä¸­æˆ‘ä»¬ä¸º metalView è®¾ç½® clear colorã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line">metalView.clearColor <span class="operator">=</span> <span class="type">Colors</span>.wenderlichGreen</span><br></pre></td></tr></table></figure><p>è¿™æ—¶å€™è¿è¡Œä¸€ä¸‹ä¾‹å­ï¼Œç„¶åå°±ä¼šå‘ç°å±å¹•æ˜¯é»‘çš„ï¼Œè¿™æ˜¯ä¸ºå•¥æï¼Ÿä¸æ˜¯è®¾ç½®äº†èƒŒæ™¯è‰²äº†å—ï¼Ÿ</p><img src="/2022/04/04/hello-metal-1/2022-04-04_09.55.44.png" class=""><p>å“¦å¼å¼ï¼Œåˆ«å¿˜äº†ï¼Œå’Œ OpenGL ä¸€æ ·ï¼Œæƒ³è¦åˆ©ç”¨ GPU å»ç»˜åˆ¶ç”»é¢ï¼Œéœ€è¦æœ‰é¡¶ç‚¹ä¿¡æ¯ï¼Œç”±å„ç§ç€è‰²å™¨å¤„ç†è¿‡åï¼Œæ‰èƒ½å¾—åˆ°ä¸€å¹…ç”»é¢ï¼Œè€Œæˆ‘ä»¬è¿˜æ²¡æœ‰å¼€å§‹å†™ç€è‰²å™¨ä»£ç ï¼Œä¹Ÿæ²¡æœ‰å†™ç»˜åˆ¶å‘½ä»¤ã€‚</p><h3 id="ç»˜åˆ¶"><a href="#ç»˜åˆ¶" class="headerlink" title="ç»˜åˆ¶"></a>ç»˜åˆ¶</h3><h4 id="å‘½ä»¤é˜Ÿåˆ—"><a href="#å‘½ä»¤é˜Ÿåˆ—" class="headerlink" title="å‘½ä»¤é˜Ÿåˆ—"></a>å‘½ä»¤é˜Ÿåˆ—</h4><p>æˆ‘ä»¬éœ€è¦æ–°å»ºä¸€ä¸ªå‘½ä»¤é˜Ÿåˆ— MTLCommandQueueï¼Œç”¨æ¥ç¼“å†²æˆ‘ä»¬çš„æ“ä½œå‘½ä»¤ã€‚</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> commandQueue: <span class="type">MTLCommandQueue</span></span><br></pre></td></tr></table></figure><p>åœ¨ viewDidLoad å‡½æ•°ä¸­ä½¿ç”¨ <code>metalView.device.makeCommandQueue()!</code> åˆå§‹åŒ– commandQueueã€‚</p><p>è¿˜éœ€è¦åˆ›å»ºä¸€ä¸ª MTLCommandBuffer æ¥ç¼“å†²å‘½ä»¤ï¼Œè¿™é‡Œå¯èƒ½å°±æœ‰ç–‘æƒ‘äº†ï¼ŒMTLCommandQueue è‡ªå·±å°±æ˜¯ä¸ªé˜Ÿåˆ—ï¼Œæ€ä¹ˆè¿˜éœ€è¦ä¸€ä¸ª buffer å‘¢ï¼ŸMTLCommandBuffer æ˜¯ä» MTLCommandQueue ä¸­åˆ›å»ºå‡ºæ¥çš„ï¼Œç”¨äºæœ¬æ¬¡ç»˜åˆ¶æ‰€éœ€çš„å…¨éƒ¨çŠ¶æ€ï¼Œä¾‹å¦‚é¡¶ç‚¹ä¿¡æ¯ã€é¢œè‰²ã€é¡¶ç‚¹è¿æ¥é¡ºåºç­‰ç­‰ï¼Œå½“å®Œæˆæ‰€æœ‰è®¾ç½®ä»¥åï¼Œå°±å¯ä»¥ä½¿ç”¨ commandBuffer.commit() æäº¤åˆ°é˜Ÿåˆ—ä¸­ã€‚</p><h4 id="å‘½ä»¤ç¼–ç "><a href="#å‘½ä»¤ç¼–ç " class="headerlink" title="å‘½ä»¤ç¼–ç "></a>å‘½ä»¤ç¼–ç </h4><p>æˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ª MTLRenderCommandEncoderï¼ŒMTLRenderCommandEncoder å¯¹è±¡è¡¨ç¤ºä¸€ä¸ªå•ç‹¬çš„å›¾å½¢æ¸²æŸ“ command encoderã€‚MTLParallelRenderCommandEncoder å¯¹è±¡ä½¿å¾—ä¸€ä¸ªå•ç‹¬çš„æ¸²æŸ“ pass è¢«åˆ†æˆè‹¥å¹²ä¸ªç‹¬ç«‹çš„ MTLRenderCommandEncoder å¯¹è±¡ï¼Œæ¯ä¸€ä¸ªéƒ½å¯ä»¥è¢«åˆ†é…åˆ°ä¸åŒçš„çº¿ç¨‹ã€‚è¿™äº› command encoders ä¸­çš„æŒ‡ä»¤éšåå°†ä¸²è¡Œèµ·æ¥ï¼Œå¹¶ä»¥ä¸€è‡´çš„å¯é¢„æµ‹çš„é¡ºåºè¢«æ‰§è¡Œã€‚</p><p>è¿™é‡Œæ˜¯ä¸€å¼  Metal æ¸²æŸ“ç®¡çº¿å›¾ã€‚</p><img src="/2022/04/04/hello-metal-1/gfx-pipeline_2x.png" class=""><h4 id="æäº¤ç»˜åˆ¶"><a href="#æäº¤ç»˜åˆ¶" class="headerlink" title="æäº¤ç»˜åˆ¶"></a>æäº¤ç»˜åˆ¶</h4><p>æœ€ç»ˆæˆ‘ä»¬æ–°å¢çš„ä»£ç æ˜¯è¿™æ ·çš„:</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line">commandQueue <span class="operator">=</span> metalView.device<span class="operator">?</span>.makeCommandQueue()</span><br><span class="line"><span class="keyword">let</span> commandBuffer <span class="operator">=</span> commandQueue.makeCommandBuffer()</span><br><span class="line"><span class="keyword">let</span> commandEncoder <span class="operator">=</span> commandBuffer<span class="operator">?</span>.makeRenderCommandEncoder(descriptor: metalView.currentRenderPassDescriptor<span class="operator">!</span>)</span><br><span class="line"></span><br><span class="line">commandEncoder<span class="operator">?</span>.endEncoding()</span><br><span class="line">commandBuffer<span class="operator">?</span>.present(metalView.currentDrawable<span class="operator">!</span>)</span><br><span class="line">commandBuffer<span class="operator">?</span>.commit()</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æœ‰äº›å˜é‡åé¢è·Ÿäº†ä¸€ä¸ª!ï¼Œå®ƒçš„æ„æ€æ˜¯è¿™é‡Œç»å¯¹ä¸ä¸ºç©ºï¼Œæ˜¯ä¸€ç§æ–­è¨€ï¼ŒåŒæ ·è¿˜æœ‰?ï¼Œå®ƒçš„æ„æ€æ˜¯å¦‚æœä¸ä¸ºç©ºå°±æ‰§è¡Œã€‚</p><h2 id="æµ‹è¯•è¿è¡Œ"><a href="#æµ‹è¯•è¿è¡Œ" class="headerlink" title="æµ‹è¯•è¿è¡Œ"></a>æµ‹è¯•è¿è¡Œ</h2><p>æˆ‘ä»¬å·²ç»å®Œæˆäº†æœ€ç»ˆçš„ä»£ç ï¼Œæ•´ä¸ª ViewController.swift çš„ä»£ç å¦‚ä¸‹:</p><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"><span class="keyword">import</span> MetalKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">Colors</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">let</span> wenderlichGreen <span class="operator">=</span> <span class="type">MTLClearColor</span>(red: <span class="number">0.0</span>,</span><br><span class="line">                                               green: <span class="number">0.4</span>,</span><br><span class="line">                                               blue: <span class="number">0.21</span>,</span><br><span class="line">                                               alpha: <span class="number">1.0</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ViewController</span>: <span class="title class_ inherited__">UIViewController</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> metalView: <span class="type">MTKView</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> view <span class="keyword">as!</span> <span class="type">MTKView</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> commandQueue: <span class="type">MTLCommandQueue</span>!</span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">func</span> <span class="title function_">viewDidLoad</span>() &#123;</span><br><span class="line">        <span class="keyword">super</span>.viewDidLoad()</span><br><span class="line">        metalView.device <span class="operator">=</span> <span class="type">MTLCreateSystemDefaultDevice</span>()</span><br><span class="line">        metalView.clearColor <span class="operator">=</span> <span class="type">Colors</span>.wenderlichGreen</span><br><span class="line">        commandQueue <span class="operator">=</span> metalView.device<span class="operator">?</span>.makeCommandQueue()</span><br><span class="line">        <span class="keyword">let</span> commandBuffer <span class="operator">=</span> commandQueue.makeCommandBuffer()</span><br><span class="line">        <span class="keyword">let</span> commandEncoder <span class="operator">=</span> commandBuffer<span class="operator">?</span>.makeRenderCommandEncoder(descriptor: metalView.currentRenderPassDescriptor<span class="operator">!</span>)</span><br><span class="line"></span><br><span class="line">        commandEncoder<span class="operator">?</span>.endEncoding()</span><br><span class="line">        commandBuffer<span class="operator">?</span>.present(metalView.currentDrawable<span class="operator">!</span>)</span><br><span class="line">        commandBuffer<span class="operator">?</span>.commit()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><img src="/2022/04/04/hello-metal-1/2022-04-04_11.44.40.png" class=""><p>è¿™æ—¶å€™å°±å¯ä»¥çœ‹åˆ°å±å¹•å‡ºç°äº†ç»¿è‰²ï¼Œè¿™æ˜¯æˆ‘ä»¬è®¾ç½®çš„ clearColorã€‚</p><p>æœ¬ç¯‡å…ˆè®²äº†ä¸€ä¸ªåŸºæœ¬çš„ Metal é¡¹ç›®çš„ä½¿ç”¨ï¼Œä¸‹ä¸€ç¯‡ä¼šå¼€å§‹è®²é¡¶ç‚¹å’Œç€è‰²å™¨çš„ç”¨æ³•ï¼Œå®Œæˆæˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªä¸‰è§’å½¢ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> HelloMetalç³»åˆ— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Metal </tag>
            
            <tag> GameEngine </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vimç®€å•é…ç½®</title>
      <link href="/2022/03/22/vim%E7%AE%80%E5%8D%95%E9%85%8D%E7%BD%AE/"/>
      <url>/2022/03/22/vim%E7%AE%80%E5%8D%95%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<p>ä½œä¸ºä¸€ä¸ªçˆ±æŠ˜è…¾çš„åŒå­¦ï¼ŒæŠ˜è…¾å‡ ä¸ªç¼–è¾‘å™¨ä¸è¿‡åˆ†å§ã€‚</p><p>æˆ‘æŠ˜è…¾ç¼–è¾‘å™¨çš„å†å²è¿˜ç®—è·Ÿå¾—ä¸Šæ½®æµï¼Œæœ€å¼€å§‹ç”¨ sublimeï¼Œåæ¥ atom å‡ºæ¥äº†ï¼ŒåŠæ‰“ sublimeï¼Œæˆ‘å°±å»ç”¨ atomäº†ã€‚<br>å†åæ¥å®‡å®™ç¬¬ä¸€ç¼–è¾‘å™¨ vscode å‡ºæ¥äº†ï¼ŒåŠæ‰“äº†(æˆ‘è®¤ä¸º)æ‰€æœ‰çš„ç¼–è¾‘å™¨ï¼Œæˆ‘å°±åˆå»ç”¨ vscodeã€‚ <del>(æ€ä¹ˆæ„Ÿè§‰æˆ‘ä¸€ç›´åœ¨è¿½æ–°?å–µ?)</del></p><p>å·¥ä½œä»¥åï¼Œåæˆ‘å·¦è¾¹çš„æ˜¯ä¸€ä¸ª emacs ç”¨æˆ·ï¼Œå³è¾¹æ˜¯ä¸€ä¸ª vim ç”¨æˆ·ï¼Œç„¶åä»–ä¿©å¶å°”ä¼šæ‹‰æˆ‘çœ‹ä»–ä»¬æçš„æ–°æ’ä»¶ï¼Œæˆ–è€…æ˜¯ä»–ä»¬äº’ç›¸åœ¨è‡ªå·±çš„ç¼–è¾‘å™¨ä¸Šå®ç°äº†å¯¹æ–¹çš„æ’ä»¶çš„åŠŸèƒ½ã€‚<br>è¯´å®è¯æˆ‘ä¹Ÿä¸æ˜¯æ²¡ç”¨è¿‡ vim æˆ–è€… emacsï¼Œä½†æ˜¯æœ€å¤§çš„é—®é¢˜å…¶å®æ˜¯ï¼Œå¯¹æˆ‘æ¥è¯´å­¦ä¹ æˆæœ¬éå¸¸å¤§ï¼Œé‡åˆ°ä¸€ç‚¹å°é—®é¢˜ï¼Œæˆ‘å°±ä¼šä¸ç”±è‡ªä¸»çš„å›æƒ³èµ· vscode çš„å¥½ï¼Œç„¶åå°±ä¸æƒ³æŠ˜è…¾äº†ã€‚<br>è¿™å¯¹æˆ‘å…¶å®æ˜¯ä¸å¥½çš„ï¼Œæ¯•ç«Ÿæˆ‘æ˜¯ä¸€ä¸ªçˆ±æŠ˜è…¾çš„äººã€‚</p><p>æ‰€ä»¥æˆ‘åˆä¸€æ¬¡æŠ˜è…¾èµ·äº† emacsï¼Œæ¯ä¸€æ¬¡æŠ˜è…¾éƒ½ä¼šè®©æˆ‘å­¦ä¹ åˆ°æ–°çš„å†…å®¹ï¼Œä»æœ€å¼€å§‹çš„æ‡µé€¼ï¼Œåˆ°ç°åœ¨å·²ç»ä¼šç®€å•çš„ç”¨ lisp å†™ä¸€äº›æ’ä»¶ã€‚æ¯ä¸€æ¬¡éƒ½æœ‰æå‡ï¼Œä¸è¿‡å°±æ˜¯æ— ç”¨åŠŸæ¯”è¾ƒå¤šã€‚</p><p>ä½†æ˜¯æœ¬ç¯‡å…ˆä¸æŠ˜è…¾ emacsï¼Œè¿™æ¬¡æˆ‘æƒ³å…ˆå†™ä¸€ä¸‹æˆ‘å­¦ä¹ åˆ°çš„ vim çš„é…ç½®ã€‚</p><h2 id="neovim"><a href="#neovim" class="headerlink" title="neovim"></a>neovim</h2><p>vim é˜µè¥å…¶å®å¯ä»¥ç®€å•çš„åˆ†ä¸º vim å’Œ neovimï¼Œä¸ºä»€ä¹ˆä¼šæœ‰ä¸¤ä¸ªé˜µè¥å‘¢ï¼Ÿç®€å•æ¥è¯´å°±æ˜¯ neovim çš„ä½œè€…å—ä¸äº† vim çš„ä½œè€…ï¼Œæ‰€ä»¥ fork å‡ºæ¥å¢åŠ è‡ªå·±çš„åŠŸèƒ½ï¼Œç»“æœä»åŸç‰ˆé‚£é‡Œæ‹‰æ¥äº†å¾ˆå¤šçš„ç”¨æˆ·ï¼Œ<br>vim ä½œè€…ä¸€çœ‹é˜µåŠ¿ä¸å¯¹ï¼Œèµ¶ç´§åˆåå‘å¢åŠ åŠŸèƒ½ï¼Œç°åœ¨ä¸¤è€…çš„åŒºåˆ«å·²ç»ä¸æ˜¯å¾ˆå¤§äº†ã€‚</p><p>ä½¿ç”¨ neovim ä½œä¸ºæˆ‘çš„ä¸» vim ç¼–è¾‘å™¨æ˜¯å› ä¸ºå®ƒæ”¯æŒ lua è„šæœ¬ä½œä¸ºé…ç½®æ–‡ä»¶ï¼Œlua è„šæœ¬æ¯”è¾ƒå¥½ä¸Šæ‰‹ä¸€äº›ã€‚</p><h2 id="åŸºæœ¬é…ç½®"><a href="#åŸºæœ¬é…ç½®" class="headerlink" title="åŸºæœ¬é…ç½®"></a>åŸºæœ¬é…ç½®</h2><p>neovim çš„é…ç½®æ–‡ä»¶åœ¨ <code>~/.config/nvim/</code>ã€‚</p><p>å…¥å£æ–‡ä»¶æ˜¯ <code>init.vim</code>ï¼Œé‡Œé¢å†™çš„å†…å®¹å¾ˆç®€å•ï¼Œå°±æ˜¯åŠ è½½ lua è„šæœ¬ã€‚</p><figure class="highlight lua"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot; åŸºç¡€è®¾ç½®</span></span><br><span class="line"><span class="string">lua require(&#x27;basic&#x27;)</span></span><br></pre></td></tr></table></figure><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œlua è„šæœ¬å¿…é¡»éƒ½æ”¾åœ¨ init.vim åŒçº§çš„ lua ç›®å½•é‡Œã€‚</p><p>æˆ‘ä½¿ç”¨ packer ä½œä¸º vim çš„æ’ä»¶ç®¡ç†ç³»ç»Ÿï¼Œvim æœ‰å¾ˆå¤šæ’ä»¶ç³»ç»Ÿï¼Œæˆ‘é€‰æ‹©å®ƒæ²¡æœ‰å•¥ç†ç”±ï¼Œå°±æ˜¯éšæ‰‹ç”¨äº†ä¸€ä¸ªã€‚</p><p>å®‰è£… picker éœ€è¦æ‰‹åŠ¨ä¸‹è½½ï¼Œä½†æ˜¯è¿™æ ·å¯èƒ½ä¼šåœ¨æ›´æ¢ç¯å¢ƒçš„æ—¶å€™å¿˜è®°ï¼Œæ‰€ä»¥æˆ‘å†™åœ¨äº†è„šæœ¬é‡Œï¼Œæ£€æµ‹å¹¶è‡ªåŠ¨ä¸‹è½½ã€‚</p><p>åœ¨ <code>~/.config/nvim/lua/basic.lua</code> é‡Œå°±å¯ä»¥å†™ lua è„šæœ¬å»æ‰§è¡Œæ›´å¤æ‚çš„æŒ‡ä»¤ï¼Œæ¯”å¦‚åŠ è½½æ’ä»¶ã€‚</p><figure class="highlight lua"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- utf8</span></span><br><span class="line"><span class="comment">-- é«˜äº®æ‰€åœ¨è¡Œ</span></span><br><span class="line">vim.wo.cursorline = <span class="literal">true</span></span><br><span class="line"><span class="comment">-- å³ä¾§å‚è€ƒçº¿ï¼Œè¶…è¿‡è¡¨ç¤ºä»£ç å¤ªé•¿äº†ï¼Œè€ƒè™‘æ¢è¡Œ</span></span><br><span class="line">vim.wo.colorcolumn = <span class="string">&quot;80&quot;</span></span><br><span class="line"><span class="comment">-- ç¼©è¿›2ä¸ªç©ºæ ¼ç­‰äºä¸€ä¸ªTab</span></span><br><span class="line">vim.o.tabstop = <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> fn = vim.fn</span><br><span class="line"><span class="comment">-- ä¸‹è½½ packer</span></span><br><span class="line"><span class="keyword">local</span> install_path = fn.stdpath(<span class="string">&#x27;data&#x27;</span>)..<span class="string">&#x27;/site/pack/packer/start/packer.nvim&#x27;</span></span><br><span class="line"><span class="keyword">local</span> is_startup = <span class="literal">false</span></span><br><span class="line"><span class="keyword">if</span> fn.empty(fn.glob(install_path)) &gt; <span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">  fn.system(&#123;<span class="string">&#x27;git&#x27;</span>, <span class="string">&#x27;clone&#x27;</span>, <span class="string">&#x27;--depth&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;https://github.com/wbthomason/packer.nvim&#x27;</span>, install_path&#125;)</span><br><span class="line">  vim.cmd<span class="string">[[packadd packer.nvim]]</span></span><br><span class="line">  is_startup = <span class="literal">true</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- åˆå§‹åŒ– packer</span></span><br><span class="line"><span class="keyword">return</span> <span class="built_in">require</span>(<span class="string">&#x27;packer&#x27;</span>).startup(</span><br><span class="line">  <span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">    <span class="keyword">local</span> use = <span class="built_in">require</span>(<span class="string">&#x27;packer&#x27;</span>).use</span><br><span class="line">    <span class="keyword">local</span> home = <span class="built_in">os</span>.<span class="built_in">getenv</span>(<span class="string">&quot;HOME&quot;</span>)</span><br><span class="line">    <span class="comment">-- ä½¿ç”¨ ~/.config/nvim/lua/plugins-d ä½œä¸ºæ’ä»¶çš„ç›®å½•</span></span><br><span class="line">    <span class="keyword">local</span> plugins = <span class="built_in">io</span>.<span class="built_in">popen</span>(<span class="string">&#x27;find &quot;&#x27;</span>.. home .. <span class="string">&#x27;/.config/nvim/lua/plugins-d/&#x27;</span>..<span class="string">&#x27;&quot; -type f&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> plugin <span class="keyword">in</span> plugins:<span class="built_in">lines</span>() <span class="keyword">do</span></span><br><span class="line">      <span class="comment">-- æ’ä»¶çš„æ ‡å‡†æ–‡ä»¶åæ˜¯è¿™ç§å½¢å¼ _lsp.lua</span></span><br><span class="line">      <span class="keyword">local</span> part1, part2 = <span class="built_in">string</span>.<span class="built_in">match</span>(plugin,home .. <span class="string">&quot;/[.]config/nvim/lua/(.*)_(.*)[.]lua&quot;</span>)</span><br><span class="line">      <span class="keyword">if</span> part1 ~= <span class="literal">nil</span> <span class="keyword">and</span> part2 ~= <span class="literal">nil</span> <span class="keyword">then</span></span><br><span class="line">        plugin = part1 .. <span class="string">&#x27;_&#x27;</span> .. part2</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        plugin = <span class="string">&#x27;&#x27;</span></span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line">      <span class="keyword">if</span> plugin ~= <span class="string">&#x27;&#x27;</span> <span class="keyword">then</span></span><br><span class="line">        use(<span class="built_in">require</span>(plugin))</span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">if</span> is_startup <span class="keyword">then</span></span><br><span class="line">      <span class="built_in">require</span>(<span class="string">&#x27;packer&#x27;</span>).sync()</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>æ–°å»ºä¸€ä¸ª plugins-d ç›®å½•ï¼Œå°±å¯ä»¥å†™æ’ä»¶äº†ï¼Œä½¿ç”¨ vim ä½œä¸ºå¼€å‘å·¥å…·ï¼Œç¬¬ä¸€ä»¶äº‹è‚¯å®šæ˜¯å…ˆé…ç½®å¥½è¯­è¨€æœåŠ¡å™¨ã€‚</p><p>æ–°å»º <code>~/.config/nvim/lua/plugins-d/_lsp.lua</code></p><figure class="highlight lua"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- https://github.com/neovim/nvim-lspconfig</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- Description:</span></span><br><span class="line"><span class="comment">-- lsp configs for neovim builtin lsp</span></span><br><span class="line"></span><br><span class="line">Capabilities = vim.lsp.protocol.make_client_capabilities()</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Use an on_attach function to only map the following keys</span></span><br><span class="line"><span class="comment">-- after the language server attaches to the current buffer</span></span><br><span class="line">On_Attach_hooks = &#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">On_Attach</span> <span class="params">(client, bufnr)</span></span></span><br><span class="line">  <span class="keyword">local</span> wk = <span class="built_in">require</span>(<span class="string">&quot;which-key&quot;</span>)</span><br><span class="line">  <span class="keyword">local</span> key_opts = &#123;</span><br><span class="line">    <span class="comment">-- mode   Help        Affected                              Equivalent</span></span><br><span class="line">    <span class="comment">-- &#x27;&#x27;     mapmode-nvo Normal/Visual/Select/Operator-pending :map</span></span><br><span class="line">    <span class="comment">-- &#x27;n&#x27;    mapmode-n  Normal                                :nmap</span></span><br><span class="line">    <span class="comment">-- &#x27;v&#x27;    mapmode-v   Visual/Select                         :vmap</span></span><br><span class="line">    <span class="comment">-- &#x27;s&#x27;    mapmode-s  Select                                :smap</span></span><br><span class="line">    <span class="comment">-- &#x27;x&#x27;    mapmode-x  Visual                                :xmap</span></span><br><span class="line">    <span class="comment">-- &#x27;o&#x27;    mapmode-o   Operator-pending                      :omap</span></span><br><span class="line">    <span class="comment">-- &#x27;!&#x27;    mapmode-ic  Insert/Command-line                   :map!</span></span><br><span class="line">    <span class="comment">-- &#x27;i&#x27;    mapmode-i   Insert                                :imap</span></span><br><span class="line">    <span class="comment">-- &#x27;l&#x27;    mapmode-l   Insert/Command-line/Lang-Arg          :lmap</span></span><br><span class="line">    <span class="comment">-- &#x27;c&#x27;    mapmode-c   Command-line                          :cmap</span></span><br><span class="line">    <span class="comment">-- &#x27;t&#x27;    mapmode-t   Terminal                              :tmap</span></span><br><span class="line">    mode    = <span class="string">&quot;n&quot;</span>,</span><br><span class="line">    buffer  = <span class="number">0</span>, <span class="comment">-- local mappings</span></span><br><span class="line">    silent  = <span class="literal">true</span>, <span class="comment">-- use `silent ` when creating keymaps</span></span><br><span class="line">    noremap = <span class="literal">true</span>, <span class="comment">-- use `noremap` when creating keymaps</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  wk.register(</span><br><span class="line">    &#123;</span><br><span class="line">      [<span class="string">&quot;K&quot;</span>] = &#123;</span><br><span class="line">        <span class="string">&quot;&lt;cmd&gt;lua vim.lsp.buf.hover()&lt;CR&gt;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;LSP:: hover&quot;</span> &#125;,</span><br><span class="line">      [<span class="string">&quot;&lt;C-k&gt;&quot;</span>] = &#123;</span><br><span class="line">        <span class="string">&quot;&lt;cmd&gt;lua vim.lsp.buf.signature_help()&lt;CR&gt;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;LSP:: signature help&quot;</span> &#125;,</span><br><span class="line">      [<span class="string">&quot;&lt;space&gt;rn&quot;</span>] = &#123;</span><br><span class="line">        <span class="string">&quot;&lt;cmd&gt;lua vim.lsp.buf.rename()&lt;CR&gt;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;LSP:: rename&quot;</span> &#125;,</span><br><span class="line">      [<span class="string">&quot;&lt;space&gt;f&quot;</span>] = &#123;</span><br><span class="line">        <span class="string">&quot;&lt;cmd&gt;lua vim.lsp.buf.formatting()&lt;CR&gt;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;LSP:: format&quot;</span> &#125;,</span><br><span class="line">      [<span class="string">&quot;&lt;space&gt;E&quot;</span>] = &#123;</span><br><span class="line">        <span class="string">&quot;&lt;cmd&gt;lua vim.diagnostic.open_float()&lt;CR&gt;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;LSP:: float diagnostic&quot;</span> &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    key_opts</span><br><span class="line">  )</span><br><span class="line"></span><br><span class="line">  key_opts = &#123;</span><br><span class="line">    mode    = <span class="string">&quot;n&quot;</span>,</span><br><span class="line">    buffer  = <span class="number">0</span>, <span class="comment">-- local mappings</span></span><br><span class="line">    silent  = <span class="literal">true</span>, <span class="comment">-- use `silent ` when creating keymaps</span></span><br><span class="line">    noremap = <span class="literal">false</span>, <span class="comment">-- not use `noremap` when creating keymaps</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  wk.register(</span><br><span class="line">    &#123;</span><br><span class="line">      [<span class="string">&quot;gd&quot;</span>] = &#123;</span><br><span class="line">        <span class="string">&quot;&lt;cmd&gt;lua vim.lsp.buf.definition()&lt;cr&gt;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;LSP:: definition&quot;</span> &#125;,</span><br><span class="line">      [<span class="string">&quot;gr&quot;</span>] = &#123;</span><br><span class="line">        <span class="string">&quot;&lt;cmd&gt;lua vim.lsp.buf.references()&lt;cr&gt;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;LSP:: reference&quot;</span> &#125;,</span><br><span class="line">      [<span class="string">&quot;gi&quot;</span>] = &#123;</span><br><span class="line">        <span class="string">&quot;&lt;cmd&gt;lua vim.lsp.buf.implementation()&lt;cr&gt;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;LSP:: implementation&quot;</span> &#125;,</span><br><span class="line">      [<span class="string">&quot;gy&quot;</span>] = &#123;</span><br><span class="line">        <span class="string">&quot;&lt;cmd&gt;lua vim.lsp.buf.type_definition()&lt;cr&gt;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;LSP:: type definition&quot;</span> &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    key_opts</span><br><span class="line">  )</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> _, hook <span class="keyword">in</span> <span class="built_in">ipairs</span>(On_Attach_hooks) <span class="keyword">do</span></span><br><span class="line">    <span class="keyword">if</span> hook ~= <span class="literal">nil</span> <span class="keyword">then</span></span><br><span class="line">      hook(client, bufnr)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> <span class="function"><span class="keyword">function</span> <span class="title">config</span><span class="params">()</span></span></span><br><span class="line">  <span class="keyword">local</span> nvim_lsp = <span class="built_in">require</span>(<span class="string">&#x27;lspconfig&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">-- Use a loop to conveniently call &#x27;setup&#x27; on multiple servers and</span></span><br><span class="line">  <span class="comment">-- map buffer local keybindings when the language server attaches</span></span><br><span class="line">  <span class="keyword">local</span> servers =&#123;</span><br><span class="line">    <span class="string">&#x27;ccls&#x27;</span>,</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> _, lsp <span class="keyword">in</span> <span class="built_in">ipairs</span>(servers) <span class="keyword">do</span></span><br><span class="line">    <span class="keyword">local</span> default = &#123;</span><br><span class="line">      flags = &#123;</span><br><span class="line">        debounce_text_changes = <span class="number">150</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      on_attach = On_Attach,</span><br><span class="line">      capabilities = Capabilities</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">local</span> cfg = vim.tbl_deep_extend(<span class="string">&#x27;force&#x27;</span>, default, <span class="built_in">require</span>(<span class="string">&#x27;lsp-d/&#x27;</span>..lsp..<span class="string">&#x27;_&#x27;</span>))</span><br><span class="line">    nvim_lsp[lsp].setup(cfg)</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> &#123;</span><br><span class="line">  <span class="string">&#x27;neovim/nvim-lspconfig&#x27;</span>,</span><br><span class="line">  <span class="built_in">config</span> = <span class="built_in">config</span>,</span><br><span class="line">  after = &#123;</span><br><span class="line">    <span class="string">&#x27;nvim-cmp&#x27;</span>,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸è¦çœ‹æ–‡ä»¶å¾ˆé•¿ï¼Œå…¶å®å¤§éƒ¨åˆ†éƒ½æ˜¯ nvim çš„é»˜è®¤ lsp-config é…ç½®ï¼Œè€Œä¸”å¤§éƒ¨åˆ†é…ç½®ä¸€çœ¼å°±èƒ½çœ‹å¾—æ‡‚ï¼Œæœ€å¼€å§‹ On_Attach å‡½æ•°æ˜¯åœ¨å¤„ç†å¿«æ·é”®ç›¸å…³çš„ï¼Œå³ä½¿ä¸äº†è§£ vim å¦‚ä½•å®šä¹‰å¿«æ·é”®ï¼Œä¹Ÿä¸å½±å“çœ‹è¿™ä¸ªé…ç½®æ–‡ä»¶ã€‚</p><p>åœ¨ config å‡½æ•°ä¸­ï¼Œæœ‰ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«äº† cclsï¼Œè¿™é‡Œçš„æ„æ€æ˜¯å»åŠ è½½ ccls è¯­è¨€æœåŠ¡å™¨ï¼Œnvim ç»™äº†ä¸€åˆ†åˆ—è¡¨ï¼Œå¯ä»¥æŸ¥æ‰¾è‡ªå·±ä½¿ç”¨çš„<a href="https://github.com/neovim/nvim-lspconfig/blob/master/doc/server_configurations.md">è¯­è¨€æœåŠ¡å™¨</a>çš„åç§°ã€‚</p><p>åœ¨ config å‡½æ•°é‡Œï¼Œlocal cfg è¿™é‡Œæ˜¯å®šä¹‰æŸ¥æ‰¾æ–‡ä»¶çš„ï¼Œæˆ‘è¿™é‡Œæ˜¯å¬ä»äº† <a href="https://github.com/black_desk">black_desk</a> çš„å»ºè®®ï¼Œå¦‚æœæ–‡ä»¶åæ˜¯ _ å¼€å¤´çš„ï¼Œå°±å±è”½è¿™ä¸ªæ–‡ä»¶ï¼Œå¯ä»¥å¿«é€Ÿè¿›è¡Œè°ƒè¯•ã€‚</p><p>åœ¨ <code>~/.config/nvim/lua/lsp-d/ccls_.lua</code> é‡Œå†™å…¥é…ç½®å†…å®¹ï¼Œå°±å¯ä»¥å¯ç”¨ ccls è¯­è¨€æœåŠ¡å™¨äº†ã€‚</p><figure class="highlight lua"><table><tr><td class="code"><pre><span class="line"><span class="keyword">local</span> home = <span class="built_in">os</span>.<span class="built_in">getenv</span>(<span class="string">&#x27;HOME&#x27;</span>)</span><br><span class="line"><span class="keyword">return</span> &#123;</span><br><span class="line">  init_options = &#123;</span><br><span class="line">    cache = &#123;</span><br><span class="line">      directory = home .. <span class="string">&quot;/.ccls-cache&quot;</span>,</span><br><span class="line">      retainInMemory = <span class="number">0</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">-- highlight = &#123;</span></span><br><span class="line">      <span class="comment">-- lsRanges = true,</span></span><br><span class="line">    <span class="comment">-- &#125;</span></span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é»˜è®¤ nvim æ˜¯å®šä¹‰äº†å¾ˆå¤šå€¼ï¼Œå¹¶ä¸æ˜¯æ¯ä¸€ä¸ªè¯­è¨€æœåŠ¡å™¨éƒ½éœ€è¦å®šä¹‰ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå³ä½¿æ²¡æœ‰ä½¿ç”¨é…ç½®æ–‡ä»¶ï¼Œä¹Ÿéœ€è¦åˆ›å»ºç›¸åº”çš„æ–‡ä»¶ï¼Œå¹¶è¿”å›ä¸€ä¸ªç©ºå¯¹è±¡ã€‚</p><p>åŸºæœ¬é…ç½®å·²ç»å®Œæˆäº†ï¼Œåªå·®æœ€åä¸€æ­¥äº†ï¼Œè¿˜è®°å¾—ä¸€å¼€å§‹æˆ‘è¯´çš„ä½¿ç”¨äº† packer ä½œä¸ºæ’ä»¶ç®¡ç†å™¨äº†ä¹ˆï¼Œç°åœ¨å°±éœ€è¦ç¼–è¯‘ä¸€éé…ç½®æ–‡ä»¶ï¼Œè®© packer èƒ½åŠ è½½æˆ‘ä»¬çš„æ’ä»¶ã€‚</p><p>æ‰§è¡Œå‘½ä»¤ <code>nvim +PackerCompile</code>ï¼Œç„¶åé€€å‡º vimã€‚å¦‚æœæ”¹åŠ¨äº†é…ç½®æ–‡ä»¶ï¼Œéƒ½éœ€è¦é‡æ–°æ‰§è¡Œä¸€æ¬¡è¿™æ ·çš„å‘½ä»¤ï¼Œå¦åˆ™é…ç½®å°†ä¸ä¼šç”Ÿæ•ˆã€‚</p><p>ä¸‹é¢æ˜¯æˆ‘çš„ä½¿ç”¨æˆªå›¾ã€‚</p><img src="/2022/03/22/vim%E7%AE%80%E5%8D%95%E9%85%8D%E7%BD%AE/ts.png" class="" title="ts"><img src="/2022/03/22/vim%E7%AE%80%E5%8D%95%E9%85%8D%E7%BD%AE/ts-lsp.png" class="" title="ts-lsp"><img src="/2022/03/22/vim%E7%AE%80%E5%8D%95%E9%85%8D%E7%BD%AE/cpp.png" class="" title="cpp"><img src="/2022/03/22/vim%E7%AE%80%E5%8D%95%E9%85%8D%E7%BD%AE/cpp-lsp.png" class="" title="cpp">]]></content>
      
      
      
        <tags>
            
            <tag> vim </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CSS å¤–è¾¹è·æŠ˜å é—®é¢˜</title>
      <link href="/2022/03/16/css-mastering-margin-collapsing/"/>
      <url>/2022/03/16/css-mastering-margin-collapsing/</url>
      
        <content type="html"><![CDATA[<p>åœ¨å­¦ä¹  CSS ç»ƒä¹ å…ƒç´ æµ®åŠ¨çš„æ—¶å€™ï¼Œæˆ‘å‘ç°äº†ä¸€ä¸ªå¥‡æ€ªçš„ç°è±¡ï¼Œå°±æ˜¯ä¸Šä¸‹ä¸¤ä¸ªå—å…ƒç´ ä¼¼ä¹è·ç¦»å¤ªè¿‘äº†ï¼Œæ— è®ºæˆ‘æ€ä¹ˆå¢åŠ ä¸Šä¸‹ marginsï¼Œå§‹ç»ˆéƒ½ä¸ä¼šæŒ‰ç…§æˆ‘é¢„æœŸçš„é‚£æ ·æ˜¾ç¤ºã€‚</p><p>æŸ¥é˜…äº†ä¸€äº›èµ„æ–™å‘ç°è¿™æ˜¯ä¸€ä¸ª CSS çš„ç‰¹å®šï¼Œå« <code>å¤–è¾¹è·æŠ˜å </code>ï¼Œåœ¨CSSä¸­ï¼Œä¸¤ä¸ªæˆ–å¤šä¸ªç›¸é‚»çš„æ™®é€šæµä¸­çš„ç›’å­ï¼ˆå¯èƒ½æ˜¯çˆ¶å­å…ƒç´ ï¼Œä¹Ÿå¯èƒ½æ˜¯å…„å¼Ÿå…ƒç´ ï¼‰åœ¨å‚ç›´æ–¹å‘ä¸Šçš„å¤–è¾¹è·ä¼šå‘ç”Ÿå åŠ ï¼Œè¿™ç§å½¢æˆçš„å¤–è¾¹è·ç§°ä¹‹ä¸ºå¤–è¾¹è·å åŠ ã€‚</p><p>W3C å¯¹äºå¤–è¾¹è·å åŠ çš„å®šä¹‰ï¼š</p><blockquote><p>In CSS, the adjoining margins of two or more boxes (which might or might not be siblings) can combine to form a single margin. Margins that combine this way are said to collapse, and the resulting combined margin is called a collapsed margin.</p></blockquote><p>åœ¨ W3C ä¸­ï¼Œå¯¹ç›¸é‚»ä¹Ÿæœ‰å®šä¹‰:</p><blockquote><p>Two margins are adjoining if and only if:</p><ul><li><p>both belong to in-flow block-level boxes that participate in the same block formatting context</p></li><li><p>no line boxes, no clearance, no padding and no border separate them</p></li><li><p>both belong to vertically-adjacent box edges, i.e. form one of the following pairs:</p><ul><li>top margin of a box and top margin of its first in-flow child</li><li>bottom margin of box and top margin of its next in-flow following sibling</li><li>bottom margin of a last in-flow child and bottom margin of its parent if the &gt; parent has â€œautoâ€ computed height</li><li>top and bottom margins of a box that does not establish a new block formatting context and that has zero computed â€œmin-heightâ€, zero or â€œautoâ€ computed â€œheightâ€, and no in-flow children</li></ul></li></ul></blockquote><p>ç¿»è¯‘ï¼š</p><blockquote><p>ä¸¤ä¸ªè¾¹è·ç›¸é‚»å½“ä¸”ä»…å½“ï¼š</p><ul><li><p>éƒ½å±äºæ™®é€šæµçš„å—çº§ç›’å­ä¸”å‚ä¸åˆ°ç›¸åŒçš„å—çº§æ ¼å¼ä¸Šä¸‹æ–‡ä¸­</p></li><li><p>æ²¡æœ‰è¢«paddingã€borderã€clearå’Œline boxåˆ†éš”å¼€</p></li><li><p>éƒ½å±äºå‚ç›´ç›¸é‚»ç›’å­è¾¹ç¼˜ï¼š</p><ul><li>ç›’å­çš„top marginå’Œå®ƒç¬¬ä¸€ä¸ªæ™®é€šæµå­å…ƒç´ çš„top margin</li><li>ç›’å­çš„bottom marginå’Œå®ƒä¸‹ä¸€ä¸ªæ™®é€šæµå…„å¼Ÿçš„top margin</li><li>ç›’å­çš„bottom marginå’Œå®ƒçˆ¶å…ƒç´ çš„bottom margin</li><li>ç›’å­çš„top marginå’Œbottom marginï¼Œä¸”æ²¡æœ‰åˆ›å»ºä¸€ä¸ªæ–°çš„å—çº§æ ¼å¼ä¸Šä¸‹æ–‡ï¼Œä¸”æœ‰è¢«è®¡ç®—ä¸º0çš„min-heightï¼Œè¢«è®¡ç®—ä¸º0æˆ–autoçš„heightï¼Œä¸”æ²¡æœ‰æ™®é€šæµå­å…ƒç´ </li></ul></li></ul></blockquote><p>ä¸‹é¢æ¥å†™ä¸€ä¸ªå°ä¾‹å­:</p><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.container1</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">30px</span>;</span><br><span class="line">    <span class="attribute">background</span>: green;</span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.container2</span> &#123;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">10px</span> <span class="number">0</span> <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.container3</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">20px</span>;</span><br><span class="line">    <span class="attribute">background</span>: blue;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.child</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: red;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">10px</span> <span class="number">0</span> <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;<span class="selector-tag">div</span> class=&quot;container1&quot;&gt;&lt;/<span class="selector-tag">div</span>&gt;</span><br><span class="line">&lt;<span class="selector-tag">div</span> class=&quot;container2&quot;&gt;</span><br><span class="line">    &lt;<span class="selector-tag">div</span> class=&quot;child&quot;&gt;&lt;/<span class="selector-tag">div</span>&gt;</span><br><span class="line">    &lt;<span class="selector-tag">div</span> class=&quot;child&quot;&gt;&lt;/<span class="selector-tag">div</span>&gt;</span><br><span class="line">    &lt;<span class="selector-tag">div</span> class=&quot;child&quot;&gt;&lt;/<span class="selector-tag">div</span>&gt;</span><br><span class="line">&lt;/<span class="selector-tag">div</span>&gt;</span><br><span class="line">&lt;<span class="selector-tag">div</span> class=&quot;container3&quot;&gt;&lt;/<span class="selector-tag">div</span>&gt;</span><br></pre></td></tr></table></figure><p>æ˜¾ç¤ºæ•ˆæœå¦‚ä¸‹:</p><center><img src="/2022/03/16/css-mastering-margin-collapsing/tg_image_1874748614.jpg" class="" width="1"></center><center><img src="/2022/03/16/css-mastering-margin-collapsing/tg_image_3289103855.jpg" class="" width="2"></center><p>å¯ä»¥çœ‹åˆ°ï¼Œä¸Šä¸€ä¸ªå…ƒç´ çš„èŒƒå›´å·²ç»åˆ°äº†ä¸‹ä¸€ä¸ªå…ƒç´ çš„é¡¶éƒ¨ï¼Œè€Œä¸‹ä¸€ä¸ªå…ƒç´ çš„ä¸Šå¤–è¾¹ç¼˜ï¼Œå·²ç»è¢«æŠ˜å åœ¨äº†ä¸€èµ·ã€‚</p><p>è¿™æ ·çš„è¯æˆ‘ä»¬å°±æ— æ³•æŒ‰ç…§æœŸæœ›å»å¸ƒå±€äº†ï¼Œé‚£ä¹ˆæœ‰ä»€ä¹ˆåŠæ³•å¯ä»¥è§£å†³å—ï¼Ÿ</p><p>æ—¢ç„¶å¤–è¾¹è·çš„æŠ˜å æ˜¯æœ‰æ¡ä»¶çš„ï¼Œåªè¦æƒ³åŠæ³•ç ´åæ¡ä»¶ï¼Œå°±å¯ä»¥é¿å…è¿™ä¸ªé—®é¢˜äº†ã€‚</p><p>è€Œä¸” W3C ä¹Ÿç»™å‡ºäº†è§£å†³åŠæ³•:</p><blockquote><ul><li>Margins between a floated box and any other box do not collapse (not even between a float and its in-flow children).</li><li>Margins of elements that establish new block formatting contexts (such as floats and elements with â€œoverflowâ€ other than â€œvisibleâ€) do not collapse with their in-flow children.</li><li>Margins of absolutely positioned boxes do not collapse (not even with their in-flow children).</li><li>Margins of inline-block boxes do not collapse (not even with their in-flow children).</li><li>The bottom margin of an in-flow block-level element always collapses with the top margin of its next in-flow block-level sibling, unless that sibling has clearance.</li><li>The top margin of an in-flow block element collapses with its first in-flow block-level childâ€s top margin if the element has no top border, no top padding, and the child has no clearance.</li><li>The bottom margin of an in-flow block box with a â€œheightâ€ of â€œautoâ€ and a â€œmin-heightâ€ of zero collapses with its last in-flow block-level childâ€s bottom margin if the box has no bottom padding and no bottom border and the childâ€s bottom margin does not collapse with a top margin that has clearance.</li><li>A boxâ€s own margins collapse if the â€œmin-heightâ€ property is zero, and it has neither top or bottom borders nor top or bottom padding, and it has a â€œheightâ€ of either 0 or â€œautoâ€, and it does not contain a line box, and all of its in-flow childrenâ€s margins (if any) collapse.</li></ul></blockquote><p>ç¿»è¯‘ä¸‹å°±æ˜¯:</p><blockquote><ul><li>æµ®åŠ¨å…ƒç´ ä¸ä¼šä¸ä»»ä½•å…ƒç´ å‘ç”Ÿå åŠ ï¼Œä¹ŸåŒ…æ‹¬å®ƒçš„å­å…ƒç´ </li><li>åˆ›å»ºäº† BFC çš„å…ƒç´ ä¸ä¼šå’Œå®ƒçš„å­å…ƒç´ å‘ç”Ÿå¤–è¾¹è·å åŠ </li><li>ç»å¯¹å®šä½å…ƒç´ å’Œå…¶ä»–ä»»ä½•å…ƒç´ ä¹‹é—´ä¸å‘ç”Ÿå¤–è¾¹è·å åŠ ï¼Œä¹ŸåŒ…æ‹¬å®ƒçš„å­å…ƒç´ </li><li>inline-block å…ƒç´ å’Œå…¶ä»–ä»»ä½•å…ƒç´ ä¹‹é—´ä¸å‘ç”Ÿå¤–è¾¹è·å åŠ ï¼Œä¹ŸåŒ…æ‹¬å®ƒçš„å­å…ƒç´ </li><li>æ™®é€šæµä¸­çš„å—çº§å…ƒç´ çš„ margin-bottom æ°¸è¿œå’Œå®ƒç›¸é‚»çš„ä¸‹ä¸€ä¸ªå—çº§å…ƒç´ çš„ margin-top å åŠ ï¼Œé™¤éç›¸é‚»çš„å…„å¼Ÿå…ƒç´  clear</li><li>æ™®é€šæµä¸­çš„å—çº§å…ƒç´ ï¼ˆæ²¡æœ‰ border-topã€æ²¡æœ‰ padding-topï¼‰çš„ margin-top å’Œå®ƒçš„ç¬¬ä¸€ä¸ªæ™®é€šæµä¸­çš„å­å…ƒç´ ï¼ˆæ²¡æœ‰clearï¼‰å‘ç”Ÿ margin-top å åŠ </li><li>æ™®é€šæµä¸­çš„å—çº§å…ƒç´ ï¼ˆheightä¸º autoã€min-heightä¸º0ã€æ²¡æœ‰ border-bottomã€æ²¡æœ‰ padding-bottomï¼‰å’Œå®ƒçš„æœ€åä¸€ä¸ªæ™®é€šæµä¸­çš„å­å…ƒç´ ï¼ˆæ²¡æœ‰è‡ªèº«å‘ç”Ÿmarginå åŠ æˆ–clearï¼‰å‘ç”Ÿ margin-bottomå åŠ </li><li>å¦‚æœä¸€ä¸ªå…ƒç´ çš„ min-height ä¸º0ã€æ²¡æœ‰ borderã€æ²¡æœ‰paddingã€é«˜åº¦ä¸º0æˆ–è€…autoã€ä¸åŒ…å«å­å…ƒç´ ï¼Œé‚£ä¹ˆå®ƒè‡ªèº«çš„å¤–è¾¹è·ä¼šå‘ç”Ÿå åŠ </li></ul></blockquote><p>è¿˜å¥½ä»¥å‰å†™äº†ä¸€ä¸ªæµ®åŠ¨çš„ç¬”è®°ï¼Œå¯ä»¥æ‹¿æ¥ç”¨ã€‚</p><p>è·³è½¬æŸ¥çœ‹ <a href="/2021/08/07/CSS%E6%B5%AE%E5%8A%A8%E7%AC%94%E8%AE%B0/" title="CSSæµ®åŠ¨ç¬”è®°">CSSæµ®åŠ¨ç¬”è®°</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> CSS </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨ if constexpr å®ç°æ¡ä»¶ç¼–è¯‘</title>
      <link href="/2022/03/10/if-constexpr/"/>
      <url>/2022/03/10/if-constexpr/</url>
      
        <content type="html"><![CDATA[<p>åœ¨é¡¹ç›®å¼€å‘ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šä½¿ç”¨æ¡ä»¶ç¼–è¯‘å¯¹ä»£ç è¿›è¡Œè£å‰ªï¼Œé€‰æ‹©æ€§åœ°æ’é™¤ä¸éœ€è¦çš„ä»£ç ï¼Œæ¯”å¦‚åœ¨æŸä¸ªå¹³å°ä¸‹å®Œå…¨ä¸æ”¯æŒæŸä¸ªåŠŸèƒ½ï¼Œé‚£ä¹ˆè¿™ä¸ªåŠŸèƒ½å°±ä¸åº”è¯¥è¢«ç¼–è¯‘ã€‚</p><p>ä¸€èˆ¬æˆ‘ä»¬ä½¿ç”¨å®æ¥åˆ¤æ–­ä»£ç ï¼Œé€‰æ‹©æ€§çš„æŒ‘é€‰éœ€è¦ç¼–è¯‘çš„éƒ¨åˆ†ï¼Œå¹¶åœ¨æ„å»ºç³»ç»Ÿä¸­å¼€å¯è¿™æ ·çš„æ¡ä»¶ã€‚</p><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifdef</span> XXXXXXXXXX</span></span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;hello world!&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;good bye!&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure><p>åœ¨ C è¯­è¨€çš„é¡¹ç›®ä¸­ï¼Œè¿™æ ·çš„è¡Œä¸ºæ˜¯å¾ˆæ­£å¸¸çš„ï¼Œç”šè‡³åœ¨ C++ é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿä¼šé€‰æ‹©ä½¿ç”¨å®è¿›è¡Œæ¡ä»¶åˆ¤æ–­ã€‚</p><p>ä½†æ˜¯å¦‚æœå®šä¹‰çš„å®å¤šäº†ï¼Œåˆ™å¾ˆå®¹æ˜“å¯¼è‡´ä»£ç ç¢ç‰‡åŒ–ï¼Œå¹¶ä¸”æ— æ³•ç›´è§‚åœ°çœ‹åˆ°å·¥ä½œæµç¨‹ã€‚</p><p>ä¾‹å¦‚è¿™æ ·çš„ä»£ç :</p><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> KWIN_VERSION_CHECK(major, minor, patch, build) ((major&lt;&lt;24)|(minor&lt;&lt;16)|(patch&lt;&lt;8)|build)</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> KWIN_VERSION_STR</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> KWIN_VERSION KWIN_VERSION_CHECK(KWIN_VERSION_MAJ, KWIN_VERSION_MIN, KWIN_VERSION_PAT, KWIN_VERSION_BUI)</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> defined(KWIN_VERSION) &amp;&amp; KWIN_VERSION &lt; KWIN_VERSION_CHECK(5, 21, 3, 0)</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">int</span> TimeArgType;</span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line"><span class="keyword">typedef</span> std::chrono::milliseconds TimeArgType;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> defined(Q_OS_LINUX) &amp;&amp; !defined(QT_NO_DYNAMIC_LIBRARY) &amp;&amp; !defined(QT_NO_LIBRARY)</span></span><br><span class="line"><span class="function">QT_BEGIN_NAMESPACE</span></span><br><span class="line"><span class="function">QFunctionPointer <span class="title">qt_linux_find_symbol_sys</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *symbol)</span></span>;</span><br><span class="line"><span class="function">QT_END_NAMESPACE</span></span><br><span class="line"><span class="function">QFunctionPointer <span class="title">KWinUtils::resolve</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *symbol)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">QT_PREPEND_NAMESPACE</span>(qt_linux_find_symbol_sys)(symbol);</span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line"><span class="function">QFunctionPointer <span class="title">KWinUtils::resolve</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *symbol)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">static</span> QString lib_name = <span class="string">&quot;kwin.so.&quot;</span> + qApp-&gt;<span class="built_in">applicationVersion</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> QLibrary::<span class="built_in">resolve</span>(lib_name, symbol);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»ä¸Šé¢çš„ä¾‹å­ä¸­å¯ä»¥çœ‹åˆ°ï¼Œä»£ç ä¸­ä¸€æ—¦å‡ºç°å¤§é‡é‡å¤çš„åˆ¤æ–­æ¡ä»¶ï¼Œä»£ç éå¸¸ä¸ç›´è§‚ï¼Œè€Œä¸”è¢«å®åˆ†å‰²æˆäº†å¾ˆå¤šéƒ¨åˆ†ã€‚</p><p>åœ¨ä¸€æ¬¡å¶ç„¶çš„æœºä¼šï¼Œæˆ‘çœ‹åˆ°äº†ä¸€ç¯‡ä»‹ç» C++ 17 ä¸­çš„ if constexpr çš„ç”¨æ³•ï¼Œå¯ä»¥åœ¨ç¼–è¯‘æœŸè¿›è¡Œä¸€äº›è®¡ç®—ï¼Œè™½ç„¶æˆ‘å¾ˆæ—©å°±çŸ¥é“äº† constexpr çš„ç”¨æ³•ï¼Œä½†æ˜¯å¤§å®¶ä¸¾çš„ä¾‹å­åŸºæœ¬ä¸Šéƒ½æ˜¯æ•°å€¼è®¡ç®—ï¼Œè®©ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æœŸé—´å°†æ•°å€¼è¿›è¡Œè®¡ç®—ï¼Œä»è€Œå‡è½»è¿è¡Œæ—¶çš„æ¶ˆè€—ï¼Œæˆ‘ä¹Ÿä»æ¥æƒ³åˆ°å…¶ä»–ç”¨æ³•ï¼Œæ‰€ä»¥ä¸€ç›´æ²¡æœ‰åœ¨é¡¹ç›®ä¸­ä½¿ç”¨åˆ°ã€‚</p><p>constexpr çš„ä½œç”¨å¹¶ä¸æ˜¯ç¼–è¯‘æœŸè®¡ç®—æ•°å€¼ï¼Œè€Œæ˜¯ç¼–è¯‘æœŸè¿›è¡Œçš„ä»£ç åˆ†æï¼Œå¦‚æœä»£ç è¾ƒå°ä¸”éå¸¸ç›´è§‚ï¼Œæ¯”å¦‚å¤§å®¶ç»å¸¸ä¸¾çš„ä¾‹å­ï¼Œåœ¨ç¼–è¯‘æœŸé—´è®¡ç®—æ–æ³¢é‚£å¥‘æ•°åˆ—ï¼Œè¿™ç§ä¾‹å­å³ä½¿ä¸ä½¿ç”¨ constexpr æ˜¾å¼è¦æ±‚ï¼Œç¼–è¯‘å™¨ä¹Ÿä¼šå¸®åŠ©æˆ‘ä»¬å¼€å¯ä¼˜åŒ–ï¼Œç›´æ¥ç»™å‡ºç»“æœã€‚</p><p>ä½†æ˜¯å¦‚æœä»£ç éå¸¸å¤æ‚ï¼Œç¼–è¯‘å™¨å°±ä¸ä¸€å®šä¼šä¸ºæˆ‘ä»¬åšè¿™æ ·çš„ä¼˜åŒ–ï¼Œå°±éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨æ ‡è®°å¯ä»¥è®¡ç®—çš„ä½ç½®ï¼Œè¦æ±‚ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æœŸé—´è¿›è¡Œæ±‚å€¼å’Œä¼˜åŒ–ã€‚</p><p>æˆ‘è®¾æƒ³çš„æ˜¯ï¼Œä½¿ç”¨ cmake åœ¨æ„å»ºæ—¶ï¼Œå…ˆç”Ÿæˆä¸€ä»½æ–‡ä»¶ï¼Œå°†å¼€å…³çš„å€¼è®°å½•ä¸‹æ¥ï¼Œåœ¨éœ€è¦è¿›è¡Œåˆ¤æ–­çš„åœ°æ–¹ï¼Œå°±å¯ä»¥ç›´æ¥ä½¿ç”¨ if constexpr è¿›è¡Œæ¡ä»¶åˆ¤æ–­ï¼Œåœ¨ç¼–è¯‘æœŸé—´ï¼Œç¼–è¯‘å™¨ä¼šå‘ç°æœ‰ä¸€ä¸ªåˆ†æ”¯ç¡®å®šä¸ä¼šè¢«æ‰§è¡Œï¼ˆç›¸å½“äº  <code>if(false) &#123;&#125;</code>ï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ªåˆ†æ”¯å°±ä¸ä¼šè¿›è¡Œç¼–è¯‘ï¼Œç›´æ¥å‰”é™¤ã€‚</p><p>CMakeLists.txt ä¸­éœ€è¦åšä¸€äº›å·¥ä½œï¼Œå°†ç¼–è¯‘å‚æ•°åŠ å…¥æ„å»ºç³»ç»Ÿã€‚</p><figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="keyword">option</span> (ENABLE_MODULE <span class="string">&quot;Enable Module&quot;</span> <span class="keyword">ON</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(ENABLE_MODULE)</span><br><span class="line">    <span class="keyword">set</span>(ENABLE_MODULE <span class="string">&quot;1&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>()</span><br><span class="line">    <span class="keyword">set</span>(ENABLE_MODULE <span class="string">&quot;0&quot;</span>)</span><br><span class="line"><span class="keyword">endif</span>(ENABLE_MODULE)</span><br><span class="line"></span><br><span class="line"><span class="keyword">configure_file</span> (</span><br><span class="line">  <span class="string">&quot;$&#123;CMAKE_CURRENT_SOURCE_DIR&#125;/options/options.h.in&quot;</span></span><br><span class="line">  <span class="string">&quot;$&#123;CMAKE_CURRENT_BINARY_DIR&#125;/options/options.h&quot;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>åœ¨ options&#x2F;options.h.in æ–‡ä»¶é‡Œï¼ŒæŒ‰ç…§ cmake çš„è¦æ±‚å°†å˜é‡å¯¼å…¥è¿›æ–‡ä»¶ä¸­ï¼Œè¿›è¡Œå†…å®¹æ›¿æ¢ã€‚</p><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line">#cmakedefine01 ENABLE_MODULE</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»ç„¶ä½¿ç”¨çš„æ˜¯å®å®šä¹‰ï¼Œä¹Ÿå¯ä»¥ç›´æ¥å†™æˆå¦‚ä¸‹å½¢å¼:</p><figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="keyword">option</span> (ENABLE_MODULE <span class="string">&quot;Enable Module&quot;</span> <span class="keyword">ON</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(ENABLE_MODULE)</span><br><span class="line">    <span class="keyword">set</span>(ENABLE_MODULE <span class="string">&quot;true&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>()</span><br><span class="line">    <span class="keyword">set</span>(ENABLE_MODULE <span class="string">&quot;false&quot;</span>)</span><br><span class="line"><span class="keyword">endif</span>(ENABLE_MODULE)</span><br><span class="line"></span><br><span class="line"><span class="keyword">configure_file</span> (</span><br><span class="line">  <span class="string">&quot;$&#123;CMAKE_CURRENT_SOURCE_DIR&#125;/options/options.h.in&quot;</span></span><br><span class="line">  <span class="string">&quot;$&#123;CMAKE_CURRENT_BINARY_DIR&#125;/options/options.h&quot;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">bool</span> ENABLE_MODULE&#123;@ENABLE_MODULE@&#125;;</span><br></pre></td></tr></table></figure><p>åœ¨ main.cpp ä¸­å†™ä¸€æ®µæµ‹è¯•ä»£ç :</p><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;options/options.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">if</span> <span class="title">constexpr</span> <span class="params">(ENABLE_MODULE)</span> </span>&#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;Now Enable Module&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">if</span> <span class="title">constexpr</span> <span class="params">(!ENABLE_MODULE)</span> </span>&#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;Now Disable Module&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œç»“æœæ˜¯ç¬¦åˆé¢„æœŸçš„ã€‚</p><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line"># lxz @ lxz-MacBook-Pro in ~/Develop/constexpr-demo/build on git:master o [13:28:39]</span><br><span class="line">$ cmake ../ -G Ninja -DENABLE_MODULE=ON</span><br><span class="line">-- The CXX compiler identification is AppleClang 13.0.0.13000029</span><br><span class="line">-- Detecting CXX compiler ABI info</span><br><span class="line">-- Detecting CXX compiler ABI info - done</span><br><span class="line">-- Check for working CXX compiler: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/c++ - skipped</span><br><span class="line">-- Detecting CXX compile features</span><br><span class="line">-- Detecting CXX compile features - done</span><br><span class="line">-- Configuring done</span><br><span class="line">-- Generating done</span><br><span class="line">-- Build files have been written to: /Users/lxz/Develop/constexpr-demo/build</span><br><span class="line"></span><br><span class="line"># lxz @ lxz-MacBook-Pro in ~/Develop/constexpr-demo/build on git:master o [13:28:45]</span><br><span class="line">$ ninja</span><br><span class="line">[2/2] Linking CXX executable src/constexpr</span><br><span class="line"></span><br><span class="line"># lxz @ lxz-MacBook-Pro in ~/Develop/constexpr-demo/build on git:master o [13:28:48]</span><br><span class="line">$ ./src/constexpr</span><br><span class="line">Now Enable Module</span><br><span class="line"></span><br><span class="line"># lxz @ lxz-MacBook-Pro in ~/Develop/constexpr-demo/build on git:master o [13:28:52]</span><br><span class="line">$ cmake ../ -G Ninja -DENABLE_MODULE=OFF</span><br><span class="line">-- Configuring done</span><br><span class="line">-- Generating done</span><br><span class="line">-- Build files have been written to: /Users/lxz/Develop/constexpr-demo/build</span><br><span class="line"></span><br><span class="line"># lxz @ lxz-MacBook-Pro in ~/Develop/constexpr-demo/build on git:master o [13:28:58]</span><br><span class="line">$ ninja</span><br><span class="line">[2/2] Linking CXX executable src/constexpr</span><br><span class="line"></span><br><span class="line"># lxz @ lxz-MacBook-Pro in ~/Develop/constexpr-demo/build on git:master o [13:29:00]</span><br><span class="line">$ ./src/constexpr</span><br><span class="line">Now Disable Module</span><br></pre></td></tr></table></figure><p>è™½ç„¶ç»“æœæ˜¯ç¬¦åˆçš„ï¼Œä½†æ˜¯æˆ‘ä»¬å…¶å®ä¸ç¡®å®šæ˜¯å¦çœŸçš„åœ¨ç¼–è¯‘æœŸé—´å°±å®Œæˆäº†ä»£ç å‰”é™¤ï¼Œæ‰€ä»¥ä½¿ç”¨å‘½ä»¤è¿›è¡Œæ±‡ç¼–ï¼ŒæŸ¥çœ‹æ±‡ç¼–ä¸­æ˜¯å¦åŒ…å«äº†åˆ¤æ–­æŒ‡ä»¤å’Œä¸¤æ®µè¾“å‡ºçš„å­—ç¬¦ä¸²ã€‚</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">clang -S main.cpp -o main.s -I./</span><br></pre></td></tr></table></figure><p>main.s</p><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">.text</span><br><span class="line">.file&quot;main.cpp&quot;</span><br><span class="line">.globlmain                            // -- Begin function main</span><br><span class="line">.p2align2</span><br><span class="line">.typemain,@function</span><br><span class="line">main:                                   // @main</span><br><span class="line">.cfi_startproc</span><br><span class="line">// %bb.0:</span><br><span class="line">stpx29, x30, [sp, #-32]!           // 16-byte Folded Spill</span><br><span class="line">strx19, [sp, #16]                  // 8-byte Folded Spill</span><br><span class="line">movx29, sp</span><br><span class="line">.cfi_def_cfa w29, 32</span><br><span class="line">.cfi_offset w19, -16</span><br><span class="line">.cfi_offset w30, -24</span><br><span class="line">.cfi_offset w29, -32</span><br><span class="line">adrpx19, :got:_ZSt4cout</span><br><span class="line">ldrx19, [x19, :got_lo12:_ZSt4cout]</span><br><span class="line">adrpx1, .L.str</span><br><span class="line">addx1, x1, :lo12:.L.str</span><br><span class="line">movw2, #18</span><br><span class="line">movx0, x19</span><br><span class="line">bl_ZSt16__ostream_insertIcSt11char_traitsIcEERSt13basic_ostreamIT_T0_ES6_PKS3_l</span><br><span class="line">ldrx8, [x19]</span><br><span class="line">ldurx8, [x8, #-24]</span><br><span class="line">addx8, x8, x19</span><br><span class="line">ldrx19, [x8, #240]</span><br><span class="line">cbzx19, .LBB0_5</span><br><span class="line">// %bb.1:</span><br><span class="line">ldrbw8, [x19, #56]</span><br><span class="line">cbzw8, .LBB0_3</span><br><span class="line">// %bb.2:</span><br><span class="line">ldrbw1, [x19, #67]</span><br><span class="line">b.LBB0_4</span><br><span class="line">.LBB0_3:</span><br><span class="line">movx0, x19</span><br><span class="line">bl_ZNKSt5ctypeIcE13_M_widen_initEv</span><br><span class="line">ldrx8, [x19]</span><br><span class="line">movw1, #10</span><br><span class="line">movx0, x19</span><br><span class="line">ldrx8, [x8, #48]</span><br><span class="line">blrx8</span><br><span class="line">movw1, w0</span><br><span class="line">.LBB0_4:</span><br><span class="line">adrpx0, :got:_ZSt4cout</span><br><span class="line">ldrx0, [x0, :got_lo12:_ZSt4cout]</span><br><span class="line">bl_ZNSo3putEc</span><br><span class="line">bl_ZNSo5flushEv</span><br><span class="line">ldrx19, [sp, #16]                  // 8-byte Folded Reload</span><br><span class="line">movw0, wzr</span><br><span class="line">ldpx29, x30, [sp], #32             // 16-byte Folded Reload</span><br><span class="line">ret</span><br><span class="line">.LBB0_5:</span><br><span class="line">bl_ZSt16__throw_bad_castv</span><br><span class="line">.Lfunc_end0:</span><br><span class="line">.sizemain, .Lfunc_end0-main</span><br><span class="line">.cfi_endproc</span><br><span class="line">                                        // -- End function</span><br><span class="line">.section.text.startup,&quot;ax&quot;,@progbits</span><br><span class="line">.p2align2                               // -- Begin function _GLOBAL__sub_I_main.cpp</span><br><span class="line">.type_GLOBAL__sub_I_main.cpp,@function</span><br><span class="line">_GLOBAL__sub_I_main.cpp:                // @_GLOBAL__sub_I_main.cpp</span><br><span class="line">.cfi_startproc</span><br><span class="line">// %bb.0:</span><br><span class="line">stpx29, x30, [sp, #-32]!           // 16-byte Folded Spill</span><br><span class="line">strx19, [sp, #16]                  // 8-byte Folded Spill</span><br><span class="line">movx29, sp</span><br><span class="line">.cfi_def_cfa w29, 32</span><br><span class="line">.cfi_offset w19, -16</span><br><span class="line">.cfi_offset w30, -24</span><br><span class="line">.cfi_offset w29, -32</span><br><span class="line">adrpx19, _ZStL8__ioinit</span><br><span class="line">addx19, x19, :lo12:_ZStL8__ioinit</span><br><span class="line">movx0, x19</span><br><span class="line">bl_ZNSt8ios_base4InitC1Ev</span><br><span class="line">adrpx0, :got:_ZNSt8ios_base4InitD1Ev</span><br><span class="line">ldrx0, [x0, :got_lo12:_ZNSt8ios_base4InitD1Ev]</span><br><span class="line">movx1, x19</span><br><span class="line">ldrx19, [sp, #16]                  // 8-byte Folded Reload</span><br><span class="line">adrpx2, __dso_handle</span><br><span class="line">addx2, x2, :lo12:__dso_handle</span><br><span class="line">ldpx29, x30, [sp], #32             // 16-byte Folded Reload</span><br><span class="line">b__cxa_atexit</span><br><span class="line">.Lfunc_end1:</span><br><span class="line">.size_GLOBAL__sub_I_main.cpp, .Lfunc_end1-_GLOBAL__sub_I_main.cpp</span><br><span class="line">.cfi_endproc</span><br><span class="line">                                        // -- End function</span><br><span class="line">.type_ZStL8__ioinit,@object          // @_ZStL8__ioinit</span><br><span class="line">.local_ZStL8__ioinit</span><br><span class="line">.comm_ZStL8__ioinit,1,1</span><br><span class="line">.hidden__dso_handle</span><br><span class="line">.type.L.str,@object                  // @.str</span><br><span class="line">.section.rodata.str1.1,&quot;aMS&quot;,@progbits,1</span><br><span class="line">.L.str:</span><br><span class="line">.asciz&quot;Now Disable Module&quot; // å…³é”®åœ¨è¿™é‡Œ</span><br><span class="line">.size.L.str, 19</span><br><span class="line"></span><br><span class="line">.section.init_array,&quot;aw&quot;,@init_array</span><br><span class="line">.p2align3</span><br><span class="line">.xword_GLOBAL__sub_I_main.cpp</span><br><span class="line">.ident&quot;clang version 13.0.1&quot;</span><br><span class="line">.section&quot;.note.GNU-stack&quot;,&quot;&quot;,@progbits</span><br><span class="line">.addrsig</span><br><span class="line">.addrsig_sym _GLOBAL__sub_I_main.cpp</span><br><span class="line">.addrsig_sym _ZStL8__ioinit</span><br><span class="line">.addrsig_sym __dso_handle</span><br><span class="line">.addrsig_sym _ZSt4cout</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹æ•´ä¸ª main.s æ±‡ç¼–ï¼Œå‘ç°åªåœ¨ .L.str æ®µä¸­æœ‰é¢„æœŸçš„æ–‡æœ¬å­—ç¬¦ä¸²ï¼Œå¯ä»¥å¾—å‡ºç»“è®ºï¼Œä»£ç æ˜¯åœ¨ç¼–è¯‘æœŸé—´å®Œæˆäº†å‰”é™¤ï¼Œç¬¦åˆæˆ‘ä»¬çš„è¦æ±‚ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>latex ç¯å¢ƒé…ç½®</title>
      <link href="/2022/03/08/latex-environment-config/"/>
      <url>/2022/03/08/latex-environment-config/</url>
      
        <content type="html"><![CDATA[<p>åœ¨æˆ‘åˆšå¼€å§‹å­¦ä¹ ä½¿ç”¨ Linux çš„æ—¶å€™ï¼Œç»å¸¸èƒ½çœ‹åˆ°ä¸€äº›äººåœ¨é¼“å¹ texã€markdownã€org-mode ä¹‹ç±»çš„æ–‡æ¡£ç¼–å†™æ–¹å¼çš„å¥½å¤„ï¼Œç”šè‡³åˆ†åŒ–å‡ºä¸åŒçš„é˜µè¥ï¼Œäº’ç›¸æ‹‰æ‹¢ï¼ˆ<del>å¿½æ‚ </del>ï¼‰å…¶ä»–åˆšå…¥é—¨çš„äººã€‚</p><p>åæ¥æˆ‘æ¸æ¸å–œæ¬¢ä¸Šäº† markdownï¼Œå› ä¸ºå®ƒå†™èµ·æ¥è¶³å¤Ÿç®€å•ï¼Œä¸Šæ‰‹éš¾åº¦è¾ƒä½ï¼Œè€Œä¸”æˆ‘çš„åšå®¢æ˜¯ç”¨ hexo æ­å»ºçš„ï¼Œå®ƒéœ€è¦ markdown ä½œä¸ºåšå®¢æ–‡ç« ï¼Œæ‰€ä»¥æˆ‘é€æ¸å°±ä½¿ç”¨èµ·æ¥äº† markdownã€‚</p><p>åœ¨å…¬å¸é‡Œï¼Œè™½ç„¶ markdown å†™èµ·æ¥éå¸¸ç®€å•ï¼Œä½†æ˜¯å…¬å¸å†…éƒ¨çš„æ–‡æ¡£æ˜¯æœ‰æ ¼å¼è¦æ±‚çš„ï¼Œæ’ç‰ˆè¢«æä¸Šäº†æ—¥ç¨‹ï¼Œè€Œæ’ç‰ˆæ°æ°æ˜¯ markdown çš„ç¡¬ä¼¤ï¼Œmarkdown å¯ä»¥è¯´å‡ ä¹æ²¡æœ‰æ’ç‰ˆçš„åŠŸèƒ½ï¼Œå®ƒæ˜¯è½»é‡çš„æ ‡è®°è¯­è¨€ï¼Œæ²¡æœ‰äººç»™å®ƒæä¾›å¤æ‚çš„æ’ç‰ˆï¼Œæ‰€ä»¥æˆ‘ä»¬çš„ç›®æ ‡å˜æˆäº†éœ€è¦ä¸€ç§æ–¹ä¾¿è¿›è¡Œæ–‡æœ¬ diff åˆä¸æ˜¯ word è¿™ç±»è½¯ä»¶ï¼Œæœ€ç»ˆæˆ‘ä»¬çš„ç›®æ ‡è½åœ¨äº† latex ä¸Šã€‚</p><p>åœ¨ 20 ä¸–çºªï¼Œè®¡ç®—æœºæ•™æˆé«˜å¾·çº³ï¼ˆDonald Ervin Knuthï¼‰ç¼–å†™äº†ä¸€ä¸ªæ’ç‰ˆè½¯ä»¶ï¼Œå®ƒå¯ä»¥å¤„ç†éå¸¸å¤æ‚çš„æ•°å­¦å…¬å¼ï¼Œåæ¥å‘å±•å‡ºäº†éå¸¸å¤šçš„è¯­è¨€æ’ç‰ˆï¼Œå®ƒåœ¨å­¦æœ¯ç•Œç‰¹åˆ«æ˜¯æ•°å­¦ã€ç‰©ç†å­¦å’Œè®¡ç®—æœºç§‘å­¦ç•Œååˆ†æµè¡Œã€‚tex è¢«æ™®éè®¤ä¸ºæ˜¯ä¸€ä¸ªä¼˜ç§€çš„æ’ç‰ˆå·¥å…·ï¼Œå°¤å…¶æ˜¯å¯¹äºå¤æ‚æ•°å­¦å…¬å¼çš„å¤„ç†ã€‚åˆ©ç”¨ latex ç­‰ç»ˆç«¯è½¯ä»¶ï¼Œtex å°±èƒ½å¤Ÿæ’ç‰ˆå‡ºç²¾ç¾çš„æ–‡æœ¬ä»¥å¸®åŠ©äººä»¬è¾¨è®¤å’ŒæŸ¥æ‰¾ã€‚</p><p>latex æ˜¯ä¸€ç§åŸºäº tex çš„æ’ç‰ˆç³»ç»Ÿï¼Œåˆ©ç”¨è¿™ç§æ ¼å¼ç³»ç»Ÿçš„å¤„ç†ï¼Œå³ä½¿ç”¨æˆ·æ²¡æœ‰æ’ç‰ˆå’Œç¨‹åºè®¾è®¡çš„çŸ¥è¯†ä¹Ÿå¯ä»¥å……åˆ†å‘æŒ¥ç”± tex æ‰€æä¾›çš„å¼ºå¤§åŠŸèƒ½ï¼Œä¸å¿…ä¸€ä¸€äº²è‡ªå»è®¾è®¡æˆ–æ ¡å¯¹ï¼Œèƒ½åœ¨å‡ å¤©ï¼Œç”šè‡³å‡ å°æ—¶å†…ç”Ÿæˆå¾ˆå¤šå…·æœ‰ä¹¦ç±è´¨é‡çš„å°åˆ·å“ã€‚</p><p>ç›®å‰æ¥çœ‹ï¼Œæˆ‘ä»¬ä½¿ç”¨ latex å†™æ–‡æ¡£ï¼Œè¿›è¡Œ git æäº¤ï¼Œåœ¨ä½¿ç”¨çš„æ—¶å€™ç¼–è¯‘æˆ pdfï¼Œå‘é€ç»™å…¶ä»–äººä½¿ç”¨ï¼Œå…¶ä»–äººæ›´æ–°æ–‡æ¡£æˆ‘ä»¬ä¹Ÿå¯ä»¥éå¸¸æ–¹ä¾¿è¿›è¡Œ reviewã€‚</p><p>æ‰€ä»¥æˆ‘å°±éœ€è¦åœ¨æœ¬åœ°é…ç½®ä¸€ä¸‹ latex çš„ç¯å¢ƒï¼Œä»¥åŠä½¿ç”¨ vscode è¿›è¡Œ latex æ–‡æ¡£çš„ç¼–å†™ã€‚</p><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>ç”±äºæˆ‘åœ¨ä½¿ç”¨ macOSï¼Œæ‰€ä»¥æˆ‘éœ€è¦è¿›è¡Œçš„æ­¥éª¤è¦æ¯”ä½¿ç”¨ deepin å¤šä¸€äº›ã€‚</p><p>åœ¨ deepin ä¸Šï¼Œåªéœ€è¦å®‰è£… texlive-lang-cjk å’Œ texlive-xetex ä¸¤ä¸ªåŒ…å°±å¯ä»¥äº†ã€‚</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo apt install texlive-lang-cjk texlive-xetex</span><br></pre></td></tr></table></figure><p>åœ¨ macOS ä¸Šï¼Œéœ€è¦ä½¿ç”¨ homebrew å®‰è£… mactexï¼Œè¿™æ˜¯ä¸“é—¨é’ˆå¯¹ mac ç³»ç»Ÿä¼˜åŒ–çš„ tex å‘è¡Œç‰ˆã€‚</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">brew install mactex</span><br></pre></td></tr></table></figure><p>å®‰è£…å®Œ mactex ä»¥åï¼Œéœ€è¦æ‰“å¼€ TeX Live Utilityï¼Œç„¶åé€‰æ‹©æ›´æ–°ï¼Œå°†æ‰€æœ‰åŒ…æ›´æ–°åˆ°æœ€æ–°ã€‚å¦‚æœè§‰å¾—ç½‘é€Ÿæ…¢ï¼Œå¯ä»¥ä½¿ç”¨å›½å†…çš„é•œåƒåŠ é€Ÿä¸‹è½½ã€‚</p><p>é˜…è¯» <a href="https://mirrors.bfsu.edu.cn/help/CTAN/">https://mirrors.bfsu.edu.cn/help/CTAN/</a> ä½¿ç”¨é•œåƒã€‚</p><p>ä»¥ä¸Šå®‰è£…å·¥ä½œå°±ç»“æŸäº†ã€‚</p><h2 id="é…ç½®æ¨¡æ¿"><a href="#é…ç½®æ¨¡æ¿" class="headerlink" title="é…ç½®æ¨¡æ¿"></a>é…ç½®æ¨¡æ¿</h2><p>ä¸ºäº†æ–¹ä¾¿æ¯ä¸ªäººå†™çš„æ–‡æ¡£éƒ½æ»¡è¶³å…¬å¸çš„è¦æ±‚ï¼Œæ‰€ä»¥æˆ‘ä»¬å‡†å¤‡äº†ä¸€ä»½å…¬å¸çš„ latex æ¨¡æ¿ï¼Œlatex çš„æ¨¡æ¿è§„å®šäº†ä¸€äº›ç›®å½•ï¼Œåªè¦æ”¾åœ¨æ¨¡æ¿ç›®å½•å³å¯ä½¿ç”¨ã€‚</p><p>Linux: <code>/usr/share/texlive/texmf-dist/tex/latex/</code></p><p>macOS: <code>~/Library/texmf/tex/latex/</code></p><h2 id="vscode"><a href="#vscode" class="headerlink" title="vscode"></a>vscode</h2><p>ä»¥ä¸Šå‡†å¤‡å·¥ä½œåšå¥½ä»¥åï¼Œæ‰“å¼€ vscodeï¼Œå®‰è£… <code>LaTeX Workshop</code> æ’ä»¶ï¼Œå…¶ä»–æ’ä»¶å¯ä»¥ä¸ç”¨å®‰è£…ï¼Œè¿™ä¸ªæ’ä»¶ä¼šå¸®åŠ©æˆ‘ä»¬è‡ªåŠ¨è¡¥å…¨è¯­æ³•ã€é«˜äº®å’Œæ ¼å¼åŒ–ã€‚</p><p>å‡†å¤‡å®Œæ¯•ä»¥åï¼Œå°±å¯ä»¥æ„‰å¿«å†™ latex äº†ï¼Œæœ¬ç¯‡æ–‡ç« å¹¶ä¸ä¼šæ•™å¤§å®¶å¦‚ä½•å†™ latexï¼Œåªæ˜¯ä»‹ç»ä¸€ä¸‹ latexï¼Œä»¥åŠæˆ‘ä½¿ç”¨çš„é…ç½®ã€‚</p><p>é¦–å…ˆç»™ vscode é…ç½®ä»¥ä¸‹çš„å·¥ä½œåŒºé…ç½®:</p><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;latex-workshop.latex.outDir&quot;</span><span class="punctuation">:</span> <span class="string">&quot;%DIR%/build&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;latex-workshop.view.pdf.viewer&quot;</span><span class="punctuation">:</span> <span class="string">&quot;tab&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;latex-workshop.latex.autoBuild.cleanAndRetry.enabled&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;latex-workshop.latex.autoClean.run&quot;</span><span class="punctuation">:</span> <span class="string">&quot;onFailed&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;latex-workshop.latex.clean.subfolder.enabled&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;latex-workshop.latex.clean.fileTypes&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span> <span class="string">&quot;*.aux&quot;</span> <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;latex-workshop.latex.tools&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;xelatex&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;xelatex&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;-synctex=1&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;-interaction=nonstopmode&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;-file-line-error&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;--shell-escape&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;-pdf&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;--output-directory=%OUTDIR%&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;%DOCFILE%&quot;</span></span><br><span class="line">            <span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pdflatex&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pdflatex&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;-synctex=1&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;-interaction=nonstopmode&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;-file-line-error&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;--output-directory=%OUTDIR%&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;%DOCFILE%&quot;</span></span><br><span class="line">            <span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;bibtex&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;bibtex&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;%OUTDIR%/%DOCFILE%&quot;</span></span><br><span class="line">            <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;env&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;TEXMFOUTPUT&quot;</span><span class="punctuation">:</span> <span class="string">&quot;%OUTDIR%&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;latex-workshop.latex.recipes&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;xelatex&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;tools&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;xelatex&quot;</span></span><br><span class="line">            <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pdflatex&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;tools&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;pdflatex&quot;</span></span><br><span class="line">            <span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;xe-&gt;bib-&gt;xe-&gt;xe&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;tools&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;xelatex&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;bibtex&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;xelatex&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;xelatex&quot;</span></span><br><span class="line">            <span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pdf-&gt;bib-&gt;pdf-&gt;pdf&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;tools&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;pdflatex&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;bibtex&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;pdflatex&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;pdflatex&quot;</span></span><br><span class="line">            <span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>åœ¨é…ç½®ä¸­ï¼Œè¿™æ®µçš„ä½œç”¨æ˜¯æ§åˆ¶è¾“å‡ºç›®å½•ã€è‡ªåŠ¨æ„å»ºå’Œæ¸…ç†ã€‚</p><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;latex-workshop.latex.outDir&quot;</span><span class="punctuation">:</span> <span class="string">&quot;%DIR%/build&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;latex-workshop.view.pdf.viewer&quot;</span><span class="punctuation">:</span> <span class="string">&quot;tab&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;latex-workshop.latex.autoBuild.cleanAndRetry.enabled&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;latex-workshop.latex.autoClean.run&quot;</span><span class="punctuation">:</span> <span class="string">&quot;onFailed&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;latex-workshop.latex.clean.subfolder.enabled&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;latex-workshop.latex.clean.fileTypes&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span> <span class="string">&quot;*.aux&quot;</span> <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥çš„æ­¥éª¤æ˜¯æ§åˆ¶ç¼–è¯‘çš„ï¼Œä¸ºä»€ä¹ˆéœ€è¦å†™è¿™ä¹ˆé•¿å‘¢ï¼Œå› ä¸º latex å…¶å®ä¸æ”¯æŒä¸­æ–‡çš„ï¼Œæ”¯æŒä¸­æ–‡çš„æ˜¯ xelatexï¼Œæˆ‘ä»¬éœ€è¦é‡å†™ç¼–è¯‘å‚æ•°ï¼Œå¦åˆ™è¾“å‡ºçš„ pdf æ˜¯ä¸ä¼šæ˜¾ç¤ºä¸­æ–‡çš„ã€‚</p><p>åœ¨ <code>latex-workshop.latex.tools</code> ä¸­ï¼Œæˆ‘ä»¬å¢åŠ äº†ä¸‰ä¸ªæ–°çš„æ„å»ºæŒ‡ä»¤ï¼Œç”¨äºå¤„ç†æˆ‘ä»¬çš„ latex æ–‡æ¡£ã€‚</p><p>åœ¨ <code>latex-workshop.latex.recipes</code> ä¸­ï¼Œç¬¬ä¸€ä¸ª recipe ä¸ºé»˜è®¤çš„ç¼–è¯‘å·¥å…·ï¼Œæ‰€ä»¥é»˜è®¤æˆ‘ä»¬ä¼šä½¿ç”¨ xelatex è¿›è¡Œç¼–è¯‘ï¼Œä»è€Œä½¿ç”¨æˆ‘ä»¬è‡ªå®šä¹‰çš„ç¼–è¯‘å‘½ä»¤ã€‚</p><p>ä¿å­˜å·¥ä½œåŒºé…ç½®åˆ° <code>.vscode/settings.json</code> ä¸­ï¼Œå°±å¯ä»¥æ„‰å¿«çš„å†™ latex å•¦ã€‚</p><p>æ”¾å‡ å¼ æ¼”ç¤ºå›¾ç‰‡ï¼š</p><img src="/2022/03/08/latex-environment-config/2022-03-09-09.46.35.png" class="" title="æ¼”ç¤º1"><img src="/2022/03/08/latex-environment-config/2022-03-09-09.46.44.png" class="" title="æ¼”ç¤º2">]]></content>
      
      
      
        <tags>
            
            <tag> latex </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>QDir å’Œ std::filesystem çš„ç®€å•å¯¹æ¯”</title>
      <link href="/2022/03/04/qdir-stdfilesystem/"/>
      <url>/2022/03/04/qdir-stdfilesystem/</url>
      
        <content type="html"><![CDATA[<p>ä½œä¸ºä¸€åä½¿ç”¨ Qt çš„å¼€å‘äººå‘˜ï¼ŒQt ä¸ºæˆ‘æä¾›äº†å¤§é‡å¥½ç”¨çš„åŸºç¡€è®¾æ–½ï¼Œä¾‹å¦‚å¹¿å—å¥½è¯„çš„ QStringã€QNetworkä¹‹ç±»çš„ï¼Œè¿™æ˜¯ Qt å¹³å°ä¸ºæˆ‘æä¾›çš„å¸®åŠ©ï¼Œæˆ‘åªéœ€è¦åœ¨è¿™ä¸ªå¹³å°ä¸Šå¼€å‘å°±è¶³å¤Ÿäº†ã€‚</p><p>åŒæ ·ä½œä¸ºä¸€å C++ å¼€å‘äººå‘˜ï¼ŒC++ æ ‡å‡†åº“ä¹Ÿæ˜¯æˆ‘éœ€è¦ç”¨çš„åŸºç¡€è®¾æ–½ï¼Œä½†æ˜¯æ ‡å‡†åº“æä¾›çš„åŠŸèƒ½å°±ä¸å¦‚ Qt äº†ï¼Œæœ€ä»¤äººè¯Ÿç—…çš„å°±æ˜¯ C++ çš„ std::stringï¼Œä¸šå†…å……æ–¥ç€å¯¹ std::string çš„ä¸å±‘ä¸è°©éª‚ã€‚</p><p>ä½†æ˜¯è¿™ä¸€æƒ…å†µå°†ä¼šåœ¨ C++ 20 æ ‡å‡†åæ”¹å–„ï¼Œè¿™é‡Œä¸å…·ä½“å±•å¼€ï¼Œå°†æ¥æˆ‘ä¼šå‡†å¤‡å†™ä¸€ä»½ C++ 20 çš„åŠŸèƒ½ä»‹ç»ã€‚</p><p>ä»Šå¤©åœ¨å¼€å‘é¡¹ç›®çš„æ—¶å€™ï¼Œä¸ºäº†èŠ‚çœèµ„æºï¼Œæˆ‘ä»…ä½¿ç”¨æ ‡å‡†åº“å®Œæˆå¼€å‘ï¼Œç¼ºå°‘äº† Qt å¹³å°ä¸ºæˆ‘æä¾›çš„æœ‰åˆ©å¸®åŠ©ï¼Œé¡¹ç›®å¼€å‘çš„éš¾åº¦ç¬é—´å¢åŠ ï¼Œåœ¨æ­¤æœŸé—´ï¼Œæˆ‘å‘ç°äº† C++ çš„ç›®å½•æ“ä½œä¼¼ä¹èƒ½æ¯”çš„ä¸Š Qt æä¾›çš„ QDirå°è£…ï¼Œæˆ‘æ‰“ç®—åœ¨æœ¬ç¯‡æ–‡ç« ä¸­ä»‹ç»ä¸€ä¸‹è¿™ä¸¤è€…çš„ä¸åŒã€‚</p><h2 id="QDir"><a href="#QDir" class="headerlink" title="QDir"></a>QDir</h2><p>Qt çš„åŸºæœ¬æ€è·¯æ˜¯ç»§æ‰¿å¤§äºç»„åˆï¼Œæ‰€ä»¥ Qt ä¸ºæˆ‘ä»¬æä¾›çš„éƒ½æ˜¯å„ç§ç»§æ‰¿çš„ç±»ï¼Œåœ¨ Qt ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ QDir ç±»è¿›è¡Œç›®å½•æ“ä½œã€‚</p><p>QDir ç±»ä½¿ç”¨ç›¸å¯¹æˆ–ç»å¯¹æ–‡ä»¶è·¯å¾„æ¥æŒ‡å‘ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•ã€‚å¦‚æœæ€»æ˜¯ä½¿ç”¨ â€œ&#x2F;â€ ä½œä¸ºç›®å½•åˆ†éš”ç¬¦ï¼ŒQt å°†ä¼šæŠŠä½ çš„è·¯å¾„è½¬åŒ–ä¸ºç¬¦åˆåº•å±‚çš„æ“ä½œç³»ç»Ÿçš„ã€‚</p><p>QDir ç±»ç”±äºä¸æ¶‰åŠ IO çš„å…·ä½“æ“ä½œï¼Œæ‰€ä»¥æ²¡æœ‰ç»§æ‰¿è‡ª QObject æˆ–è€…å…¶ä»– QIO çš„ç±»ã€‚</p><p>QDir æä¾›äº†éå¸¸å¤šçš„æ–¹æ³•ï¼Œå¯ä»¥æ–¹ä¾¿çš„è·å–ç›®å½•çš„åç§°ã€ç»å¯¹è·¯å¾„ã€ç›¸å¯¹è·¯å¾„ã€è®¾ç½®ç›®å½•è¿‡æ»¤å™¨ç­‰ã€‚</p><p>ä¸€ä¸ªåŸºæœ¬çš„ç”¨æ³•å¦‚ä¸‹:</p><figure class="highlight qt"><table><tr><td class="code"><pre><span class="line">QDir dir(<span class="string">&quot;/tmp&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (!dir.exists()) &#123;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> QFileInfo&amp; <span class="attribute">item</span> : dir.entryInfoList()) &#123;</span><br><span class="line">    <span class="keyword">if</span> (item.isDir()) &#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">dir.setFilter(<span class="attribute">QDir</span>::Files | <span class="attribute">QDir</span>::Hidden | <span class="attribute">QDir</span>::NoSymLinks);</span><br><span class="line">dir.setSorting(<span class="attribute">QDir</span>::Size | <span class="attribute">QDir</span>::Reversed);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> QFileInfoList&amp; <span class="built_in">list</span> = dir.entryInfoList();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> QFileInfo&amp; <span class="attribute">item</span> : <span class="built_in">list</span>) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä»£ç ä¸­å¯ä»¥çœ‹åˆ°ï¼ŒQDir æ•´ä½“æ˜¯éå¸¸ç¬¦åˆé¢å‘å¯¹è±¡çš„ï¼Œæˆ‘ä»¬ä½¿ç”¨ QDir å¯¹è±¡ï¼Œå¯¹ç›®å½•æ‰§è¡Œå„ç§æ“ä½œï¼Œæ¶‰åŠåˆ°å…·ä½“çš„æ–‡ä»¶ï¼ˆç›®å½•æ˜¯ç‰¹æ®Šçš„æ–‡ä»¶ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ QFileInfo ç±»è·å–å…·ä½“æ–‡ä»¶çš„ä¿¡æ¯ã€‚</p><p>é™¤äº†ä»¥ä¸Šæ¼”ç¤ºæ¶‰åŠåˆ°çš„æ–¹æ³•ï¼ŒQDir è¿˜æœ‰å¾ˆå¤šå…¶ä»–æ–¹æ³•ï¼Œä½¿ç”¨ <code>count()</code> æ–¹æ³•ç»Ÿè®¡ç›®å½•å†…æ–‡ä»¶å’Œç›®å½•çš„æ•°é‡ï¼Œä½¿ç”¨ <code>remove()</code> æ–¹æ³•åˆ é™¤æŒ‡å®šçš„ç›®å½•ï¼Œè¿™é‡Œå°±ä¸ä¸€ä¸€åˆ—ä¸¾äº†ã€‚</p><p>QDir æ”¯æŒè®¾ç½®å¤šç§è¿‡æ»¤ï¼Œè¿‡æ»¤(Filter) å’Œ æ’åº(Sorting) éƒ½ä¼šå½±å“åˆ° entryInfoList æ–¹æ³•è¿”å›çš„å†…å®¹ã€‚</p><p>QDir æ¥å—çš„è¿‡æ»¤å™¨æšä¸¾:</p><table><thead><tr><th>æšä¸¾</th><th>æšä¸¾å€¼</th><th>æè¿°</th></tr></thead><tbody><tr><td>QDir::Dirs</td><td>0x001</td><td>åˆ—å‡ºä¸è¿‡æ»¤å™¨åŒ¹é…çš„ç›®å½•ã€‚</td></tr><tr><td>QDir::AllDirs</td><td>0x400</td><td>åˆ—å‡ºæ‰€æœ‰ç›®å½•ï¼›å³ä¸è¦å°†è¿‡æ»¤å™¨åº”ç”¨äºç›®å½•åç§°ã€‚</td></tr><tr><td>QDir::Files</td><td>0x002</td><td>åˆ—å‡ºæ–‡ä»¶ã€‚</td></tr><tr><td>QDir::Drives</td><td>0x004</td><td>åˆ—å‡ºç£ç›˜é©±åŠ¨å™¨ï¼ˆåœ¨Unixä¸‹å¿½ç•¥ï¼‰ã€‚</td></tr><tr><td>QDir::NoSymLinks</td><td>0x008</td><td>ä¸è¦åˆ—å‡ºç¬¦å·é“¾æ¥ï¼ˆä¸æ”¯æŒç¬¦å·é“¾æ¥çš„æ“ä½œç³»ç»Ÿå¿½ç•¥ï¼‰ã€‚</td></tr><tr><td>QDir::NoDotAndDotDot</td><td>NoDot</td><td>NoDotDot</td></tr><tr><td>QDir::NoDot</td><td>0x2000</td><td>ä¸è¦åˆ—å‡ºç‰¹æ®Šæ¡ç›®â€œ.â€ã€‚</td></tr><tr><td>QDir::NoDotDot</td><td>0x4000</td><td>ä¸è¦åˆ—å‡ºç‰¹æ®Šæ¡ç›®â€œ..â€ã€‚</td></tr><tr><td>QDir::AllEntries</td><td>Dirs</td><td>Files</td></tr><tr><td>QDir::Readable</td><td>0x010</td><td>åˆ—å‡ºåº”ç”¨ç¨‹åºå…·æœ‰è¯»å–è®¿é—®æƒé™çš„æ–‡ä»¶ã€‚å¯è¯»å€¼éœ€è¦ä¸Dirsæˆ–Filesåˆå¹¶ã€‚</td></tr><tr><td>QDir::Writable</td><td>0x020</td><td>åˆ—å‡ºåº”ç”¨ç¨‹åºå…·æœ‰å†™å…¥è®¿é—®æƒé™çš„æ–‡ä»¶ã€‚å¯å†™å€¼éœ€è¦ä¸Dirsæˆ–Filesåˆå¹¶ã€‚</td></tr><tr><td>QDir::Executable</td><td>0x040</td><td>åˆ—å‡ºåº”ç”¨ç¨‹åºå…·æœ‰æ‰§è¡Œè®¿é—®æƒé™çš„æ–‡ä»¶ã€‚å¯æ‰§è¡Œå€¼éœ€è¦ä¸Dirsæˆ–Filesåˆå¹¶ã€‚</td></tr><tr><td>QDir::Modified</td><td>0x080</td><td>ä»…åˆ—å‡ºå·²ä¿®æ”¹çš„æ–‡ä»¶ï¼ˆåœ¨Unixä¸Šå¿½ç•¥ï¼‰ã€‚</td></tr><tr><td>QDir::Hidden</td><td>0x100</td><td>åˆ—å‡ºéšè—çš„æ–‡ä»¶ï¼ˆåœ¨Unixä¸Šï¼Œä»¥â€œ.â€å¼€å¤´çš„æ–‡ä»¶ï¼‰ã€‚</td></tr><tr><td>QDir::System</td><td>0x200</td><td>åˆ—å‡ºç³»ç»Ÿæ–‡ä»¶ï¼ˆåŒ…æ‹¬Unixã€FIFOã€å¥—æ¥å­—å’Œè®¾å¤‡æ–‡ä»¶ï¼›åœ¨Windowsä¸Šï¼ŒåŒ…æ‹¬.lnkæ–‡ä»¶ï¼‰</td></tr><tr><td>QDir::CaseSensitive</td><td>0x800</td><td>è¿‡æ»¤å™¨åº”è¯¥åŒºåˆ†å¤§å°å†™ã€‚</td></tr></tbody></table><p>QDir æ¥å—çš„æ’åºæšä¸¾:</p><table><thead><tr><th>æšä¸¾</th><th>æšä¸¾å€¼</th><th>æè¿°</th></tr></thead><tbody><tr><td>QDir::Name</td><td>0x00</td><td>æŒ‰åç§°æ’åºã€‚</td></tr><tr><td>QDir::Time</td><td>0x01</td><td>æŒ‰æ—¶é—´ï¼ˆä¿®æ”¹æ—¶é—´ï¼‰æ’åºã€‚</td></tr><tr><td>QDir::Size</td><td>0x02</td><td>æŒ‰æ–‡ä»¶å¤§å°æ’åºã€‚</td></tr><tr><td>QDir::Type</td><td>0x80</td><td>æŒ‰æ–‡ä»¶ç±»å‹ï¼ˆæ‰©å±•åï¼‰æ’åºã€‚</td></tr><tr><td>QDir::Unsorted</td><td>0x03</td><td>ä¸è¦æ’åºã€‚</td></tr><tr><td>QDir::NoSort</td><td>-1</td><td>é»˜è®¤æƒ…å†µä¸‹æœªæ’åºã€‚</td></tr><tr><td>QDir::DirsFirst</td><td>0x04</td><td>å…ˆæ”¾ç›®å½•ï¼Œç„¶åæ”¾æ–‡ä»¶ã€‚</td></tr><tr><td>QDir::DirsLast</td><td>0x20</td><td>å…ˆæ”¾æ–‡ä»¶ï¼Œç„¶åæ”¾ç›®å½•ã€‚</td></tr><tr><td>QDir::Reversed</td><td>0x08</td><td>é¢ å€’æ’åºé¡ºåºã€‚</td></tr><tr><td>QDir::IgnoreCase</td><td>0x10</td><td>ä¸åŒºåˆ†å¤§å°å†™çš„æ’åºã€‚</td></tr><tr><td>QDir::LocaleAware</td><td>0x40</td><td>ä½¿ç”¨å½“å‰åŒºåŸŸè®¾ç½®å¯¹é¡¹ç›®è¿›è¡Œé€‚å½“æ’åºã€‚</td></tr></tbody></table><h2 id="std-filesystem"><a href="#std-filesystem" class="headerlink" title="std::filesystem"></a>std::filesystem</h2><p>ä¸Šé¢ä»‹ç»äº† Qt çš„è®¾è®¡é£æ ¼ï¼Œè€Œæ ‡å‡†åº“çš„è®¾è®¡é£æ ¼æ˜¯ç»„åˆå¤§äºç»§æ‰¿ï¼Œæ ‡å‡†åº“æä¾›å„ç§éå¸¸å…·ä½“çš„ç±»æˆ–è€…å‡½æ•°ï¼Œå°†ä¸€ä¸ªç³»åˆ—çš„æ“ä½œæ‹†åˆ†ä¸ºå„ä¸ªå­é¡¹ï¼Œæœ€ç»ˆå®Œæˆä»»åŠ¡ã€‚</p><p>è¿™é‡Œä½¿ç”¨ä¸€ä¸ªå°ä¾‹å­æ¥è¯´æ˜ä¸€ä¸‹:</p><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">std::filesystem::path tmp&#123;<span class="string">&quot;/tmp&quot;</span>&#125;;</span><br><span class="line"><span class="keyword">if</span> (!std::filesystem::<span class="built_in">exists</span>(tmp)) &#123;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;ç›®å½•ä¸å­˜åœ¨&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">bool</span> result = std::filesystem::<span class="built_in">create_directories</span>(tmp);</span><br><span class="line"><span class="keyword">if</span> (!result) &#123;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;ç›®å½•åˆ›å»ºå¤±è´¥ï¼Œä¹Ÿè®¸æ˜¯å·²ç»å­˜åœ¨ã€‚&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> <span class="type">const</span>&amp; dir_entry : std::filesystem::<span class="built_in">directory_iterator</span>(tmp)) &#123;</span><br><span class="line">    <span class="keyword">if</span> (dir_entry.<span class="built_in">is_directory</span>()) &#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (std::filesystem::<span class="built_in">is_directory</span>(tmp)) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼ŒC++ æ ‡å‡†åº“ä½¿ç”¨å¤šä¸ªç±»å…±åŒå®Œæˆäº†å¯¹ç›®å½•çš„æ£€æŸ¥å’Œéå†ï¼Œè¿™ç§åŸºäºç»„åˆçš„æ–¹å¼å¯ä»¥å¸¦æ¥æ›´å¤šçš„çµæ´»æ€§ï¼Œå¦‚æœéœ€è¦å¯¹æŸä¸ªéƒ¨åˆ†è¿›è¡Œä¿®æ”¹ï¼Œåªéœ€è¦ç»§æ‰¿ç‰¹å®šç±»å°±å¯ä»¥å®Œæˆï¼Œå¦‚æœæ˜¯ Qt çš„ QDirï¼Œåˆ™ä¸æ˜¯å¾ˆè½»æ¾ã€‚</p><p>åœ¨ä½¿ç”¨æ ‡å‡†åº“çš„æ—¶å€™éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ ‡å‡†åº“é€šå¸¸ä¸ä¼šçº¦æŸä½¿ç”¨è€…ï¼Œä½¿ç”¨å½“å‰çš„ä¾‹å­ä¸¾ä¾‹ï¼ŒQDir æä¾›äº†è¿‡æ»¤å™¨æšä¸¾ï¼Œå¯ä»¥å¸®åŠ©å¼€å‘è€…ç®€å•çš„å®ç°æ–‡ä»¶è¿‡æ»¤åŠŸèƒ½ï¼Œä½†æ˜¯ std::filesystem åˆ™ä¸æä¾›è¿™ç§æ¥å£ï¼Œæ ‡å‡†åº“æä¾›äº†æœºåˆ¶ï¼Œä½†æ˜¯ä¸æä¾›ç­–ç•¥ï¼Œå¼€å‘è€…éœ€è¦ä½¿ç”¨æ ‡å‡†åº“æä¾›çš„å„ç§æ¥å£ï¼Œ<strong>ç»„åˆ</strong> å‡ºè‡ªå·±çš„ä¸šåŠ¡ï¼Œæ‰€ä»¥å¦‚æœæƒ³è¦ä½¿ç”¨æ ‡å‡†åº“çš„æ—¶å€™ä¹Ÿèƒ½å®ç°è¿‡æ»¤å’Œæ’åºï¼Œå°±åªèƒ½è‡ªå·±æä¾›ç›¸åº”çš„æ“ä½œã€‚</p><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">std::filesystem::path tmp&#123; <span class="string">&quot;/tmp&quot;</span> &#125;;</span><br><span class="line">std::vector&lt;std::filesystem::directory_entry&gt; list;</span><br><span class="line">std::vector&lt;std::string&gt; filter&#123; <span class="string">&quot;.jpg&quot;</span>, <span class="string">&quot;.txt&quot;</span> &#125;;</span><br><span class="line">std::filesystem::directory_iterator iter&#123; tmp &#125;;</span><br><span class="line">std::<span class="built_in">copy_if</span>(iter.<span class="built_in">begin</span>(),</span><br><span class="line">             iter.<span class="built_in">end</span>(),</span><br><span class="line">             std::<span class="built_in">back_inserter</span>(list),</span><br><span class="line">             [filter](std::filesystem::directory_entry entry) &#123;</span><br><span class="line">                <span class="keyword">return</span> !entry.<span class="built_in">is_directory</span>() &amp;&amp; </span><br><span class="line">                       std::<span class="built_in">find_if</span>(filter.<span class="built_in">begin</span>(),</span><br><span class="line">                                    filter.<span class="built_in">end</span>(),</span><br><span class="line">                                    [entry](std::string s) &#123;</span><br><span class="line">                                      <span class="keyword">return</span> entry.<span class="built_in">path</span>().<span class="built_in">extension</span>() == s;</span><br><span class="line">                                    &#125;</span><br><span class="line">                       );</span><br><span class="line">              &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p><del>å¯ä»¥çœ‹åˆ°ï¼Œä»£ç å˜å¾—å¼‚å¸¸ä¸‘é™‹ï¼ˆé€ƒ</del></p><p>æ ‡å‡†åº“æä¾›äº†ä¸€äº›æ¯”è¾ƒæ–¹ä¾¿çš„å‡½æ•°ï¼Œä¾‹å¦‚ std::copy_ifã€ std::back_inserter å’Œ std::find_if ç­‰ï¼Œè¿˜æœ‰ä¸€ä¸ªè¾ƒä¸ºå¸¸ç”¨çš„ std::transformã€‚æ ‡å‡†åº“æä¾›äº†è¿­ä»£å™¨æŠ½è±¡ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿­ä»£å™¨å¯¹è±¡å’Œè¿­ä»£å™¨ç®—æ³•ï¼Œæ–¹ä¾¿çš„è¿›è¡Œå„ç§éå†ã€å¤åˆ¶å’Œè½¬æ¢ã€‚</p><p>ä»ä¸Šé¢çš„ä¾‹å­å¯ä»¥çœ‹å‡ºï¼ŒQt ç¡®å®ä¸ºå¼€å‘è€…æä¾›äº†å¾ˆå¥½çš„å¸®åŠ©ï¼Œè¿™æ˜¯ Qt ä½œä¸ºä¸€ä¸ªå¹³å°åŠ›æ‰€èƒ½åŠçš„å·¥ä½œï¼Œå½“ç„¶ï¼Œå³ä½¿æˆ‘ä»¬ä½¿ç”¨ Qtï¼Œä¹Ÿè¿˜æ˜¯å¯ä»¥å†™å‡ºä¸Šé¢ä¸€æ ·çš„ä»£ç ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ä»¥ä¸Šå°±æ˜¯ç®€å•çš„ QDir å’Œ std::filesystem çš„ä¸åŒï¼Œç»¼åˆæ¥çœ‹ï¼ŒQt åº“å’Œæ ‡å‡†åº“å…¶å®å„æœ‰ä¼˜ç¼ºï¼Œä»–ä»¬çš„ç›®æ ‡å’Œé¢å‘çš„å¼€å‘è€…æ˜¯ä¸åŒçš„ï¼ŒQt æœ€è¿‘ä¸€ç›´åœ¨å°è¯•ä½¿ç”¨æ ‡å‡†åº“çš„å†…å®¹æ¥ä»£æ›¿è‡ªå·±çš„ä¸€éƒ¨åˆ†ç»„ä»¶ï¼Œæœ€æ–°çš„Qt6 å°±å·²ç»å‡çº§åˆ°äº† C++ 17 æ ‡å‡†ï¼Œå°† qSort å®æ”¹ä¸ºäº†ä½¿ç”¨ std::sortï¼Œä¹Ÿè®¸åœ¨ä¸ä¹…çš„å°†æ¥ï¼Œæˆ‘ä»¬å†ä¹Ÿä¸ç”¨ä¸ºä½¿ç”¨ Qt è¿˜æ˜¯æ ‡å‡†åº“è€Œäº‰è®ºæˆ–è€…ç«™é˜Ÿã€‚</p><blockquote><p><strong>å¼•ç”¨èµ„æ–™</strong><br><a href="https://en.cppreference.com/w/cpp/filesystem">std::filesystem https://en.cppreference.com/w/cpp/filesystem</a><br><a href="https://doc.qt.io/qt-5/qdir.html">QDir https://doc.qt.io/qt-5/qdir.html</a></p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> C++ </tag>
            
            <tag> Qt </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>How to use cuda with deepin</title>
      <link href="/2022/02/25/How-to-use-cuda-with-deepin/"/>
      <url>/2022/02/25/How-to-use-cuda-with-deepin/</url>
      
        <content type="html"><![CDATA[<p>CUDAï¼ˆCompute Unified Device Architectureï¼Œç»Ÿä¸€è®¡ç®—æ¶æ„ï¼‰æ˜¯ç”±NVIDIAæ‰€æ¨å‡ºçš„ä¸€ç§é›†æˆæŠ€æœ¯ï¼Œæ˜¯è¯¥å…¬å¸å¯¹äºGPGPUçš„æ­£å¼åç§°ã€‚é€šè¿‡è¿™ä¸ªæŠ€æœ¯ï¼Œç”¨æˆ·å¯åˆ©ç”¨NVIDIAçš„GeForce 8ä»¥åçš„GPUå’Œè¾ƒæ–°çš„Quadro GPUè¿›è¡Œè®¡ç®—ã€‚äº¦æ˜¯é¦–æ¬¡å¯ä»¥åˆ©ç”¨GPUä½œä¸ºC-ç¼–è¯‘å™¨çš„å¼€å‘ç¯å¢ƒã€‚NVIDIAè¥é”€çš„æ—¶å€™ï¼Œå¾€å¾€å°†ç¼–è¯‘å™¨ä¸æ¶æ„æ··åˆæ¨å¹¿ï¼Œé€ æˆæ··ä¹±ã€‚å®é™…ä¸Šï¼ŒCUDAå¯ä»¥å…¼å®¹OpenCLæˆ–è€…è‡ªå®¶çš„C-ç¼–è¯‘å™¨ã€‚æ— è®ºæ˜¯CUDA C-è¯­è¨€æˆ–æ˜¯OpenCLï¼ŒæŒ‡ä»¤æœ€ç»ˆéƒ½ä¼šè¢«é©±åŠ¨ç¨‹åºè½¬æ¢æˆPTXä»£ç ï¼Œäº¤ç”±æ˜¾ç¤ºæ ¸å¿ƒè®¡ç®—ã€‚</p><p>åœ¨è®ºå›ä¸Šçœ‹åˆ°æœ‰äº›ç”¨æˆ·å¸Œæœ›åœ¨ deepin ä¸‹ä½¿ç”¨ CUDAï¼Œä½†æ˜¯ä»–ä»¬é‡‡å–çš„åšæ³•å¾€å¾€æ˜¯æ‰‹åŠ¨ä¸‹è½½nvidiaçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œç›´æ¥è¿›è¡Œå®‰è£…ã€‚</p><p>ä½†æ˜¯è¿™æ ·ä¼šç ´åä¸€éƒ¨åˆ†çš„ glx é“¾æ¥ï¼Œå¯¼è‡´å¸è½½çš„æ—¶å€™æ— æ³•å½»åº•æ¢å¤ï¼Œç»“æœå°±æ˜¯ç³»ç»Ÿå› ä¸ºå¸è½½nvidiaé©±åŠ¨è€ŒåºŸæ‰ï¼Œæ‰€ä»¥æˆ‘å¼ºçƒˆæ¨èä½¿ç”¨åŒ…ç®¡ç†å™¨çš„æ–¹å¼å®‰è£… nvidia é©±åŠ¨å’Œ CUDA ç›¸å…³çš„ä¸œè¥¿ï¼Œå°½é‡ä¸è¦æ‰‹åŠ¨ä¿®æ”¹ã€‚</p><p>åœ¨å…¶ä»–å‘è¡Œç‰ˆï¼Œä¾‹å¦‚ archï¼Œå®‰è£… NVIDIA åŒ…ä¼šæä¾›ä¸€ä¸ªé…ç½®æ–‡ä»¶è‡ªåŠ¨åŠ è½½å¯¹åº”çš„å†…æ ¸æ¨¡å—ï¼Œè€Œ deepin çš„åŒ…æ˜¯æ¥è‡ª debianï¼Œdebian å¹¶æ²¡æœ‰åšè¿™ä¸ªäº‹æƒ…ï¼Œè¿™å°±å¯¼è‡´åœ¨ deepin ä¸Šå®‰è£… NVIDIA é©±åŠ¨åï¼Œ<br>æ˜¾ç¤ºç›¸å…³çš„å†…æ ¸æ¨¡å—ä¼šè¢« X åŠ è½½ï¼Œè€Œ CUDA ç›¸å…³çš„å†…æ ¸æ¨¡å—å¹¶ä¸ä¼šè¢«åŠ è½½ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯¹åŒ…è¿›è¡Œäº†ä¿®æ”¹ï¼Œæ·»åŠ äº†è‡ªåŠ¨åŠ è½½å†…æ ¸æ¨¡å—çš„é…ç½®æ–‡ä»¶ã€‚</p><h2 id="å®‰è£…ä¾èµ–"><a href="#å®‰è£…ä¾èµ–" class="headerlink" title="å®‰è£…ä¾èµ–"></a>å®‰è£…ä¾èµ–</h2><p>å¦‚æœæƒ³è¦ç›´æ¥ä½¿ç”¨ CUDA çš„å¼€å‘å¤´æ–‡ä»¶ï¼Œé‚£ä¹ˆéœ€è¦å®‰è£…ä»¥ä¸‹çš„åŒ…ï¼Œä¸è¿‡ä¼šä¾èµ–å¾ˆå¤šnvidiaçš„åº“ï¼Œæ€»é‡è¿˜æ˜¯æœ‰ä¸€äº›çš„ã€‚</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo apt install nvidia-cuda-dev nvidia-cuda-toolkit</span><br></pre></td></tr></table></figure><p>ç°åœ¨ï¼Œé‡å¯ä¸€ä¸‹ç³»ç»Ÿå°±å¯ä»¥æ­£å¸¸ä½¿ç”¨äº†ã€‚å¦‚æœä¸æƒ³é‡å¯ç³»ç»Ÿï¼Œå¯ä»¥æ‰‹åŠ¨æ‰§è¡Œå‘½ä»¤åŠ è½½å†…æ ¸æ¨¡å—ã€‚</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo modprobe nvidia_uvm</span><br></pre></td></tr></table></figure><h2 id="CUDA-å°ä¾‹å­"><a href="#CUDA-å°ä¾‹å­" class="headerlink" title="CUDA å°ä¾‹å­"></a>CUDA å°ä¾‹å­</h2><p><a href="https://bingliu221.gitbooks.io/learn-cuda-the-simple-way/content/chapter2.html/">è¿™é‡Œæœ‰ä¸ªå°æ —å­ï¼Œå¯ä»¥ç”¨æ¥æµ‹è¯• CUDA æ˜¯å¦èƒ½å¤ŸæˆåŠŸç¼–è¯‘å’Œè¿è¡Œ</a></p><p><strong>å°†ä»¥ä¸‹ä»£ç ä¿å­˜ä¸º main.cu</strong></p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function">__global__ <span class="type">void</span> <span class="title">vector_add</span><span class="params">(<span class="type">const</span> <span class="type">int</span> *a, <span class="type">const</span> <span class="type">int</span> *b, <span class="type">int</span> *c)</span> </span>&#123;</span><br><span class="line">    *c = *a + *b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span> </span>&#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> a = <span class="number">2</span>, b = <span class="number">5</span>;</span><br><span class="line">    <span class="type">int</span> c = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> *dev_a, *dev_b, *dev_c;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cudaMalloc</span>((<span class="type">void</span> **)&amp;dev_a, <span class="built_in">sizeof</span>(<span class="type">int</span>));</span><br><span class="line">    <span class="built_in">cudaMalloc</span>((<span class="type">void</span> **)&amp;dev_b, <span class="built_in">sizeof</span>(<span class="type">int</span>));</span><br><span class="line">    <span class="built_in">cudaMalloc</span>((<span class="type">void</span> **)&amp;dev_c, <span class="built_in">sizeof</span>(<span class="type">int</span>));</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cudaMemcpy</span>(dev_a, &amp;a, <span class="built_in">sizeof</span>(<span class="type">int</span>), cudaMemcpyHostToDevice);</span><br><span class="line">    <span class="built_in">cudaMemcpy</span>(dev_b, &amp;b, <span class="built_in">sizeof</span>(<span class="type">int</span>), cudaMemcpyHostToDevice);</span><br><span class="line"></span><br><span class="line">    vector_add&lt;&lt;&lt;<span class="number">1</span>, <span class="number">1</span>&gt;&gt;&gt;(dev_a, dev_b, dev_c);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cudaMemcpy</span>(&amp;c, dev_c, <span class="built_in">sizeof</span>(<span class="type">int</span>), cudaMemcpyDeviceToHost);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d + %d = %d, Is that right?\n&quot;</span>, a, b, c);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cudaFree</span>(dev_a);</span><br><span class="line">    <span class="built_in">cudaFree</span>(dev_b);</span><br><span class="line">    <span class="built_in">cudaFree</span>(dev_c);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nvcc main.cu</span><br></pre></td></tr></table></figure><p>è¿è¡Œ:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">./a.out</span><br></pre></td></tr></table></figure><p>å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œåœ¨ç¼–è¯‘çš„æ—¶å€™å°±ä¸ä¼šæœ‰æŠ¥é”™ï¼Œä¸è¿‡åœ¨æˆ‘çš„ç¯å¢ƒä¸‹nvccä¼šæœ‰æ¶æ„è¢«å¼ƒç”¨çš„è­¦å‘Šï¼Œæœ¬ç€åªè¦ä¸errorå°±ç®—æ²¡äº‹çš„åŸåˆ™ï¼Œæˆ‘ä»¬æ— è§†è¿™æ¡è­¦å‘Šå³å¯ã€‚</p><p>è¾“å‡ºç»“æœ:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">2 + 5 = 0, Is that right?</span><br></pre></td></tr></table></figure><h2 id="Machine-Learning-æµ‹è¯•"><a href="#Machine-Learning-æµ‹è¯•" class="headerlink" title="Machine Learning æµ‹è¯•"></a>Machine Learning æµ‹è¯•</h2><p>æ—¢ç„¶éƒ½ç”¨ä¸Š Nvidia æ˜¾å¡å’Œ CUDA é©±åŠ¨äº†ï¼Œé‚£è‚¯å®šæ˜¯è¦ç‚¼ä¸€ä¸ªä¸¹å‘€ã€‚</p><p>å…ˆå®‰è£… Anacondaï¼Œè¿™æ˜¯ä¸€ä¸ª python çš„å‘è¡Œç‰ˆï¼Œæä¾›äº†ä¸€ä¸ªå®Œæ•´çš„ç§‘å­¦è®¡ç®—ç¯å¢ƒï¼ŒåŒ…æ‹¬ NumPyã€SciPy ç­‰å¸¸ç”¨ç§‘å­¦è®¡ç®—åº“ã€‚å½“ç„¶ï¼Œä½ æœ‰æƒé€‰æ‹©è‡ªå·±å–œæ¬¢çš„ Python ç¯å¢ƒã€‚</p><p>å¯ä»¥æ ¹æ® anaconda å®˜æ–¹æ•™ç¨‹æ¥å®‰è£… <a href="https://docs.conda.io/en/latest/miniconda.html#linux-installers">https://docs.conda.io/en/latest/miniconda.html#linux-installers</a></p><p>åˆ›å»ºä¸€ä¸ªå­˜æ”¾ tensorflow demo çš„ç›®å½•ã€‚</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">mkdir tensorflow</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ conda åˆ›å»ºä¸€ä¸ªæ–°çš„ç¯å¢ƒã€‚</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd tensorflow</span><br><span class="line">conda create --name tf2 python=3.7      # â€œtf2â€æ˜¯ä½ å»ºç«‹çš„condaè™šæ‹Ÿç¯å¢ƒçš„åå­—</span><br><span class="line">conda activate tf2                      # è¿›å…¥åä¸ºâ€œtf2â€çš„condaè™šæ‹Ÿç¯å¢ƒ</span><br></pre></td></tr></table></figure><p>è¿™æ—¶å€™æˆ‘ä»¬å°±ä¼šçœ‹åˆ°shellä¸­ä¼šæç¤ºä¸€ä¸ª <code>(tf2)</code>ï¼Œè¯´æ˜å½“å‰ shell ä½¿ç”¨çš„æ˜¯ conda venv ç¯å¢ƒï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å½“å‰ç¯å¢ƒä¸­å®‰è£…å„ç§ä¾èµ–åŒ…ã€‚</p><p>ä¸ºäº†èƒ½æ­£å¸¸ä½¿ç”¨ tensorflowï¼Œæˆ‘ä»¬è¿˜éœ€è¦å®‰è£… cudnnï¼Œå¯ä»¥é€šè¿‡ anaconda æ¥å®‰è£…ã€‚</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">(tf2) $ conda install -c anaconda cudnn tensorflow-gpu</span><br></pre></td></tr></table></figure><p>å½“ç¯å¢ƒå‡†å¤‡å°±ç»ªï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ª tf.py æ–‡ä»¶ï¼Œå°†æµ‹è¯•ä»£ç å†™å…¥ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"></span><br><span class="line">mnist = tf.keras.datasets.mnist</span><br><span class="line"></span><br><span class="line">(x_train, y_train),(x_test, y_test) = mnist.load_data()</span><br><span class="line">x_train, x_test = x_train / <span class="number">255.0</span>, x_test / <span class="number">255.0</span></span><br><span class="line"></span><br><span class="line">model = tf.keras.models.Sequential([</span><br><span class="line">  tf.keras.layers.Flatten(input_shape=(<span class="number">28</span>, <span class="number">28</span>)),</span><br><span class="line">  tf.keras.layers.Dense(<span class="number">128</span>, activation=<span class="string">&#x27;relu&#x27;</span>),</span><br><span class="line">  tf.keras.layers.Dropout(<span class="number">0.2</span>),</span><br><span class="line">  tf.keras.layers.Dense(<span class="number">10</span>, activation=<span class="string">&#x27;softmax&#x27;</span>)</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">model.<span class="built_in">compile</span>(optimizer=<span class="string">&#x27;adam&#x27;</span>,</span><br><span class="line">              loss=<span class="string">&#x27;sparse_categorical_crossentropy&#x27;</span>,</span><br><span class="line">              metrics=[<span class="string">&#x27;accuracy&#x27;</span>])</span><br><span class="line"></span><br><span class="line">model.fit(x_train, y_train, epochs=<span class="number">5</span>)</span><br><span class="line">model.evaluate(x_test, y_test)</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œè¿™ä¸ª py æ–‡ä»¶ï¼Œå°±å¯ä»¥çœ‹åˆ°å¼€å§‹è‡ªåŠ¨ç‚¼ä¸¹ã€‚</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">(tf2) ~/tensorflow$ python tf.py</span><br><span class="line">2022-01-06 22:12:31.752249: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1</span><br><span class="line">2022-01-06 22:12:31.787298: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero</span><br><span class="line">2022-01-06 22:12:31.787645: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties:</span><br><span class="line">pciBusID: 0000:01:00.0 name: NVIDIA GeForce RTX 3070 computeCapability: 8.6</span><br><span class="line">coreClock: 1.815GHz coreCount: 46 deviceMemorySize: 7.79GiB deviceMemoryBandwidth: 417.29GiB/s</span><br><span class="line">2022-01-06 22:12:31.788616: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1</span><br><span class="line">2022-01-06 22:12:31.802163: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10</span><br><span class="line">2022-01-06 22:12:31.811230: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10</span><br><span class="line">2022-01-06 22:12:31.813348: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10</span><br><span class="line">2022-01-06 22:12:31.832304: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10</span><br><span class="line">2022-01-06 22:12:31.837966: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10</span><br><span class="line">2022-01-06 22:12:31.874633: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7</span><br><span class="line">2022-01-06 22:12:31.874864: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero</span><br><span class="line">2022-01-06 22:12:31.875707: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero</span><br><span class="line">2022-01-06 22:12:31.876401: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0</span><br><span class="line">2022-01-06 22:12:31.877075: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA</span><br><span class="line">2022-01-06 22:12:31.903636: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 3609600000 Hz</span><br><span class="line">2022-01-06 22:12:31.906524: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559ed2e8b830 initialized for platform Host (this does not guarantee that XLA will be used). Devices:</span><br><span class="line">2022-01-06 22:12:31.906581: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version</span><br><span class="line">2022-01-06 22:12:31.907492: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero</span><br><span class="line">2022-01-06 22:12:31.908582: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties:</span><br><span class="line">pciBusID: 0000:01:00.0 name: NVIDIA GeForce RTX 3070 computeCapability: 8.6</span><br><span class="line">coreClock: 1.815GHz coreCount: 46 deviceMemorySize: 7.79GiB deviceMemoryBandwidth: 417.29GiB/s</span><br><span class="line">2022-01-06 22:12:31.908632: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1</span><br><span class="line">2022-01-06 22:12:31.908655: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10</span><br><span class="line">2022-01-06 22:12:31.908674: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10</span><br><span class="line">2022-01-06 22:12:31.908695: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10</span><br><span class="line">2022-01-06 22:12:31.908714: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10</span><br><span class="line">2022-01-06 22:12:31.908732: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10</span><br><span class="line">2022-01-06 22:12:31.908751: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7</span><br><span class="line">2022-01-06 22:12:31.908855: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero</span><br><span class="line">2022-01-06 22:12:31.909548: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero</span><br><span class="line">2022-01-06 22:12:31.910177: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0</span><br><span class="line">2022-01-06 22:12:31.910430: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1</span><br><span class="line">2022-01-06 22:12:31.964445: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:</span><br><span class="line">2022-01-06 22:12:31.964465: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0</span><br><span class="line">2022-01-06 22:12:31.964468: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N</span><br><span class="line">2022-01-06 22:12:31.964586: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero</span><br><span class="line">2022-01-06 22:12:31.964866: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero</span><br><span class="line">2022-01-06 22:12:31.965060: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero</span><br><span class="line">2022-01-06 22:12:31.965367: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4626 MB memory) -&gt; physical GPU (device: 0, name: NVIDIA GeForce RTX 3070, pci bus id: 0000:01:00.0, compute capability: 8.6)</span><br><span class="line">2022-01-06 22:12:31.966801: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559ed4798980 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:</span><br><span class="line">2022-01-06 22:12:31.966811: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): NVIDIA GeForce RTX 3070, Compute Capability 8.6</span><br><span class="line">2022-01-06 22:15:23.414471: W tensorflow/core/framework/cpu_allocator_impl.cc:81] Allocation of 188160000 exceeds 10% of free system memory.</span><br><span class="line">Epoch 1/5</span><br><span class="line">2022-01-06 22:15:23.672182: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10</span><br><span class="line">1875/1875 [==============================] - 3s 2ms/step - loss: 0.2967 - accuracy: 0.9131</span><br><span class="line">Epoch 2/5</span><br><span class="line">1875/1875 [==============================] - 3s 2ms/step - loss: 0.1440 - accuracy: 0.9578</span><br><span class="line">Epoch 3/5</span><br><span class="line">1875/1875 [==============================] - 3s 2ms/step - loss: 0.1097 - accuracy: 0.9670</span><br><span class="line">Epoch 4/5</span><br><span class="line">1875/1875 [==============================] - 2s 1ms/step - loss: 0.0881 - accuracy: 0.9732</span><br><span class="line">Epoch 5/5</span><br><span class="line">1875/1875 [==============================] - 2s 966us/step - loss: 0.0751 - accuracy: 0.9768</span><br><span class="line">2022-01-06 22:16:32.382922: W tensorflow/core/framework/cpu_allocator_impl.cc:81] Allocation of 31360000 exceeds 10% of free system memory.</span><br><span class="line">313/313 [==============================] - 1s 2ms/step - loss: 0.0716 - accuracy: 0.9781</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Solution </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>fix h5py build failed on m1</title>
      <link href="/2022/01/05/fix-h5py-build-failed-on-m1/"/>
      <url>/2022/01/05/fix-h5py-build-failed-on-m1/</url>
      
        <content type="html"><![CDATA[<p>ä»Šå¤©åœ¨ m1 mbp ä¸Šå®‰è£… tensorflow-metal é‡åˆ°äº†ä¾èµ–æ— æ³•å®‰è£…çš„é—®é¢˜ï¼Œé”™è¯¯çš„åŸå› æ˜¯ h5py è¿™ä¸ªåŒ…æ— æ³•ç¼–è¯‘ã€‚</p><p>åœ¨ h5py çš„é¡¹ç›®é‡Œçœ‹åˆ°äº†å·²ç»è§£å†³äº†ï¼Œä½†æ˜¯ä»ç„¶éœ€è¦ä»æºç æ„å»ºã€‚</p><blockquote><p><a href="https://github.com/h5py/h5py/issues/1810">https://github.com/h5py/h5py/issues/1810</a></p></blockquote><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">brew install hdf5</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">export</span> HDF5_DIR=/opt/homebrew/Cellar/hdf5/</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">pip install --no-binary=h5py h5py</span></span><br></pre></td></tr></table></figure><p>æµ‹è¯•ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"></span><br><span class="line">mnist = tf.keras.datasets.mnist</span><br><span class="line"></span><br><span class="line">(x_train, y_train),(x_test, y_test) = mnist.load_data()</span><br><span class="line">x_train, x_test = x_train / <span class="number">255.0</span>, x_test / <span class="number">255.0</span></span><br><span class="line"></span><br><span class="line">model = tf.keras.models.Sequential([</span><br><span class="line">  tf.keras.layers.Flatten(input_shape=(<span class="number">28</span>, <span class="number">28</span>)),</span><br><span class="line">  tf.keras.layers.Dense(<span class="number">128</span>, activation=<span class="string">&#x27;relu&#x27;</span>),</span><br><span class="line">  tf.keras.layers.Dropout(<span class="number">0.2</span>),</span><br><span class="line">  tf.keras.layers.Dense(<span class="number">10</span>, activation=<span class="string">&#x27;softmax&#x27;</span>)</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">model.<span class="built_in">compile</span>(optimizer=<span class="string">&#x27;adam&#x27;</span>,</span><br><span class="line">              loss=<span class="string">&#x27;sparse_categorical_crossentropy&#x27;</span>,</span><br><span class="line">              metrics=[<span class="string">&#x27;accuracy&#x27;</span>])</span><br><span class="line"></span><br><span class="line">model.fit(x_train, y_train, epochs=<span class="number">5</span>)</span><br><span class="line">model.evaluate(x_test, y_test)</span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœ:</p><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">$ python demo.py</span><br><span class="line">Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/mnist.npz</span><br><span class="line">11493376/11490434 [==============================] - 7s 1us/step</span><br><span class="line">11501568/11490434 [==============================] - 7s 1us/step</span><br><span class="line">Metal device set to: Apple M1</span><br><span class="line"></span><br><span class="line">systemMemory: 16.00 GB</span><br><span class="line">maxCacheSize: 5.33 GB</span><br><span class="line"></span><br><span class="line">2022-01-05 11:20:21.920404: I tensorflow/core/common_runtime/pluggable_device/pluggable_device_factory.cc:305] Could not identify NUMA node of platform GPU ID 0, defaulting to 0. Your kernel may not have been built with NUMA support.</span><br><span class="line">2022-01-05 11:20:21.920545: I tensorflow/core/common_runtime/pluggable_device/pluggable_device_factory.cc:271] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 0 MB memory) -&gt; physical PluggableDevice (device: 0, name: METAL, pci bus id: &lt;undefined&gt;)</span><br><span class="line">2022-01-05 11:20:22.484838: W tensorflow/core/platform/profile_utils/cpu_utils.cc:128] Failed to get CPU frequency: 0 Hz</span><br><span class="line">Epoch 1/5</span><br><span class="line">2022-01-05 11:20:22.682840: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:112] Plugin optimizer for device_type GPU is enabled.</span><br><span class="line">1875/1875 [==============================] - 11s 5ms/step - loss: 0.2896 - accuracy: 0.9160</span><br><span class="line">Epoch 2/5</span><br><span class="line">1875/1875 [==============================] - 9s 5ms/step - loss: 0.1391 - accuracy: 0.9585</span><br><span class="line">Epoch 3/5</span><br><span class="line">1875/1875 [==============================] - 9s 5ms/step - loss: 0.1036 - accuracy: 0.9684</span><br><span class="line">Epoch 4/5</span><br><span class="line">1875/1875 [==============================] - 8s 4ms/step - loss: 0.0844 - accuracy: 0.9739</span><br><span class="line">Epoch 5/5</span><br><span class="line">1875/1875 [==============================] - 8s 4ms/step - loss: 0.0715 - accuracy: 0.9776</span><br><span class="line">2022-01-05 11:21:07.206209: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:112] Plugin optimizer for device_type GPU is enabled.</span><br><span class="line">313/313 [==============================] - 2s 5ms/step - loss: 0.0738 - accuracy: 0.9784</span><br></pre></td></tr></table></figure><blockquote><p>Apple ç»™çš„é€‚é… tensorflow çš„ metal æ’ä»¶å®‰è£…æ–¹æ¡ˆ<br><a href="https://developer.apple.com/metal/tensorflow-plugin/">https://developer.apple.com/metal/tensorflow-plugin/</a></p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Starting sessions with systemd part 2</title>
      <link href="/2021/12/29/Starting-sessions-with-systemd-part-2/"/>
      <url>/2021/12/29/Starting-sessions-with-systemd-part-2/</url>
      
        <content type="html"><![CDATA[<p>æ¥ç€ä¸Šä¸€ç¯‡æ–‡ç«  <a href="/2021/12/25/Starting-sessions-with-systemd/" title="Starting sessions with systemd">Starting sessions with systemd</a>ï¼Œè¿™ç¯‡æ–‡ç« ä¸»è¦è®²è§£ä¸€ä¸‹å…·ä½“çš„å®ç°ã€‚</p><p><a href="https://github.com/linuxdeepin/dde-session">https://github.com/linuxdeepin/dde-session</a> å·²ç»åŒ…å«äº†æ‰€æœ‰çš„æ–‡ä»¶å’Œæäº¤ã€‚</p><p>ä¸Šé¢æ–‡ç« è¯´è¿‡ï¼Œä¸ºäº†è®© dde ä½¿ç”¨ systemd â€“user æ¥å…³ç³»æœåŠ¡ï¼Œæˆ‘æä¾›äº†ä¸€ç»„æœåŠ¡ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dde-session-initialized.target</span><br><span class="line">dde-session-manager.service</span><br><span class="line">dde-session-manager.target</span><br><span class="line">dde-session-pre.target</span><br><span class="line">dde-session-restart-dbus.service</span><br><span class="line">dde-session-shutdown.service</span><br><span class="line">dde-session-shutdown.target</span><br><span class="line">dde-session.target</span><br><span class="line">dde-session-x11-services-ready.target</span><br><span class="line">dde-session-x11-services.target</span><br><span class="line">dde-session-x11.target</span><br><span class="line">org.deepin.Session.service</span><br></pre></td></tr></table></figure><p>lightdm åœ¨è®¤è¯é€šè¿‡ä»¥åï¼Œä¼šå¯åŠ¨ dde-session è¿›ç¨‹ï¼Œdde-session ä¼šé€šè¿‡ systemd çš„ dbus å¯åŠ¨ <code>org.deepin.Session.service</code>ã€‚</p><p>åœ¨ <code>org.deepin.Session.service</code> ä¸­ä¼šæ‰§è¡Œ <code>dde-session-ctl --systemd-service</code>ï¼Œå¯åŠ¨ <code>dde-session-x11.target</code>.</p><p><code>dde-session-x11.target</code> å…³è”äº†æ‰€æœ‰åˆå§‹åŒ–çš„æœåŠ¡ï¼Œsystemd ä¼šå¸®åŠ©è‡ªåŠ¨è¿è¡Œè¿™äº›æœåŠ¡ï¼Œå¹¶ä¸”æœ€ç»ˆä¼šè¿è¡Œåˆ° <code>dde-session-manager.service</code> ä¸Šã€‚</p><blockquote><p>dde-session-manager.service</p></blockquote><figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="section">[Service]</span></span><br><span class="line"><span class="attr">Type</span>=simple</span><br><span class="line"><span class="attr">ExecStart</span>=/usr/bin/startdde</span><br><span class="line"><span class="attr">ExecStopPost</span>=/usr/lib/libexec/dde-session-ctl --logout</span><br></pre></td></tr></table></figure><p>åœ¨ <code>org.deepin.Session.service</code> ä¸­ä¼šå¯åŠ¨ä¸€ä¸ªç‰¹æ®Šçš„æœåŠ¡ï¼Œè¿™ä¸ªæœåŠ¡ä¼šç›‘å¬ dde-session çš„é€€å‡ºï¼Œå› ä¸ºæ€»è¦æœ‰ä¸€ä¸ªæœåŠ¡å»ç›‘å¬ session çš„çŠ¶æ€ï¼Œè¦ç¡®ä¿ session åœ¨æœåŠ¡åœ¨ï¼Œsession é€€æœåŠ¡é€€ï¼ŒæœåŠ¡é€€ session é€€ï¼Œå…±å­˜äº¡ï¼Œè¿™ä¹Ÿæ˜¯æ‰€æœ‰æ“ä½œä¸­æœ€éº»çƒ¦çš„ä¸€æ­¥ã€‚</p><blockquote><p>org.deepin.Session.service</p></blockquote><figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="section">[Service]</span></span><br><span class="line"><span class="attr">Type</span>=dbus</span><br><span class="line"><span class="attr">BusName</span>=org.deepin.Session</span><br><span class="line"><span class="attr">ExecStart</span>=/usr/bin/dde-session --systemd-service</span><br><span class="line"><span class="attr">ExecStop</span>=/usr/lib/libexec/dde-session-ctl --shutdown</span><br></pre></td></tr></table></figure><p>åœ¨ dde-session-ctl ä¸­æ˜¯è¿™ä¹ˆå®ç° shutdown çš„:</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (isShutdown) &#123;</span><br><span class="line">    <span class="comment">// kill startdde-session or call login1</span></span><br><span class="line">    <span class="function">QDBusInterface <span class="title">systemd</span><span class="params">(<span class="string">&quot;org.freedesktop.systemd1&quot;</span>, <span class="string">&quot;/org/freedesktop/systemd1&quot;</span>, <span class="string">&quot;org.freedesktop.systemd1.Manager&quot;</span>)</span></span>;</span><br><span class="line">    <span class="built_in">qInfo</span>() &lt;&lt; systemd.<span class="built_in">call</span>(<span class="string">&quot;StartUnit&quot;</span>, <span class="string">&quot;dde-session-shutdown.target&quot;</span>, <span class="string">&quot;replace-irreversibly&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ dde-session-ctl ä¸­æ˜¯è¿™ä¹ˆå®ç° logout çš„:</p><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (parser.<span class="built_in">isSet</span>(logout)) &#123;</span><br><span class="line">    org::<span class="function">deepin::Session <span class="title">session</span><span class="params">(<span class="string">&quot;org.deepin.Session&quot;</span>, <span class="string">&quot;/org/deepin/Session&quot;</span>, QDBusConnection::sessionBus())</span></span>;</span><br><span class="line">    session.<span class="built_in">Logout</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>dde-session main.cpp</p></blockquote><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ·»åŠ å¯åŠ¨å‚æ•°ï¼Œè¡¨ç¤ºè¿™æ˜¯é€šè¿‡ systemd å¯åŠ¨çš„ã€‚</span></span><br><span class="line"><span class="function">QCommandLineOption <span class="title">systemd</span><span class="params">(QStringList&#123;<span class="string">&quot;d&quot;</span>, <span class="string">&quot;systemd-service&quot;</span>, <span class="string">&quot;wait for systemd services&quot;</span>&#125;)</span></span>;</span><br><span class="line">parser.<span class="built_in">addOption</span>(systemd);</span><br><span class="line">parser.<span class="built_in">process</span>(app);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (parser.<span class="built_in">isSet</span>(systemd)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">QDBusServiceWatcher *watcher = <span class="keyword">new</span> <span class="built_in">QDBusServiceWatcher</span>(<span class="string">&quot;org.deepin.Session&quot;</span>, QDBusConnection::<span class="built_in">sessionBus</span>(), QDBusServiceWatcher::WatchForUnregistration);</span><br><span class="line">    watcher-&gt;<span class="built_in">connect</span>(watcher, &amp;QDBusServiceWatcher::serviceUnregistered, [=] &#123;</span><br><span class="line">        QDBusInterface <span class="built_in">systemdDBus</span>(<span class="string">&quot;org.freedesktop.systemd1&quot;</span>, <span class="string">&quot;/org/freedesktop/systemd1&quot;</span>, <span class="string">&quot;org.freedesktop.systemd1.Manager&quot;</span>);</span><br><span class="line">        <span class="built_in">qInfo</span>() &lt;&lt; systemdDBus.<span class="built_in">call</span>(<span class="string">&quot;StartUnit&quot;</span>, <span class="string">&quot;dde-session-shutdown.service&quot;</span>, <span class="string">&quot;replace&quot;</span>);</span><br><span class="line">        qApp-&gt;<span class="built_in">quit</span>();</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">qInfo</span>() &lt;&lt; systemdDBus.<span class="built_in">call</span>(<span class="string">&quot;StartUnit&quot;</span>, <span class="string">&quot;dde-session-x11.target&quot;</span>, <span class="string">&quot;replace&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>dde-session-shutdown.service</code> åªè´Ÿè´£æ‰§è¡Œ <code>dde-session-ctl --shutdown</code>ï¼Œç”¨äºå¯åŠ¨ <code>dde-session-shutdown.target</code>ã€‚</p><blockquote><p>dde-session-shutdown.service</p></blockquote><figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="section">[Service]</span></span><br><span class="line"><span class="attr">Type</span>=<span class="literal">on</span>eshot</span><br><span class="line"><span class="attr">ExecStart</span>=/usr/lib/libexec/dde-session-ctl --logout</span><br></pre></td></tr></table></figure><p>é€šè¿‡ systemd çš„æ¥å£å¯åŠ¨äº† <code>dde-session-shutdown.target</code>ï¼Œä»è€Œå¯åŠ¨äº†æ¸…ç†æµç¨‹ã€‚</p><p><code>dde-session-shutdown.target</code> æ²¡æœ‰æ‰§è¡Œä»»ä½•å†…å®¹ï¼Œä»…ä»…æ˜¯å…³è”äº†ä¸€ç»„æœåŠ¡ï¼Œä½†æ˜¯æ˜¯å†²çªè¿™äº›æœåŠ¡ï¼Œå› ä¸ºè¿™æ˜¯å¯åŠ¨çš„æ—¶å€™</p><p>åœ¨ <code>dde-session-shutdown.target</code> ä¸­è¿˜å…³è”äº†æœ€é‡è¦çš„ä¸€ä¸ªæœåŠ¡: <code>dde-session-restart-dbus.service</code>ï¼Œè¿™ä¸ªæœåŠ¡æ˜¯ç”¨æ¥å…³é—­ <code>dbus.service</code> æœåŠ¡çš„ï¼Œè¿™æ ·å°±å¯ä»¥ä¿è¯ session ç»“æŸçš„æ—¶å€™ï¼Œä¸ä¼šæœ‰ dbus æœåŠ¡é€ƒé€¸å‡ºå»ã€‚</p><blockquote><p>dde-session-restart-dbus.service</p></blockquote><figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="section">[Service]</span></span><br><span class="line"><span class="attr">Type</span>=notify</span><br><span class="line"><span class="attr">ExecStart</span>=/usr/lib/libexec/dde-session-ctl --restart-dbus</span><br></pre></td></tr></table></figure><p>åœ¨ dde-session-ctl ä¸­æ˜¯è¿™ä¹ˆå®ç° restart-dbus çš„:</p><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (isRestartDBus) &#123;</span><br><span class="line">    <span class="function">QDBusInterface <span class="title">systemd</span><span class="params">(<span class="string">&quot;org.freedesktop.systemd1&quot;</span>, <span class="string">&quot;/org/freedesktop/systemd1&quot;</span>, <span class="string">&quot;org.freedesktop.systemd1.Manager&quot;</span>)</span></span>;</span><br><span class="line">    <span class="built_in">qInfo</span>() &lt;&lt; systemd.<span class="built_in">call</span>(<span class="string">&quot;StopUnit&quot;</span>, <span class="string">&quot;dbus.service&quot;</span>, <span class="string">&quot;replace-irreversibly&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¤ç›˜ä¸€ä¸‹æ•´ä¸ªæµç¨‹ï¼Œåœ¨ç™»å½•ç•Œé¢è¾“å…¥å¯†ç ç™»å½•ä»¥åï¼Œlightdm ä¼šå¯åŠ¨ <code>dde-session</code> ä½œä¸º session çš„å…¥å£ï¼Œ<code>dde-session</code> ä¼šæ³¨å†Œä¸€ä¸ª <code>org.deepin.Session</code> çš„ dbus æœåŠ¡ï¼Œå¹¶ä¸”ä¼šå¯åŠ¨å…³è”çš„ systemd æœåŠ¡ï¼Œå¯åŠ¨ä¸€ä¸ª <code>dde-session --systemd-service</code>ï¼Œåœ¨è¿™ä¸ªè¿›ç¨‹é‡Œï¼Œä¼šå¯åŠ¨ <code>dde-session-x11.target</code>ï¼Œä»è€Œæœ€ç»ˆå¯åŠ¨äº† <code>dde-session-manager.service</code>ï¼Œå°†åŸæœ¬çš„ä¼šè¯å…¥å£ startdde å¯åŠ¨äº†ã€‚</p><p>åœ¨ <code>dde-session --systemd-service</code> ä¼šç›‘å¬ <code>org.deepin.Session</code> æœåŠ¡çš„å­˜æ´»ï¼Œå½“æœåŠ¡ä¸å­˜åœ¨æ—¶ï¼Œå°±ä¼šå¼€å§‹æ‰§è¡Œé€€å‡ºæµç¨‹ï¼Œä»è€Œå¯åŠ¨äº† <code>dde-session-ctl --shutdown</code>ï¼Œåœ¨ dde-session-ctl çš„å¸®åŠ©ä¸‹ï¼Œå¯åŠ¨äº† <code>dde-session-shutdown.target</code>ï¼Œå°†æ‰€æœ‰å¯åŠ¨çš„ dde æ ¸å¿ƒæœåŠ¡éƒ½å†²çªæ‰ï¼Œä»è€Œå®Œæˆäº†æœåŠ¡å…³é—­ï¼Œåœ¨æœ€åé˜¶æ®µå†å°† <code>dbus.service</code> æœåŠ¡åœæ­¢ï¼Œå®Œæˆæœ€ç»ˆçš„æ¸…ç†ã€‚</p><p>è¿˜æœ‰ä¸€ç§é€€å‡ºæ¨¡å¼ï¼Œæ‰‹åŠ¨å¯åŠ¨äº† <code>dde-session-shutdown.service</code> æœåŠ¡ï¼Œä¹Ÿä¼šè§¦å‘å®Œæˆçš„é€€å‡ºæµç¨‹ï¼Œ<code>dde-session-shutdown.service</code> ä¼šåˆ©ç”¨ <code>dde-session-ctl --logout</code> å°†ä¼šè¯æ³¨é”€ï¼Œä»è€Œè§¦å‘ä¸Šé¢çš„æ‰§è¡Œæµç¨‹ï¼Œå®Œæˆä¼šè¯ä¸æœåŠ¡çš„å…³é—­ã€‚</p><p>ç›®å‰è¿˜æœ‰ä¸€äº›é—®é¢˜æ²¡æœ‰è§£å†³ï¼Œæ²¡æœ‰åˆ›å»ºç‹¬ç«‹çš„ systemd.slice å’Œ systemd.scopeï¼Œè¿™å¯ä»¥å¸®åŠ© dde ç»†è‡´çš„åˆ’åˆ†å’Œç®¡ç†è‡ªå·±çš„å­ servicesï¼Œé€€å‡º dbus.service çš„æ‰‹æ®µéå¸¸é»‘ï¼Œè€Œä¸” dbus æœåŠ¡çš„ç¨‹åºç”±äºå›¾å½¢æœåŠ¡ä¹Ÿå·²ç»ç»“æŸäº†ï¼Œå¯¼è‡´æˆç‰‡çš„ X11 Errorã€‚è¿™äº›éƒ½æ˜¯è¦è§£å†³çš„ã€‚</p><p>ä¸‹ä¸€æ­¥å‡†å¤‡å†™å‡ ä¸ª serviceï¼Œç”¨æ¥ä»£æ›¿ startdde çš„ç»„ä»¶å¯åŠ¨ï¼Œæ¯”å¦‚ kwinã€dde-desktopã€dde-dock å’Œ xdg-autostart ç­‰ã€‚</p><p>å°±ç›®å‰çš„æƒ…å†µæ¥çœ‹ï¼Œä»»é‡è€Œé“è¿œã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> systemd </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Starting sessions with systemd</title>
      <link href="/2021/12/25/Starting-sessions-with-systemd/"/>
      <url>/2021/12/25/Starting-sessions-with-systemd/</url>
      
        <content type="html"><![CDATA[<p>DDE ç°åœ¨æ­£åœ¨åš Wayland çš„æ”¯æŒï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯¹ç›®å‰çš„æ¡Œé¢ç¯å¢ƒç»“æ„è¿›è¡Œè°ƒæ•´ï¼Œ<br>è€ƒè™‘åˆ° GNOME å’Œ KDE éƒ½å·²ç»ä½¿ç”¨ <code>systemd</code> æ¥ç®¡ç† sessionï¼Œæˆ‘è®¤ä¸º deepin å›¢é˜Ÿä¹Ÿå¯ä»¥è€ƒè™‘è¿™ä¸€æ­¥äº†ã€‚</p><h2 id="ä¸ºä»€ä¹ˆéœ€è¦-systemdï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆéœ€è¦-systemdï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆéœ€è¦ systemdï¼Ÿ"></a>ä¸ºä»€ä¹ˆéœ€è¦ systemdï¼Ÿ</h2><p>ç›®å‰ <code>systemd</code> ä½œä¸ºäº‹å®ä¸Šèƒœåˆ©çš„ init è¿›ç¨‹ï¼Œå®ƒç°åœ¨è´Ÿè´£çš„åŠŸèƒ½å·²ç»è¶Šæ¥è¶Šå¤šäº†ï¼Œæ”¯æŒä½†ä¸é™äºï¼š<code>udev</code>ã€<code>sleep/hibernate/suspend</code>ã€<code>dbus</code>ã€<code>services</code> ç­‰ã€‚ç°åœ¨è¶Šæ¥è¶Šå¤šçš„ç¨‹åºä¹Ÿå¼€å§‹ä½¿ç”¨ <code>systemd</code> ç®¡ç†åå°æœåŠ¡ã€‚</p><h2 id="ä¸ä½¿ç”¨-systemd-æ¥ç®¡ç†-session-ä¼šæœ‰ä»€ä¹ˆé—®é¢˜å—ï¼Ÿ"><a href="#ä¸ä½¿ç”¨-systemd-æ¥ç®¡ç†-session-ä¼šæœ‰ä»€ä¹ˆé—®é¢˜å—ï¼Ÿ" class="headerlink" title="ä¸ä½¿ç”¨ systemd æ¥ç®¡ç† session ä¼šæœ‰ä»€ä¹ˆé—®é¢˜å—ï¼Ÿ"></a>ä¸ä½¿ç”¨ systemd æ¥ç®¡ç† session ä¼šæœ‰ä»€ä¹ˆé—®é¢˜å—ï¼Ÿ</h2><p>å­˜åœ¨ä¸€ä¸ªè¿›ç¨‹é€ƒé€¸é—®é¢˜ï¼Œä¸è¿‡è¿™ä¸ªé—®é¢˜ä¸æ˜¯å¦é‡‡ç”¨ <code>systemd</code> ç®¡ç† <code>session</code> æ²¡æœ‰å¤ªå¤§å…³ç³»ã€‚</p><p>æˆ‘å…ˆæ¥ç®€å•ä»‹ç»ä¸€ä¸‹ç›®å‰ DDE çš„å·¥ä½œæ¨¡å‹ï¼š</p><p>é¦–å…ˆï¼ŒDDE ä½¿ç”¨ <code>LightDM</code> ä½œä¸ºæ˜¾ç¤ºæœåŠ¡å™¨ï¼ˆDisplay Managerï¼‰ï¼ŒDDE æä¾›äº† <code>lightdm-deepin-greeter</code> ä½œä¸ºç™»å½•ç•Œé¢ï¼Œgreeter å¯ä»¥é€šè¿‡è°ƒç”¨ LightDM çš„ api è¿›è¡Œ linux-pam çš„è®¤è¯ã€‚</p><p>å½“è®¤è¯é€šè¿‡åï¼ŒLightDM ä¼šå¯åŠ¨ä¸€ä¸ªä¼šè¯ï¼ˆSessionï¼‰ï¼Œä¹‹åè¿è¡Œçš„ç¨‹åºéƒ½å°†æ˜¯ä»¥ç™»å½•çš„ç”¨æˆ·èº«ä»½å¯åŠ¨ï¼Œç„¶å <code>systemd --user</code> è¿›ç¨‹ä¼šè¢«å¯åŠ¨ï¼ŒåŒæ—¶ <code>dbus-daemon</code> ä¹Ÿä¼šå¯åŠ¨ï¼Œä¹‹å LightDM ä¼šå¯åŠ¨ <code>startddeã€‚</code></p><p>æ­¤æ—¶å°±å¼€å§‹æ‰§è¡Œåˆ° DDE <code>çš„åˆå§‹åŒ–é˜¶æ®µï¼Œstartdde</code> ä¼šå¯åŠ¨ <code>dde-session-daemon</code> å’Œ DDE çš„æ ¸å¿ƒç»„ä»¶ï¼Œä¹‹åå°±å¹¶è¡Œå¯åŠ¨ autostart ä¸­çš„ desktop æ–‡ä»¶ã€‚</p><p><code>startdde</code> ç›®å‰çš„æµç¨‹æœ¬èº«æ²¡æœ‰é—®é¢˜ï¼Œé—®é¢˜å‡ºåœ¨ <code>systemd</code> æ¥ç®¡äº† dbusï¼Œå¹¶ä¸”ä» <code>systemd 226</code> ç‰ˆæœ¬å¼€å§‹ï¼Œ<code>/etc/pam.d/system-login</code> é»˜è®¤é…ç½®ä¸­çš„ <code>pam_systemd</code> æ¨¡å—ä¼šåœ¨ç”¨æˆ·é¦–æ¬¡ç™»å½•çš„æ—¶å€™, è‡ªåŠ¨è¿è¡Œä¸€ä¸ª <code>systemd --user</code> å®ä¾‹ã€‚ åªè¦ç”¨æˆ·è¿˜æœ‰ä¼šè¯å­˜åœ¨ï¼Œè¿™ä¸ªè¿›ç¨‹å°±ä¸ä¼šé€€å‡ºï¼›ç”¨æˆ·æ‰€æœ‰ä¼šè¯é€€å‡ºæ—¶ï¼Œè¿›ç¨‹å°†ä¼šè¢«é”€æ¯ã€‚å½“#éšç³»ç»Ÿè‡ªåŠ¨å¯åŠ¨ <code>systemd</code> ç”¨æˆ·å®ä¾‹å¯ç”¨æ—¶, è¿™ä¸ªç”¨æˆ·å®ä¾‹å°†åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶åŠ è½½ï¼Œå¹¶ä¸”ä¸ä¼šè¢«é”€æ¯ã€‚</p><blockquote><p><code>systemd --user</code> å®ä¾‹æ˜¯é’ˆå¯¹æ¯ä¸ªç”¨æˆ·å¤„ç†çš„ï¼Œè€Œä¸æ˜¯é’ˆå¯¹ä¼šè¯ã€‚è¿™æ ·åšçš„åŸç†æ˜¯ç”¨æˆ·æœåŠ¡å¤„ç†çš„å¤§éƒ¨åˆ†èµ„æºï¼Œåƒ socket æˆ–çŠ¶æ€æ–‡ä»¶æ˜¯é’ˆå¯¹æ¯ä¸ªç”¨æˆ·çš„ï¼ˆå­˜æ´»äºç”¨æˆ·çš„ä¸»ç›®å½•ä¸‹ï¼‰è€Œä¸æ˜¯ä¼šè¯ã€‚è¿™æ„å‘³ç€æ‰€æœ‰çš„ç”¨æˆ·æœåŠ¡æ˜¯ç‹¬ç«‹äºä¼šè¯ä¹‹å¤–è¿è¡Œçš„ã€‚æœ€ç»ˆï¼Œæˆ‘ä»¬å¾—å‡ºç»“è®ºï¼šåŸºäºä¼šè¯è¿è¡Œçš„ç¨‹åºå¯èƒ½ä¼šå¯¼è‡´ç”¨æˆ·æœåŠ¡ä¸­æ–­ã€‚<code>systemd</code> å¤„ç†ç”¨æˆ·ä¼šè¯çš„æ–¹å¼æ˜¯éå¸¸ç”Ÿç¡¬çš„ï¼ˆpretty much in fluxï¼‰ã€‚</p></blockquote><p>é‚£ä¹ˆé—®é¢˜å°±æ¥äº†ï¼Œä¸Šé¢è¯´äº†ï¼Œsystemd æ¥ç®¡äº† dbus æœåŠ¡ï¼Œé€šè¿‡ dbus å¯åŠ¨çš„ç¨‹åºä¼šåœ¨ <code>dbus.service</code> ä¸‹é¢ï¼Œæˆä¸ºå®ƒçš„å­è¿›ç¨‹ï¼Œè€Œ <code>systemd --user</code> åœ¨æœ‰ç”¨æˆ·å…¶å®ƒç™»å½•çš„ä¼šè¯å­˜åœ¨æ—¶ï¼Œå¹¶ä¸ä¼šåœæ­¢ <code>systemd --user</code>ï¼Œæ‰€ä»¥ <code>dbus.service</code> ä¹Ÿä¸ä¼šåœæ­¢ã€‚ä½†æ˜¯ dde çš„ä¼šè¯<br>å·²ç»å®Œæˆæ³¨é”€äº†ï¼Œä½†æ˜¯é€šè¿‡ dde å¯åŠ¨çš„ç¨‹åºå´æ²¡æœ‰è¢«é€€å‡ºï¼Œä»è€Œå¯¼è‡´äº†ç¨‹åº <strong>é€ƒé€¸</strong>ã€‚</p><h2 id="è§£å†³æ–¹æ¡ˆï¼Ÿ"><a href="#è§£å†³æ–¹æ¡ˆï¼Ÿ" class="headerlink" title="è§£å†³æ–¹æ¡ˆï¼Ÿ"></a>è§£å†³æ–¹æ¡ˆï¼Ÿ</h2><p>å¦‚æœåªæ˜¯æƒ³è§£å†³é€ƒé€¸é—®é¢˜ï¼Œé‚£ä¹ˆæƒ³ä¸€ä¸ªåŠæ³•ï¼Œåœ¨ <code>session</code> åœæ­¢çš„æ—¶å€™ï¼Œä¸»åŠ¨æŠŠ <code>dbus.service</code> æœåŠ¡åœæ‰å…¶å®å°±å¯ä»¥è§£å†³äº†ï¼Œä½†æ˜¯æˆ‘ä»¬æƒ³è¦åˆ©ç”¨ <code>systemd</code> çš„è‡ªåŠ¨ä¾èµ–è§£å†³ï¼Œè¿™æ ·å°±ä¸ç”¨é‡å¤é€ ä¸€ç‚¹ç‚¹å°è½®å­äº†ã€‚</p><p>é‚£ä¹ˆéœ€è¦æ€ä¹ˆä¿®æ”¹æ‰èƒ½ç¬¦åˆæ¡Œé¢ç¯å¢ƒçš„è¦æ±‚ï¼Ÿ</p><p>GNOME å’Œ KDE ç°åœ¨å·²ç»å®Œæˆäº† <code>systemd session</code> çš„å·¥ä½œï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸¤ä¸ªè€å¤§å“¥èº«ä¸Šå­¦ä¹ ã€‚</p><blockquote><p>æä¾›äº†ä¸€ä¸ªæ–°çš„ä¼šè¯å…¥å£ç‚¹ <code>gnome-session-systemd</code>ã€‚ è¿™éœ€è¦ä¸€ä¸ªå‚æ•°ï¼Œå³å¼€å§‹ä¼šè¯çš„å•å…ƒï¼ˆé€šå¸¸æ˜¯ .target å•å…ƒï¼‰ã€‚ å®ƒå°†æ‰§è¡Œä¸€äº›æ¸…ç†åŠŸèƒ½ï¼Œåˆå§‹åŒ– systemd ç¯å¢ƒï¼Œç„¶åå¯åŠ¨å•å…ƒå¹¶ç­‰å¾…å®ƒåœæ­¢ã€‚ä¼šè¯é€šè¿‡ä¿®æ”¹å®ƒä»¬çš„ Exec è¡Œå¹¶åˆ é™¤ <code>RequiredComponents</code> æ¥é€‰æ‹©ä»¥è¿™ç§æ–¹å¼å¯åŠ¨ã€‚</p></blockquote><blockquote><p>XDG autostart ç°åœ¨ <code>systemd</code> æä¾›äº†ä¸€ä¸ª wrapperï¼Œå¯ä»¥è‡ªåŠ¨ç”Ÿæˆå‡º service å•å…ƒï¼Œæ‰€ä»¥åŠŸèƒ½å¯ä»¥å¤ç”¨ã€‚</p></blockquote><blockquote><p>åœ¨ systemd ç®¡ç†çš„ç³»ç»Ÿä¸Šï¼Œæ¯ä¸ªç”¨æˆ·éƒ½è¢«åˆ†é…äº†ä¸€ä¸ª <code>user-x.slice (systemd.slice(5))</code>,å¹¶ä¸”ç”¨æˆ·çš„ä¼šè¯å°†åœ¨ <code>session-Y.scope (systemd.scope(5))</code> ä¸­è¿è¡Œã€‚æ‚¨è¿˜å¯ä»¥åœ¨ä¸»æœºä¸Šçœ‹åˆ°ä¸€äº›å…¶å®ƒç”¨æˆ·ç‰¹å®šçš„å•å…ƒï¼ŒåŒ…æ‹¬ <code>user@x.service</code>,å®ƒæ˜¯ç”¨æˆ·çš„ <code>systemd</code> å®ä¾‹ã€‚è¿™æ˜¯ç”¨æˆ·çš„ä¸€ä¸ªå•ç‹¬çš„ <code>systemd</code> è¿›ç¨‹ï¼Œå¦‚æœç”¨æˆ·ä¸å†ç™»å½•ï¼Œå®ƒå°†å†æ¬¡å…³é—­ã€‚</p></blockquote><blockquote><p>éšç€ <code>systemd</code> çš„ç§»åŠ¨ï¼Œä¸ä»… DBus æ¿€æ´»çš„åº”ç”¨ç¨‹åºå’ŒæœåŠ¡ï¼Œæ‚¨çš„æ•´ä¸ªä¼šè¯ç°åœ¨éƒ½ä½¿ç”¨ç”¨æˆ·çš„ <code>systemd</code> å®ä¾‹å¯åŠ¨ã€‚ è¿™æœ‰ä¸€äº›å‰¯ä½œç”¨ï¼Œèµ·åˆå¯èƒ½çœ‹èµ·æ¥å¾ˆå¥‡æ€ªã€‚ ä¾‹å¦‚ï¼Œä¹‹å‰æåˆ°çš„ session-Y.scope æ›¾ç»åŒ…å« 200 å¤šä¸ªè¿›ç¨‹ï¼Œç°åœ¨å‡å°‘åˆ°ä»… 4 ä¸ªè¿›ç¨‹ã€‚ å¦ä¸€ä¸ªå‰¯ä½œç”¨æ˜¯æ›´éš¾ç†è§£è¿›ç¨‹å±äºå“ªä¸ªä¼šè¯ï¼ˆè¿™ä¸è®¸å¤šæœåŠ¡ç›¸å…³ï¼‰æˆ–è€… ps å°†ä¸å†æ˜¾ç¤º ttyã€‚</p></blockquote><blockquote><p>ä½†æ˜¯æ ¹æ® GNOME blog çš„æ–‡ç« è¯´æ˜ï¼Œè¿™äº›å‰¯ä½œç”¨å·²ç»è¢«å¤„ç†äº†ã€‚GNOMEä¼šè¯ä»ç„¶å§‹ç»ˆç»‘å®šåˆ°<code>session-Y.scope</code>ï¼ˆä¾‹å¦‚ï¼Œä½¿ç”¨ <code>loginctl kill-session</code> ç»§ç»­å¯é åœ°å·¥ä½œï¼‰ã€‚</p></blockquote><p>æŸ¥çœ‹äº† GNOME æä¾›çš„ dbus æœåŠ¡å•å…ƒæ–‡ä»¶ï¼Œæœ€ç»ˆæ˜ç™½äº† GNOME æ˜¯æ€ä¹ˆåšåˆ°é˜²æ­¢ dbus ç¨‹åºé€ƒé€¸çš„ï¼Œå…¶å®æ“ä½œéå¸¸ç®€å•ï¼Œå°±æ˜¯æä¾›äº†ä¸€ä¸ª <code>gnome-session-shutdown.target</code>ï¼Œåœ¨è¿™ä¸ª target é‡Œå…³è”äº† <code>gnome-sessino-restart-dbus.service</code>ï¼Œé‡Œé¢æ‰§è¡Œçš„æ˜¯ <code>gnome-session-ctl --restart-dbus</code>ï¼Œ<br>å…¶å®å°±æ˜¯é€šè¿‡ DBus è°ƒç”¨äº† <code>systemd --user</code> çš„ dbus æ–¹æ³•ï¼Œå°† <code>dbus.service</code> ç»™åœæ‰äº†ã€‚ï¼ˆ- - |ï¼‰</p><h2 id="æ”¹é€ æ–¹æ¡ˆ"><a href="#æ”¹é€ æ–¹æ¡ˆ" class="headerlink" title="æ”¹é€ æ–¹æ¡ˆ"></a>æ”¹é€ æ–¹æ¡ˆ</h2><p>æ—¢ç„¶äº†è§£äº†å‰å› åæœï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç€æ‰‹æ”¹é€  DDE äº†ã€‚</p><p>è¿˜éœ€è¦è¡¥å……ä¸€ä¸ªçŸ¥è¯†ï¼Œä¼šè¯å¯åŠ¨ä»¥åï¼Œä¼šæœ‰ä¸€ä¸ªè¿›ç¨‹ä½œä¸ºä¼šè¯çš„å…¥å£ï¼Œä¼šè¯æ‰€æœ‰çš„ç¨‹åºéƒ½æ˜¯ä»è¿™ä¸ªå…¥å£å¼€å§‹å¯åŠ¨çš„ï¼Œè¿™ä¸ªå…¥å£å°±æ˜¯ <code>startdde</code>ã€‚</p><p>æˆ‘ä»¬æ—¢ç„¶å¸Œæœ›åˆ©ç”¨ <code>systemd</code> çš„æœåŠ¡æ¥å¯åŠ¨ï¼Œå¹¶ä¸”å¸®åŠ©æˆ‘ä»¬è‡ªåŠ¨è§£å†³ä¾èµ–ï¼Œä½†æ˜¯æ‹†åˆ†é¡¹ç›®ç›®å‰å‹åŠ›æ¯”è¾ƒå¤§ï¼Œæˆ‘ä»¬è¿˜è®¡åˆ’é‡å†™ä¸€éƒ¨åˆ†åç«¯åŠŸèƒ½ï¼Œå¯ä»¥åœ¨é‡å†™æ—¶è¿›è¡Œè°ƒæ•´ã€‚</p><h3 id="å¯åŠ¨å…¥å£"><a href="#å¯åŠ¨å…¥å£" class="headerlink" title="å¯åŠ¨å…¥å£"></a>å¯åŠ¨å…¥å£</h3><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ç³»åˆ—çš„ <code>service</code> å’Œ <code>target</code> æ–‡ä»¶ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dde-session-initialized.target</span><br><span class="line">dde-session-manager.service</span><br><span class="line">dde-session-manager.target</span><br><span class="line">dde-session-pre.target</span><br><span class="line">dde-session-restart-dbus.service</span><br><span class="line">dde-session-shutdown.service</span><br><span class="line">dde-session-shutdown.target</span><br><span class="line">dde-session.target</span><br><span class="line">dde-session-x11-services-ready.target</span><br><span class="line">dde-session-x11-services.target</span><br><span class="line">dde-session-x11.target</span><br><span class="line">org.deepin.Session.service</span><br></pre></td></tr></table></figure><p>çœ‹èµ·æ¥éå¸¸çš„å¤šï¼Œä¸ç”¨æ‹…å¿ƒï¼Œä»–ä»¬éƒ½æœ‰å„è‡ªçš„ä½œç”¨ï¼Œä½ å¯ä»¥è®¤ä¸ºè¿™æ˜¯å°†ç”Ÿå‘½å‘¨æœŸåœ¨ <code>systemd</code> å®ç°äº†ã€‚</p><p>ç”±äº <code>systemd</code> ä¼šå¸®åŠ©æˆ‘ä»¬è‡ªåŠ¨å®Œæˆä¾èµ–è§£æï¼Œé‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦ä¿ç•™ä¸€ä¸ªå…¥å£æœåŠ¡ï¼Œå…¶å®ƒæœåŠ¡éƒ½ç¦æ­¢æ‰‹åŠ¨å¯åŠ¨å³å¯ã€‚</p><p>æˆ‘é€‰æ‹©ä½¿ç”¨ <code>dde-session-x11.target</code> ä½œä¸ºå…¥å£ï¼Œå› ä¸ºæœªæ¥ deepin è¿˜è¦æ”¯æŒ waylandï¼Œé‚£ä¹ˆåœ¨è¿™é‡Œå°±åŒºåˆ†å¼€ä¼šæ¯”è¾ƒæ–¹ä¾¿ä¸€äº›ï¼Œå› ä¸ºæ¡Œé¢ç¯å¢ƒçš„åç»­å¯åŠ¨ä¸ä½¿ç”¨ä»€ä¹ˆå›¾å½¢æœåŠ¡æ²¡æœ‰å¤ªå¤§å…³ç³»ã€‚</p><p>æ ¹æ®æ–‡ä»¶åç§°å°±å¯ä»¥æ–¹ä¾¿çš„äº†è§£åˆ°è¿™äº›æ–‡ä»¶æ˜¯åœ¨ä»€ä¹ˆé˜¶æ®µè¢«æ‰§è¡Œçš„ã€‚</p><h3 id="é€€å‡ºæ—¶æ¸…ç†"><a href="#é€€å‡ºæ—¶æ¸…ç†" class="headerlink" title="é€€å‡ºæ—¶æ¸…ç†"></a>é€€å‡ºæ—¶æ¸…ç†</h3><p>åˆ›å»ºçš„ <code>dde-session-shutdown.target</code> ç”¨æ¥å…³è”æ‰€æœ‰é€€å‡ºæ—¶éœ€è¦æ‰§è¡Œçš„ <code>services</code>ã€‚</p><h3 id="æ¸…ç†-dbus-service"><a href="#æ¸…ç†-dbus-service" class="headerlink" title="æ¸…ç† dbus.service"></a>æ¸…ç† dbus.service</h3><p>æä¾›äº†ä¸€ä¸ª <code>dde-session-restart-dbus.service</code> ç”¨æ¥æ³¨é”€ä»¥åå…³é—­ <code>dbus.service</code>ï¼Œä¸è¦é—®ï¼Œé—®å°±æ˜¯æ²¡åŠæ³•ï½ã€‚</p><p>åœ¨ <code>dde-session-shutdown.target</code> ä¸­ä¼šå…³è”è¿™ä¸ªæœåŠ¡ï¼Œå½“ç”¨æˆ·çš„ä¼šè¯æ³¨é”€æˆ–è€…æ¡Œé¢ç¯å¢ƒæœåŠ¡å‡ºç°é—®é¢˜æ—¶ï¼Œå°±å¯ä»¥é€€å‡ºæ‰€æœ‰çš„ <code>dbus.service</code>ã€‚</p><p>å½“å‘ç°ä¼šè¯æ³¨é”€æ—¶ï¼Œ<code>dde-session-manager.service</code> ä¼šæ‰§è¡Œé€€å‡ºï¼Œåœ¨æœåŠ¡å…³é—­æ—¶å¯åŠ¨ <code>dde-session-shutdown.target</code>ï¼Œå¹¶ä¸”ä½¿ç”¨ <code>replace-irreversibly</code> æ ‡è®°ä¸ºä¸å¯æ’¤é”€ã€‚</p><p><code>dde-session-shutdown.target</code> ä¸­åˆä¼šæ¸…ç† <code>dbus.service</code> ä¸‹çš„æ‰€æœ‰ç¨‹åºï¼Œè¿™æ ·å°±é¿å…äº†æœåŠ¡å¯ä»¥é€šè¿‡ dbus é€ƒé€¸å‡ºä¼šè¯ã€‚</p><h3 id="æ¶æ„æ¨¡å‹"><a href="#æ¶æ„æ¨¡å‹" class="headerlink" title="æ¶æ„æ¨¡å‹"></a>æ¶æ„æ¨¡å‹</h3><center><img src="/2021/12/25/Starting-sessions-with-systemd/model.svg" class=""></center><h3 id="æœ€ç»ˆæ•ˆæœ"><a href="#æœ€ç»ˆæ•ˆæœ" class="headerlink" title="æœ€ç»ˆæ•ˆæœ"></a>æœ€ç»ˆæ•ˆæœ</h3><p>å¯ä»¥çœ‹åˆ° startdde å’Œå®ƒçš„è¿›ç¨‹æ ‘æŒ‚åœ¨ systemd ä¸‹é¢ã€‚</p><center><img src="/2021/12/25/Starting-sessions-with-systemd/110276978.jpeg" class=""></center><p>åŸæœ¬çš„ä½ç½®ç°åœ¨åªæœ‰ä¸€ä¸ªå ä½çš„ç¨‹åºã€‚</p><center><img src="/2021/12/25/Starting-sessions-with-systemd/3503592248.jpeg" class=""></center><h2 id="å¼•ç”¨èµ„æ–™"><a href="#å¼•ç”¨èµ„æ–™" class="headerlink" title="å¼•ç”¨èµ„æ–™"></a>å¼•ç”¨èµ„æ–™</h2><blockquote><p><a href="https://blogs.gnome.org/benzea/2019/10/01/gnome-3-34-is-now-managed-using-systemd/">https://blogs.gnome.org/benzea/2019/10/01/gnome-3-34-is-now-managed-using-systemd/</a></p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> systemd </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>introduction-to-the-qml-cmake-apiï¼ˆä¸­æ–‡ç¿»è¯‘ï¼‰</title>
      <link href="/2021/09/14/introduction-to-the-qml-cmake-api/"/>
      <url>/2021/09/14/introduction-to-the-qml-cmake-api/</url>
      
        <content type="html"><![CDATA[<p>åŸæ–‡ï¼š</p><blockquote><p><a href="https://www.qt.io/blog/introduction-to-the-qml-cmake-api">https://www.qt.io/blog/introduction-to-the-qml-cmake-api</a></p></blockquote><p>å½“ Qt 6 è¿ç§»åˆ° CMake æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›ä¸º QML é¡¹ç›®æä¾›æ›´å¥½çš„ä½“éªŒã€‚åœ¨æœ€åˆçš„Qt 6.0å‘å¸ƒç‰ˆä¸­ï¼Œæˆ‘ä»¬åªæä¾›äº†ä¸€äº›æŠ€æœ¯é¢„è§ˆAPIï¼Œè¿™å¹¶æ²¡æœ‰æ¯” qmake è‡ª Qt 5.15 ä»¥æ¥æä¾›çš„ API åšå¾—æ›´å¤šã€‚</p><p>ç°åœ¨ï¼Œéšç€å³å°†å‘å¸ƒçš„ Qt 6.2ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº† CMake APIã€‚åœ¨è¿™ç¯‡åšå®¢æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†è¯´æ˜ä¸ºä»€ä¹ˆéœ€è¦ä¸º QML æ·»åŠ æ„å»ºç³»ç»Ÿæ”¯æŒï¼Œå¹¶å±•ç¤ºå¦‚ä½•å®ç°ä¸¤ä¸ªå¸¸ç”¨ç”¨ä¾‹ã€‚</p><h2 id="ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦CMakeçš„æ”¯æŒ"><a href="#ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦CMakeçš„æ”¯æŒ" class="headerlink" title="ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦CMakeçš„æ”¯æŒ?"></a>ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦CMakeçš„æ”¯æŒ?</h2><p>åœ¨è®¨è®ºåˆ›å»º QML åº”ç”¨ç¨‹åºå’Œåº“çš„æ–°æ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆåº”è¯¥äº†è§£åˆ°ç›®å‰ä¸ºæ­¢å®ƒä»¬æ˜¯å¦‚ä½•å®Œæˆçš„:</p><ul><li>åªæœ‰è‡ªå®šä¹‰ c++ è¢«æ”¾åˆ°å®é™…çš„QMLåç§°ç©ºé—´ä¸­;æ— è®ºæ˜¯é€šè¿‡ 5.15 ä»¥æ¥çš„å£°æ˜å¼ç±»å‹æ³¨å†Œï¼Œè¿˜æ˜¯ä»ç„¶ä½¿ç”¨æ‰‹åŠ¨ qml*Register è°ƒç”¨ã€‚</li><li>QML æ–‡ä»¶é€šå¸¸ç®€å•åœ°æ”¾åœ¨å•ä¸ªæ–‡ä»¶å¤¹ä¸­ã€‚å¦‚æœå®ƒä»¬ç›¸äº’å¼•ç”¨ï¼Œäººä»¬é€šå¸¸ä¾èµ–äºéšå¼å¯¼å…¥( QML æ–‡æ¡£å¯ä»¥åœ¨å…¶ä»– QML æ–‡æ¡£ä¸­ä½¿ç”¨ç±»å‹ï¼Œåªè¦å®ƒä»¬åœ¨åŒä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­)ã€‚å¤§å¤šæ•°äººéƒ½å¿½ç•¥äº† qmldir æ–‡ä»¶ï¼Œé™¤éä»–ä»¬æœ‰å¾ˆå¼ºçš„ç†ç”±ä½¿ç”¨å®ƒä»¬(å¾ˆå¯èƒ½æ˜¯å› ä¸ºä»–ä»¬éœ€è¦ä¸€ä¸ª QML å•ä¾‹)ã€‚ç„¶åï¼Œåº”ç”¨ç¨‹åºåªéœ€é€šè¿‡ QQmlApplicationEngine æˆ– QQuickWindow åŠ è½½ä¸» QML æ–‡ä»¶ã€‚</li><li>å›¾åƒã€ç€è‰²å™¨æˆ–å­—ä½“ç­‰é™„åŠ èµ„æºé€šå¸¸è¢«æ”¾å…¥èµ„æºç³»ç»Ÿä¸­ã€‚ç„¶åï¼ŒQML æ–‡ä»¶å°†é€šè¿‡qrc è·¯å¾„å¼•ç”¨å®ƒä»¬ã€‚å› æ­¤ï¼Œæ‚¨ä¸èƒ½å†ä½¿ç”¨ QML(åœºæ™¯)ä¸­çš„ QML æ–‡ä»¶æˆ– QtCreator ä¸­çš„ QML è®¾è®¡å™¨ã€‚</li><li>è¦ä½¿ç”¨ qmlcachegenï¼Œéœ€è¦åˆ›å»ºä¸€ä¸ªåŒ…å«æ‰€æœ‰ QML æ–‡ä»¶çš„ QRC æ–‡ä»¶ï¼Œç„¶åé€šè¿‡æŒ‡å®š <code>QT += qtquickcompiler.prf</code> å¯ç”¨ qmlcachegen è¿™åªä¼šåœ¨æ‚¨ä»èµ„æºæ–‡ä»¶ç³»ç»ŸåŠ è½½ç›¸åº”æ–‡ä»¶æ—¶ç”Ÿæ•ˆï¼Œä½†æ˜¯ï¼Œä»ç‰©ç†æ–‡ä»¶ç³»ç»ŸåŠ è½½æ–‡ä»¶æ—¶ï¼Œå®ƒä»¬ä»å°†åœ¨è¿è¡Œæ—¶ç¼–è¯‘ã€‚</li></ul><p>ä¸Šé¢å·²ç»åˆ—å‡ºäº†ä¸€äº›ç”±è¿„ä»Šä¸ºæ­¢ä½¿ç”¨çš„ç›¸å½“ç‰¹åˆ«çš„æ–¹æ³•å¼•èµ·çš„é—®é¢˜ã€‚ é€šå¸¸ï¼Œæˆ‘ä»¬çš„å·¥å…·å¾ˆéš¾å¯¹ QML é¡¹ç›®è¿›è¡Œæ¨ç†ã€‚ è¾“å…¥ CMake å’Œ qt6_add_qml_moduleã€‚ æœ‰äº†è¿™ä¸ªæ–°å¼•å…¥çš„å‡½æ•°ï¼Œæ„å»ºç³»ç»Ÿå°±çŸ¥é“ QML é¡¹ç›®çš„æ‰€æœ‰éƒ¨åˆ†ï¼Œå¹¶ä¸”å¯ä»¥æ ¹æ®éœ€è¦å°†å…¶ä¼ é€’ç»™æˆ‘ä»¬çš„å·¥å…·ã€‚ è®©æˆ‘ä»¬çœ‹å‡ ä¸ªä¾‹å­ï¼</p><h2 id="ä¸€ä¸ªåŸºæœ¬çš„-QML-åº”ç”¨ç¨‹åºâ€¦â€¦"><a href="#ä¸€ä¸ªåŸºæœ¬çš„-QML-åº”ç”¨ç¨‹åºâ€¦â€¦" class="headerlink" title="ä¸€ä¸ªåŸºæœ¬çš„ QML åº”ç”¨ç¨‹åºâ€¦â€¦"></a>ä¸€ä¸ªåŸºæœ¬çš„ QML åº”ç”¨ç¨‹åºâ€¦â€¦</h2><p>æˆ‘ä»¬ä»ä¸€ä¸ªå°å°çš„â€œHello, World!â€å¼€å§‹ ä¾‹å­ã€‚ æˆ‘ä»¬åœ¨åŒä¸€ç›®å½•ä¸­æœ‰ä¸€ä¸ª QML æ–‡ä»¶ main.qml</p><figure class="highlight qml"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> QtQuick</span><br><span class="line"></span><br><span class="line"><span class="title">Window</span> &#123;</span><br><span class="line">    <span class="attribute">id:</span><span class="string"> root</span></span><br><span class="line">    <span class="attribute">visible</span>: <span class="literal">true</span></span><br><span class="line">    <span class="title">Text</span> &#123;</span><br><span class="line">        <span class="attribute">text</span>: <span class="string">&quot;Hello, world!&quot;</span></span><br><span class="line">        <span class="attribute">anchors.centerIn</span>: <span class="built_in">parent</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å’Œä¸€ä¸ªå®ä¾‹åŒ–å®ƒçš„ main.cpp æ–‡ä»¶ï¼š</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QGuiApplication&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QQmlApplicationEngine&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">QGuiApplication <span class="title">app</span><span class="params">(argc, argv)</span></span>;</span><br><span class="line"></span><br><span class="line">    QQmlApplicationEngine engine;</span><br><span class="line">    <span class="function"><span class="type">const</span> QUrl <span class="title">url</span><span class="params">(<span class="string">u&quot;qrc:/hello/main.qml&quot;</span>_qs)</span></span>;</span><br><span class="line">    engine.<span class="built_in">load</span>(url);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> app.<span class="built_in">exec</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é™¤äº† URL ä¸­çš„â€œhelloâ€å¤–ï¼Œå¤§éƒ¨åˆ†éƒ½å¾ˆç®€å•ã€‚æˆ‘ä»¬ä¸€ä¼šå„¿å†å›åˆ°è¿™ä¸ªé—®é¢˜ä¸Šã€‚ä½†é¦–å…ˆï¼Œè®©æˆ‘ä»¬çœ‹çœ‹æ„å»ºé¡¹ç›®æ‰€éœ€çš„CMakeLists.txtæ–‡ä»¶:</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬åšä¸€äº›é€šç”¨çš„è®¾ç½®ã€‚</p><figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION <span class="number">3.18</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">project</span>(hello VERSION <span class="number">1.0</span> LANGUAGES CXX)</span><br><span class="line"></span><br><span class="line"><span class="keyword">set</span>(CMAKE_AUTOMOC <span class="keyword">ON</span>)</span><br><span class="line"><span class="keyword">set</span>(CMAKE_CXX_STANDARD <span class="number">17</span>)</span><br><span class="line"><span class="keyword">set</span>(CMAKE_CXX_STANDARD_REQUIRED <span class="keyword">ON</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">find_package</span>(Qt6 <span class="number">6.2</span> COMPONENTS Quick Gui REQUIRED)</span><br><span class="line"></span><br><span class="line">qt_add_executable(myapp</span><br><span class="line">    main.cpp</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">target_link_libraries</span>(myapp PRIVATE Qt6::Gui Qt6::Quick)</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬æ·»åŠ äº† Quick æ¨¡å—ï¼Œå¹¶å‘Šè¯‰ CMake ä¸ºæˆ‘ä»¬çš„å¯æ‰§è¡Œæ–‡ä»¶åˆ›å»ºä¸€ä¸ªç›®æ ‡ï¼Œæ¥ä¸‹æ¥ä¼šå‘ç”Ÿæœ‰è¶£çš„éƒ¨åˆ†ï¼š</p><figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line">qt_add_qml_module(myapp</span><br><span class="line">    URI hello</span><br><span class="line">    VERSION <span class="number">1.0</span></span><br><span class="line">    QML_FILES main.qml)</span><br></pre></td></tr></table></figure><p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ç»ˆäºçœ‹åˆ°äº† <code>qt_add_qml_module</code> çš„ä½œç”¨ã€‚ æˆ‘ä»¬å°†å¯æ‰§è¡Œæ–‡ä»¶çš„ç›®æ ‡ã€URIã€æ¨¡å—ç‰ˆæœ¬å’Œ QML æ–‡ä»¶åˆ—è¡¨ä¼ é€’ç»™å®ƒã€‚ åè¿‡æ¥ï¼Œå®ƒç¡®ä¿ myapp æˆä¸º QML æ¨¡å—ã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œè¿™ä¼šå°† QML æ–‡ä»¶æ”¾å…¥èµ„æºæ–‡ä»¶ç³»ç»Ÿä¸­çš„ qrc:&#x2F;${URI} ä¸­ã€‚ è¿™ç°åœ¨å¯èƒ½çœ‹èµ·æ¥å¾ˆå¥‡æ€ªï¼Œå®é™…ä¸Šåœ¨è¿™ç¯‡åšæ–‡çš„ç»“å°¾çœ‹èµ·æ¥ä»ç„¶å¾ˆå¥‡æ€ªï¼šæ‚¨å¿…é¡»ç­‰å¾…å³å°†å‘å¸ƒçš„å…³äº QML æ¨¡å—çš„åšæ–‡ï¼Œæˆ‘ä»¬å°†è¯¦ç»†è§£é‡Šä¸ºä»€ä¹ˆéœ€è¦è¿™æ ·åšã€‚ åœ¨è¿™ä¸€ç‚¹ä¸Šï¼Œæ‚¨å¯èƒ½ä¼šæƒ³çŸ¥é“è¿™ç§å¥‡æ€ªæ˜¯å¦çœŸçš„å€¼å¾—ã€‚ æ¯•ç«Ÿåœ¨ Qt 5 ä¸­ä½¿ç”¨ cmake å·²ç»å¯ä»¥å°†æ–‡ä»¶æ”¾å…¥èµ„æºç³»ç»Ÿï¼Œè€Œæ— éœ€å¤ªå¤šä»ªå¼ï¼</p><p>è¯·æ”¾å¿ƒï¼Œæˆ‘ä»¬å·²ç»è·å¾—äº†ä¸¤ä»¶äº‹ï¼šç¬¬ä¸€ï¼Œ<code>qt_add_qml_module</code> ç¡®ä¿ qmlcachegen è¿è¡Œã€‚ å…¶æ¬¡ï¼Œå®ƒåˆ›å»ºä¸€ä¸ª myapp_qmllint ç›®æ ‡ï¼Œè¯¥ç›®æ ‡å¯¹ QML_FILES ä¸­çš„æ–‡ä»¶è¿è¡Œ qmlintã€‚ é˜…è¯»æˆ‘ä»¬<a href="https://www.qt.io/blog/whats-new-in-qml-tooling-in-qt-6.2?hsLang=en">å…³äºå·¥å…·çš„åšå®¢</a>æ–‡ç« ï¼Œäº†è§£ä¸ºä»€ä¹ˆè¦è¿è¡Œ qmllintã€‚</p><h2 id="å˜å¾—æ›´åŠ å…ˆè¿›"><a href="#å˜å¾—æ›´åŠ å…ˆè¿›" class="headerlink" title="å˜å¾—æ›´åŠ å…ˆè¿›"></a>å˜å¾—æ›´åŠ å…ˆè¿›</h2><p>è®©æˆ‘ä»¬æ‰©å±•è¿™ä¸ªç¤ºä¾‹ï¼Œä½¿å…¶æ›´æœ‰è¶£ã€‚æˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ªæ–°çš„ QML æ–‡ä»¶ï¼ŒFramedImage.qml å’Œ img å­ç›®å½•ä¸­çš„å›¾åƒã€‚</p><figure class="highlight qml"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> QtQuick</span><br><span class="line"></span><br><span class="line"><span class="title">Rectangle</span> &#123;</span><br><span class="line">    <span class="attribute">border.width</span>: <span class="number">2</span></span><br><span class="line">    <span class="attribute">border.color</span>: <span class="string">&quot;black&quot;</span></span><br><span class="line">    <span class="title">Image</span> &#123;</span><br><span class="line">        <span class="attribute">source</span>: Qt.resolvedUrl(<span class="string">&quot;img/world.png&quot;</span>)</span><br><span class="line">        <span class="attribute">anchors.centerIn</span>: <span class="built_in">parent</span></span><br><span class="line">        <span class="attribute">sourceSize.width</span>: <span class="built_in">parent</span>.width</span><br><span class="line">        <span class="attribute">sourceSize.height</span>: <span class="built_in">parent</span>.height</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ main.qml ä¸­ä½¿ç”¨:</p><figure class="highlight qml"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> QtQuick</span><br><span class="line"></span><br><span class="line"><span class="title">Window</span> &#123;</span><br><span class="line">    <span class="attribute">id:</span><span class="string"> root</span></span><br><span class="line">    <span class="attribute">visible</span>: <span class="literal">true</span></span><br><span class="line">    <span class="title">Text</span> &#123;</span><br><span class="line">        <span class="attribute">text</span>: <span class="string">&quot;Hello, world!&quot;</span></span><br><span class="line">        <span class="attribute">anchors.centerIn</span>: <span class="built_in">parent</span></span><br><span class="line">        <span class="attribute">color</span>: <span class="string">&quot;white&quot;</span></span><br><span class="line">        <span class="attribute">z</span>: <span class="number">2</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title">FramedImage</span> &#123; <span class="attribute">anchors.fill</span>: <span class="built_in">parent</span> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ›´æ–°æˆ‘ä»¬çš„ CMakeList.txt:</p><figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line">qt_add_qml_module(myapp</span><br><span class="line">    URI hello</span><br><span class="line">    VERSION <span class="number">1.0</span></span><br><span class="line">    QML_FILES</span><br><span class="line">        main.qml</span><br><span class="line">        FramedImage.qml</span><br><span class="line">    RESOURCES</span><br><span class="line">        img/world.png</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>æ‚¨å¯èƒ½å·²ç»é¢„æ–™åˆ° QML_FILES ç°åœ¨ä¹Ÿä¼šåˆ—å‡º FramedImage.qmlã€‚ æ›´æœ‰è¶£çš„å˜åŒ–æ˜¯ RESOURCES æ¡ç›®ã€‚ é€šè¿‡åœ¨é‚£é‡Œæ·»åŠ å¼•ç”¨çš„èµ„æºï¼Œå®ƒä»¬ä¼šè‡ªåŠ¨æ·»åŠ åˆ°ä¸ QML æ–‡ä»¶ç›¸åŒçš„æ ¹è·¯å¾„ä¸‹çš„åº”ç”¨ç¨‹åº - ä¹Ÿåœ¨èµ„æºæ–‡ä»¶ç³»ç»Ÿä¸­ã€‚ æ— éœ€é‡å¤ qt_add_resources ä¸­çš„è·¯å¾„ã€‚ å¹¶ä¸”é€šè¿‡ä¿æŒèµ„æºç³»ç»Ÿä¸­çš„è·¯å¾„ä¸ source å’Œ build ç›®å½•ä¸­çš„è·¯å¾„ä¸€è‡´ï¼Œæˆ‘ä»¬ç¡®ä¿å§‹ç»ˆæ‰¾åˆ°å›¾åƒï¼š ç”±äºå®ƒæ˜¯ç›¸å¯¹äº FramedImage.qml è§£æçš„ï¼Œå› æ­¤å®ƒæŒ‡çš„æ˜¯èµ„æºæ–‡ä»¶ç³»ç»Ÿä¸­çš„å›¾åƒ å¦‚æœæˆ‘ä»¬ä»é‚£é‡ŒåŠ è½½ mainï¼Œæˆ–è€…å¦‚æœæˆ‘ä»¬ä½¿ç”¨ qml å·¥å…·æ£€æŸ¥å®ƒï¼Œåˆ™åŠ è½½åˆ°å®é™…æ–‡ä»¶ç³»ç»Ÿä¸­çš„é‚£ä¸ªã€‚</p><h2 id="åˆ›å»ºä¸€ä¸ª-qml-åº“"><a href="#åˆ›å»ºä¸€ä¸ª-qml-åº“" class="headerlink" title="åˆ›å»ºä¸€ä¸ª qml åº“"></a>åˆ›å»ºä¸€ä¸ª qml åº“</h2><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬å¼€å§‹ç¬¬äºŒä¸ªä¾‹å­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå‘ QML å…¬å¼€ C++ ç±»å‹çš„åº“ã€‚ æˆ‘ä»¬è¿™ä¸ªä¾‹å­çš„ç›®å½•ç»“æ„çœ‹èµ·æ¥åƒï¼š</p><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">â”œâ”€â”€ CMakeLists.txt</span><br><span class="line">â””â”€â”€ example</span><br><span class="line">    â””â”€â”€ mylib</span><br><span class="line">        â”œâ”€â”€ CMakeLists.txt</span><br><span class="line">        â”œâ”€â”€ mytype.cpp</span><br><span class="line">        â””â”€â”€ mytype.h</span><br></pre></td></tr></table></figure><p>mytype.h å£°æ˜ä¸€ä¸ªç±»å¹¶ä½¿ç”¨ Qt 5.15 ä¸­å¼•å…¥çš„å£°æ˜æ€§æ³¨å†Œå®å°†å…¶å…¬å¼€ç»™å¼•æ“ï¼š</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QObject&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QtQml/qqmlregistration.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyType</span> : <span class="keyword">public</span> QObject</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function">Q_OBJECT</span></span><br><span class="line"><span class="function">    QML_ELEMENT</span></span><br><span class="line"><span class="function">    <span class="title">Q_PROPERTY</span><span class="params">(<span class="type">int</span> answer READ answer CONSTANT)</span></span></span><br><span class="line"><span class="function"> <span class="keyword">public</span>:</span></span><br><span class="line"><span class="function">    int answer() const;</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>é¡¶å±‚ CMakeLists.txt æ–‡ä»¶è¿›è¡Œä¸€äº›åŸºæœ¬è®¾ç½®ï¼Œç„¶åä½¿ç”¨ add_subdirectory å°†å…¶åŒ…å«åœ¨ mylib ä¸­ã€‚ æˆ‘ä»¬ä½¿ç”¨ä¸ QML æ¨¡å—çš„ URI ç›¸å¯¹åº”çš„å­ç›®å½•ç»“æ„ï¼Œä½†å°†ç‚¹æ›¿æ¢ä¸ºæ–œæ  - è¿™ä¸å¼•æ“åœ¨å¯¼å…¥è·¯å¾„ä¸­æœç´¢æ¨¡å—æ—¶ä½¿ç”¨çš„é€»è¾‘ç›¸åŒã€‚ é€šè¿‡éµå¾ªè¯¥çº¦å®šï¼Œæˆ‘ä»¬æœ‰åŠ©äºå·¥å…·ã€‚</p><figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line">qt6_add_qml_module(mylib</span><br><span class="line">    URI example.mylib</span><br><span class="line">    VERSION <span class="number">1.0</span></span><br><span class="line">    SOURCES</span><br><span class="line">        mytype.h mytype.cpp</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>é¦–å…ˆï¼Œè¿™æ¬¡æˆ‘ä»¬è¦æ·»åŠ  C++ ç±»å‹ã€‚ ä¸ºæ­¤ï¼Œæˆ‘ä»¬ä½¿ç”¨ SOURCES å‚æ•°æŒ‡å®šå®ƒä»¬ã€‚ æ­¤å¤–ï¼Œè¿™æ¬¡æˆ‘ä»¬è¿˜æ²¡æœ‰ä¸º mylib åˆ›å»ºä»»ä½•ç›®æ ‡ã€‚ å¦‚æœ qt6_add_qml_module çš„ target å‚æ•°ä¸å­˜åœ¨ï¼Œå®ƒä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªåº“ç›®æ ‡ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬åœ¨è¿™ç§æƒ…å†µä¸‹æƒ³è¦çš„ã€‚</p><p>å¦‚æœæ‚¨æ„å»ºé¡¹ç›®ï¼Œæ‚¨ä¼šæ³¨æ„åˆ°æˆ‘ä»¬ä¸ä»…æ„å»ºäº†åº“ï¼Œè¿˜æ„å»ºäº†ä¸€ä¸ª QML æ’ä»¶â€”â€”å³ä½¿æˆ‘ä»¬æ²¡æœ‰ç¼–å†™è‡ªå®šä¹‰ QQmlEngineExtensionPluginã€‚ é‚£ä¹ˆæ’ä»¶æœ‰ä»€ä¹ˆä½œç”¨å‘¢ï¼Ÿ å°±å…¶æœ¬èº«è€Œè¨€ï¼Œä¸æ˜¯å¾ˆå¤šã€‚ mylib åº“æœ¬èº«å·²ç»åŒ…å«å‘å¼•æ“æ³¨å†Œç±»å‹çš„ä»£ç ã€‚ ä½†æ˜¯ï¼Œè¿™ä»…åœ¨æˆ‘ä»¬å¯ä»¥é“¾æ¥åº“çš„æƒ…å†µä¸‹æ‰æœ‰ç”¨ã€‚ ä¸ºäº†ä½¿æ¨¡å—åœ¨ qml å·¥å…·åŠ è½½çš„ QML æ–‡ä»¶ä¸­å¯ç”¨ï¼Œæˆ‘ä»¬éœ€è¦ä¸€äº›å¯ä»¥åŠ è½½çš„æ’ä»¶ã€‚ ç„¶åæ’ä»¶è´Ÿè´£å®é™…é“¾æ¥åº“ï¼Œå¹¶ç¡®ä¿ç±»å‹å¾—åˆ°æ³¨å†Œã€‚ åº”è¯¥æ³¨æ„çš„æ˜¯ï¼Œè‡ªåŠ¨æ’ä»¶ç”Ÿæˆåªæœ‰åœ¨æ¨¡å—é™¤äº†æ³¨å†Œç±»å‹ä¹‹å¤–ä¸åšä»»ä½•äº‹æƒ…æ—¶æ‰å¯èƒ½ã€‚ å¦‚æœå®ƒéœ€è¦åšä¸€äº›æ›´é«˜çº§çš„äº‹æƒ…ï¼Œæ¯”å¦‚åœ¨ initializeEngine ä¸­æ³¨å†Œä¸€ä¸ªå›¾åƒæä¾›è€…ï¼Œä½ ä»ç„¶éœ€è¦æ‰‹åŠ¨ç¼–å†™æ’ä»¶ã€‚ qt6_add_qml_module é€šè¿‡ NO_GENERATE_PLUGIN_SOURCE å¯¹æ­¤æä¾›æ”¯æŒã€‚ æˆ‘ä»¬å°†åœ¨ç¨åçš„åšå®¢æ–‡ç« ä¸­æ›´è¯¦ç»†åœ°ä»‹ç»è¿™ä¸€ç‚¹ã€‚</p><p>å¦å¤–ï¼Œæ‚¨è¿˜è®°å¾—æˆ‘ä»¬æåˆ°éµå¾ªç›®å½•å¸ƒå±€çº¦å®šæœ‰åŠ©äºå·¥å…·å—ï¼Ÿ è¯¥å¸ƒå±€åæ˜ åœ¨æˆ‘ä»¬çš„æ„å»ºç›®å½•ä¸­ï¼Œæ’ä»¶å°±ä½ã€‚ è¿™æ„å‘³ç€æ‚¨å¯ä»¥å°†æ„å»ºç›®å½•çš„è·¯å¾„ä¼ é€’ç»™ qml å·¥å…·ï¼ˆé€šè¿‡ -I æ ‡å¿—ï¼‰ï¼Œå®ƒä¼šæ‰¾åˆ°æ’ä»¶ã€‚ åè¿‡æ¥ï¼Œè¿™å¯ä»¥å¸®åŠ©æ‚¨æµ‹è¯•çº¯ C++ åº“æ¨¡å—ä¸Šçš„æ›´æ”¹ï¼Œå› ä¸ºæ‚¨ä¸éœ€è¦æ‰§è¡Œä»»ä½•è¿›ä¸€æ­¥çš„å®‰è£…æ­¥éª¤ã€‚</p><p>åœ¨ç»“æŸä¹‹å‰ï¼Œè®©æˆ‘ä»¬å‘æ¨¡å—æ·»åŠ ä¸€ä¸ª QML æ–‡ä»¶ï¼šåœ¨ lib å­æ–‡ä»¶å¤¹ä¸­ï¼Œæˆ‘ä»¬æ·»åŠ ä¸€ä¸ª Mistake.qml æ–‡ä»¶ï¼š</p><figure class="highlight qml"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> example.mylib</span><br><span class="line"></span><br><span class="line"><span class="title">MyType</span>&#123;</span><br><span class="line">    <span class="attribute">answer</span>: <span class="number">43</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¹¶è°ƒæ•´ qt6_add_qml_module è°ƒç”¨ï¼š</p><figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line">qt6_add_qml_module(mylib</span><br><span class="line">    URI example.mylib</span><br><span class="line">    VERSION <span class="number">1.0</span></span><br><span class="line">    SOURCES</span><br><span class="line">        mytype.h mytype.cpp</span><br><span class="line">    QML_FILES</span><br><span class="line">        Mistake.qml</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>é¡¾åæ€ä¹‰ï¼ˆMistakeï¼‰ï¼Œæˆ‘ä»¬åœ¨è¿™é‡ŒçŠ¯äº†ä¸€ä¸ªé”™è¯¯ï¼š answer å®é™…ä¸Šæ˜¯ä¸€ä¸ªåªè¯»å±æ€§ã€‚ æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦è¿™æ ·åšï¼Ÿ å½“ç„¶ï¼Œä¸ºäº†ç‚«è€€æ‰¿è¯ºçš„ qmllint é›†æˆï¼šCMake å°†ä¸ºæˆ‘ä»¬åˆ›å»ºä¸€ä¸ª qmllint ç›®æ ‡ï¼Œä¸€æ—¦æˆ‘ä»¬è¿è¡Œå®ƒï¼Œqmllint å°±ä¼šè­¦å‘Šæˆ‘ä»¬è¿™ä¸ªé—®é¢˜ï¼š</p><p>(åªæœ‰å½“æ‚¨ä½¿ç”¨äº†devåˆ†æ”¯æœ€è¿‘çš„qmllintæ—¶)</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$</span><span class="language-bash">&gt; cmake --build . --target mylib_qmllint</span></span><br><span class="line">...</span><br><span class="line">Warning: Mistake.qml:4:13: Cannot assign to read-only property answer</span><br><span class="line">    answer: 43</span><br></pre></td></tr></table></figure><h2 id="å±•æœ›"><a href="#å±•æœ›" class="headerlink" title="å±•æœ›"></a>å±•æœ›</h2><p>è¿™æ˜¯å…³äºæ–° CMake API çš„ç³»åˆ—æ–‡ç« ä¸­çš„ç¬¬ä¸€ç¯‡åšæ–‡ã€‚ æˆ‘ä»¬ä»‹ç»äº† qt6_add_qml_moduleï¼Œå¹¶å±•ç¤ºäº†å®ƒå¦‚ä½•å¤„ç†ä¸€äº›åŸºæœ¬ç”¨ä¾‹ã€‚ æˆ‘ä»¬å·²ç»çœ‹åˆ° CMake é€šè¿‡å¤„ç†é‡å¤æ€§ä»»åŠ¡æ¥å¸®åŠ©ä½ ï¼Œæ¯”å¦‚æ‰‹åŠ¨ç¼–å†™ QML æ’ä»¶ï¼Œä»¥åŠå®ƒå¦‚ä½•å¸®åŠ©æˆ‘ä»¬çš„å·¥å…·æ•…äº‹ã€‚</p><p>åœ¨æœ¬åšå®¢ç³»åˆ—çš„ä¸‹ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥ç ”ç©¶ QML æ¨¡å—ï¼Œå¹¶æŸ¥çœ‹ä¸€äº›æ›´é«˜çº§çš„ç”¨ä¾‹ï¼šåŒ…å«å¤šä¸ª QML åº“çš„åº”ç”¨ç¨‹åºå’Œå®‰è£… QML æ¨¡å—åº“ã€‚</p><p>å¦‚æœæ‚¨æƒ³äº†è§£æœ‰å…³å®ƒæä¾›çš„æ‰€æœ‰é€‰é¡¹çš„æ›´å¤šä¿¡æ¯ï¼Œè¿˜å¯ä»¥æŸ¥çœ‹ <a href="https://doc-snapshots.qt.io/qt6-dev/qt-add-qml-module.html">qt6_add_qml_module çš„å‚è€ƒæ–‡æ¡£</a>ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Qt </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VuexåŸºæœ¬ä½¿ç”¨</title>
      <link href="/2021/08/10/Vuex%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/"/>
      <url>/2021/08/10/Vuex%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨å†™ deepincn çš„é¦–é¡µï¼Œçœ‹ç€ elementary os çš„é¦–é¡µæ ·å¼æŒºå¥½çœ‹çš„ï¼Œå°±æ‰“ç®—å±±å¯¨ä¸€ä¸‹ã€‚</p><p>æœ¬æ¥æ‰“ç®—ç”¨ Angular å¼€å‘çš„ï¼Œä½†æ˜¯çœ‹åˆ° Vue3 å·²ç»ååˆ†ç¨³å®šäº†ï¼Œå°±æ‰“ç®—é‡æ‹¾ Vue3ï¼Œç”¨ Vue3 æ¥å†™æ–°çš„é¦–é¡µã€‚</p><p>ä¸ºäº†æ–¹ä¾¿ä»¥åæ›´æ–°æ•°æ®ï¼Œéœ€è¦ä½¿ç”¨é›†ä¸­çš„æ•°æ®ç®¡ç†ï¼ŒVue ä¸‹æ¯”è¾ƒå‡ºåå’Œå¥½ç”¨çš„å°±æ˜¯ Vuex äº†ï¼Œè€Œ Vuex ä¹Ÿå·²ç»é€‚é…äº† Vue3ï¼Œå¯ä»¥æ”¾å¿ƒä½¿ç”¨äº†ã€‚</p><p>æœ¬ç¯‡æ–‡ç« ä¼šè§ç®€å•ä»‹ç»ä¸€ä¸‹ Vuexï¼Œç„¶åè®²ä¸€ä¸‹åŸºæœ¬è¯­æ³•ï¼Œæˆ‘ä¼šå†å¼€( <del>æ°´</del> )ä¸€ç¯‡æ–‡ç« æ¥ä¸“é—¨å±±å¯¨ä¸€ä¸ª Vuexï¼Œé€šè¿‡å®ç°ä¸€ä¸ªç®€æ˜“çš„ Vuex æ¥æ·±å…¥äº†è§£æ ¸å¿ƒã€‚</p><h2 id="1-ç®€ä»‹"><a href="#1-ç®€ä»‹" class="headerlink" title="1. ç®€ä»‹"></a>1. ç®€ä»‹</h2><p>Vue æœ€é‡è¦çš„ä¸€ä¸ªåŠŸèƒ½ç‚¹å°±æ˜¯ <strong>æ•°æ®é©±åŠ¨</strong>ã€‚</p><p>æ‰€è°“æ•°æ®é©±åŠ¨ï¼Œæ˜¯æŒ‡è§†å›¾æ˜¯ç”±æ•°æ®é©±åŠ¨ç”Ÿæˆçš„ï¼Œæˆ‘ä»¬å¯¹è§†å›¾çš„ä¿®æ”¹ï¼Œä¸ä¼šç›´æ¥æ“ä½œ DOMï¼Œè€Œæ˜¯é€šè¿‡ä¿®æ”¹æ•°æ®ã€‚å®ƒç›¸æ¯”æˆ‘ä»¬ä¼ ç»Ÿçš„å‰ç«¯å¼€å‘ï¼Œå¦‚ä½¿ç”¨ jQuery ç­‰å‰ç«¯åº“ç›´æ¥ä¿®æ”¹ DOMï¼Œå¤§å¤§ç®€åŒ–äº†ä»£ç é‡ã€‚</p><p>ç‰¹åˆ«æ˜¯å½“äº¤äº’å¤æ‚çš„æ—¶å€™ï¼Œåªå…³å¿ƒæ•°æ®çš„ä¿®æ”¹ä¼šè®©ä»£ç çš„é€»è¾‘å˜çš„éå¸¸æ¸…æ™°ï¼Œå› ä¸º DOM å˜æˆäº†æ•°æ®çš„æ˜ å°„ï¼Œæˆ‘ä»¬æ‰€æœ‰çš„é€»è¾‘éƒ½æ˜¯å¯¹æ•°æ®çš„ä¿®æ”¹ï¼Œè€Œä¸ç”¨ç¢°è§¦ DOMï¼Œè¿™æ ·çš„ä»£ç éå¸¸åˆ©äºç»´æŠ¤ã€‚</p><p>Vue è¿˜æœ‰ä¸€ä¸ªé‡è¦çš„åŠŸèƒ½ç‚¹æ˜¯ <strong>ç»„ä»¶åŒ–</strong>ï¼Œæ¯ä¸ªç»„ä»¶å°±æ˜¯æœ€å°çš„åŠŸèƒ½å•ä½ï¼Œæ¯ä¸ªç»„ä»¶éƒ½æœ‰è‡ªå·±çš„ <code>data</code>ï¼Œ<code>template</code> å’Œ <code>methods</code>ã€‚æˆ‘ä»¬é€šè¿‡ä¿®æ”¹ <code>data</code> ä¸­çš„æ•°æ®æ¥æ›´æ–° <code>template</code> ä¸­è§†å›¾ã€‚åœ¨å•ä¸ªç»„ä»¶ä¸­æˆ‘ä»¬æ›´æ–°è§†å›¾æ˜¯éå¸¸æ–¹ä¾¿çš„ï¼Œä½†æ˜¯å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬çš„é¡¹ç›®ä¸æ­¢ä¸€ä¸ªç»„ä»¶ï¼Œéå¸¸å¤šçš„ç»„ä»¶æ•´åˆåœ¨ä¸€èµ·çš„æ—¶å€™ï¼Œç»´æŠ¤åŒä¸€ä¸ªçŠ¶æ€å°±ä¼šéå¸¸å›°éš¾ï¼Œç‰¹åˆ«æ˜¯åµŒå…¥éå¸¸æ·±çš„æ—¶å€™ï¼Œä¼ é€’å‚æ•°å°±ä¼šå˜å¾—éå¸¸éº»çƒ¦ï¼ˆè¿™é‡Œæˆ‘æƒ³èµ·æ¥äº† Deepin çš„æ§åˆ¶ä¸­å¿ƒï¼Œç»„ä»¶é‡Œé¢æœ‰éå¸¸æ·±çš„åµŒå¥—ï¼Œæœ€é‡Œé¢çš„ç»„ä»¶æƒ³è¦è·å–æ•°æ®ï¼Œéœ€è¦æ²¿ç€åµŒå¥—å±‚å±‚ä¼ é€’ï¼Œéå¸¸éº»çƒ¦ï¼‰ã€‚</p><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥ Vuex æ¥è¿›è¡ŒçŠ¶æ€ç®¡ç†ï¼Œè´Ÿè´£ç»„ä»¶ä¸­çš„é€šä¿¡ã€‚</p><blockquote><p>Vuex è§£å†³çš„é—®é¢˜</p></blockquote><ul><li><p>å¤šä¸ªè§†å›¾ä¾èµ–äºåŒä¸€çŠ¶æ€ã€‚</p></li><li><p>æ¥è‡ªä¸åŒè§†å›¾çš„è¡Œä¸ºéœ€è¦å˜æ›´åŒä¸€çŠ¶æ€ã€‚</p></li></ul><h2 id="2-åŸºç¡€ä½¿ç”¨"><a href="#2-åŸºç¡€ä½¿ç”¨" class="headerlink" title="2. åŸºç¡€ä½¿ç”¨"></a>2. åŸºç¡€ä½¿ç”¨</h2><p>é¦–å…ˆå…ˆåœ¨é¡¹ç›®ä¸­å®‰è£… Vuexï¼ŒVuex4 æ˜¯ä¸º Vue3 å¼€å‘çš„ç‰ˆæœ¬ï¼Œæˆ‘ä»¬é€šè¿‡ä»¥ä¸‹å‘½ä»¤å®‰è£…ï¼š</p><p><strong>npm</strong></p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install vuex@next</span><br></pre></td></tr></table></figure><p><strong>yarn</strong></p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">yarn add vuex@next</span><br></pre></td></tr></table></figure><p>æ¯ä¸€ä¸ª Vuex åº”ç”¨çš„æ ¸å¿ƒå°±æ˜¯ storeï¼ˆä»“åº“ï¼‰ã€‚â€œstoreâ€åŸºæœ¬ä¸Šå°±æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œå®ƒåŒ…å«ç€ä½ çš„åº”ç”¨ä¸­å¤§éƒ¨åˆ†çš„çŠ¶æ€ (state)ã€‚Vuex å’Œå•çº¯çš„å…¨å±€å¯¹è±¡æœ‰ä»¥ä¸‹ä¸¤ç‚¹ä¸åŒï¼š</p><ol><li><p>Vuex çš„çŠ¶æ€å­˜å‚¨æ˜¯å“åº”å¼çš„ã€‚å½“ Vue ç»„ä»¶ä» store ä¸­è¯»å–çŠ¶æ€çš„æ—¶å€™ï¼Œè‹¥ store ä¸­çš„çŠ¶æ€å‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆç›¸åº”çš„ç»„ä»¶ä¹Ÿä¼šç›¸åº”åœ°å¾—åˆ°é«˜æ•ˆæ›´æ–°ã€‚</p></li><li><p>ä½ ä¸èƒ½ç›´æ¥æ”¹å˜ store ä¸­çš„çŠ¶æ€ã€‚æ”¹å˜ store ä¸­çš„çŠ¶æ€çš„å”¯ä¸€é€”å¾„å°±æ˜¯æ˜¾å¼åœ°æäº¤ (commit) mutationã€‚è¿™æ ·ä½¿å¾—æˆ‘ä»¬å¯ä»¥æ–¹ä¾¿åœ°è·Ÿè¸ªæ¯ä¸€ä¸ªçŠ¶æ€çš„å˜åŒ–ï¼Œä»è€Œè®©æˆ‘ä»¬èƒ½å¤Ÿå®ç°ä¸€äº›å·¥å…·å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°äº†è§£æˆ‘ä»¬çš„åº”ç”¨ã€‚</p></li></ol><p>ç°åœ¨å·²ç»å®‰è£…å¥½ Vuex äº†ï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹å†™ä¸€ä¸ªç®€å•çš„ storeã€‚åˆ›å»ºä¸€ä¸ª <code>store.ts</code> æ–‡ä»¶ã€‚</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">createStore</span>(&#123;</span><br><span class="line">    <span class="attr">state</span>: &#123;</span><br><span class="line">        <span class="attr">count</span>: <span class="number">0</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">mutations</span>: &#123;</span><br><span class="line">        <span class="title function_">increment</span> (state) &#123;</span><br><span class="line">            state.<span class="property">count</span>++</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123; store &#125;;</span><br></pre></td></tr></table></figure><p>åœ¨ main.ts ä¸­ï¼Œå°† store æ³¨å†Œåˆ° Vue çš„ app å®ä¾‹ä¸­ã€‚</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; store &#125; <span class="keyword">from</span> <span class="string">&#x27;./store&#x27;</span></span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(store);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>); <span class="comment">// æ·»åŠ åœ¨æŒ‚è½½ä¹‹å‰</span></span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šå°±æ˜¯ä¸€ä¸ªæœ€ç®€å•çš„ store çš„ä¾‹å­äº†ï¼Œæ˜¯ä¸æ˜¯æœ‰äº›æ‘¸ä¸ç€å¤´è„‘ï¼Ÿ</p><p>store.ts ä¸­æˆ‘ä»¬å¯¼å‡ºäº†ä½¿ç”¨ createStore å‡½æ•°è¿”å›çš„å¯¹è±¡ï¼Œåœ¨ store ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸¤ä¸ªå±æ€§ï¼š<code>state</code> å’Œ <code>mutations</code>ã€‚</p><p>æˆ‘ä»¬åœ¨ state ä¸­å®šä¹‰çŠ¶æ€ï¼Œåœ¨ mutations ä¸­å®šä¹‰æ“ä½œæ–¹æ³•ï¼Œåœ¨ mutations ä¸­å®šä¹‰çš„æ–¹æ³•ï¼Œå¿…é¡»é€šè¿‡ <code>store.commit()</code> æ–¹æ³•è°ƒç”¨ï¼Œè€Œä¸èƒ½ç›´æ¥è®¿é—®ã€‚</p><p>ç°åœ¨æˆ‘ä»¬åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ store å§ã€‚</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; count &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> &#123; defineComponent &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineComponent</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">setup</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">return</span> &#123; <span class="attr">count</span>: <span class="variable language_">this</span>.<span class="property">$store</span>.<span class="property">state</span>.<span class="property">count</span> &#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">methods</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="title function_">increment</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="variable language_">this</span>.<span class="property">$store</span>.<span class="title function_">commit</span>(<span class="string">&#x27;increment&#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>åœ¨ç»„ä»¶çš„ä¾‹å­ä¸­ï¼Œsetup å‡½æ•°æ˜¯ Vue3 å¼•å…¥çš„ ç»„åˆå¼ APIï¼ˆcomposition APIï¼‰ï¼Œè¿™é‡Œä¸è¯¦ç»†ä»‹ç» setup çš„ä½¿ç”¨ï¼Œsetup çš„å‡ºç°ï¼Œæˆ‘ä»¬å¯ä»¥å°†ç›¸åŒåŠŸèƒ½çš„ä»£ç æ”¾åœ¨æ¥è¿‘çš„ä½ç½®ï¼Œåªéœ€è¦åœ¨å‡½æ•°æœ€åè¿”å›è§†å›¾(template)æ‰€éœ€çš„å˜é‡å³å¯ã€‚</p><p>åœ¨ä¾‹å­ä¸­ï¼Œsetup å‘è§†å›¾æä¾›äº† count å˜é‡ï¼Œè¿™é‡Œä½¿ç”¨äº†è§£æ„èµ‹å€¼ï¼Œæ¨¡æ¿ä½¿ç”¨ count å˜é‡æ—¶ï¼Œå®é™…ä¸Šè®¿é—®çš„è¿˜æ˜¯ store ä¸­çš„ count,ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p><p>è¿™æ˜¯å› ä¸º Vuex çš„çŠ¶æ€å­˜å‚¨æ˜¯å“åº”å¼çš„ï¼Œå…·ä½“è¯·çœ‹ <del><a href="/">ã€ŠVue å“åº”å¼åŸç†ã€‹</a></del>ã€‚</p><p>åœ¨ä¾‹å­ä¸­ï¼Œç»„ä»¶æä¾›äº†ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºä¿®æ”¹ store ä¸­çš„ countï¼Œæ›´æ”¹ Vuex çš„ store ä¸­çš„çŠ¶æ€çš„å”¯ä¸€æ–¹æ³•æ˜¯æäº¤ mutationã€‚Vuex ä¸­çš„ mutation éå¸¸ç±»ä¼¼äºäº‹ä»¶ï¼šæ¯ä¸ª mutation éƒ½æœ‰ä¸€ä¸ªå­—ç¬¦ä¸²çš„äº‹ä»¶ç±»å‹ (type)å’Œä¸€ä¸ªå›è°ƒå‡½æ•° (handler)ã€‚è¿™ä¸ªå›è°ƒå‡½æ•°å°±æ˜¯æˆ‘ä»¬å®é™…è¿›è¡ŒçŠ¶æ€æ›´æ”¹çš„åœ°æ–¹ï¼Œå¹¶ä¸”å®ƒä¼šæ¥å— state ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ã€‚</p><p>ä½ ä¸èƒ½ç›´æ¥è°ƒç”¨ä¸€ä¸ª mutation å¤„ç†å‡½æ•°ã€‚è¿™ä¸ªé€‰é¡¹æ›´åƒæ˜¯äº‹ä»¶æ³¨å†Œï¼šâ€œå½“è§¦å‘ä¸€ä¸ªç±»å‹ä¸º increment çš„ mutation æ—¶ï¼Œè°ƒç”¨æ­¤å‡½æ•°ã€‚â€ã€‚</p><h2 id="3-æ ¸å¿ƒæ¦‚å¿µ"><a href="#3-æ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="3. æ ¸å¿ƒæ¦‚å¿µ"></a>3. æ ¸å¿ƒæ¦‚å¿µ</h2><p>Vuex ä¸€å…±æœ‰äº”ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼š Stateã€Getterã€Mutationã€Action å’Œ Moduleã€‚</p><h3 id="State"><a href="#State" class="headerlink" title="State"></a>State</h3><p>Vuex ä½¿ç”¨å•ä¸€çŠ¶æ€æ ‘ï¼Œç”¨ä¸€ä¸ªå¯¹è±¡å°±åŒ…å«äº†å…¨éƒ¨çš„åº”ç”¨å±‚çº§çŠ¶æ€ã€‚è‡³æ­¤å®ƒä¾¿ä½œä¸ºä¸€ä¸ªâ€œå”¯ä¸€æ•°æ®æº (SSOT)â€è€Œå­˜åœ¨ã€‚è¿™ä¹Ÿæ„å‘³ç€ï¼Œæ¯ä¸ªåº”ç”¨å°†ä»…ä»…åŒ…å«ä¸€ä¸ª store å®ä¾‹ã€‚å•ä¸€çŠ¶æ€æ ‘è®©æˆ‘ä»¬èƒ½å¤Ÿç›´æ¥åœ°å®šä½ä»»ä¸€ç‰¹å®šçš„çŠ¶æ€ç‰‡æ®µï¼Œåœ¨è°ƒè¯•çš„è¿‡ç¨‹ä¸­ä¹Ÿèƒ½è½»æ˜“åœ°å–å¾—æ•´ä¸ªå½“å‰åº”ç”¨çŠ¶æ€çš„å¿«ç…§ã€‚</p><p>åœ¨ç»„ä»¶ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>this.$store.state</code> æ¥è·å–æ³¨å†Œåˆ°çš„ stateã€‚æ¯å½“ store.state.count å˜åŒ–çš„æ—¶å€™, éƒ½ä¼šé‡æ–°æ±‚å–è®¡ç®—å±æ€§ï¼Œå¹¶ä¸”è§¦å‘æ›´æ–°ç›¸å…³è”çš„ DOMã€‚</p><p>Vuex é€šè¿‡ Vue çš„æ’ä»¶ç³»ç»Ÿå°† store å®ä¾‹ä»æ ¹ç»„ä»¶ä¸­â€œæ³¨å…¥â€åˆ°æ‰€æœ‰çš„å­ç»„ä»¶é‡Œã€‚ä¸”å­ç»„ä»¶èƒ½é€šè¿‡ this.$store è®¿é—®åˆ°ã€‚</p><p>template å¯ä»¥ç›´æ¥ä½¿ç”¨ this.$store.state.[å±æ€§] ï¼Œthis å¯ä»¥çœç•¥ã€‚</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    &#123;&#123; this.$store.state.name &#125;&#125;</span></span><br><span class="line"><span class="language-xml">    &#123;&#123; this.$store.state.age &#125;&#125;</span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><h3 id="Getter"><a href="#Getter" class="headerlink" title="Getter"></a>Getter</h3><p>æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦ä» store ä¸­çš„ state ä¸­æ´¾ç”Ÿå‡ºä¸€äº›çŠ¶æ€ï¼Œä¾‹å¦‚å¯¹åˆ—è¡¨è¿›è¡Œè¿‡æ»¤å¹¶è®¡æ•°ï¼š</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="title function_">doneTodosCount</span> () &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">$store</span>.<span class="property">state</span>.<span class="property">todos</span>.<span class="title function_">filter</span>(<span class="function"><span class="params">todo</span> =&gt;</span> todo.<span class="property">done</span>).<span class="property">length</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœæœ‰å¤šä¸ªç»„ä»¶éœ€è¦ç”¨åˆ°æ­¤å±æ€§ï¼Œæˆ‘ä»¬è¦ä¹ˆå¤åˆ¶è¿™ä¸ªå‡½æ•°ï¼Œæˆ–è€…æŠ½å–åˆ°ä¸€ä¸ªå…±äº«å‡½æ•°ç„¶ååœ¨å¤šå¤„å¯¼å…¥å®ƒâ€”â€”æ— è®ºå“ªç§æ–¹å¼éƒ½ä¸æ˜¯å¾ˆç†æƒ³ã€‚</p><p>Vuex å…è®¸æˆ‘ä»¬åœ¨ store ä¸­å®šä¹‰â€œgetterâ€ï¼ˆå¯ä»¥è®¤ä¸ºæ˜¯ store çš„è®¡ç®—å±æ€§ï¼‰ã€‚</p><p>Getter æ¥å— state ä½œä¸ºå…¶ç¬¬ä¸€ä¸ªå‚æ•°ï¼š</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> store = <span class="title function_">createStore</span>(&#123;</span><br><span class="line">  <span class="attr">state</span>: &#123;</span><br><span class="line">    <span class="attr">todos</span>: [</span><br><span class="line">      &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">text</span>: <span class="string">&#x27;...&#x27;</span>, <span class="attr">done</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">text</span>: <span class="string">&#x27;...&#x27;</span>, <span class="attr">done</span>: <span class="literal">false</span> &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">getters</span>: &#123;</span><br><span class="line">    <span class="title function_">doneTodos</span> (state) =&gt; &#123;</span><br><span class="line">      <span class="keyword">return</span> state.<span class="property">todos</span>.<span class="title function_">filter</span>(<span class="function"><span class="params">todo</span> =&gt;</span> todo.<span class="property">done</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>Getter ä¼šæš´éœ²ä¸º store.getters å¯¹è±¡ï¼Œä½ å¯ä»¥ä»¥å±æ€§çš„å½¢å¼è®¿é—®è¿™äº›å€¼ï¼š</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line">store.<span class="property">getters</span>.<span class="property">doneTodos</span> <span class="comment">// -&gt; [&#123; id: 1, text: &#x27;...&#x27;, done: true &#125;]</span></span><br></pre></td></tr></table></figure><h3 id="Mutation"><a href="#Mutation" class="headerlink" title="Mutation"></a>Mutation</h3><p>åœ¨ä¸Šé¢å·²ç»è¯´è¿‡äº†ï¼Œæ›´æ”¹ Vuex çš„ store ä¸­çš„çŠ¶æ€çš„å”¯ä¸€æ–¹æ³•æ˜¯æäº¤ mutationã€‚</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> store = <span class="title function_">createStore</span>(&#123;</span><br><span class="line">  <span class="attr">state</span>: &#123;</span><br><span class="line">    <span class="attr">count</span>: <span class="number">1</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">mutations</span>: &#123;</span><br><span class="line">    <span class="title function_">increment</span> (state) &#123;</span><br><span class="line">      <span class="comment">// å˜æ›´çŠ¶æ€</span></span><br><span class="line">      state.<span class="property">count</span>++</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>éœ€è¦ä½¿ç”¨ commit æ–¹æ³•æ¥æäº¤ä¸€ä¸ªè°ƒç”¨ï¼š</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line">store.<span class="title function_">commit</span>(<span class="string">&#x27;increment&#x27;</span>)</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥æäº¤å¤šä¸ªå‚æ•°ï¼Œcommit å‡½æ•°ä¼šå±•å¼€æ‰€æœ‰å‚æ•°ï¼š</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="attr">mutations</span>: &#123;</span><br><span class="line">  <span class="title function_">increment</span> (state, n) &#123;</span><br><span class="line">    state.<span class="property">count</span> += n</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line">store.<span class="title function_">commit</span>(<span class="string">&#x27;increment&#x27;</span>, <span class="number">10</span>)</span><br></pre></td></tr></table></figure><h3 id="Action"><a href="#Action" class="headerlink" title="Action"></a>Action</h3><p>Action ç±»ä¼¼äº mutationï¼Œä¸åŒåœ¨äºï¼š</p><ol><li>Action æäº¤çš„æ˜¯ mutationï¼Œè€Œä¸æ˜¯ç›´æ¥å˜æ›´çŠ¶æ€ã€‚</li><li>Action å¯ä»¥åŒ…å«ä»»æ„å¼‚æ­¥æ“ä½œã€‚</li></ol><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> store = <span class="title function_">createStore</span>(&#123;</span><br><span class="line">  <span class="attr">state</span>: &#123;</span><br><span class="line">    <span class="attr">count</span>: <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">mutations</span>: &#123;</span><br><span class="line">    <span class="title function_">increment</span> (state) &#123;</span><br><span class="line">      state.<span class="property">count</span>++</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">actions</span>: &#123;</span><br><span class="line">    <span class="title function_">increment</span> (context) &#123;</span><br><span class="line">      context.<span class="title function_">commit</span>(<span class="string">&#x27;increment&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>Action å‡½æ•°æ¥å—ä¸€ä¸ªä¸ store å®ä¾‹å…·æœ‰ç›¸åŒæ–¹æ³•å’Œå±æ€§çš„ context å¯¹è±¡ï¼Œå› æ­¤ä½ å¯ä»¥è°ƒç”¨ context.commit æäº¤ä¸€ä¸ª mutationï¼Œæˆ–è€…é€šè¿‡ context.state å’Œ context.getters æ¥è·å– state å’Œ gettersã€‚</p><p>Action é€šè¿‡ store.dispatch æ–¹æ³•è§¦å‘ï¼š</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line">store.<span class="title function_">dispatch</span>(<span class="string">&#x27;increment&#x27;</span>)</span><br></pre></td></tr></table></figure><p>ä¹ä¸€çœ¼çœ‹ä¸Šå»æ„Ÿè§‰å¤šæ­¤ä¸€ä¸¾ï¼Œæˆ‘ä»¬ç›´æ¥åˆ†å‘ mutation å²‚ä¸æ›´æ–¹ä¾¿ï¼Ÿå®é™…ä¸Šå¹¶éå¦‚æ­¤ï¼Œè¿˜è®°å¾— mutation å¿…é¡»åŒæ­¥æ‰§è¡Œè¿™ä¸ªé™åˆ¶ä¹ˆï¼ŸAction å°±ä¸å—çº¦æŸï¼æˆ‘ä»¬å¯ä»¥åœ¨ action å†…éƒ¨æ‰§è¡Œå¼‚æ­¥æ“ä½œï¼š</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="attr">actions</span>: &#123;</span><br><span class="line">  <span class="title function_">incrementAsync</span> (&#123; commit &#125;) &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">commit</span>(<span class="string">&#x27;increment&#x27;</span>)</span><br><span class="line">    &#125;, <span class="number">1000</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Module"><a href="#Module" class="headerlink" title="Module"></a>Module</h3><p>ç”±äºä½¿ç”¨å•ä¸€çŠ¶æ€æ ‘ï¼Œåº”ç”¨çš„æ‰€æœ‰çŠ¶æ€ä¼šé›†ä¸­åˆ°ä¸€ä¸ªæ¯”è¾ƒå¤§çš„å¯¹è±¡ã€‚å½“åº”ç”¨å˜å¾—éå¸¸å¤æ‚æ—¶ï¼Œstore å¯¹è±¡å°±æœ‰å¯èƒ½å˜å¾—ç›¸å½“è‡ƒè‚¿ã€‚</p><p>ä¸ºäº†è§£å†³ä»¥ä¸Šé—®é¢˜ï¼ŒVuex å…è®¸æˆ‘ä»¬å°† store åˆ†å‰²æˆæ¨¡å—ï¼ˆmoduleï¼‰ã€‚æ¯ä¸ªæ¨¡å—æ‹¥æœ‰è‡ªå·±çš„ stateã€mutationã€actionã€getterã€ç”šè‡³æ˜¯åµŒå¥—å­æ¨¡å—â€”â€”ä»ä¸Šè‡³ä¸‹è¿›è¡ŒåŒæ ·æ–¹å¼çš„åˆ†å‰²ï¼š</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> moduleA = &#123;</span><br><span class="line">  <span class="attr">state</span>: <span class="function">() =&gt;</span> (&#123; ... &#125;),</span><br><span class="line">  <span class="attr">mutations</span>: &#123; ... &#125;,</span><br><span class="line">  <span class="attr">actions</span>: &#123; ... &#125;,</span><br><span class="line">  <span class="attr">getters</span>: &#123; ... &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> moduleB = &#123;</span><br><span class="line">  <span class="attr">state</span>: <span class="function">() =&gt;</span> (&#123; ... &#125;),</span><br><span class="line">  <span class="attr">mutations</span>: &#123; ... &#125;,</span><br><span class="line">  <span class="attr">actions</span>: &#123; ... &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">createStore</span>(&#123;</span><br><span class="line">  <span class="attr">modules</span>: &#123;</span><br><span class="line">    <span class="attr">a</span>: moduleA,</span><br><span class="line">    <span class="attr">b</span>: moduleB</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">store.<span class="property">state</span>.<span class="property">a</span> <span class="comment">// -&gt; moduleA çš„çŠ¶æ€</span></span><br><span class="line">store.<span class="property">state</span>.<span class="property">b</span> <span class="comment">// -&gt; moduleB çš„çŠ¶æ€</span></span><br></pre></td></tr></table></figure><p>å¯¹äºæ¨¡å—å†…éƒ¨çš„ mutation å’Œ getterï¼Œæ¥æ”¶çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ¨¡å—çš„å±€éƒ¨çŠ¶æ€å¯¹è±¡ã€‚</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> moduleA = &#123;</span><br><span class="line">  <span class="attr">state</span>: <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">    <span class="attr">count</span>: <span class="number">0</span></span><br><span class="line">  &#125;),</span><br><span class="line">  <span class="attr">mutations</span>: &#123;</span><br><span class="line">    <span class="title function_">increment</span> (state) &#123;</span><br><span class="line">      <span class="comment">// è¿™é‡Œçš„ `state` å¯¹è±¡æ˜¯æ¨¡å—çš„å±€éƒ¨çŠ¶æ€</span></span><br><span class="line">      state.<span class="property">count</span>++</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="attr">getters</span>: &#123;</span><br><span class="line">    <span class="title function_">doubleCount</span> (state) &#123;</span><br><span class="line">      <span class="keyword">return</span> state.<span class="property">count</span> * <span class="number">2</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒæ ·ï¼Œå¯¹äºæ¨¡å—å†…éƒ¨çš„ actionï¼Œå±€éƒ¨çŠ¶æ€é€šè¿‡ context.state æš´éœ²å‡ºæ¥ï¼Œæ ¹èŠ‚ç‚¹çŠ¶æ€åˆ™ä¸º context.rootStateï¼š</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> moduleA = &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="attr">actions</span>: &#123;</span><br><span class="line">    <span class="title function_">incrementIfOddOnRootSum</span> (&#123; state, commit, rootState &#125;) &#123;</span><br><span class="line">      <span class="keyword">if</span> ((state.<span class="property">count</span> + rootState.<span class="property">count</span>) % <span class="number">2</span> === <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="title function_">commit</span>(<span class="string">&#x27;increment&#x27;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¨¡å—å†…éƒ¨çš„ action å’Œ mutation ä»ç„¶æ˜¯æ³¨å†Œåœ¨å…¨å±€å‘½åç©ºé—´çš„â€”â€”è¿™æ ·ä½¿å¾—å¤šä¸ªæ¨¡å—èƒ½å¤Ÿå¯¹åŒä¸€ä¸ª action æˆ– mutation ä½œå‡ºå“åº”ã€‚Getter åŒæ ·ä¹Ÿé»˜è®¤æ³¨å†Œåœ¨å…¨å±€å‘½åç©ºé—´ï¼Œä½†æ˜¯ç›®å‰è¿™å¹¶éå‡ºäºåŠŸèƒ½ä¸Šçš„ç›®çš„ï¼ˆä»…ä»…æ˜¯ç»´æŒç°çŠ¶æ¥é¿å…éå…¼å®¹æ€§å˜æ›´ï¼‰ã€‚å¿…é¡»æ³¨æ„ï¼Œä¸è¦åœ¨ä¸åŒçš„ã€æ— å‘½åç©ºé—´çš„æ¨¡å—ä¸­å®šä¹‰ä¸¤ä¸ªä¸åŒçš„ getter ä»è€Œå¯¼è‡´é”™è¯¯ã€‚</p><p>å¦‚æœå¸Œæœ›ä½ çš„æ¨¡å—å…·æœ‰æ›´é«˜çš„å°è£…åº¦å’Œå¤ç”¨æ€§ï¼Œä½ å¯ä»¥é€šè¿‡æ·»åŠ  namespaced: true çš„æ–¹å¼ä½¿å…¶æˆä¸ºå¸¦å‘½åç©ºé—´çš„æ¨¡å—ã€‚å½“æ¨¡å—è¢«æ³¨å†Œåï¼Œå®ƒçš„æ‰€æœ‰ getterã€action åŠ mutation éƒ½ä¼šè‡ªåŠ¨æ ¹æ®æ¨¡å—æ³¨å†Œçš„è·¯å¾„è°ƒæ•´å‘½åã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> store = <span class="title function_">createStore</span>(&#123;</span><br><span class="line">  <span class="attr">modules</span>: &#123;</span><br><span class="line">    <span class="attr">account</span>: &#123;</span><br><span class="line">      <span class="attr">namespaced</span>: <span class="literal">true</span>,</span><br><span class="line"></span><br><span class="line">      <span class="comment">// æ¨¡å—å†…å®¹ï¼ˆmodule assetsï¼‰</span></span><br><span class="line">      <span class="attr">state</span>: <span class="function">() =&gt;</span> (&#123; ... &#125;), <span class="comment">// æ¨¡å—å†…çš„çŠ¶æ€å·²ç»æ˜¯åµŒå¥—çš„äº†ï¼Œä½¿ç”¨ `namespaced` å±æ€§ä¸ä¼šå¯¹å…¶äº§ç”Ÿå½±å“</span></span><br><span class="line">      <span class="attr">getters</span>: &#123;</span><br><span class="line">        <span class="title function_">isAdmin</span> () &#123; ... &#125; <span class="comment">// -&gt; getters[&#x27;account/isAdmin&#x27;]</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">actions</span>: &#123;</span><br><span class="line">        <span class="title function_">login</span> () &#123; ... &#125; <span class="comment">// -&gt; dispatch(&#x27;account/login&#x27;)</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">mutations</span>: &#123;</span><br><span class="line">        <span class="title function_">login</span> () &#123; ... &#125; <span class="comment">// -&gt; commit(&#x27;account/login&#x27;)</span></span><br><span class="line">      &#125;,</span><br><span class="line"></span><br><span class="line">      <span class="comment">// åµŒå¥—æ¨¡å—</span></span><br><span class="line">      <span class="attr">modules</span>: &#123;</span><br><span class="line">        <span class="comment">// ç»§æ‰¿çˆ¶æ¨¡å—çš„å‘½åç©ºé—´</span></span><br><span class="line">        <span class="attr">myPage</span>: &#123;</span><br><span class="line">          <span class="attr">state</span>: <span class="function">() =&gt;</span> (&#123; ... &#125;),</span><br><span class="line">          <span class="attr">getters</span>: &#123;</span><br><span class="line">            <span class="title function_">profile</span> () &#123; ... &#125; <span class="comment">// -&gt; getters[&#x27;account/profile&#x27;]</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è¿›ä¸€æ­¥åµŒå¥—å‘½åç©ºé—´</span></span><br><span class="line">        <span class="attr">posts</span>: &#123;</span><br><span class="line">          <span class="attr">namespaced</span>: <span class="literal">true</span>,</span><br><span class="line"></span><br><span class="line">          <span class="attr">state</span>: <span class="function">() =&gt;</span> (&#123; ... &#125;),</span><br><span class="line">          <span class="attr">getters</span>: &#123;</span><br><span class="line">            <span class="title function_">popular</span> () &#123; ... &#125; <span class="comment">// -&gt; getters[&#x27;account/posts/popular&#x27;]</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>å¯ç”¨äº†å‘½åç©ºé—´çš„ getter å’Œ action ä¼šæ”¶åˆ°å±€éƒ¨åŒ–çš„ getterï¼Œdispatch å’Œ commitã€‚æ¢è¨€ä¹‹ï¼Œä½ åœ¨ä½¿ç”¨æ¨¡å—å†…å®¹ï¼ˆmodule assetsï¼‰æ—¶ä¸éœ€è¦åœ¨åŒä¸€æ¨¡å—å†…é¢å¤–æ·»åŠ ç©ºé—´åå‰ç¼€ã€‚æ›´æ”¹ namespaced å±æ€§åä¸éœ€è¦ä¿®æ”¹æ¨¡å—å†…çš„ä»£ç ã€‚</p><h2 id="4-é…åˆ-TypeScript"><a href="#4-é…åˆ-TypeScript" class="headerlink" title="4. é…åˆ TypeScript"></a>4. é…åˆ TypeScript</h2><p>Vuex4 ä½¿ç”¨ TypeScript è¿˜æ˜¯æœ‰ä¸€å®šçš„éº»çƒ¦ï¼ŒVue æä¾›äº†ä¸€ä¸ª InjectionKey æ¥å£ï¼Œè¯¥æ¥å£æ˜¯æ‰©å±• Symbol çš„æ³›å‹ç±»å‹ã€‚å®ƒå¯ç”¨äºåœ¨æä¾›è€…å’Œæ¶ˆè´¹è€…ä¹‹é—´åŒæ­¥ inject å€¼çš„ç±»å‹ã€‚</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createStore, <span class="title class_">Store</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">InjectionKey</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Menu</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./settings&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">Menu</span> &#123;</span><br><span class="line">    <span class="attr">icon</span>?: <span class="built_in">string</span>;</span><br><span class="line">    <span class="attr">text</span>: <span class="built_in">string</span>;</span><br><span class="line">    <span class="attr">url</span>: <span class="built_in">string</span>;</span><br><span class="line">    <span class="attr">id</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">MenuState</span> &#123;</span><br><span class="line">  <span class="attr">menus</span>: <span class="title class_">Menu</span>[];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">MenuKey</span>: <span class="title class_">InjectionKey</span>&lt;<span class="title class_">Store</span>&lt;<span class="title class_">MenuState</span>&gt;&gt; = <span class="title class_">Symbol</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> menuStore = createStore&lt;<span class="title class_">MenuState</span>&gt;(&#123;</span><br><span class="line">  <span class="attr">state</span>: &#123;</span><br><span class="line">    <span class="attr">menus</span>: []</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">mutations</span>: &#123;</span><br><span class="line">    <span class="title function_">add</span>(<span class="params"><span class="attr">state</span>: <span class="title class_">MenuState</span>, <span class="attr">menu</span>: <span class="title class_">Menu</span></span>) &#123;</span><br><span class="line">      state.<span class="property">menus</span>.<span class="title function_">push</span>(menu);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">actions</span>: &#123;</span><br><span class="line">    <span class="title function_">add</span>(<span class="params">context, <span class="attr">menu</span>: <span class="title class_">Menu</span></span>) &#123;</span><br><span class="line">      context.<span class="title function_">commit</span>(<span class="string">&#x27;add&#x27;</span>, menu);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">getters</span>: &#123;</span><br><span class="line">    <span class="title function_">menus</span>(<span class="params">state</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> state.<span class="property">menus</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123; <span class="title class_">Menu</span>, <span class="title class_">MenuKey</span>, menuStore &#125;;</span><br></pre></td></tr></table></figure><p>åœ¨ main.ts ä¸­æ³¨å…¥ä¾èµ–ï¼š</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">MenuKey</span>, menuStore &#125; <span class="keyword">from</span> <span class="string">&#x27;./store&#x27;</span></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(menuStore, <span class="title class_">MenuKey</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
          <category> Vue </category>
          
          <category> Vuex </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CSSæµ®åŠ¨ç¬”è®°</title>
      <link href="/2021/08/07/CSS%E6%B5%AE%E5%8A%A8%E7%AC%94%E8%AE%B0/"/>
      <url>/2021/08/07/CSS%E6%B5%AE%E5%8A%A8%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h2 id="DOMæ–‡æ¡£æ’ç‰ˆçš„ç‰¹ç‚¹"><a href="#DOMæ–‡æ¡£æ’ç‰ˆçš„ç‰¹ç‚¹" class="headerlink" title="DOMæ–‡æ¡£æ’ç‰ˆçš„ç‰¹ç‚¹"></a>DOMæ–‡æ¡£æ’ç‰ˆçš„ç‰¹ç‚¹</h2><p>å—çº§å…ƒç´ åªèƒ½å‚ç›´æ’ç‰ˆï¼Œè¡Œå†…å…ƒç´ åªèƒ½æ°´å¹³æ’ç‰ˆã€‚</p><p>å—çº§å…ƒç´ å¯ä»¥è®¾ç½®å®½é«˜å±æ€§ï¼Œè¡Œå†…å…ƒç´ æ²¡æœ‰å®½é«˜å±æ€§ï¼Œåªèƒ½è¢«å†…éƒ¨å…ƒç´ æ’‘èµ·æ¥ï¼Œæ°´å¹³æ”¾ç½®ä¸ä¸‹æ—¶ä¼šæ¢è¡Œç»§ç»­æ’ç‰ˆã€‚</p><h2 id="CSS-æµ®åŠ¨"><a href="#CSS-æµ®åŠ¨" class="headerlink" title="CSS æµ®åŠ¨"></a>CSS æµ®åŠ¨</h2><p>æµ®åŠ¨å°±æ˜¯è®©æ–‡æ¡£è„±ç¦»æ–‡æ¡£æµï¼Œåœ¨çˆ¶å…ƒç´ å†…éƒ¨å¯ä»¥ç§»åŠ¨åˆ°æŒ‡å®šä½ç½®ã€‚</p><p>æµ®åŠ¨çš„å…ƒç´ å¯ä»¥è®¾ç½®å®½é«˜ï¼Œåƒå—çº§å…ƒç´ ä¸€æ ·ï¼Œåˆå‘è¡Œå†…å…ƒç´ ä¸€æ ·å¯ä»¥æ°´å¹³æ’ç‰ˆã€‚</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>å…ƒç´ çš„æµ®åŠ¨<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="comment">/*å®šä¹‰çˆ¶å…ƒç´ çš„æ ·å¼*/</span></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.father</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#ccc</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border</span>: <span class="number">1px</span> dashed <span class="number">#999</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="comment">/*å®šä¹‰ box01ã€ box02ã€ box03 ä¸‰ä¸ªç›’å­çš„æ ·å¼*/</span></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.box01</span>, <span class="selector-class">.box02</span>, <span class="selector-class">.box03</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">height</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">width</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#FF9</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#F33</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">margin</span>: <span class="number">15px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: <span class="number">0px</span> <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="comment">/*å®šä¹‰æ®µè½æ–‡æœ¬çš„æ ·å¼*/</span></span></span><br><span class="line"><span class="language-css"><span class="selector-tag">p</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#FCF</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border</span>: <span class="number">1px</span> dashed <span class="number">#F33</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: <span class="number">0px</span> <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.box01</span>, <span class="selector-class">.box02</span>, <span class="selector-class">.box03</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">float</span>: left;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;father&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box01&quot;</span>&gt;</span>box01<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box02&quot;</span>&gt;</span>box02<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box03&quot;</span>&gt;</span>box03<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>12<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--ä¸å®šä¹‰floatå±æ€§ï¼Œfloatå±æ€§å€¼éƒ½ä¸ºå…¶é»˜è®¤å€¼ none--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><center><img src="/2021/08/07/CSS%E6%B5%AE%E5%8A%A8%E7%AC%94%E8%AE%B0/%E5%85%83%E7%B4%A0%E7%9A%84%E6%B5%AE%E5%8A%A8.png" class="" title="å…ƒç´ çš„æµ®åŠ¨"></center><p>è¿è¡Œåï¼Œbox01ã€box02ã€box03 åŠæ®µè½æ–‡æœ¬ä»ä¸Šåˆ°ä¸‹ä¸€ä¸€ç½—åˆ—ã€‚ å¯è§å¦‚æœä¸å¯¹å…ƒç´ è®¾ç½®æµ®åŠ¨ï¼Œåˆ™è¯¥å…ƒç´ åŠå…¶å†…éƒ¨çš„å­å…ƒç´ å°†æŒ‰ç…§æ ‡å‡†æ–‡æ¡£æµçš„æ ·å¼æ˜¾ç¤ºï¼Œå³å—å…ƒç´ å æ®é¡µé¢æ•´è¡Œã€‚</p><p>æ¥ä¸‹æ¥ä»¥ box01 ä¸ºè®¾ç½®å¯¹è±¡ï¼Œå¯¹å…¶åº”ç”¨å·¦æµ®åŠ¨æ ·å¼ï¼Œåœ¨ head çš„ style æ ‡ç­¾ä¸‹æ·»åŠ æ–°çš„ style æ ‡ç­¾ï¼Œå…·ä½“CSSä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.box01</span> &#123;</span><br><span class="line">    <span class="attribute">float</span>: left;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ° box01 å·²ç»è„±ç¦»äº†æ–‡æ¡£æµï¼Œæ¥ä¸‹æ¥ä¸º box02 å’Œ box03 è®¾ç½®å·¦æµ®åŠ¨ï¼š</p><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.box02</span> &#123;</span><br><span class="line">    <span class="attribute">float</span>: left;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.box03</span> &#123;</span><br><span class="line">    <span class="attribute">float</span>: left;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><center><img src="/2021/08/07/CSS%E6%B5%AE%E5%8A%A8%E7%AC%94%E8%AE%B0/%E5%85%83%E7%B4%A0%E7%9A%84%E6%B5%AE%E5%8A%A8_1.png" class="" title="å…ƒç´ çš„æµ®åŠ¨"></center><p>ä¸Šè¿°ä»£ç è¿è¡Œåï¼Œbox01ã€ box02ã€ box03 ä¸‰ä¸ªç›’å­æ’åˆ—åœ¨åŒä¸€è¡Œï¼ŒåŒæ—¶ï¼Œå‘¨å›´çš„æ®µè½æ–‡æœ¬å°†ç¯ç»•ç›’å­ï¼Œå‡ºç°äº†å›¾æ–‡æ··æ’çš„ç½‘é¡µæ•ˆæœã€‚</p><h3 id="CSS-æµ®åŠ¨æ¸…é™¤"><a href="#CSS-æµ®åŠ¨æ¸…é™¤" class="headerlink" title="CSS æµ®åŠ¨æ¸…é™¤"></a>CSS æµ®åŠ¨æ¸…é™¤</h3><p>ç”±äºæµ®åŠ¨å…ƒç´ ä¸å ç”¨åŸæ–‡æ¡£æµçš„ä½ç½®ï¼Œä½¿ç”¨æµ®åŠ¨æ—¶ä¼šå½±å“åé¢ç›¸é‚»çš„å›ºå®šå…ƒç´ ã€‚</p><p>CSS æä¾›äº† clear å±æ€§ï¼Œå¯ä»¥æ¸…é™¤æ‰æµ®åŠ¨å…ƒç´ ã€‚</p><p><code>clear</code> æœ‰ä¸‰ä¸ªå±æ€§å€¼ï¼š</p><p><code>left</code> ï¼šä¸å…è®¸å·¦ä¾§æœ‰æµ®åŠ¨å…ƒç´ (æ¸…é™¤å·¦ä¾§æµ®åŠ¨çš„å½±å“)</p><p><code>right</code> ï¼šä¸å…è®¸å³ä¾§æœ‰æµ®åŠ¨å…ƒç´ (æ¸…é™¤å³ä¾§æµ®åŠ¨çš„å½±å“)</p><p><code>both</code> ï¼šåŒæ—¶æ¸…é™¤å·¦å³ä¸¤ä¾§æµ®åŠ¨çš„å½±å“</p><p>æµ®åŠ¨æ¸…é™¤å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œæµ®åŠ¨æ¸…é™¤æœ¬è´¨ä¸Šå¤„ç†çš„æ˜¯å·¦å³å…ƒç´ ï¼Œå¦‚æœçˆ¶å…ƒç´ å†…æ‰€æœ‰çš„å…ƒç´ éƒ½æµ®åŠ¨äº†ï¼Œæ­¤æ—¶å› ä¸ºæ–‡æ¡£æµä¸­æ²¡æœ‰å…¶ä»–å…ƒç´ å¯ä»¥åœ¨å†…éƒ¨æ’‘èµ·çˆ¶å…ƒç´ çš„é«˜åº¦ï¼Œçˆ¶å…ƒç´ æ­¤æ—¶ä¼šåç¼©ä¸º 0 é«˜åº¦ã€‚</p><h4 id="æ–¹æ³•ä¸€ï¼šä½¿ç”¨ç©ºæ ‡è®°æ¸…é™¤æµ®åŠ¨"><a href="#æ–¹æ³•ä¸€ï¼šä½¿ç”¨ç©ºæ ‡è®°æ¸…é™¤æµ®åŠ¨" class="headerlink" title="æ–¹æ³•ä¸€ï¼šä½¿ç”¨ç©ºæ ‡è®°æ¸…é™¤æµ®åŠ¨"></a><strong>æ–¹æ³•ä¸€</strong>ï¼šä½¿ç”¨ç©ºæ ‡è®°æ¸…é™¤æµ®åŠ¨</h4><p>åœ¨æµ®åŠ¨å…ƒç´ ä¹‹åæ·»åŠ ç©ºæ ‡è®°ï¼Œå¹¶å¯¹è¯¥æ ‡è®°åº”ç”¨  <code>clear:both</code> æ ·å¼ï¼Œå¯æ¸…é™¤å…ƒç´ æµ®åŠ¨æ‰€äº§ç”Ÿçš„å½±å“ï¼Œè¿™ä¸ªç©ºæ ‡è®°å¯ä»¥ä¸º <code>&lt;div&gt;</code> ã€ <code>&lt;p&gt;</code> ã€ <code>&lt;hr /&gt;</code> ç­‰ä»»ä½•æ ‡è®°ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸Šè¿°æ–¹æ³•è™½ç„¶å¯ä»¥æ¸…é™¤æµ®åŠ¨ï¼Œ ä½†æ˜¯åœ¨æ— å½¢ä¸­å¢åŠ äº†æ¯«æ— æ„ä¹‰çš„ç»“æ„å…ƒç´ (ç©ºæ ‡è®°)ï¼Œå› æ­¤åœ¨å®é™…å·¥ä½œä¸­ä¸å»ºè®®ä½¿ç”¨ã€‚</p><p>(ç©ºæ ‡è®°)å› æ­¤åœ¨å®é™…å·¥ä½œä¸­ä¸å»ºè®®ä½¿ç”¨ã€‚</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>ç©ºæ ‡è®°æ¸…é™¤æµ®åŠ¨<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="comment">/*æ²¡æœ‰ç»™çˆ¶å…ƒç´ å®šä¹‰é«˜åº¦*/</span></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.father</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#ccc</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border</span>: lpx dashed <span class="number">#999</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="comment">/*å®šä¹‰box01ã€box02ã€box03ä¸‰ä¸ªç›’å­å·¦æµ®åŠ¨*/</span></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.box01</span>, <span class="selector-class">.box02</span>, <span class="selector-class">.box03</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">height</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">line-height</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#f9c</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border</span>:<span class="number">1px</span> dashed <span class="number">999</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">margin</span>: <span class="number">15px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: <span class="number">0px</span> <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">float</span>: left;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="comment">/*å¯¹ç©ºæ ‡è®°åº”ç”¨clear:both;*/</span></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.box04</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">clear</span>: both;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;father&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box01&quot;</span>&gt;</span>box01<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box02&quot;</span>&gt;</span>box02<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box03&quot;</span>&gt;</span>box03<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box04&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--åœ¨æµ®åŠ¨å…ƒç´ åæ·»åŠ ç©ºæ ‡è®°--&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><center><img src="/2021/08/07/CSS%E6%B5%AE%E5%8A%A8%E7%AC%94%E8%AE%B0/%E7%A9%BA%E6%A0%87%E8%AE%B0%E6%B8%85%E9%99%A4%E6%B5%AE%E5%8A%A8.png" class="" title="ç©ºæ ‡è®°æ¸…é™¤æµ®åŠ¨"></center><h4 id="æ–¹æ³•äºŒï¼šä½¿ç”¨-overflow-å±æ€§æ¸…é™¤æµ®åŠ¨"><a href="#æ–¹æ³•äºŒï¼šä½¿ç”¨-overflow-å±æ€§æ¸…é™¤æµ®åŠ¨" class="headerlink" title="æ–¹æ³•äºŒï¼šä½¿ç”¨ overflow å±æ€§æ¸…é™¤æµ®åŠ¨"></a><strong>æ–¹æ³•äºŒ</strong>ï¼šä½¿ç”¨ overflow å±æ€§æ¸…é™¤æµ®åŠ¨</h4><p>å¯¹å…ƒç´ åº”ç”¨ <code>overflow: hidden;</code> ä¹Ÿå¯ä»¥æ¸…é™¤æµ®åŠ¨å¯¹è¯¥å…ƒç´ çš„å½±å“ï¼Œè¯¥æ–¹æ³•å¼¥è¡¥äº†ç©ºæ ‡è®°æ¸…é™¤æµ®åŠ¨çš„ä¸è¶³ã€‚</p><p>å¯¹çˆ¶å…ƒç´ åº”ç”¨ <code>overflow: hidden;</code> æ ·å¼æ¥æ¸…é™¤å­å…ƒç´ æµ®åŠ¨å¯¹çˆ¶å…ƒç´ çš„å½±å“ã€‚</p><p>çˆ¶å…ƒç´ åˆè¢«å…¶å­å…ƒç´ æ’‘å¼€äº†ï¼Œå³å­å…ƒç´ æµ®åŠ¨å¯¹çˆ¶å…ƒç´ çš„å½±å“å·²ç»ä¸å­˜åœ¨ã€‚</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>overflowå±æ€§æ¸…é™¤æµ®åŠ¨<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="comment">/*æ²¡æœ‰ç»™çˆ¶å…ƒç´ å®šä¹‰é«˜åº¦*/</span></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.father</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#ccc</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border</span>: <span class="number">1px</span> dashed <span class="number">#999</span>;</span></span><br><span class="line"><span class="language-css">    <span class="comment">/*å¯¹çˆ¶å…ƒç´ åº”ç”¨overflow:hidden;*/</span></span></span><br><span class="line"><span class="language-css">    <span class="attribute">overflow</span>: hidden;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="comment">/*å®šä¹‰box01ã€box02ã€box03ä¸‰ä¸ªç›’å­å·¦æµ®åŠ¨*/</span></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.box01</span>, <span class="selector-class">.box02</span>, <span class="selector-class">.box03</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">height</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">line-height</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#f9c</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border</span>: <span class="number">1px</span> dashed <span class="number">#999</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">margin</span>: <span class="number">15px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: <span class="number">0px</span> <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">float</span>: left;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;father&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box01&quot;</span>&gt;</span>box01<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box02&quot;</span>&gt;</span>box02<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box03&quot;</span>&gt;</span>box03<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><center><img src="/2021/08/07/CSS%E6%B5%AE%E5%8A%A8%E7%AC%94%E8%AE%B0/%E7%A9%BA%E6%A0%87%E8%AE%B0%E6%B8%85%E9%99%A4%E6%B5%AE%E5%8A%A8.png" class="" title="overflow æ¸…é™¤æµ®åŠ¨"></center><h4 id="æ–¹æ³•ä¸‰-ä½¿ç”¨-after-ä¼ªå¯¹è±¡æ¸…é™¤æµ®åŠ¨"><a href="#æ–¹æ³•ä¸‰-ä½¿ç”¨-after-ä¼ªå¯¹è±¡æ¸…é™¤æµ®åŠ¨" class="headerlink" title="æ–¹æ³•ä¸‰: ä½¿ç”¨ after ä¼ªå¯¹è±¡æ¸…é™¤æµ®åŠ¨"></a><strong>æ–¹æ³•ä¸‰</strong>: ä½¿ç”¨ after ä¼ªå¯¹è±¡æ¸…é™¤æµ®åŠ¨</h4><p>ä½¿ç”¨ <code>after</code> ä¼ªå¯¹è±¡ä¹Ÿå¯ä»¥æ¸…é™¤æµ®åŠ¨ï¼Œä½†æ˜¯è¯¥æ–¹æ³•åªé€‚ç”¨äº IE8 åŠä»¥ä¸Šç‰ˆæœ¬æµè§ˆå™¨å’Œå…¶ä»–é IE æµè§ˆå™¨ã€‚</p><p>å¦å¤–ï¼Œä½¿ç”¨ <code>after</code> ä¼ªå¯¹è±¡æ¸…é™¤æµ®åŠ¨æ—¶éœ€è¦æ³¨æ„ï¼š</p><p>(1) å¿…é¡»ä¸ºéœ€è¦æ¸…é™¤æµ®åŠ¨çš„å…ƒç´ ä¼ªå¯¹è±¡è®¾ç½® <code>height: ();</code> æ ·å¼ï¼Œå¦åˆ™è¯¥å…ƒç´ ä¼šæ¯”å…¶å®é™…é«˜åº¦é«˜å‡ºè‹¥å¹²åƒç´ ã€‚</p><p>(2) å¿…é¡»åœ¨ä¼ªå¯¹è±¡ä¸­è®¾ç½® <code>content</code> å±æ€§ï¼Œå±æ€§å€¼å¯ä»¥ä¸ºç©ºï¼Œå¦‚ <code>contentï¼š&quot; &quot;;</code> ã€‚</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>ä½¿ç”¨afterä¼ªå¯¹è±¡æ¸…é™¤æµ®åŠ¨<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="comment">/*æ²¡æœ‰ç»™çˆ¶å…ƒç´ å®šä¹‰é«˜åº¦*/</span></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.father</span> &#123;</span></span><br><span class="line"><span class="language-css"><span class="attribute">background</span>: <span class="number">#ccc</span>;</span></span><br><span class="line"><span class="language-css"><span class="attribute">border</span>: <span class="number">1px</span> dashed <span class="number">#999</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="comment">/*å¯¹çˆ¶å…ƒç´ åº”ç”¨afterä¼ªå¯¹è±¡æ ·å¼*/</span></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.father</span><span class="selector-pseudo">:after</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: block;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">clear</span>: both;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">content</span>:<span class="string">&quot; &quot;</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">visibility</span>: hidden;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">height</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="comment">/*å®šä¹‰box01ã€box02ã€box03ä¸‰ä¸ªç›’å­å·¦æµ®åŠ¨*/</span></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.box01</span>, <span class="selector-class">.box02</span>, <span class="selector-class">.box03</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">height</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">line-height</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#f9c</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border</span>: <span class="number">1px</span> dashed <span class="number">#999</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">margin</span>: <span class="number">15px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: <span class="number">0px</span> <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">float</span>: left;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;father&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box01&quot;</span>&gt;</span>box01<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box02&quot;</span>&gt;</span>box02<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box03&quot;</span>&gt;</span>box03<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><center><img src="/2021/08/07/CSS%E6%B5%AE%E5%8A%A8%E7%AC%94%E8%AE%B0/%E7%A9%BA%E6%A0%87%E8%AE%B0%E6%B8%85%E9%99%A4%E6%B5%AE%E5%8A%A8.png" class="" title="ä½¿ç”¨afterä¼ªå¯¹è±¡æ¸…é™¤æµ®åŠ¨"></center>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScriptä»»åŠ¡æ‰§è¡Œç¬”è®°</title>
      <link href="/2021/08/07/JavaScript%E4%BB%BB%E5%8A%A1%E6%89%A7%E8%A1%8C%E7%AC%94%E8%AE%B0/"/>
      <url>/2021/08/07/JavaScript%E4%BB%BB%E5%8A%A1%E6%89%A7%E8%A1%8C%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<p>æµè§ˆå™¨ä¸­çš„ JavaScript çš„æ‰§è¡Œæµç¨‹å’Œ Node.js ä¸­çš„æ‰§è¡Œæµç¨‹éƒ½æ˜¯åŸºäº <strong>äº‹ä»¶å¾ªç¯</strong> çš„</p><h2 id="äº‹ä»¶å¾ªç¯"><a href="#äº‹ä»¶å¾ªç¯" class="headerlink" title="äº‹ä»¶å¾ªç¯"></a>äº‹ä»¶å¾ªç¯</h2><p><strong>äº‹ä»¶å¾ªç¯</strong> çš„æ¦‚å¿µéå¸¸ç®€å•ï¼Œäº‹ä»¶å°±æ˜¯ä¸€ä¸ªåŠ¨ä½œï¼Œç•Œé¢ç‚¹å‡»ä¼šè§¦å‘ä¸€ä¸ªåŠ¨ä½œï¼Œç”Ÿæˆç‚¹å‡»äº‹ä»¶ï¼Œget è¯·æ±‚ä¼šè§¦å‘ä¸€ä¸ªåŠ¨ä½œï¼Œä¹Ÿä¼šäº§ç”Ÿäº‹ä»¶ã€‚</p><p>äº‹ä»¶å¾ªç¯å°±æ˜¯æä¾›ä¸€ä¸ªå…ˆå…¥å…ˆå‡ºçš„é˜Ÿåˆ—ï¼Œäº‹ä»¶äº§ç”ŸååŠ å…¥åˆ°äº‹ä»¶é˜Ÿåˆ—ä¸­ï¼Œå½“é˜Ÿåˆ—å¤´çš„äº‹ä»¶è¢«å¤„ç†å®Œä»¥åï¼Œå¼¹å‡ºå¤´éƒ¨çš„äº‹ä»¶ï¼Œæ‰§è¡Œä¸‹ä¸€ä¸ªäº‹ä»¶ï¼Œä¸æ–­å¾ªç¯ã€‚</p><p>åœ¨ä¸Šè¿°æ¨¡å‹ä¸­ï¼Œå¯ä»¥çœ‹å‡ºäº‹ä»¶å¾ªç¯æ˜¯åœ¨å•ä¸€çº¿ç¨‹ä¸­æ‰§è¡Œçš„ï¼Œé‚£ä¹ˆå¦‚æœæ­¤æ—¶æœ‰ IO ä»»åŠ¡ï¼Œçº¿ç¨‹å²‚ä¸æ˜¯ä¼šé˜»å¡ï¼Œåœ¨ç•Œé¢ä¸Šçš„ä½“ç°å°±æ˜¯å¡æ­»ã€æ— æ³•å“åº”ã€‚</p><p>äº¦æˆ–è€…æœ‰äº›ä»£ç æ‰§è¡Œäº†å¤§é‡è®¡ç®—ï¼Œæ¯”æ–¹è¯´åœ¨å‰ç«¯æš´åŠ›ç ´è§£å¯†ç ä¹‹ç±»çš„é¬¼æ“ä½œï¼Œè¿™å°±ä¼šå¯¼è‡´åç»­ä»£ç ä¸€ç›´åœ¨ç­‰å¾…ï¼Œé¡µé¢å¤„äºå‡æ­»çŠ¶æ€ï¼Œå› ä¸ºå‰è¾¹çš„ä»£ç å¹¶æ²¡æœ‰æ‰§è¡Œå®Œã€‚</p><p>æ‰€ä»¥å¦‚æœå…¨éƒ¨ä»£ç éƒ½æ˜¯åŒæ­¥æ‰§è¡Œçš„ï¼Œè¿™ä¼šå¼•å‘å¾ˆä¸¥é‡çš„é—®é¢˜ï¼Œæ¯”æ–¹è¯´æˆ‘ä»¬è¦ä»è¿œç«¯è·å–ä¸€äº›æ•°æ®ï¼Œéš¾é“è¦ä¸€ç›´å¾ªç¯ä»£ç å»åˆ¤æ–­æ˜¯å¦æ‹¿åˆ°äº†è¿”å›ç»“æœä¹ˆï¼Ÿ</p><p>äºæ˜¯æœ‰äº†å¼‚æ­¥äº‹ä»¶çš„æ¦‚å¿µï¼Œæ³¨å†Œä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œæ¯”å¦‚è¯´å‘ä¸€ä¸ªç½‘ç»œè¯·æ±‚ï¼Œæˆ‘ä»¬å‘Šè¯‰ä¸»ç¨‹åºç­‰åˆ°æ¥æ”¶åˆ°æ•°æ®åé€šçŸ¥æˆ‘ï¼Œç„¶åæˆ‘ä»¬å°±å¯ä»¥å»åšå…¶ä»–çš„äº‹æƒ…äº†ã€‚</p><p>ç„¶ååœ¨å¼‚æ­¥å®Œæˆåï¼Œä¼šé€šçŸ¥åˆ°æˆ‘ä»¬ï¼Œä½†æ˜¯æ­¤æ—¶å¯èƒ½ç¨‹åºæ­£åœ¨åšå…¶ä»–çš„äº‹æƒ…ï¼Œæ‰€ä»¥å³ä½¿å¼‚æ­¥å®Œæˆäº†ä¹Ÿéœ€è¦åœ¨ä¸€æ—ç­‰å¾…ï¼Œç­‰åˆ°ç¨‹åºç©ºé—²ä¸‹æ¥æ‰æœ‰æ—¶é—´å»çœ‹å“ªäº›å¼‚æ­¥å·²ç»å®Œæˆäº†ï¼Œå¯ä»¥å»æ‰§è¡Œã€‚</p><h2 id="å®ä»»åŠ¡å’Œå¾®ä»»åŠ¡"><a href="#å®ä»»åŠ¡å’Œå¾®ä»»åŠ¡" class="headerlink" title="å®ä»»åŠ¡å’Œå¾®ä»»åŠ¡"></a>å®ä»»åŠ¡å’Œå¾®ä»»åŠ¡</h2><p>ä¸ºä»€ä¹ˆè¦æœ‰å®ä»»åŠ¡å’Œå¾®ä»»åŠ¡çš„åŒºåˆ«ï¼Ÿ</p><p>è¿™é‡Œä¸¾ä¸€ä¸ªç»å¸¸çœ‹åˆ°çš„ä¾‹å­ï¼Œå‡å¦‚ A å»é“¶è¡ŒåŠç†ä¸šåŠ¡ï¼Œæ’äº†åŠå¤©é˜Ÿä¼ï¼Œç»ˆäºåˆ° Aäº†ï¼Œåœ¨ A çš„ä¸šåŠ¡åŠç†çš„è¿‡ç¨‹ä¸­ï¼ŒA æƒ³è¦é™¤äº†å­˜é’±ä»¥å¤–ï¼Œè¿˜æƒ³è¦ä¿®æ”¹é“¶è¡Œå¡å¯†ç ï¼Œå¯æ˜¯æ€»ä¸èƒ½è®© A é‡æ–°æ’é˜Ÿå§ï¼Œè¿™æ ·å¤ªæµªè´¹æ—¶é—´äº†ï¼Œæ‰€ä»¥ A å¯ä»¥åœ¨å½“å‰ä¸šåŠ¡åŠç†å®Œæˆåï¼Œç«‹å³æ‰§è¡Œä¿®æ”¹å¯†ç çš„æ“ä½œï¼Œè€Œä¸ç”¨é‡æ–°åˆ°é˜Ÿä¼é‡Œæ’é˜Ÿã€‚</p><p>A åŠç†ä¸šåŠ¡çš„è¿‡ç¨‹å°±æ˜¯å®ä»»åŠ¡ï¼Œè€Œåœ¨åŠç†ä¸šåŠ¡ä¸­äº§ç”Ÿçš„æ–°çš„ä¸šåŠ¡ï¼Œå°±æ˜¯å¾®ä»»åŠ¡ã€‚</p><p>åœ¨ JavaScript ä¸­ï¼Œå®ä»»åŠ¡æ˜¯æŒ‡æ™®é€šçš„ä»»åŠ¡ï¼Œä¾‹å¦‚æ¸²æŸ“ã€è¯·æ±‚ã€è„šæœ¬ã€å»¶æ—¶ã€ioç­‰ã€‚è€Œå¾®ä»»åŠ¡æ˜¯æŒ‡ promise å›è°ƒã€proxyã€ç›‘å¬DOMã€nextTickç­‰ã€‚</p><p>æ‰§è¡Œæµç¨‹æ˜¯å®ä»»åŠ¡é˜Ÿåˆ—åœ¨æ‰§è¡Œä¸€ä¸ªä»»åŠ¡æ—¶ï¼Œä»»åŠ¡å¯èƒ½ä¼šäº§ç”Ÿæ–°çš„ä»»åŠ¡ï¼Œæ–°çš„ä»»åŠ¡ä¼šæ ¹æ®ç±»å‹æ¥å†³å®šæ˜¯æ”¾ç½®åœ¨å®ä»»åŠ¡é˜Ÿåˆ—ï¼Œè¿˜æ˜¯å¼€è¾Ÿä¸€ä¸ªæ–°çš„ä»»åŠ¡é˜Ÿåˆ—ï¼Œåœ¨å½“å‰ä»»åŠ¡æ‰§è¡Œå®Œæ¯•åæ‰§è¡Œè¿™ä¸ªé˜Ÿåˆ—ã€‚</p><p>è¿™æ˜¯ä¸€ä¸ªæ‰§è¡Œè¿‡ç¨‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;setTimeout&#x27;</span>)</span><br><span class="line">    &#125;, <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span> (<span class="params">resolve</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;promise1&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span>( <span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">1000</span>; i++ ) &#123;</span><br><span class="line">            i === <span class="number">999</span> &amp;&amp; <span class="title function_">resolve</span>()</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;promise2&#x27;</span>)</span><br><span class="line">    &#125;).<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params"></span>)  &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;promise3&#x27;</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;script&#x27;</span>)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœï¼š <code>promise1</code> â†’ <code>promise2</code> â†’ <code>script</code> â†’ <code>promise3</code> â†’ <code>setTimeout</code></p><h2 id="async-await"><a href="#async-await" class="headerlink" title="async &#x2F; await"></a>async &#x2F; await</h2><p><code>async</code> &#x2F; <code>await</code> æ˜¯ ES7 å¼•å…¥çš„é‡å¤§æ”¹è¿›ï¼Œå®ƒæœ¬è´¨ä¸Šæ˜¯è¯­æ³•ç³–ï¼Œå¯ä»¥ä»¥åŒæ­¥çš„æ–¹å¼å†™å¼‚æ­¥ä»£ç ï¼Œä¸ä¼šäº§ç”Ÿå›è°ƒåœ°ç‹±ã€‚</p><p><code>async</code> ï¼šå¼‚æ­¥æ‰§è¡Œå’Œè¿”å› Promise</p><p><code>await</code> ï¼šè¿”å› Promise å¯¹è±¡</p><p>åœ¨æ²¡æœ‰ Promise ä¹‹å‰ï¼Œæˆ‘ä»¬å†™çš„å¼‚æ­¥ä»£ç å¿…é¡»ç”¨ setTimeout æ¥æ‰§è¡Œä¸€ä¸ªå¼‚æ­¥å‡½æ•°ï¼Œå¾ˆå®¹æ˜“å°±ä¼šäº§ç”Ÿå›è°ƒåœ°ç‹±ï¼ŒsetTimeout é‡ŒåµŒå¥— setTimeoutã€‚å½“ ES6 å¼•å…¥äº† Promiseï¼Œæˆ‘ä»¬ç»ˆäºæœ‰äº†ä¸“é—¨æ‰§è¡Œå¼‚æ­¥ä»£ç çš„ç»“æ„ï¼Œä½†æ˜¯ Promise ä»ç„¶ä¼šäº§ç”Ÿå›è°ƒåœ°ç‹±ï¼Œæ‰€ä»¥åœ¨ ES7ï¼Œå¼•å…¥äº† async &#x2F; await è¯­æ³•ç³–ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„å†™å‡ºåŒæ­¥æ–¹å¼çš„å¼‚æ­¥ä»£ç ã€‚</p><p><strong>çœ‹ä»£ç </strong></p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">do2</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">do1</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">let</span> a = <span class="keyword">await</span> <span class="title function_">do2</span>();</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">3</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">4</span>);</span><br><span class="line"><span class="title function_">do1</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">5</span>);</span><br></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœï¼š <code>4 1 5 2 3</code></p><p>åœ¨ä»£ç ä¸­å¯ä»¥çœ‹åˆ°ï¼Œå‡½æ•°å¢åŠ ä¸€ä¸ª async å…³é”®å­—ï¼Œasync çš„æ„æ€æ˜¯è¯¥å‡½æ•°ä¼šä»¥å¼‚æ­¥çš„æ–¹å¼æ‰§è¡Œï¼Œasync å‡½æ•°æ˜¯ AsyncFunction æ„é€ å‡½æ•°çš„å®ä¾‹ï¼Œå¹¶ä¸”å…¶ä¸­å…è®¸ä½¿ç”¨ await å…³é”®å­—ã€‚async å’Œ await å…³é”®å­—è®©æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ç§æ›´ç®€æ´çš„æ–¹å¼å†™å‡ºåŸºäº Promise çš„å¼‚æ­¥è¡Œä¸ºï¼Œè€Œæ— éœ€åˆ»æ„åœ°é“¾å¼è°ƒç”¨ Promise</p><p>async å‡½æ•°ä¸€å®šä¼šè¿”å›ä¸€ä¸ª Promise å¯¹è±¡ã€‚å¦‚æœä¸€ä¸ª async å‡½æ•°çš„è¿”å›å€¼çœ‹èµ·æ¥ä¸æ˜¯ Promiseï¼Œé‚£ä¹ˆå®ƒå°†ä¼šè¢«éšå¼åœ°åŒ…è£…åœ¨ä¸€ä¸ª Promise ä¸­ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Wayland åè®®ï¼ˆä¸­æ–‡ï¼‰â€”â€” ç¬¬ä¸‰ç« . Waylandçš„æ¶æ„</title>
      <link href="/2021/07/24/wayland-architecture/"/>
      <url>/2021/07/24/wayland-architecture/</url>
      
        <content type="html"><![CDATA[<h2 id="ç¬¬ä¸‰ç« -Wayland-ä½“ç³»ç»“æ„"><a href="#ç¬¬ä¸‰ç« -Wayland-ä½“ç³»ç»“æ„" class="headerlink" title="ç¬¬ä¸‰ç« . Wayland ä½“ç³»ç»“æ„"></a>ç¬¬ä¸‰ç« . Wayland ä½“ç³»ç»“æ„</h2><h3 id="X-å’Œ-Wayland-çš„ä½“ç³»ç»“æ„å¯¹æ¯”"><a href="#X-å’Œ-Wayland-çš„ä½“ç³»ç»“æ„å¯¹æ¯”" class="headerlink" title="X å’Œ Wayland çš„ä½“ç³»ç»“æ„å¯¹æ¯”"></a>X å’Œ Wayland çš„ä½“ç³»ç»“æ„å¯¹æ¯”</h3><p>äº†è§£ Wayland æ¶æ„ä»¥åŠå®ƒä¸ X æœ‰ä½•ä¸åŒçš„å¥½æ–¹æ³•æ˜¯å…³æ³¨ä»è¾“å…¥è®¾å¤‡åˆ°å®ƒå½±å“çš„æ›´æ”¹å‡ºç°åœ¨å±å¹•ä¸Šçš„äº‹ä»¶ã€‚</p><p>è¿™æ˜¯ X ç›®å‰çš„æƒ…å†µï¼š</p><p>å›¾ 3.1 X æ¶æ„å›¾</p><center><img src="/2021/07/24/wayland-architecture/x.png" class="" width=""></center><ol><li>å†…æ ¸ä»è¾“å…¥è®¾å¤‡è·å–äº‹ä»¶ï¼Œå¹¶é€šè¿‡ evdev è¾“å…¥é©±åŠ¨ç¨‹åºå°†å…¶å‘é€åˆ° Xã€‚å†…æ ¸é€šè¿‡é©±åŠ¨è®¾å¤‡å¹¶å°†ä¸åŒçš„è®¾å¤‡ç‰¹å®šäº‹ä»¶åè®®è½¬æ¢ä¸º linux evdev æ ‡å‡†è¾“å…¥äº‹ä»¶ï¼Œåœ¨è¿™é‡Œå®Œæˆæ‰€æœ‰è‰°è‹¦çš„å·¥ä½œã€‚</li><li>X æœåŠ¡å™¨ç¡®å®šäº‹ä»¶å½±å“å“ªä¸ªçª—å£ï¼Œå¹¶å°†å…¶å‘é€ç»™å·²é€‰æ‹©ç”¨äºè¯¥çª—å£ä¸Šæœ‰å…³äº‹ä»¶çš„å®¢æˆ·ç«¯ã€‚X æœåŠ¡å™¨å®é™…ä¸Šä¸çŸ¥é“å¦‚ä½•æ­£ç¡®åœ°åšåˆ°è¿™ä¸€ç‚¹ï¼Œå› ä¸ºå±å¹•ä¸Šçš„çª—å£ä½ç½®ç”±åˆæˆå™¨æ§åˆ¶ï¼Œå¹¶ä¸”å¯èƒ½ä¼šä»¥ X æœåŠ¡å™¨æ— æ³•ç†è§£çš„å¤šç§æ–¹å¼è¿›è¡Œè½¬æ¢ï¼ˆç¼©å°ã€æ—‹è½¬ã€æ‘†åŠ¨ç­‰ï¼‰ã€‚</li><li>å®¢æˆ·ç«¯æŸ¥çœ‹äº‹ä»¶å¹¶å†³å®šè¯¥æ€ä¹ˆåšã€‚é€šå¸¸ï¼ŒUI å¿…é¡»æ ¹æ®äº‹ä»¶è¿›è¡Œæ›´æ”¹ï¼Œä¹Ÿè®¸ç‚¹å‡»äº†å¤é€‰æ¡†æˆ–æ˜¾ç¤ºçš„æŒ‰é’®ã€‚å› æ­¤ï¼Œå®¢æˆ·ç«¯å°†æ¸²æŸ“è¯·æ±‚å‘é€å› X æœåŠ¡å™¨ã€‚</li><li>å½“ X æœåŠ¡å™¨æ”¶åˆ°æ¸²æŸ“è¯·æ±‚æ—¶ï¼Œå®ƒä¼šå°†å…¶å‘é€ç»™é©±åŠ¨ç¨‹åºï¼Œä»¥ä¾¿å¯¹ç¡¬ä»¶è¿›è¡Œç¼–ç¨‹ä»¥è¿›è¡Œæ¸²æŸ“ã€‚X æœåŠ¡å™¨è¿˜è®¡ç®—æ¸²æŸ“çš„è¾¹ç•ŒåŒºåŸŸï¼Œå¹¶å°†å…¶ä½œä¸ºæŸåäº‹ä»¶å‘é€ç»™åˆæˆå™¨ã€‚</li><li>æŸåäº‹ä»¶å‘Šè¯‰åˆæˆå™¨çª—å£ä¸­å‘ç”Ÿäº†å˜åŒ–ï¼Œå®ƒå¿…é¡»é‡æ–°åˆæˆçª—å£å¯è§çš„é‚£éƒ¨åˆ†å±å¹•ã€‚åˆæˆå™¨åŸºäºå®ƒçš„åœºæ™¯å’ŒXçª—å£çš„å†…å®¹è´Ÿè´£æ¸²æŸ“æ•´ä¸ªå±å¹•çš„å†…å®¹ã€‚ç„¶è€Œï¼Œå®ƒå¿…é¡»é€šè¿‡XæœåŠ¡å™¨æ¥æ˜¾ç¤ºå®ƒã€‚</li><li>X æœåŠ¡å™¨æ¥æ”¶æ¥è‡ªåˆæˆå™¨çš„æ¸²æŸ“è¯·æ±‚ï¼Œç„¶åå°†åˆæˆå™¨çš„åç¼“å†²åŒºå¤åˆ¶åˆ°å‰ç¼“å†²åŒºæˆ–è¿›è¡Œé¡µé¢ç¿»è½¬ã€‚åœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒX æœåŠ¡å™¨å¿…é¡»è¿›è¡Œæ­¤æ­¥éª¤ï¼Œä»¥ä¾¿å®ƒå¯ä»¥è§£é‡Šé‡å çš„çª—å£ï¼Œè¿™å¯èƒ½éœ€è¦å‰ªåˆ‡å¹¶ç¡®å®šæ˜¯å¦å¯ä»¥ç¿»é¡µã€‚ç„¶è€Œï¼Œå¯¹äºä¸€ä¸ªåˆæˆå™¨ï¼Œå®ƒæ€»æ˜¯å…¨å±ï¼Œè¿™æ˜¯å¦ä¸€ä¸ªä¸å¿…è¦çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚</li></ol><p>å¦‚ä¸Šæ‰€è¿°ï¼Œè¿™ç§æ–¹æ³•å­˜åœ¨ä¸€äº›é—®é¢˜ã€‚X æœåŠ¡å™¨æ²¡æœ‰ä¿¡æ¯æ¥å†³å®šå“ªä¸ªçª—å£åº”è¯¥æ¥æ”¶äº‹ä»¶ï¼Œä¹Ÿä¸èƒ½å°†å±å¹•åæ ‡è½¬æ¢ä¸ºçª—å£æœ¬åœ°åæ ‡ã€‚å°½ç®¡ X å·²å°†å±å¹•æœ€ç»ˆç»˜ç”»çš„è´£ä»»äº¤ç»™äº†åˆæˆå™¨ï¼Œä½† X ä»æ§åˆ¶ç€å‰ç¼“å†²å’Œæ¨¡å¼åŒ–ã€‚ç”¨äºå¤„ç†çš„ X æœåŠ¡å™¨çš„å¤§éƒ¨åˆ†å¤æ‚æ€§ç°åœ¨å¯åœ¨å†…æ ¸æˆ–è‡ªåŒ…å«åº“ä¸­æä¾›ï¼ˆKMSã€evdevã€mesaã€å­—ä½“é…ç½®ã€è‡ªç”±å‹ã€cairoã€Qt ç­‰ï¼‰ã€‚ä¸€èˆ¬æ¥è¯´ï¼ŒX æœåŠ¡å™¨ç°åœ¨åªæ˜¯ä¸€ä¸ªä¸­é—´äººï¼Œåœ¨åº”ç”¨ç¨‹åºå’Œåˆæˆå™¨ä¹‹é—´å¼•å…¥é¢å¤–çš„æ­¥éª¤ï¼Œåœ¨åˆæˆå™¨å’Œç¡¬ä»¶ä¹‹é—´å¼•å…¥é¢å¤–çš„æ­¥éª¤ã€‚</p><p>åœ¨ Wayland ï¼Œåˆæˆå™¨æ˜¯æ˜¾ç¤ºæœåŠ¡å™¨ã€‚æˆ‘ä»¬å°† KMS å’Œ evdev çš„æ§åˆ¶æƒç§»äº¤ç»™åˆæˆå™¨ã€‚Wayland åè®®å…è®¸åˆæˆå™¨å°†è¾“å…¥äº‹ä»¶ç›´æ¥å‘é€ç»™å®¢æˆ·ç«¯ï¼Œå¹¶å…è®¸å®¢æˆ·ç«¯å°†æŸåäº‹ä»¶ç›´æ¥å‘é€ç»™åˆæˆå™¨ï¼š</p><p>å›¾ 3.2 Wayland æ¶æ„å›¾</p><center><img src="/2021/07/24/wayland-architecture/wayland.png" class="" width=""></center><ol><li>å†…æ ¸è·å–äº‹ä»¶å¹¶å°†å…¶å‘é€ç»™åˆæˆå™¨ã€‚è¿™ä¸ X æ¡ˆä¾‹ç±»ä¼¼ï¼Œè¿™å¤ªæ£’äº†ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥é‡å¤ä½¿ç”¨å†…æ ¸ä¸­çš„æ‰€æœ‰è¾“å…¥é©±åŠ¨ç¨‹åºã€‚</li><li>åˆæˆå™¨æŸ¥çœ‹å…¶åœºæ™¯å›¾ï¼Œä»¥ç¡®å®šå“ªä¸ªçª—å£åº”è¯¥æ¥æ”¶è¯¥äº‹ä»¶ã€‚åœºæ™¯å›¾å¯¹åº”äºå±å¹•ä¸Šçš„å†…å®¹ï¼Œåˆæˆå™¨äº†è§£å®ƒå¯èƒ½åº”ç”¨äºåœºæ™¯å›¾ä¸­å…ƒç´ çš„è½¬æ¢ã€‚å› æ­¤ï¼Œåˆæˆå™¨å¯ä»¥é€šè¿‡åº”ç”¨åå‘è½¬æ¢æ¥é€‰æ‹©æ­£ç¡®çš„çª—å£å¹¶å°†å±å¹•åæ ‡è½¬æ¢ä¸ºçª—å£æœ¬åœ°åæ ‡ã€‚å¯åº”ç”¨äºçª—å£çš„è½¬æ¢ç±»å‹ä»…é™äºåˆæˆå™¨å¯ä»¥æ‰§è¡Œçš„è½¬æ¢ç±»å‹ï¼Œåªè¦å®ƒå¯ä»¥åå‘è½¬æ¢è®¡ç®—è¾“å…¥çš„äº‹ä»¶ã€‚</li><li>ä¸ X æ¡ˆä¾‹ä¸€æ ·ï¼Œå½“å®¢æˆ·ç«¯æ”¶åˆ°äº‹ä»¶æ—¶ï¼Œå®ƒä¼šæ ¹æ®å“åº”æ›´æ–° UIã€‚ä½†åœ¨ Wayland æ¡ˆä¾‹ä¸­ï¼Œæ¸²æŸ“å‘ç”Ÿåœ¨å®¢æˆ·ç«¯ä¸­ï¼Œå®¢æˆ·åªéœ€å‘æ’°å†™å•†å‘é€è¯·æ±‚ï¼Œä»¥æŒ‡ç¤ºå·²æ›´æ–°çš„åŒºåŸŸã€‚</li><li>åˆæˆå™¨ä»å®¢æˆ·ç«¯æ”¶é›†æŸåè¯·æ±‚ï¼Œç„¶åé‡æ–°ç»„åˆå±å¹•ã€‚ç„¶åï¼Œåˆæˆå™¨å¯ä»¥ç›´æ¥å‘å‡ºä¸€ä¸ª ioctl æ¥å®‰æ’ä¸ KMS çš„ç¿»é¡µã€‚</li></ol><h3 id="Wayland-æ¸²æŸ“"><a href="#Wayland-æ¸²æŸ“" class="headerlink" title="Wayland æ¸²æŸ“"></a>Wayland æ¸²æŸ“</h3><p>æˆ‘åœ¨ä¸Šé¢æ¦‚è¿°ä¸­é—æ¼çš„ä¸€ä¸ªç»†èŠ‚æ˜¯å®¢æˆ·åœ¨ Wayland ä¸‹çš„å®é™…æ¸²æŸ“æ–¹å¼ã€‚é€šè¿‡ä»å›¾ç‰‡ä¸­åˆ é™¤ X æœåŠ¡å™¨ï¼Œæˆ‘ä»¬è¿˜åˆ é™¤äº† X å®¢æˆ·ç«¯é€šå¸¸å‘ˆç°çš„æœºåˆ¶ã€‚ä½†è¿˜æœ‰å¦ä¸€ç§æœºåˆ¶ï¼Œæˆ‘ä»¬å·²ç»ä½¿ç”¨ä¸ DRI2 ä¸‹ Xï¼šç›´æ¥æ¸²æŸ“ã€‚é€šè¿‡ç›´æ¥æ¸²æŸ“ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å…±äº«è§†é¢‘å†…å­˜ç¼“å†²åŒºã€‚å®¢æˆ·ç«¯é“¾æ¥åˆ°æ¸²æŸ“åº“ï¼ˆå¦‚ OpenGLï¼‰ï¼Œè¯¥åº“çŸ¥é“å¦‚ä½•å¯¹ç¡¬ä»¶è¿›è¡Œç¼–ç¨‹å¹¶ç›´æ¥æ¸²æŸ“åˆ°ç¼“å†²åŒºã€‚åˆæˆå™¨åè¿‡æ¥å¯ä»¥å–ç¼“å†²å™¨ï¼Œå¹¶åœ¨å®ƒå¤åˆæ¡Œé¢æ—¶å°†å…¶ç”¨ä½œçº¹ç†ã€‚åˆå§‹è®¾ç½®åï¼Œå®¢æˆ·ç«¯åªéœ€è¦å‘Šè¯‰åˆæˆå™¨ä½¿ç”¨å“ªä¸ªç¼“å†²å™¨ï¼Œä»¥åŠå®ƒä½•æ—¶ä½•åœ°å‘å…¶ä¸­å‘ˆç°äº†æ–°å†…å®¹ã€‚</p><p>è¿™ç»™åº”ç”¨ç¨‹åºç•™ä¸‹äº†ä¸¤ç§æ›´æ–°çª—å£å†…å®¹çš„æ–¹æ³•ï¼š</p><ol><li>å°†æ–°å†…å®¹æ¸²æŸ“ä¸ºæ–°çš„ç¼“å†²åŒºï¼Œå¹¶å‘Šè¯‰åˆæˆå™¨ä½¿ç”¨è¯¥å†…å®¹è€Œä¸æ˜¯æ—§ç¼“å†²åŒºã€‚åº”ç”¨ç¨‹åºå¯ä»¥åœ¨æ¯æ¬¡éœ€è¦æ›´æ–°çª—å£å†…å®¹æ—¶åˆ†é…ä¸€ä¸ªæ–°çš„ç¼“å†²åŒºï¼Œæˆ–è€…å®ƒå¯ä»¥åœ¨å®ƒä»¬ä¹‹é—´ä¿æŒä¸¤ä¸ªï¼ˆæˆ–å¤šä¸ªï¼‰ç¼“å†²åŒºå¹¶å¾ªç¯ã€‚ç¼“å†²åŒºç®¡ç†å®Œå…¨å¤„äºåº”ç”¨æ§åˆ¶ä¹‹ä¸‹ã€‚</li><li>å°†æ–°å†…å®¹æ¸²æŸ“åˆ°ç¼“å†²åŒºä¸­ï¼Œè¯¥ç¼“å†²åŒºä»¥å‰æ›¾å‘Šè¯‰åˆæˆå™¨ä½¿ç”¨ã€‚è™½ç„¶å¯ä»¥ç›´æ¥æ¸²æŸ“åˆ°ä¸åˆæˆå™¨å…±äº«çš„ç¼“å†²åŒºä¸­ï¼Œä½†è¿™å¯èƒ½ä¼šä¸åˆæˆå™¨ç«äº‰ã€‚å¯èƒ½å‘ç”Ÿçš„æƒ…å†µæ˜¯ï¼Œé‡æ–°ç²‰åˆ·çª—å£å†…å®¹å¯èƒ½ä¼šè¢«é‡æ–°ç²‰åˆ·æ¡Œé¢çš„åˆæˆå™¨ä¸­æ–­ã€‚å¦‚æœåº”ç”¨ç¨‹åºåœ¨æ¸…é™¤çª—å£åè¢«ä¸­æ–­ï¼Œä½†åœ¨æ¸²æŸ“å†…å®¹ä¹‹å‰ï¼Œåˆæˆå™¨å°†ä»ç©ºç™½ç¼“å†²åŒºè¿›è¡Œçº¹ç†ã€‚ç»“æœæ˜¯åº”ç”¨çª—å£å°†åœ¨ç©ºç™½çª—å£æˆ–åŠæ¸²æŸ“å†…å®¹ä¹‹é—´é—ªçƒã€‚é¿å…è¿™ç§æƒ…å†µçš„ä¼ ç»Ÿæ–¹æ³•æ˜¯å°†æ–°å†…å®¹æ¸²æŸ“ä¸ºåç¼“å†²åŒºï¼Œç„¶åä»ä¸­å¤åˆ¶åˆ°åˆæˆå™¨è¡¨é¢ã€‚åç¼“å†²åŒºå¯ä»¥å³æ—¶åˆ†é…ï¼Œå¹¶ä¸”è¶³å¤Ÿå¤§ï¼Œå¯ä»¥å®¹çº³æ–°å†…å®¹ï¼Œæˆ–è€…åº”ç”¨ç¨‹åºå¯ä»¥ä¿æŒç¼“å†²åŒºã€‚åŒæ ·ï¼Œè¿™å¤„äºåº”ç”¨æ§åˆ¶ä¹‹ä¸‹ã€‚</li></ol><p>åœ¨è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œåº”ç”¨ç¨‹åºå¿…é¡»å‘Šè¯‰åˆæˆå™¨è¡¨é¢çš„å“ªä¸ªåŒºåŸŸå…·æœ‰æ–°å†…å®¹ã€‚å½“åº”ç”¨ç¨‹åºç›´æ¥å‘ˆç°åˆ°å…±äº«ç¼“å†²åŒºæ—¶ï¼Œéœ€è¦æ³¨æ„åˆæˆå™¨æ˜¯å¦æœ‰æ–°å†…å®¹ã€‚ä½†æ˜¯ï¼Œåœ¨äº¤æ¢ç¼“å†²æ—¶ï¼Œåˆæˆå™¨ä¸ä¼šå‡è®¾ä»»ä½•æ›´æ”¹ï¼Œå¹¶ä¸”éœ€è¦åº”ç”¨ç¨‹åºçš„è¯·æ±‚æ‰èƒ½é‡æ–°ç²‰åˆ·æ¡Œé¢ã€‚å³ä½¿åº”ç”¨ç¨‹åºå°†æ–°çš„ç¼“å†²åŒºä¼ é€’ç»™åˆæˆå™¨ï¼Œç¼“å†²åŒºçš„ä¸€å°éƒ¨åˆ†ä¹Ÿå¯èƒ½ä¸åŒï¼Œå¦‚é—ªçƒçš„å…‰æ ‡æˆ–å¾®è°ƒå™¨ã€‚ã€</p><h3 id="ä¸ºWaylandå¯ç”¨ç¡¬ä»¶"><a href="#ä¸ºWaylandå¯ç”¨ç¡¬ä»¶" class="headerlink" title="ä¸ºWaylandå¯ç”¨ç¡¬ä»¶"></a>ä¸ºWaylandå¯ç”¨ç¡¬ä»¶</h3><p>é€šå¸¸ï¼Œç¡¬ä»¶å¯ç”¨åŒ…æ‹¬æ¨¡å¼å®‰è£…&#x2F;æ˜¾ç¤ºå’Œ EGL&#x2F;GLES2ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒWayland è¿˜éœ€è¦ä¸€ç§æ–¹æ³•æ¥åœ¨æµç¨‹ä¹‹é—´é«˜æ•ˆå…±äº«ç¼“å†²åŒºã€‚è¿™æœ‰ä¸¤ä¸ªæ–¹é¢ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯ã€‚</p><p>åœ¨å®¢æˆ·ç«¯ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªWayland EGL å¹³å°ã€‚åœ¨ EGL æ¨¡å‹ä¸­ï¼Œè¯¥æ¨¡å‹åŒ…æ‹¬åŸç”Ÿç±»å‹ï¼ˆEGLNative æ˜¾ç¤ºç±»å‹ã€EGLNATIVE çª—å£ç±»å‹å’Œ EGLNativePixmapTypeï¼‰ä»¥åŠåˆ›å»ºè¿™äº›ç±»å‹çš„æ–¹æ³•ã€‚æ¢å¥è¯è¯´ï¼Œå®ƒæ˜¯å°† EGL å †æ ˆåŠå…¶ç¼“å†²å…±äº«æœºåˆ¶ä¸é€šç”¨ Wayland API ç»‘å®šèµ·æ¥çš„èƒ¶æ°´ä»£ç ã€‚EGL å †æ ˆé¢„è®¡å°†æä¾› Wayland EGL å¹³å°çš„å®æ–½ã€‚å®Œæ•´çš„ API ä½äº wayland-egl.h å¤´æ–‡ä»¶ä¸­ã€‚mesa EGL å †æ ˆä¸­çš„å¼€æºå®ç°å¤„äº wayland-egl.c å’Œ platform_wayland.c çŠ¶æ€ã€‚</p><p>åœ¨å¼•æ“ç›–ä¸‹ï¼ŒEGL å †æ ˆé¢„è®¡å°†å®šä¹‰ä¾›åº”å•†ç‰¹å®šçš„åè®®æ‰©å±•ï¼Œå…è®¸å®¢æˆ·ç«¯ EGL å †æ ˆä¸åˆæˆå™¨é€šä¿¡ç¼“å†²è¯¦ç»†ä¿¡æ¯ï¼Œä»¥ä¾¿å…±äº«ç¼“å†²åŒºã€‚Wayland-egl.h API çš„è¦ç‚¹æ˜¯æŠ½è±¡æ‰å®ƒï¼Œè®©å®¢æˆ·ç«¯ä¸º Wayland è¡¨é¢åˆ›å»ºä¸€ä¸ª EGL è¡¨é¢å¹¶å¼€å§‹æ¸²æŸ“ã€‚å¼€æºå †æ ˆä½¿ç”¨ drm Wayland æ‰©å±•ï¼Œå…è®¸å®¢æˆ·ç«¯å‘ç° drm è®¾å¤‡ç”¨äºä½¿ç”¨å’ŒéªŒè¯ï¼Œç„¶åä¸åˆæˆå™¨å…±äº« drm ï¼ˆGEMï¼‰ ç¼“å†²åŒºã€‚</p><p>Wayland çš„æœåŠ¡å™¨ç«¯æ˜¯å‚ç›´çš„åˆæˆå™¨å’Œæ ¸å¿ƒ UXï¼Œé€šå¸¸å°†ä»»åŠ¡åˆ‡æ¢å™¨ã€åº”ç”¨å¯åŠ¨å™¨ã€é”å±ç•Œé¢é›†æˆåœ¨ä¸€ä¸ªå•ä¸€åº”ç”¨ç¨‹åºä¸­ã€‚æœåŠ¡å™¨è¿è¡Œåœ¨è°ƒåˆ¶ APIï¼ˆå†…æ ¸æ¨¡å¼ï¼ŒOpenWF æ˜¾ç¤ºå™¨æˆ–ç±»ä¼¼ï¼‰çš„é¡¶éƒ¨ï¼Œå¹¶ä½¿ç”¨ EGL&#x2F;GLES2 åˆæˆå™¨å’Œç¡¬ä»¶å åŠ ï¼ˆå¦‚æœå¯ç”¨ï¼‰çš„ç»„åˆç»„åˆå°†æœ€ç»ˆçš„ UI è¿›è¡Œå¤åˆã€‚å¯ç”¨æ¨¡å¼è®¾ç½®ã€EGL&#x2F;GLES2 å’Œå åŠ åº”è¯¥æ˜¯æ ‡å‡†ç¡¬ä»¶å¸¦æ¥çš„ä¸€éƒ¨åˆ†ã€‚Wayland å¯ç”¨çš„é¢å¤–è¦æ±‚æ˜¯ EGL_WL_bind_wayland_display æ‰©å±•ï¼Œå…è®¸åˆæˆå™¨ä»é€šç”¨ Wayland å…±äº«ç¼“å†²åŒºåˆ›å»º EGLImageã€‚å®ƒç±»ä¼¼äºä» X åƒç´ å›¾åˆ›å»º EGLIM çš„ EGL_KHR_image_pixmap æ‰©å±•ã€‚</p><p>æ‰©å±•å…·æœ‰è®¾ç½®æ­¥éª¤ï¼Œæ‚¨å¿…é¡»å°† EGL æ˜¾ç¤ºå™¨ç»‘å®šåˆ° Wayland æ˜¾ç¤ºå±ã€‚ç„¶åï¼Œå½“åˆæˆå™¨ä»å®¢æˆ·ç«¯æ¥æ”¶é€šç”¨ Wayland ç¼“å†²å™¨ï¼ˆé€šå¸¸å½“å®¢æˆ·è‡´ç”µ eglSwapBuffers æ—¶ï¼‰ï¼Œå®ƒå°†èƒ½å¤Ÿé€šè¿‡ç»“æ„ wl_buffer æŒ‡å¤´å°†å›¾åƒ KHR ä½œä¸º EGLClientBuffer å‚æ•°ï¼Œå¹¶ä»¥ EGL_WAYLAND_BUFFER_WL ä¸ºç›®æ ‡ã€‚è¿™å°†åˆ›å»ºä¸€ä¸ª EGLImageï¼Œç„¶åç”±åˆæˆå™¨ç”¨ä½œçº¹ç†æˆ–ä¼ é€’åˆ°è°ƒåˆ¶è§£ç ä»¥ç”¨ä½œè¦†ç›–å¹³é¢ã€‚åŒæ ·ï¼Œè¿™ç”±ä¾›åº”å•†ç‰¹å®šçš„åè®®æ‰©å±•å®ç°ï¼ŒæœåŠ¡å™¨ç«¯å°†æ¥æ”¶æœ‰å…³å…±äº«ç¼“å†²åŒºçš„é©±åŠ¨ç¨‹åºç‰¹å®šè¯¦ç»†ä¿¡æ¯ï¼Œå¹¶åœ¨ç”¨æˆ·è°ƒç”¨ eglCreateImageKHR æ—¶å°†å…¶è½¬æ¢ä¸º EGL å›¾åƒã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Wayland </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> Wayland </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Wayland åè®®ï¼ˆä¸­æ–‡ï¼‰â€”â€” ç¬¬äºŒç« . åˆæˆå™¨çš„ç±»å‹</title>
      <link href="/2021/07/24/wayland-types/"/>
      <url>/2021/07/24/wayland-types/</url>
      
        <content type="html"><![CDATA[<h2 id="ç¬¬äºŒç« -åˆæˆçš„ç±»å‹"><a href="#ç¬¬äºŒç« -åˆæˆçš„ç±»å‹" class="headerlink" title="ç¬¬äºŒç« . åˆæˆçš„ç±»å‹"></a>ç¬¬äºŒç« . åˆæˆçš„ç±»å‹</h2><p>åˆæˆå™¨æœ‰ä¸åŒçš„ç±»å‹ï¼Œå–å†³äºå®ƒä»¬åœ¨æ“ä½œç³»ç»Ÿçš„æ•´ä½“æ¶æ„ä¸­æ‰®æ¼”çš„è§’è‰²ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªç³»ç»Ÿåˆæˆå™¨å¯ä»¥ç”¨äºå¼•å¯¼ç³»ç»Ÿã€å¤„ç†å¤šä¸ªç”¨æˆ·åˆ‡æ¢ã€ä¸€ä¸ªå¯èƒ½çš„æ§åˆ¶å°ç»ˆç«¯æ¨¡æ‹Ÿå™¨ç­‰ç­‰ã€‚ä¸€ä¸ªä¸åŒçš„åˆæˆå™¨ã€ä¼šè¯åˆæˆå™¨å°†æä¾›å®é™…çš„æ¡Œé¢ç¯å¢ƒã€‚æœ‰è®¸å¤šæ–¹æ³•å¯ä»¥è®©ä¸åŒçš„åˆæˆå™¨å…±å­˜ã€‚</p><p>åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»ä¸‰ç§ä¾èµ–äº libwayland-server çš„ Wayland åˆæˆå™¨</p><h3 id="ç³»ç»Ÿåˆæˆå™¨"><a href="#ç³»ç»Ÿåˆæˆå™¨" class="headerlink" title="ç³»ç»Ÿåˆæˆå™¨"></a>ç³»ç»Ÿåˆæˆå™¨</h3><p>ç³»ç»Ÿåˆæˆå™¨å¯ä»¥ä»æ—©æœŸå¯åŠ¨ä¸€ç›´è¿è¡Œåˆ°å…³æœºã€‚å®ƒå¯ä»¥æœ‰æ•ˆåœ°ä»£æ›¿å†…æ ¸ vt ç³»ç»Ÿï¼Œå¹¶ä¸”å¯ä»¥ä¸ç³»ç»Ÿå›¾å½¢å¼•å¯¼è®¾ç½®å’Œå¤šåº§ä½æ”¯æŒç›¸ç»“åˆã€‚</p><p>ä¸€ä¸ªç³»ç»Ÿåˆæˆå™¨å¯ä»¥æ‰¿è½½ä¸åŒç±»å‹çš„ä¼šè¯åˆæˆå™¨ï¼Œå¹¶ä¸”è®©æˆ‘ä»¬åœ¨å¤šä¸ªä¼šè¯ï¼ˆå¿«é€Ÿç”¨æˆ·åˆ‡æ¢ï¼Œæˆ–è€…å®‰å…¨&#x2F;ç§äººæ¡Œé¢åˆ‡æ¢ï¼‰ä¹‹é—´åˆ‡æ¢ã€‚</p><p>ç³»ç»Ÿåˆæˆå™¨çš„ linux å®ç°é€šå¸¸ä½¿ç”¨ libudevã€eglã€kmsã€evdev å’Œ cairoã€‚<br>å¯¹äºå…¨å±å®¢æˆ·ç«¯ï¼Œç³»ç»Ÿåˆæˆå™¨å¯ä»¥é‡æ–°ç¼–ç¨‹è§†é¢‘æ‰«æåœ°å€ç›´æ¥ä»å®¢æˆ·ç«¯æä¾›çš„ç¼“å†²åŒºè¯»å–ã€‚</p><h3 id="ä¼šè¯åˆæˆå™¨"><a href="#ä¼šè¯åˆæˆå™¨" class="headerlink" title="ä¼šè¯åˆæˆå™¨"></a>ä¼šè¯åˆæˆå™¨</h3><p>ä¸€ä¸ªä¼šè¯åˆæˆå™¨è´Ÿè´£å•ä¸€çš„ç”¨æˆ·ä¼šè¯ã€‚å¦‚æœå­˜åœ¨ç³»ç»Ÿåˆæˆå™¨ï¼Œä¼šè¯åˆæˆå™¨å°†åµŒå¥—åœ¨ç³»ç»Ÿåˆæˆå™¨ä¸‹è¿è¡Œã€‚åµŒå¥—æ˜¯å¯è¡Œçš„ï¼Œå› ä¸ºåè®®æ˜¯å¼‚æ­¥çš„ï¼›å½“æ¶‰åŠåˆ°åµŒå¥—æ—¶ï¼Œå¾€è¿”çš„å¼€é”€ä¼šå¾ˆå¤§ã€‚å¦‚æœæ²¡æœ‰ç³»ç»Ÿåˆæˆå™¨ï¼Œä¼šè¯åˆæˆå™¨å¯ä»¥ç›´æ¥åœ¨ç¡¬ä»¶ä¸Šè¿è¡Œã€‚</p><p>X åº”ç”¨ç¨‹åºå¯ä»¥é€šè¿‡æŒ‰éœ€æ¿€æ´»çš„æ—  Root X æœåŠ¡å™¨ç»§ç»­åœ¨ä¼šè¯åˆæˆå™¨ä¸‹å·¥ä½œã€‚</p><p>ä¼šè¯åˆæˆå™¨çš„å®ä¾‹åŒ…æ‹¬ï¼š</p><ul><li>gnome-shell</li><li>moblin</li><li>kwin</li><li>kmscon</li><li>rdp session</li><li>Weston ä¸ X11 æˆ– Wayland åç«¯æ˜¯åµŒå¥—åœ¨å¦ä¸€ä¸ªä¼šè¯åˆæˆã€‚</li><li>åœ¨ Wayland ä¸‹çš„å…¨å± X ä¼šè¯</li></ul><h3 id="åµŒå¥—åˆæˆå™¨"><a href="#åµŒå¥—åˆæˆå™¨" class="headerlink" title="åµŒå¥—åˆæˆå™¨"></a>åµŒå¥—åˆæˆå™¨</h3><p>X11 å…è®¸å®¢æˆ·ç«¯ä»å…¶ä»–å®¢æˆ·ç«¯åµŒå…¥çª—å£ï¼Œæˆ–å…è®¸å®¢æˆ·ç«¯å°†å¦ä¸€ä¸ªå®¢æˆ·ç«¯å‘ˆç°çš„ pixmap å†…å®¹å¤åˆ¶åˆ°å…¶çª—å£ä¸­ã€‚è¿™é€šå¸¸ç”¨äºé¢æ¿ã€æµè§ˆå™¨æ’ä»¶æˆ–ç±»ä¼¼å†…å®¹çš„å°ç¨‹åºã€‚wayland ä¸å…è®¸ç›´æ¥è¿™ä¹ˆåšï¼Œä½†å®¢æˆ·ç«¯å¯ä»¥åœ¨åè®®å¤–ä¼ è¾¾ GEM ç¼“å†²åŒºçš„åç§°ï¼Œä¾‹å¦‚ï¼Œä½¿ç”¨ D-Busï¼Œæˆ–è€…åœ¨é¢æ¿å¯åŠ¨å°ç¨‹åºæ—¶ä¼ é€’å‘½ä»¤è¡Œå‚æ•°ã€‚å¦ä¸€ç§é€‰æ‹©æ˜¯ä½¿ç”¨åµŒå¥—çš„ Wayland å®ä¾‹ã€‚ä¸ºæ­¤ï¼ŒWayland æœåŠ¡å™¨å¿…é¡»æ˜¯ä¸»æœºåº”ç”¨ç¨‹åºé“¾æ¥åˆ°çš„åº“ã€‚ç„¶åä¸»æœºåº”ç”¨ç¨‹åºæŠŠ Wayland æœåŠ¡å™¨æ’åº§åç§°ä¼ é€’åˆ°åµŒå…¥å¼åº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”éœ€è¦å®ç° Wayland åˆæˆå™¨æ¥å£ã€‚ä¸»æœºåº”ç”¨ç¨‹åºå°†å®¢æˆ·ç«¯çš„æè´¨ç»„åˆä¸ºå…¶çª—å£çš„ä¸€éƒ¨åˆ†ï¼Œå³åœ¨ç½‘é¡µæˆ–è€…é¢æ¿ä¸­ã€‚åµŒå¥— Wayland æœåŠ¡å™¨çš„å¥½å¤„æ˜¯ï¼Œå®ƒæä¾›äº†åµŒå…¥å¼å®¢æˆ·ç«¯éœ€è¦çš„è¯·æ±‚ï¼Œä»¥ä¾¿å°†ç¼“å†²åŒºæ›´æ–°é€šçŸ¥ä¸»æœºï¼Œå¹¶æä¾›äº†ä»ä¸»æœºåº”ç”¨ç¨‹åºè½¬å‘è¾“å…¥äº‹ä»¶çš„æœºåˆ¶ã€‚</p><p>è¿™ç§è®¾ç½®çš„ä¸€ä¸ªä¾‹å­æ˜¯ Firefox åµŒå…¥ flash æ’­æ”¾å™¨ä½œä¸ºä¸€ç§ç‰¹æ®Šç”¨é€”çš„åˆæˆå™¨ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Wayland </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> Wayland </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Wayland åè®®ï¼ˆä¸­æ–‡ï¼‰â€”â€” ç¬¬ä¸€ç« . ä»‹ç»</title>
      <link href="/2021/07/24/wayland-introduction/"/>
      <url>/2021/07/24/wayland-introduction/</url>
      
        <content type="html"><![CDATA[<h2 id="ç¬¬ä¸€ç« -ä»‹ç»"><a href="#ç¬¬ä¸€ç« -ä»‹ç»" class="headerlink" title="ç¬¬ä¸€ç« . ä»‹ç»"></a>ç¬¬ä¸€ç« . ä»‹ç»</h2><h3 id="åŠ¨æœº"><a href="#åŠ¨æœº" class="headerlink" title="åŠ¨æœº"></a>åŠ¨æœº</h3><p>å¤§å¤šæ•°åŸºäº Linux å’Œ Unix çš„ç³»ç»Ÿéƒ½ä¾èµ–äº X çª—å£ç³»ç»Ÿï¼ˆæˆ–è€…ç®€å•çš„ Xï¼‰ä½œä¸ºæ„å»ºä½å›¾å›¾å½¢ç•Œé¢çš„ä½çº§åè®®ã€‚åœ¨è¿™äº›ç³»ç»Ÿä¸Šï¼ŒX ç³»ç»Ÿå·²ç»å‘å±•åˆ°åŒ…å«å®¢æˆ·ç«¯åº“ã€å¸®åŠ©åº“æˆ–ä¸»æœºæ“ä½œç³»ç»Ÿå†…æ ¸ä¸­å¯èƒ½å±äºçš„åŠŸèƒ½ã€‚PCI èµ„æºç®¡ç†ã€æ˜¾ç¤ºé…ç½®ç®¡ç†ã€ç›´æ¥æ¸²æŸ“å’Œå†…å­˜ç®¡ç†ç­‰å†…å®¹çš„æ”¯æŒéƒ½å·²ç»é›†æˆåˆ° X ç³»ç»Ÿä¸­ï¼Œå¯¹ç‹¬ç«‹åº”ç”¨ç¨‹åºçš„æ”¯æŒæœ‰é™ã€å…¶ä»–é¡¹ç›®ï¼ˆå¦‚ Linux fb æˆ–è€… DirectFB é¡¹ç›®ï¼‰çš„é‡å¤å·²ç»ç»„åˆå¤šä¸ªé€‰ç»„çš„ç³»ç»Ÿï¼ˆä¾‹å¦‚ fb é©±åŠ¨ç¨‹åºå’Œ X é©±åŠ¨ç¨‹åºä¹‹é—´çš„ Radeon å†…å­˜åœ°å›¾å¤„ç†æˆ– VT åˆ‡æ¢ï¼‰çš„å¤æ‚æ€§æ°´å¹³å¾ˆé«˜ã€‚</p><p>æ­¤å¤–ï¼ŒX ç³»ç»Ÿå·²ç»é€æ¸èå…¥äº†ç°ä»£åŠŸèƒ½ï¼Œå¦‚å±å¹•å¤–æ¸²æŸ“å’Œåœºæ™¯æ„å›¾ï¼Œä½†å—é™äº X æ¶æ„çš„é™åˆ¶ã€‚ä¾‹å¦‚ç»„åˆçš„ X å®ç°ä¸Šå¢åŠ äº†é¢å¤–çš„ä¸Šä¸‹æ–‡äº¤æ¢ï¼Œä½¿è¾“å…¥é‡å®šå‘ç­‰å†…å®¹å˜å¾—å›°éš¾ã€‚</p><center><img src="/2021/07/24/wayland-introduction/x.png" class="" width=""></center><p>ä¸Šå›¾è¯´æ˜äº† X æœåŠ¡å™¨å’Œ Compositor åœ¨æ“ä½œä¸­çš„æ ¸å¿ƒä½œç”¨ï¼Œä»¥åŠå°†å†…å®¹æ˜¾ç¤ºåˆ°å±å¹•ä¸Šæ‰€éœ€çš„æ­¥éª¤ã€‚</p><p>éšç€æ—¶é—´çš„æ¨ç§»ï¼ŒX å¼€å‘äººå‘˜é€æ¸ç†è§£äº†è¿™ç§æ–¹æ³•çš„ç¼ºç‚¹ï¼Œå¹¶åŠªåŠ›è¿›è¡Œæ‹†åˆ†ã€‚åœ¨è¿‡å»çš„å‡ å¹´ä¸­ï¼Œè®¸å¤šåŠŸèƒ½å·²ç»ä» X æœåŠ¡å™¨è½¬ç§»åˆ°äº†å®¢æˆ·ç«¯åº“æˆ–å†…æ ¸é©±åŠ¨ç¨‹åºä¸­ã€‚ç¬¬ä¸€ä¸ªè¢«ç§»é™¤çš„ç»„ä»¶æ˜¯å­—ä½“æ¸²æŸ“ï¼Œfreetype å’Œ fontconfig æä¾›äº†æ ¸å¿ƒ X å­—ä½“çš„æ›¿ä»£æ–¹æ¡ˆã€‚ä½œä¸ºå®¢æˆ·ç«¯åº“ä¸­çš„å›¾å½¢é©±åŠ¨ç¨‹åºçš„ç›´æ¥æ¸²æŸ“ OpenGL ç»è¿‡äº†ä¸€äº›è¿­ä»£ï¼Œæœ€ç»ˆå˜æˆäº† DRI2ï¼Œå®ƒä»å®¢æˆ·ç«¯ä»£ç ä¸­æŠ½è±¡å‡ºäº†å¤§éƒ¨åˆ†çš„ç›´æ¥æ¸²æŸ“ç¼“å†²åŒºç®¡ç†ã€‚åæ¥ï¼Œcairo æä¾›äº†ä¸€ä¸ªç‹¬ç«‹äº X çš„ç°ä»£ 2D æ¸²æŸ“åº“ï¼Œåˆæˆç®¡ç†å™¨æ¥ç®¡äº†æ¡Œé¢æ¸²æŸ“çš„æ§åˆ¶æƒï¼Œåƒ GTK+è¿™æ ·çš„å·¥å…·åŒ…å’Œ Qt ä¸å†ä½¿ç”¨ X api è¿›è¡Œæ¸²æŸ“ã€‚æœ€è¿‘ï¼Œå†…å­˜å’Œæ˜¾ç¤ºç®¡ç†å·²ç»è½¬ç§»åˆ° Linux å†…æ ¸ï¼Œè¿›ä¸€æ­¥ç¼©å°äº† X åŠå…¶é©±åŠ¨ç¨‹åºå †æ ˆçš„èŒƒå›´ã€‚æœ€ç»ˆçš„ç»“æœæ˜¯ä¸€ä¸ªé«˜åº¦æ¨¡å—åŒ–çš„å›¾å½¢å †æ ˆã€‚</p><h3 id="ä½œä¸ºæ˜¾ç¤ºæœåŠ¡å™¨çš„åˆæˆç®¡ç†å™¨"><a href="#ä½œä¸ºæ˜¾ç¤ºæœåŠ¡å™¨çš„åˆæˆç®¡ç†å™¨" class="headerlink" title="ä½œä¸ºæ˜¾ç¤ºæœåŠ¡å™¨çš„åˆæˆç®¡ç†å™¨"></a>ä½œä¸ºæ˜¾ç¤ºæœåŠ¡å™¨çš„åˆæˆç®¡ç†å™¨</h3><p>Wayland æ˜¯ä¸€ä¸ªæ–°çš„æ˜¾ç¤ºæœåŠ¡å™¨å’Œåˆæˆåè®®ï¼Œè€Œ Weston æ˜¯è¯¥åè®®çš„å®ç°ï¼Œå®ƒæ„å»ºåœ¨ä¸Šè¿°æ‰€æœ‰ç»„ä»¶ä¹‹ä¸Šã€‚æˆ‘ä»¬è¯•å›¾ä» X æœåŠ¡å™¨ä¸­æå–å‡ºç°ä»£ Linux æ¡Œé¢ä»åœ¨ä½¿ç”¨çš„åŠŸèƒ½ã€‚è¿™å¹¶ä¸æ˜¯å…¨éƒ¨ã€‚åº”ç”¨ç¨‹åºå¯ä»¥ä½¿ç”¨ç¡¬ä»¶åŠ é€Ÿåº“(å¦‚ libGL)æˆ–é«˜è´¨é‡çš„è½¯ä»¶å®ç°(å¦‚ Cairo ä¸­çš„é‚£äº›)ï¼Œåˆ†é…è‡ªå·±çš„å±å¹•å¤–ç¼“å†²åŒºå¹¶ç›´æ¥å‘ˆç°çª—å£å†…å®¹ã€‚æœ€åï¼Œæˆ‘ä»¬éœ€è¦çš„æ˜¯ä¸€ç§æ˜¾ç¤ºç»“æœçª—å£è¡¨é¢çš„æ–¹æ³•ï¼Œä»¥åŠåœ¨å¤šä¸ªå®¢æˆ·ç«¯ä¹‹é—´æ¥æ”¶å’Œä»²è£è¾“å…¥çš„æ–¹æ³•ã€‚è¿™å°±æ˜¯ Wayland æ‰€æä¾›çš„ï¼Œé€šè¿‡å°†ç”Ÿæ€ç³»ç»Ÿä¸­å·²ç»å­˜åœ¨çš„ç»„ä»¶ä»¥ç•¥å¾®ä¸åŒçš„æ–¹å¼æ‹¼å‡‘åœ¨ä¸€èµ·ã€‚</p><p>X å°†æ°¸è¿œæ˜¯ç›¸å…³çš„ï¼Œå°±åƒ Fortran ç¼–è¯‘å™¨å’Œ VRML æµè§ˆå™¨ä¸€æ ·ï¼Œä½†ç°åœ¨æˆ‘ä»¬åº”è¯¥è€ƒè™‘å°†å®ƒä»å…³é”®è·¯å¾„ä¸­ç§»é™¤ï¼Œå¹¶å°†å…¶ä½œä¸ºé—ç•™åº”ç”¨ç¨‹åºçš„å¯é€‰ç»„ä»¶æä¾›ã€‚</p><p>æ€»çš„æ¥è¯´ï¼ŒWayland çš„ç†å¿µæ˜¯ä¸ºå®¢æˆ·æä¾›ä¸€ç§ç®¡ç†çª—å£åŠå…¶å†…å®¹æ˜¾ç¤ºæ–¹å¼çš„æ–¹æ³•ã€‚æŠŠæ¸²æŸ“ç•™ç»™å®¢æˆ·ç«¯ï¼Œç³»ç»ŸèŒƒå›´å†…çš„å†…å­˜ç®¡ç†æ¥å£ç”¨äºåœ¨å®¢æˆ·ç«¯å’Œåˆæˆç®¡ç†å™¨ä¹‹é—´ä¼ é€’ç¼“å†²åŒºå¥æŸ„ã€‚</p><center><img src="/2021/07/24/wayland-introduction/wayland.png" class="" width=""></center><p>ä¸Šå›¾è¯´æ˜äº† Wayland å®¢æˆ·ç«¯å¦‚ä½•ä¸ Wayland æœåŠ¡å™¨äº¤äº’ã€‚è¯·æ³¨æ„ï¼Œçª—å£ç®¡ç†å’Œç»„åˆå®Œå…¨åœ¨æœåŠ¡å™¨ä¸­å¤„ç†ï¼Œè¿™å¤§å¤§é™ä½äº†å¤æ‚æ€§ï¼ŒåŒæ—¶é€šè¿‡å‡å°‘ä¸Šä¸‹æ–‡åˆ‡æ¢ç•¥å¾®æé«˜äº†æ€§èƒ½ã€‚ç”Ÿæˆçš„ç³»ç»Ÿæ¯”ç±»ä¼¼çš„ X ç³»ç»Ÿæ›´å®¹æ˜“æ„å»ºå’Œæ‰©å±•ï¼Œå› ä¸ºé€šå¸¸åªéœ€åœ¨ä¸€ä¸ªåœ°æ–¹è¿›è¡Œæ›´æ”¹ã€‚ æˆ–è€…åœ¨åè®®æ‰©å±•çš„æƒ…å†µä¸‹ï¼Œè¿˜éœ€è¦æ›´æ–°çª—å£ç®¡ç†å’Œ&#x2F;æˆ–ç»„åˆå¤„ç†çš„ XICS ä¸­çš„ä¸¤ä¸ªï¼ˆè€Œä¸æ˜¯ 3 æˆ– 4 çš„æƒ…å†µï¼‰ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Wayland </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> Wayland </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Wayland åè®®ï¼ˆä¸­æ–‡ï¼‰â€”â€” åºè¨€</title>
      <link href="/2021/07/24/wayland-preface/"/>
      <url>/2021/07/24/wayland-preface/</url>
      
        <content type="html"><![CDATA[<center><img src="/2021/07/24/wayland-preface/logo.png" class="" width=""><p>Kristian HÃ¸gsberg</p><p>Intel Corporation</p><p><a href="mailto:&#x6b;&#x72;&#104;&#64;&#98;&#x69;&#116;&#x70;&#x6c;&#97;&#110;&#x65;&#x74;&#46;&#110;&#x65;&#116;">&#x6b;&#x72;&#104;&#64;&#98;&#x69;&#116;&#x70;&#x6c;&#97;&#110;&#x65;&#x74;&#46;&#110;&#x65;&#116;</a></p></center><p>ç‰ˆæƒæ‰€æœ‰ Â© 2012 Kristian HÃ¸gsbergï¼ŒIntel å…¬å¸ã€‚</p><p>ç‰¹æ­¤å…è´¹æˆäºˆä»»ä½•è·å¾—æœ¬è½¯ä»¶åŠç›¸å…³æ–‡æ¡£æ–‡ä»¶(â€œè½¯ä»¶â€)å‰¯æœ¬çš„äººï¼Œä»¥ä¸å—é™åˆ¶åœ°ç»è¥æœ¬è½¯ä»¶ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºä½¿ç”¨ã€å¤åˆ¶ã€ä¿®æ”¹ã€åˆå¹¶ã€å‡ºç‰ˆã€åˆ†å‘ã€å†è®¸å¯çš„æƒåˆ©ï¼Œå’Œ&#x2F;æˆ–é”€å”®è½¯ä»¶çš„å‰¯æœ¬ï¼Œå¹¶å…è®¸è½¯ä»¶æä¾›çš„äººè¿™æ ·åšï¼Œä½†æ ¹æ®ä»¥ä¸‹æ¡ä»¶ï¼š</p><p>ä¸Šè¿°ç‰ˆæƒå£°æ˜å’Œæœ¬è®¸å¯å£°æ˜(åŒ…æ‹¬ä¸‹ä¸€æ®µ)åº”åŒ…å«åœ¨è½¯ä»¶çš„æ‰€æœ‰å‰¯æœ¬æˆ–å®è´¨æ€§éƒ¨åˆ†ä¸­ã€‚</p><p>æœ¬è½¯ä»¶æ˜¯â€œæŒ‰ç°çŠ¶â€æä¾›çš„ï¼Œæ²¡æœ‰ä»»ä½•æ˜ç¤ºæˆ–æš—ç¤ºçš„ä¿è¯ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºé€‚é”€æ€§ã€é€‚ç”¨äºç‰¹å®šç›®çš„å’Œä¸ä¾µæƒçš„ä¿è¯ã€‚åœ¨ä»»ä½•æƒ…å†µä¸‹ï¼Œä½œè€…æˆ–ç‰ˆæƒæŒæœ‰äººéƒ½ä¸å¯¹ä»»ä½•ç´¢èµ”ã€æŸå®³èµ”å¿æˆ–å…¶ä»–è´£ä»»è´Ÿè´£ï¼Œæ— è®ºæ˜¯åœ¨åˆåŒã€ä¾µæƒè¡Œä¸ºæˆ–å…¶ä»–è¡Œä¸ºä¸­ï¼Œç”±è½¯ä»¶æˆ–ä½¿ç”¨æˆ–å…¶ä»–äº¤æ˜“å¼•èµ·çš„ï¼Œæˆ–ä¸è½¯ä»¶æœ‰å…³çš„ï¼Œæˆ–ä¸è½¯ä»¶æœ‰å…³çš„ã€‚</p><p><strong>æ‘˜è¦</strong></p><p>Wayland æ˜¯ä¸€ä¸ªç”¨äºåˆæˆç¨‹åºä¸å®¢æˆ·ç«¯é€šä¿¡çš„åè®®ï¼Œä¹Ÿæ˜¯è¯¥åè®®çš„Cåº“å®ç°ã€‚åˆæˆå™¨å¯ä»¥æ˜¯è¿è¡Œåœ¨ Linux å†…æ ¸ modesetting å’Œ evdev è¾“å…¥è®¾å¤‡ä¸Šçš„ç‹¬ç«‹æ˜¾ç¤ºæœåŠ¡å™¨ï¼Œä¸€ä¸ª X åº”ç”¨ç¨‹åºæˆ– Wayland å®¢æˆ·ç«¯æœ¬èº«ã€‚å®¢æˆ·æœºå¯ä»¥æ˜¯ä¼ ç»Ÿåº”ç”¨ç¨‹åºã€X æœåŠ¡å™¨(æ—  Root çª—å£æˆ–å…¨å±)æˆ–å…¶ä»–æ˜¾ç¤ºæœåŠ¡å™¨ã€‚</p><p><strong>å‰è¨€</strong></p><p>æœ¬æ–‡æè¿°äº† Wayland çš„ä½“ç³»ã€Wayland çš„æ“ä½œæ¨¡å‹å’Œ Wayland çš„ APIï¼Œå¦å¤–ï¼ŒWayland åè®®è§„èŒƒå†é™„å½•ä¸­æä¾›ã€‚æœ¬æ–‡æ¡£ä¸»è¦é’ˆå¯¹ Wayland å¼€å‘è€…å’Œé‚£äº›æƒ³è¦ç”¨å®ƒç¼–ç¨‹çš„äººï¼›å®ƒä¸åŒ…æ‹¬åº”ç”¨ç¨‹åºå¼€å‘ã€‚</p><p>æœ¬æ–‡æ¡£æœ‰è®¸å¤šè´¡çŒ®è€…ï¼Œç”±äºè¿™åªæ˜¯ç¬¬ä¸€ç‰ˆï¼Œé¢„è®¡ä¼šå‘ç°è®¸å¤šé”™è¯¯ï¼Œæˆ‘ä»¬éå¸¸æ„Ÿè°¢ä¿®æ­£ã€‚</p><p>ä½ ä»¬çš„<br>Wayland å¼€æºç¤¾åŒº<br>2012 å¹´ 11 æœˆ</p>]]></content>
      
      
      <categories>
          
          <category> Wayland </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> Wayland </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>leetcode 11. ç››æœ€å¤šæ°´çš„å®¹å™¨</title>
      <link href="/2021/07/06/container-with-most-water/"/>
      <url>/2021/07/06/container-with-most-water/</url>
      
        <content type="html"><![CDATA[<h2 id="ç››æœ€å¤šæ°´çš„å®¹å™¨"><a href="#ç››æœ€å¤šæ°´çš„å®¹å™¨" class="headerlink" title="ç››æœ€å¤šæ°´çš„å®¹å™¨"></a><a href="https://leetcode-cn.com/problems/container-with-most-water/">ç››æœ€å¤šæ°´çš„å®¹å™¨</a></h2><p>ç»™ä½  <code>n</code> ä¸ªéè´Ÿæ•´æ•° <code>a1ï¼Œa2ï¼Œ...ï¼Œan</code>ï¼Œæ¯ä¸ªæ•°ä»£è¡¨åæ ‡ä¸­çš„ä¸€ä¸ªç‚¹Â <code>(i,Â ai)</code> ã€‚åœ¨åæ ‡å†…ç”» <code>n</code> æ¡å‚ç›´çº¿ï¼Œå‚ç›´çº¿ <code>i</code>Â çš„ä¸¤ä¸ªç«¯ç‚¹åˆ†åˆ«ä¸ºÂ <code>(i,Â ai)</code> å’Œ <code>(i, 0)</code> ã€‚æ‰¾å‡ºå…¶ä¸­çš„ä¸¤æ¡çº¿ï¼Œä½¿å¾—å®ƒä»¬ä¸Â <code>x</code>Â è½´å…±åŒæ„æˆçš„å®¹å™¨å¯ä»¥å®¹çº³æœ€å¤šçš„æ°´ã€‚</p><p><strong>è¯´æ˜ï¼šä½ ä¸èƒ½å€¾æ–œå®¹å™¨ã€‚</strong></p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><p><img src="https://aliyun-lc-upload.oss-cn-hangzhou.aliyuncs.com/aliyun-lc-upload/uploads/2018/07/25/question_11.jpg" alt="ç¤ºä¾‹1"></p><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ï¼š[1,8,6,2,5,4,8,3,7]</span><br><span class="line">è¾“å‡ºï¼š49</span><br><span class="line">è§£é‡Šï¼šå›¾ä¸­å‚ç›´çº¿ä»£è¡¨è¾“å…¥æ•°ç»„ [1,8,6,2,5,4,8,3,7]ã€‚åœ¨æ­¤æƒ…å†µä¸‹ï¼Œå®¹å™¨èƒ½å¤Ÿå®¹çº³æ°´ï¼ˆè¡¨ç¤ºä¸ºè“è‰²éƒ¨åˆ†ï¼‰çš„æœ€å¤§å€¼ä¸ºÂ 49ã€‚</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ï¼šheight = [1,1]</span><br><span class="line">è¾“å‡ºï¼š1</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 3ï¼š</strong></p><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ï¼šheight = [4,3,2,1,4]</span><br><span class="line">è¾“å‡ºï¼š16</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 4ï¼š</strong></p><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ï¼šheight = [1,2,1]</span><br><span class="line">è¾“å‡ºï¼š2</span><br></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><ul><li>n &#x3D; height.length</li><li>2 &lt;&#x3D; n &lt;&#x3D; 3 * 104</li><li>0 &lt;&#x3D; height[i] &lt;&#x3D; 3 * 104</li></ul><h2 id="ç®—æ³•1"><a href="#ç®—æ³•1" class="headerlink" title="ç®—æ³•1"></a>ç®—æ³•1</h2><p><strong>è§£é¢˜æ€è·¯ï¼š</strong></p><p>ä½¿ç”¨åŒæŒ‡é’ˆè¿›è¡Œè§£é¢˜ï¼Œæœ¬é¢˜çš„æ ¸å¿ƒç‚¹åœ¨äºï¼Œå®¹çº³çš„æ°´é‡ä¸º</p><p><code>ä¸¤ä¸ªæŒ‡é’ˆæŒ‡å‘çš„æ•°å­—ä¸­è¾ƒå°å€¼ âˆ— æŒ‡é’ˆä¹‹é—´çš„è·ç¦»</code></p><p>æ‰€ä»¥ï¼Œä½¿ç”¨åŒæŒ‡é’ˆæ ‡è®°åŒºé—´èŒƒå›´ï¼Œç¼“å­˜é¢ç§¯çš„å€¼ï¼Œæ¯æ¬¡è®¡ç®—éƒ½æ±‚å‡ºå½“å‰åŒºé—´èŒƒå›´çš„é¢ç§¯ï¼Œå¹¶æ±‚å‡ºç¼“å­˜çš„é¢ç§¯å€¼å’Œå½“å‰çš„é¢ç§¯å€¼çš„æœ€å¤§å€¼ï¼Œæ›´æ–°ç¼“å­˜ã€‚ä¹‹åå†ä»æœ€å°å€¼å¼€å§‹ç§»åŠ¨æŒ‡é’ˆï¼Œæ±‚ä¸‹ä¸€æ¬¡çš„é¢ç§¯ã€‚</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">maxArea</span><span class="params">(<span class="type">const</span> std::vector&lt;<span class="type">int</span>&gt; &amp;height)</span> </span>&#123;</span><br><span class="line">    <span class="type">size_t</span> lp = <span class="number">0</span>;</span><br><span class="line">    <span class="type">size_t</span> rp = height.<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line">    <span class="type">size_t</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (lp &lt; rp) &#123;</span><br><span class="line">        <span class="type">size_t</span> area = std::<span class="built_in">min</span>(height[lp], height[rp]) * (rp - lp);</span><br><span class="line">        ans = std::<span class="built_in">max</span>(ans, area);</span><br><span class="line">        <span class="keyword">if</span> (height[lp] &lt; height[rp]) &#123;</span><br><span class="line">            ++lp;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            --rp;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> leetcodeç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°ç»„ </tag>
            
            <tag> ç®—æ³• </tag>
            
            <tag> ç®€å• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>leetcode 1. ä¸¤æ•°ä¹‹å’Œ</title>
      <link href="/2021/07/06/two-sum/"/>
      <url>/2021/07/06/two-sum/</url>
      
        <content type="html"><![CDATA[<h2 id="1-ä¸¤æ•°ä¹‹å’Œ"><a href="#1-ä¸¤æ•°ä¹‹å’Œ" class="headerlink" title="1. ä¸¤æ•°ä¹‹å’Œ"></a><a href="https://leetcode-cn.com/problems/two-sum/">1. ä¸¤æ•°ä¹‹å’Œ</a></h2><p>ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ <code>nums</code>Â å’Œä¸€ä¸ªæ•´æ•°ç›®æ ‡å€¼ <code>target</code>ï¼Œè¯·ä½ åœ¨è¯¥æ•°ç»„ä¸­æ‰¾å‡º å’Œä¸ºç›®æ ‡å€¼ <code>target</code>Â  çš„é‚£Â ä¸¤ä¸ªÂ æ•´æ•°ï¼Œå¹¶è¿”å›å®ƒä»¬çš„æ•°ç»„ä¸‹æ ‡ã€‚</p><p>ä½ å¯ä»¥å‡è®¾æ¯ç§è¾“å…¥åªä¼šå¯¹åº”ä¸€ä¸ªç­”æ¡ˆã€‚ä½†æ˜¯ï¼Œæ•°ç»„ä¸­åŒä¸€ä¸ªå…ƒç´ åœ¨ç­”æ¡ˆé‡Œä¸èƒ½é‡å¤å‡ºç°ã€‚</p><p>ä½ å¯ä»¥æŒ‰ä»»æ„é¡ºåºè¿”å›ç­”æ¡ˆã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ï¼šnums = [2,7,11,15], target = 9</span><br><span class="line">è¾“å‡ºï¼š[0,1]</span><br><span class="line">è§£é‡Šï¼šå› ä¸º nums[0] + nums[1] == 9 ï¼Œè¿”å› [0, 1] ã€‚</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ï¼šnums = [3,2,4], target = 6</span><br><span class="line">è¾“å‡ºï¼š[1,2]</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 3ï¼š</strong></p><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ï¼šnums = [3,3], target = 6</span><br><span class="line">è¾“å‡ºï¼š[0,1]</span><br></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><ul><li>2 &lt;&#x3D; nums.length &lt;&#x3D; 104</li><li>-109 &lt;&#x3D; nums[i] &lt;&#x3D; 109</li><li>-109 &lt;&#x3D; target &lt;&#x3D; 109</li><li>åªä¼šå­˜åœ¨ä¸€ä¸ªæœ‰æ•ˆç­”æ¡ˆ</li></ul><p><strong>è¿›é˜¶ï¼š</strong> ä½ å¯ä»¥æƒ³å‡ºä¸€ä¸ªæ—¶é—´å¤æ‚åº¦å°äº O(n2) çš„ç®—æ³•å—ï¼Ÿ</p><h2 id="ç®—æ³•-1"><a href="#ç®—æ³•-1" class="headerlink" title="ç®—æ³• 1"></a>ç®—æ³• 1</h2><p><strong>è§£é¢˜æ€è·¯ï¼š</strong></p><p>è¿™é“é¢˜åº”è¯¥æ˜¯å¤§å®¶çš„leetcodeå…¥é—¨é¢˜äº†ï¼Œåšæ³•éå¸¸çš„ç®€å•ï¼Œæ ¸å¿ƒåœ¨äºä½¿ç”¨ unordered map ä¿å­˜ <code>target</code> å’Œ éå†å€¼çš„å·®ï¼Œæ²¡æœ‰åœ¨ map ä¸­æ‰¾åˆ°å·®å°±å°†ç»“æœä¿å­˜åˆ° map ä¸­ã€‚</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">std::vector&lt;<span class="type">int</span>&gt; <span class="title">twoSum</span><span class="params">(std::vector&lt;<span class="type">int</span>&gt;&amp; nums, <span class="type">int</span> target)</span> </span>&#123;</span><br><span class="line">    std::unordered_map&lt;<span class="type">int</span>, <span class="type">int</span>&gt; hashtable;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; nums.<span class="built_in">size</span>(); ++i) &#123;</span><br><span class="line">        <span class="keyword">auto</span> it = hashtable.<span class="built_in">find</span>(target - nums[i]);</span><br><span class="line">        <span class="keyword">if</span> (it != hashtable.<span class="built_in">end</span>()) &#123;</span><br><span class="line">            <span class="keyword">return</span> &#123;it-&gt;second, i&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">        hashtable[nums[i]] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> &#123;&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> leetcodeç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°ç»„ </tag>
            
            <tag> ç®—æ³• </tag>
            
            <tag> ç®€å• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>leetcode 704. äºŒåˆ†æŸ¥æ‰¾</title>
      <link href="/2021/07/06/binary-search/"/>
      <url>/2021/07/06/binary-search/</url>
      
        <content type="html"><![CDATA[<h2 id="704-äºŒåˆ†æŸ¥æ‰¾"><a href="#704-äºŒåˆ†æŸ¥æ‰¾" class="headerlink" title="704. äºŒåˆ†æŸ¥æ‰¾"></a><a href="https://leetcode-cn.com/problems/binary-search/">704. äºŒåˆ†æŸ¥æ‰¾</a></h2><p>ç»™å®šä¸€ä¸ªÂ nÂ ä¸ªå…ƒç´ æœ‰åºçš„ï¼ˆå‡åºï¼‰æ•´å‹æ•°ç»„Â nums å’Œä¸€ä¸ªç›®æ ‡å€¼Â target Â ï¼Œå†™ä¸€ä¸ªå‡½æ•°æœç´¢Â numsÂ ä¸­çš„ targetï¼Œå¦‚æœç›®æ ‡å€¼å­˜åœ¨è¿”å›ä¸‹æ ‡ï¼Œå¦åˆ™è¿”å› -1ã€‚</p><p>ç¤ºä¾‹ 1:</p><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">è¾“å…¥: nums = [-1,0,3,5,9,12], target = 9</span><br><span class="line">è¾“å‡º: 4</span><br><span class="line">è§£é‡Š: 9 å‡ºç°åœ¨ nums ä¸­å¹¶ä¸”ä¸‹æ ‡ä¸º 4</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹Â 2:</p><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">è¾“å…¥: nums = [-1,0,3,5,9,12], target = 2</span><br><span class="line">è¾“å‡º: -1</span><br><span class="line">è§£é‡Š: 2 ä¸å­˜åœ¨ nums ä¸­å› æ­¤è¿”å› -1</span><br></pre></td></tr></table></figure><p>æç¤ºï¼š</p><p>ä½ å¯ä»¥å‡è®¾ numsÂ ä¸­çš„æ‰€æœ‰å…ƒç´ æ˜¯ä¸é‡å¤çš„ã€‚<br>nÂ å°†åœ¨Â [1, 10000]ä¹‹é—´ã€‚<br>numsÂ çš„æ¯ä¸ªå…ƒç´ éƒ½å°†åœ¨Â [-9999, 9999]ä¹‹é—´ã€‚</p><h2 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><p>ä½¿ç”¨åŒæŒ‡é’ˆå®ç°äºŒåˆ†æŸ¥æ‰¾ã€‚</p><p>åˆå§‹åŒ– <code>left</code> ä¸º0, <code>right</code> ä¸º numsçš„é•¿åº¦å‡ä¸€ï¼Œåœ¨æ¯æ¬¡éå†çš„æ—¶å€™ï¼Œè®¡ç®— <code>mid</code> ä¸ºä¸­é—´å€¼ï¼Œè®¡ç®—æ–¹æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">mid = left + (right - left) / 2;</span><br></pre></td></tr></table></figure><p>å½“ <code>nums[mid] == target</code> æ—¶ï¼Œå³æŸ¥æ‰¾åˆ°ç›®æ ‡å€¼ï¼Œè¿”å› <code>mid</code>ã€‚<br>å½“ <code>nums[mid] &lt; target</code> æ—¶ï¼Œè°ƒæ•´ <code>right</code> ä¸º <code>mid - 1</code>ã€‚<br>å½“ <code>nums[mid] &gt; target</code> æ—¶ï¼Œè°ƒæ•´ <code>left</code> ä¸º <code>mid + 1</code>ã€‚</p><p>å¾ªç¯æ¡ä»¶ä¸º <code>left &lt;= right</code>ï¼Œå½“è¶…è¿‡ä¸­é—´å€¼ä»ç„¶æ²¡æœ‰æŸ¥æ‰¾åˆ°ç›®æ ‡å€¼ï¼Œ<code>left</code> ä¼šè¶…è¿‡ <code>right</code> çš„ä½ç½®ï¼Œä»è€Œè·³å‡ºå¾ªç¯ï¼Œè¿”å› <code>-1</code>ã€‚</p><p>è¯¦ç»†å®ç°ï¼š</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">search</span><span class="params">(<span class="type">const</span> std::vector&lt;<span class="type">int</span>&gt;&amp; nums, <span class="type">int</span> target)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (nums.<span class="built_in">size</span>() &lt; <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> nums[<span class="number">0</span>] == target ? <span class="number">0</span> : <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> mid = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> left = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> right = nums.<span class="built_in">size</span>() <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (left &lt;= right) &#123;</span><br><span class="line">        mid = left + (right - left) / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span> (nums[mid] == target) &#123;</span><br><span class="line">            <span class="keyword">return</span> mid;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (target &lt; nums[mid]) &#123;</span><br><span class="line">            right = mid - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            left = mid + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> leetcodeç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°ç»„ </tag>
            
            <tag> ç®—æ³• </tag>
            
            <tag> ç®€å• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¦‚ä½•ç»™Archæ‰“ä¸€ä¸ªåŒ…</title>
      <link href="/2021/03/04/package-manager-for-arch/"/>
      <url>/2021/03/04/package-manager-for-arch/</url>
      
        <content type="html"><![CDATA[<p>Arch ä½¿ç”¨çš„æ˜¯ pacman åŒ…ç®¡ç†å™¨ï¼ŒåŒ…æ ¼å¼æ˜¯ tar.zstã€‚Arch æä¾›äº†ä¸€äº›å·¥å…·ç”¨äºåˆ›å»º tar.zst åŒ…ï¼Œé¦–å…ˆéœ€è¦å®‰è£… base-devel åŒ…å’Œ devtools åŒ…ã€‚</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">pacman -S base-devel devtools</span><br></pre></td></tr></table></figure><p>Arch çš„æ‰“åŒ…æµç¨‹æ˜¯è¿™æ ·çš„ï¼Œè¦å…ˆå†™ä¸€ä¸ª PKGBUILD æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶æè¿°äº†æ„å»ºä¸€ä¸ªåŒ…æ‰€éœ€çš„å…¨éƒ¨ä¿¡æ¯ï¼Œå¦‚ä»å“ªé‡Œä¸‹è½½æºç ï¼Œä¾èµ–æœ‰å“ªäº›ï¼Œæ„å»ºçš„ç‰ˆæœ¬æ˜¯å¤šå°‘ï¼Œå¦‚ä½•è¿›è¡Œæ„å»ºç­‰ã€‚</p><h1 id="PKGBUILD"><a href="#PKGBUILD" class="headerlink" title="PKGBUILD"></a>PKGBUILD</h1><p>ä¸€ä¸ªåŸºæœ¬çš„ PKGBUILD æ ¼å¼å¦‚ä¸‹ï¼š</p><figure class="highlight text"><table><tr><td class="code"><pre><span class="line"># Maintainer: justforlxz &lt;justforlxz@gmail.com&gt;</span><br><span class="line"></span><br><span class="line">pkgname=dtkcore-git</span><br><span class="line">pkgver=5.4.0.r1.ge7e7a99</span><br><span class="line">pkgrel=1</span><br><span class="line">pkgdesc=&#x27;DTK core modules&#x27;</span><br><span class="line">arch=(&#x27;x86_64&#x27;)</span><br><span class="line">url=&quot;https://github.com/linuxdeepin/dtkcore&quot;</span><br><span class="line">license=(&#x27;LGPL3&#x27;)</span><br><span class="line">depends=(&#x27;dconf&#x27; &#x27;deepin-desktop-base-git&#x27; &#x27;python&#x27; &#x27;gsettings-qt&#x27; &#x27;lshw&#x27;)</span><br><span class="line">makedepends=(&#x27;git&#x27; &#x27;qt5-tools&#x27; &#x27;gtest&#x27;)</span><br><span class="line">conflicts=(&#x27;dtkcore&#x27;)</span><br><span class="line">provides=(&#x27;dtkcore&#x27;)</span><br><span class="line">groups=(&#x27;deepin-git&#x27;)</span><br><span class="line">source=(&quot;$pkgname::git://github.com/linuxdeepin/dtkcore.git&quot;)</span><br><span class="line">sha512sums=(&#x27;SKIP&#x27;)</span><br><span class="line"></span><br><span class="line">pkgver() &#123;</span><br><span class="line">    cd $pkgname</span><br><span class="line">    git describe --long --tags | sed &#x27;s/\([^-]*-g\)/r\1/;s/-/./g&#x27;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">build() &#123;</span><br><span class="line">  cd $pkgname</span><br><span class="line">  qmake-qt5 PREFIX=/usr DTK_VERSION=$pkgver LIB_INSTALL_DIR=/usr/lib</span><br><span class="line">  make</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">package() &#123;</span><br><span class="line">  cd $pkgname</span><br><span class="line">  make INSTALL_ROOT=&quot;$pkgdir&quot; install</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»¥ dtkcore ä¸ºä¾‹ï¼Œæ•´ä¸ªé…ç½®æ–‡ä»¶ååˆ†æ¸…æ™°æ˜äº†ï¼Œä¸€çœ‹å°±çŸ¥é“æ„å»ºå·¥å…·æ˜¯å¦‚ä½•ä¸€æ­¥æ­¥åˆ¶ä½œå‡ºä¸€ä¸ªåŒ…çš„ã€‚</p><p>å°†é…ç½®æ–‡ä»¶ä¿å­˜åˆ°ç›®å½•é‡Œï¼Œä»¥ <code>PKGBUILD</code> å‘½åï¼Œç„¶åæ‰§è¡Œ <code>makepkg</code>ã€‚</p><p>makepkg æ˜¯ç”¨äºæ‰§è¡Œ PKGBUILD æ–‡ä»¶çš„å·¥å…·ï¼Œå®ƒæ ¹æ®æ–‡ä»¶ä¸­çš„æè¿°ï¼Œè¿›è¡ŒåŒ…çš„æ„å»ºã€‚</p><h1 id="å¦‚ä½•æäº¤ä¸€ä¸ªåŒ…åˆ°-aur"><a href="#å¦‚ä½•æäº¤ä¸€ä¸ªåŒ…åˆ°-aur" class="headerlink" title="å¦‚ä½•æäº¤ä¸€ä¸ªåŒ…åˆ° aur"></a>å¦‚ä½•æäº¤ä¸€ä¸ªåŒ…åˆ° aur</h1><p>å½“ä½ å¸Œæœ›è‡ªå·±æ‰“çš„åŒ…å¯ä»¥è¢«åˆ«äººä½¿ç”¨çš„æ—¶å€™ï¼Œä¸€èˆ¬éƒ½ä¼šè¯·æ±‚ä¸Šä¼ åˆ°å®˜æ–¹ä»“åº“ï¼Œä½†æ˜¯è¿›å…¥å®˜æ–¹ä»“åº“çš„æµç¨‹å¼‚å¸¸ç¹çï¼Œè€Œä¸”å¯¹è´¡çŒ®è€…çš„è¦æ±‚ä¼šæ¯”è¾ƒé«˜ã€‚Arch æä¾›äº†ä¸€ä¸ªç”¨æˆ·ä»“åº“ï¼Œä¾›ç”¨æˆ·è‡ªç”±åˆ†äº«é…ç½®æ–‡ä»¶ï¼Œåªéœ€è¦ä¸‹è½½é…ç½®æ–‡ä»¶ï¼Œåœ¨æœ¬æœºæ‰“åŒ…å°±å¯ä»¥äº†ã€‚</p><p>æ ¹æ® aur çš„ <a href="https://wiki.archlinux.org/index.php/AUR_submission_guidelines">è´¡çŒ®æŒ‡å—</a>ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆè½»æ¾çš„ä¸Šä¼ è‡ªå·±çš„é…ç½®æ–‡ä»¶ï¼Œå¹¶å€Ÿç”¨yayç­‰aurå·¥å…·è‡ªåŠ¨ä¸‹è½½å’Œæ„å»ºè½¯ä»¶åŒ…ã€‚</p><blockquote><p>ç”¨æˆ·å¯ä»¥é€šè¿‡ Arch User Repository åˆ†äº« PKGBUILDã€‚AUR ä¸­ä¸åŒ…å«ä»»ä½•äºŒè¿›åˆ¶åŒ…ï¼Œä»…åŒ…å«ç”¨æˆ·ä¸Šä¼ çš„ PKGBUILDï¼Œä¾›å…¶ä»–ç”¨æˆ·ä¸‹è½½ä½¿ç”¨ã€‚æ‰€æœ‰è½¯ä»¶åŒ…éƒ½æ˜¯éå®˜æ–¹çš„ï¼Œä½¿ç”¨é£é™©è‡ªæ‹…ã€‚</p></blockquote><p>æäº¤aurä¹‹å‰ï¼Œéœ€è¦å…ˆäº†è§£ä¸€ä¸‹ aur çš„ä¸€äº›è¦æ±‚ï¼Œ<a href="https://wiki.archlinux.org/index.php/AUR_submission_guidelines#Rules_of_submission">Rules of submission</a> æä¾›äº†ä¸€äº›è§„åˆ™ï¼Œåªè¦æˆ‘ä»¬æŒ‰ç…§è§„åˆ™æ¥ï¼Œå°±å¯ä»¥ä¸Šä¼ å’Œç»´æŠ¤æˆ‘ä»¬è‡ªå·±çš„åŒ…ã€‚</p><p>é¦–å…ˆéœ€è¦å» <a href="https://aur.archlinux.org/">aurå®˜ç½‘</a> æ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œå¹¶ä¸Šä¼ è‡ªå·±çš„ ssh key æˆ‘ä»¬é€šè¿‡å…‹éš†ä¸€ä¸ªæ–°çš„ä»“åº“æ¥ä½œä¸ºä¸Šä¼ çš„æ–¹å¼ã€‚</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git clone ssh://aur@aur.archlinux.org/&lt;pkgname&gt;.git</span><br></pre></td></tr></table></figure><p>ä»¥dtkcoreä¸ºä¾‹ï¼Œå…‹éš†çš„æ—¶å€™æŠŠpkgnameæ”¹æˆdtkcoreã€‚</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git clone ssh://aur@aur.archlinux.org/dtkcore.git</span><br></pre></td></tr></table></figure><p><strong>å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡åˆ›å»ºï¼Œä¼šæç¤ºä½ å…‹éš†çš„ä¸€ä¸ªç©ºä»“åº“ã€‚</strong></p><p>æŠŠ PKGBUILD æ–‡ä»¶å¤åˆ¶åˆ°å…‹éš†çš„ç›®å½•ï¼Œç„¶åæ‰§è¡Œ <code>makepkg --printsrcinfo &gt; .SRCINFO</code> åˆ›å»ºä¸€ä¸ªè½¯ä»¶åŒ…ä¿¡æ¯ï¼Œå°† <code>.SRCINFO</code> å’Œ <code>PKGBUILD</code> æ–‡ä»¶éƒ½æ·»åŠ åˆ° git ä¸­ï¼Œç„¶åæäº¤ commit ä¿¡æ¯ï¼Œæ¨é€åˆ°æœåŠ¡å™¨ã€‚</p><blockquote><p>æ³¨æ„ï¼š å¦‚æœæ‚¨å¿˜è®°åœ¨é¦–æ¬¡æäº¤ä¸­åŒ…å« .SRCINFOï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ rebasing with â€“root æˆ–æ˜¯ filtering the tree ä½¿å¾— AUR æ¥å—æ‚¨çš„ç¬¬ä¸€æ¬¡æ¨é€</p></blockquote><blockquote><p>æç¤ºï¼š ä¸ºäº†ä¿æŒå·¥ä½œç›®å½•å’Œæäº¤å°½å¯èƒ½çš„å¹²å‡€ï¼Œå¯ä»¥åˆ›å»º gitignore æ–‡ä»¶æ¥æ’é™¤æ‰€æœ‰æ–‡ä»¶ï¼Œç„¶åå†æŒ‰éœ€æ·»åŠ æ–‡ä»¶ã€‚</p></blockquote><p>å‚è€ƒèµ„æ–™ï¼š</p><blockquote><p><a href="https://wiki.archlinux.org/index.php/PKGBUILD">https://wiki.archlinux.org/index.php/PKGBUILD</a></p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>timemachine</title>
      <link href="/2021/02/27/timemachine/"/>
      <url>/2021/02/27/timemachine/</url>
      
        <content type="html"><![CDATA[<p>æ¥ç€ä¸Šç¯‡çš„ <a href="/samba">samba</a>ï¼Œæˆ‘ç»™å®¶é‡Œé…ç½®äº† samba æœåŠ¡å™¨ï¼Œä¸ºå®¶é‡Œæä¾›å…±äº«å­˜å‚¨æœåŠ¡ã€‚</p><p>æˆ‘åœ¨æˆ‘ç¬”è®°æœ¬ä¸Šå®‰è£…äº†é»‘è‹¹æœï¼Œæ‰€ä»¥ä¹Ÿæƒ³é¡ºä¾¿è¯•è¯•ä¼ è¯´ä¸­çš„ <code>Time Machine</code> è‡ªåŠ¨å¤‡ä»½ï¼Œè¯´ä¸å®šè¿˜èƒ½æ•´ä¸€å¥—ç»™ deepin ä½¿ç”¨å‘¢ã€‚</p><p>è¯ä¸å¤šè¯´å¼€å¹²ã€‚</p><h1 id="å®‰è£…-avahi"><a href="#å®‰è£…-avahi" class="headerlink" title="å®‰è£… avahi"></a>å®‰è£… avahi</h1><p>Avahi æ˜¯ä¸€ç§å…è´¹çš„é›¶é…ç½®ç½‘ç»œå®ç°ï¼ŒåŒ…æ‹¬ç”¨äºå¤šæ’­ DNS &#x2F; DNS-SDæœåŠ¡å‘ç°çš„ç³»ç»Ÿã€‚å®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬å¹¿æ’­ samba æœåŠ¡å™¨ï¼Œè¿™æ ·ç½‘ç»œå†…å…¶ä»–æœºå™¨å°±å¯ä»¥æŸ¥æ‰¾åˆ° samba æœåŠ¡å™¨äº†ã€‚</p><p>åœ¨ arch ä¸Šå®‰è£… avahiã€‚</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">pacman -S avahi</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¹¶ä¸éœ€è¦é…ç½®ä»€ä¹ˆï¼Œç›´æ¥å¼€å¯æœåŠ¡å°±è¡Œäº†ã€‚</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">systemctl enable --now avahi-daemon</span><br></pre></td></tr></table></figure><h1 id="é…ç½®-samba"><a href="#é…ç½®-samba" class="headerlink" title="é…ç½® samba"></a>é…ç½® samba</h1><p>æˆ‘ä»¬è¿˜éœ€è¦ç¨å¾®é…ç½®ä¸€ä¸‹ samba æœåŠ¡ï¼Œä¸“é—¨å¼€è¾Ÿä¸€ä¸ªç”¨äºå¤‡ä»½çš„ç›®å½•ã€‚</p><p>ä¿®æ”¹ <code>/etc/samba/smb.conf</code>ï¼Œæ·»åŠ ä¸€ä¸ª timemachine çš„æ¡ç›®ã€‚</p><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">[timemachine]</span><br><span class="line">    comment = macos time machine backup</span><br><span class="line">    path = /home/lxz/TimeMachine</span><br><span class="line">    valid users = lxz</span><br><span class="line">    browseable = yes</span><br><span class="line">    writeable = yes</span><br><span class="line">    writelist = lxz</span><br><span class="line">    create mask = 0777</span><br><span class="line">    # åŠ è½½æ¨¡å—ä»¥æ”¯æŒAAPLæ‹“å±•ï¼Œæ³¨æ„é¡ºåºå¾ˆé‡è¦ï¼</span><br><span class="line">    vfs objects = catia fruit streams_xattr</span><br><span class="line">    # æ”¯æŒaapl</span><br><span class="line">    fruit:aapl = yes</span><br><span class="line">    # å­˜å‚¨os xçš„å…ƒæ•°æ®</span><br><span class="line">    fruit:metadata = stream</span><br><span class="line">    # è®¾ç½®æœåŠ¡å™¨åœ¨finderä¸­çš„å›¾æ ‡</span><br><span class="line">    fruit:model = MacPro</span><br><span class="line">    # æ”¯æŒtime machineï¼Œéå¸¸é‡è¦ï¼</span><br><span class="line">    fruit:time machine = yes</span><br><span class="line">    # æ–‡ä»¶æ¸…ç†çš„ä¸€äº›é…ç½®</span><br><span class="line">    fruit:posix_rename = yes</span><br><span class="line">    fruit:veto_appledouble = no</span><br><span class="line">    fruit:wipe_intentionally_left_blank_rfork = yes</span><br><span class="line">    fruit:delete_empty_adfiles = yes</span><br></pre></td></tr></table></figure><p>è¿˜éœ€è¦è®¾ç½® smb åè®®çš„ç‰ˆæœ¬å’Œå¼€å¯è‹¹æœçš„æ”¯æŒï¼Œåœ¨é…ç½®æ–‡ä»¶ä¸­æŸ¥æ‰¾æˆ–è€…æ·»åŠ æ–°çš„ï¼Œæ³¨æ„ï¼Œè¿™é‡Œçš„é…ç½®æ–‡ä»¶å¿…é¡»æ˜¯åœ¨ä¸Šé¢æ¡ç›®çš„ä¸Šæ–¹ï¼Œæˆ‘æ¨èæ˜¯æ”¾åœ¨ <code>dns proxy</code> çš„ä¸‹æ–¹ã€‚</p><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">min protocol = SMB2</span><br><span class="line">ea support = yes</span><br></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬é‡å¯ä¸€ä¸‹ samba å’Œ avahiçš„æœåŠ¡ã€‚</p><p>æ­¤æ—¶ TimeMachine å’Œ Finder éƒ½ä¼šæ˜¾ç¤º samba æœåŠ¡å™¨äº†ã€‚</p><img src="/2021/02/27/timemachine/finder.png" class="" title="timemachine&#x2F;finder.png"><h1 id="å¼€å¯-time-machine"><a href="#å¼€å¯-time-machine" class="headerlink" title="å¼€å¯ time machine"></a>å¼€å¯ time machine</h1><p>æ‰“å¼€è®¾ç½®ï¼Œè¿›å…¥æ—¶é—´æœºå™¨ï¼Œæ‰“å¼€é€‰æ‹©ä¸€ä¸ªç¡¬ç›˜ã€‚</p><img src="/2021/02/27/timemachine/timemachine.png" class="" title="timemachine&#x2F;timemachine.png"><p>é€‰æ‹©å…±äº«çš„timemachineï¼Œç‚¹å‡»ä½¿ç”¨ç¡¬ç›˜ï¼Œç„¶åä¼šå¼¹å‡ºæ¥è®¤è¯çš„å¯¹è¯æ¡†ï¼Œè¾“å…¥ç”¨æˆ·åå’Œå¯†ç å³å¯ã€‚</p><img src="/2021/02/27/timemachine/timemachine1.png" class="" title="timemachine&#x2F;timemachine1.png"><img src="/2021/02/27/timemachine/finished.png" class="" title="timemachine&#x2F;finished.png"><p>é…ç½®å°±ç®—å®Œæˆäº†ï¼Œåªéœ€è¦ç­‰å¾…è‡ªåŠ¨å¤‡ä»½ï¼Œæˆ–è€…é€‰æ‹©ä¸‹é¢çš„åœ¨èœå•æ ä¸­æ˜¾ç¤ºæ—¶é—´æœºå™¨ï¼Œåœ¨èœå•æ é‡Œé€‰æ‹©ç«‹å³å¤‡ä»½ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>samba</title>
      <link href="/2021/02/27/samba/"/>
      <url>/2021/02/27/samba/</url>
      
        <content type="html"><![CDATA[<p>samba æ˜¯ä¸€ä¸ªlinuxä¸‹å¼€æºçš„SMB&#x2F;CIFSåè®®çš„å…è´¹è½¯ä»¶ï¼Œæœ€åˆ SMB åè®®æ˜¯ Microsoft å¼€å‘çš„ç½‘ç»œé€šè®¯åè®®ï¼Œåæ¥å¾®è½¯åˆæŠŠ SMB æ”¹åä¸º CIFSï¼ˆCommon Internet File Systemï¼‰ï¼Œå³å…¬å…± Internet æ–‡ä»¶ç³»ç»Ÿï¼Œå¹¶ä¸”åŠ å…¥äº†è®¸å¤šæ–°çš„åŠŸèƒ½ï¼Œè¿™æ ·ä¸€æ¥ï¼Œä½¿å¾—Sambaå…·æœ‰äº†æ›´å¼ºå¤§çš„åŠŸèƒ½ã€‚</p><p>sambaç›®å‰æœ€å¤§çš„ä½œç”¨æ˜¯æ–‡ä»¶å…±äº«ï¼ŒæœåŠ¡å™¨åªéœ€è¦æä¾›è´¦å·å’Œå¯†ç ï¼Œå°±å¯ä»¥ç”± samba å®¢æˆ·ç«¯è®¿é—®ï¼Œå¹¶æŒ‚è½½åˆ°æœ¬åœ°ç³»ç»Ÿä¸Šã€‚</p><p>æˆ‘åœ¨å®¶ç”¨äº†ä¸€ä¸ª macmini å½“åšå®¶åº­ nasï¼Œå¹¶ä¸”ä½¿ç”¨ archlinux å½“åšæœåŠ¡å™¨ç³»ç»Ÿï¼Œæˆ‘åœ¨ä¸Šé¢éƒ¨ç½²äº† samba æœåŠ¡ï¼Œseafile æœåŠ¡ï¼Œnextcloud æœåŠ¡ï¼Œplex æœåŠ¡ï¼Œarai2c ä¸‹è½½æœºã€‚</p><p>é™¤äº† samba æœåŠ¡ï¼Œå…¶ä»–æœåŠ¡éƒ½æ˜¯è¿è¡Œåœ¨ docker ä¸­ï¼Œæ‰€ä»¥ samba æœåŠ¡éœ€è¦æˆ‘æ‰‹åŠ¨é…ç½®ã€‚</p><h1 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h1><p>archlinux å®‰è£… samba æœåŠ¡å¾ˆç®€å•ï¼Œåªéœ€è¦ä½¿ç”¨ pacman å®‰è£… samba åŒ…å³å¯ã€‚</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">pacman -S samba</span><br></pre></td></tr></table></figure><p>å®‰è£…å®Œæˆä»¥åæˆ‘ä»¬å°±å¯ä»¥åˆ›å»ºç”¨æˆ·å’Œé…ç½®å…±äº«ç›®å½•äº†ã€‚</p><h1 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h1><p>ç”±äº samba ä¸æä¾›é…ç½®æ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ä»ç½‘ä¸Šä¸‹è½½åŸºæœ¬çš„ <a href="https://man.archlinux.org/man/smb.conf.5">é…ç½®æ–‡ä»¶</a>ã€‚</p><h2 id="åˆ›å»ºç”¨æˆ·"><a href="#åˆ›å»ºç”¨æˆ·" class="headerlink" title="åˆ›å»ºç”¨æˆ·"></a>åˆ›å»ºç”¨æˆ·</h2><p>æˆ‘ä»¬éœ€è¦å…ˆåœ¨ç³»ç»Ÿåˆ›å»ºå¯¹åº”çš„ç”¨æˆ·ï¼Œä»¥æˆ‘çš„ç”¨æˆ·å lxz ä¸ºä¾‹ã€‚</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">useradd -m -g users -G wheel lxz</span><br></pre></td></tr></table></figure><h2 id="ç¦ç”¨ç”¨æˆ·ç™»å½•"><a href="#ç¦ç”¨ç”¨æˆ·ç™»å½•" class="headerlink" title="ç¦ç”¨ç”¨æˆ·ç™»å½•"></a>ç¦ç”¨ç”¨æˆ·ç™»å½•</h2><p>ç”±äºè¯¥ç”¨æˆ·åªæ˜¯ä¸ºäº†æƒé™ç›¸å…³çš„æ“ä½œï¼Œæ‰€ä»¥æˆ‘å¹¶æ²¡æœ‰è®¡åˆ’ä½¿ç”¨è¯¥è´¦æˆ·ï¼Œå¦‚æœéœ€è¦åœ¨ç³»ç»Ÿä¸­ä½¿ç”¨è¯¥è´¦æˆ·ï¼Œåˆ™ä¸éœ€è¦è¿›è¡Œæ¥ä¸‹æ¥çš„ç¦ç”¨æ“ä½œã€‚</p><p><strong>ç¦ç”¨æœ¬åœ°ç™»å½•</strong></p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">usermod --shell /usr/bin/nologin --lock lxz</span><br></pre></td></tr></table></figure><p><strong>ç¦ç”¨sshç™»å½•</strong></p><p>ä¿®æ”¹ <code>/etc/ssh/sshd_config</code> ï¼Œä¿®æ”¹ <code>AllowUsers</code>ã€‚</p><h2 id="åˆ›å»º-samba-ç”¨æˆ·"><a href="#åˆ›å»º-samba-ç”¨æˆ·" class="headerlink" title="åˆ›å»º samba ç”¨æˆ·"></a>åˆ›å»º samba ç”¨æˆ·</h2><p>æˆ‘ä»¬éœ€è¦åŒºåˆ†çš„æ˜¯ï¼Œå°½ç®¡ samba çš„ç”¨æˆ·å’Œ Linux ç³»ç»Ÿæœ¬èº«çš„ç”¨æˆ·æ˜¯åŒä¸€ä¸ªï¼Œä½†æ˜¯å¯†ç åˆ™æ˜¯åˆ†å¼€å­˜æ”¾çš„ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ samba æä¾›çš„å‘½ä»¤ä¿®æ”¹ç”¨æˆ·çš„å¯†ç ã€‚</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">smbpasswd -a lxz</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹å¯†ç åˆ™ä¸ä½¿ç”¨ <code>-a</code> å‚æ•°ï¼š</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">smbpasswd lxz</span><br></pre></td></tr></table></figure><h1 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h1><p>åˆ°æ­¤ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº†åŸºæœ¬çš„ samba é…ç½®ï¼Œé…ç½®æ–‡ä»¶é‡Œé»˜è®¤å¼€å¯äº†ç”¨æˆ·çš„å®¶ç›®å½•è®¿é—®ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨ smb å®¢æˆ·ç«¯è¿›è¡Œç™»å½•çš„æ—¶å€™ï¼Œå¯ä»¥ç›´æ¥è®¿é—®å®¶ç›®å½•ã€‚</p><h2 id="å¼€å¯æœåŠ¡"><a href="#å¼€å¯æœåŠ¡" class="headerlink" title="å¼€å¯æœåŠ¡"></a>å¼€å¯æœåŠ¡</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">systemctl enable smb</span><br><span class="line">systemctl start smb</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ smbclient å¯ä»¥éªŒè¯æœ¬æœºæœåŠ¡ã€‚</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">smbclient -L localhost -U%</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@LXZ-MacMini ~]# smbclient -L localhost -U%</span><br><span class="line"></span><br><span class="line">Sharename       Type      Comment</span><br><span class="line">---------       ----      -------</span><br><span class="line">timemachine     Disk      macos time machine backup</span><br><span class="line"><span class="meta prompt_">IPC$ </span><span class="language-bash">           IPC       IPC Service (Samba Server)</span></span><br><span class="line">SMB1 disabled -- no workgroup available</span><br></pre></td></tr></table></figure><h1 id="æ·»åŠ å…¶ä»–çš„å…±äº«ç›®å½•"><a href="#æ·»åŠ å…¶ä»–çš„å…±äº«ç›®å½•" class="headerlink" title="æ·»åŠ å…¶ä»–çš„å…±äº«ç›®å½•"></a>æ·»åŠ å…¶ä»–çš„å…±äº«ç›®å½•</h1><p>é™¤äº†ç”¨æˆ·å®¶ç›®å½•ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å…±äº«ç‰¹å®šçš„ç›®å½•ã€‚</p><p>ä¾‹å¦‚æˆ‘åˆ›å»ºä¸€ä¸ª data ç›®å½•ï¼Œå…è®¸ä»»ä½•äººåªè¯»è®¿é—®ã€‚</p><p>ä¿®æ”¹ <code>/etc/samba/smb.conf</code> æ–‡ä»¶ï¼Œåœ¨æœ«å°¾å¤„æ·»åŠ é…ç½®ã€‚</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[Guests]</span><br><span class="line">  comment = Allow all users to read</span><br><span class="line">  path = /data</span><br><span class="line">  public = yes</span><br><span class="line">  only guest = yes</span><br><span class="line">  writable = no</span><br><span class="line">  printable = no</span><br></pre></td></tr></table></figure><p>ç„¶åé‡å¯ samba æœåŠ¡ï¼Œä½¿ç”¨ smbclient éªŒè¯ã€‚</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@LXZ-MacMini ~]# systemctl restart smb</span><br><span class="line">[root@LXZ-MacMini ~]# smbclient -L localhost -U%</span><br><span class="line"></span><br><span class="line">Sharename       Type      Comment</span><br><span class="line">---------       ----      -------</span><br><span class="line">timemachine     Disk      macos time machine backup</span><br><span class="line">Guests          Disk      Allow all users to read</span><br><span class="line"><span class="meta prompt_">IPC$ </span><span class="language-bash">           IPC       IPC Service (Samba Server)</span></span><br><span class="line">SMB1 disabled -- no workgroup available</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020 Review</title>
      <link href="/2021/02/26/2020review/"/>
      <url>/2021/02/26/2020review/</url>
      
        <content type="html"><![CDATA[<h1 id="2020"><a href="#2020" class="headerlink" title="2020"></a>2020</h1><p>æ‹–äº†è¿™ä¹ˆä¹…æ‰æ›´æ–°åšå®¢ï¼Œæƒ³å¿…å¤§å®¶éƒ½åœ¨ 2020 å¹´è¿‡çš„æŒºä¸å¥½çš„ï¼Œå¹´åˆæ­¦æ±‰çš„ç–«æƒ…æ‰“äº†å…¨å›½ä¸€ä¸ªæªä¸åŠé˜²ï¼Œç”šè‡³å·²ç»ä¸€æ•´å¹´äº†ï¼Œå…¨çƒç–«æƒ…è¿˜æ˜¯ååˆ†ç´§å¼ ã€‚æˆªæ­¢åˆ° 2021 å¹´ 2 æœˆ 26 æ—¥ï¼Œå…¨çƒæ¯æ—¥æ–°å¢ä»ç„¶æœ‰30 å¤šä¸‡ï¼Œè€Œä¸”å…¨çƒç´¯è®¡æ­»äº¡å·²æœ‰ 250 ä¸‡äººä¹‹å¤šã€‚</p><h1 id="ç–«æƒ…"><a href="#ç–«æƒ…" class="headerlink" title="ç–«æƒ…"></a>ç–«æƒ…</h1><p>ç”Ÿå‘½æ˜¯å¦‚æ­¤çš„è„†å¼±ã€‚æœ‰äº›æ—¶å€™å’Œæœ‹å‹ä»¬ä¸€èµ·åƒé¥­ï¼Œä¼šè¯´èµ·ä¸€æœˆä»½æ—¶å¤§å®¶æ˜¯å¦‚ä½• <code>é€ƒç¦»</code> æ­¦æ±‰çš„ï¼Œåœ¨å®¶éš”ç¦»åˆå¤šäº†å“ªäº›äº‹æƒ…ï¼Œæˆ‘ä»¬æ´»ç€æ˜¯å¤šä¹ˆçš„ä¸å®¹æ˜“ã€‚è™½ç„¶äººç±»å·²ç»å¯ä»¥ç”Ÿäº§ 5 çº³ç±³çš„èŠ¯ç‰‡äº†ï¼Œä½†æ˜¯å°±å¦‚åŒæˆ‘ä»¬å¯¹è¿™ä¸ªå®‡å®™çš„è®¤çŸ¥ä¸€æ ·ï¼Œå‡ ç™¾äº¿å…‰å¹´å¤–ä»»æˆ‘ä»¬çœ‹ï¼Œå¯å¤ªé˜³ç³»å†…æœ‰ä»€ä¹ˆæˆ‘ä»¬éƒ½ä¸çŸ¥é“ï¼Œç”šè‡³åœ¨åœ°çƒä¸Šè¿˜æœ‰å¾ˆå¤šæˆ‘ä»¬æœªçŸ¥çš„ä¸œè¥¿ã€‚</p><h1 id="è®¡åˆ’å¤±è¯¯"><a href="#è®¡åˆ’å¤±è¯¯" class="headerlink" title="è®¡åˆ’å¤±è¯¯"></a>è®¡åˆ’å¤±è¯¯</h1><p>2020 å¹´æˆ‘çš„è®¡åˆ’å‡ ä¹æ²¡æœ‰ä¸€ä»¶äº‹æ˜¯å®Œæˆçš„ï¼Œæˆ‘è®¡åˆ’åº”è¯¥ä¸€æ•´å¹´æŒæ¡ <code>TypeScript</code> å’Œ <code>web</code> å¼€å‘ï¼Œå¹¶å¼€å‘è‡ªå·±çš„blogç³»ç»Ÿï¼Œä½†æ˜¯æ–¹æ¡ˆè¢«æˆ‘æ¨åˆ°é‡æ¥äº†ä¸‰æ¬¡ï¼Œæˆ‘å°±æ²¡è€å¿ƒç»§ç»­å¼€å‘äº†ï¼Œåªå®Œæˆäº†åŸºæœ¬çš„ <code>md</code> æ–‡ä»¶ç¼–è¯‘å’ŒæœåŠ¡å™¨æ¸²æŸ“å°±æš‚åœäº†ã€‚è®¡åˆ’é˜…è¯» <code>ã€Š1984ã€‹</code> ã€ <code>ã€ŠTensorFlowã€‹</code> å’Œ <code>ã€ŠTypeScriptå®æˆ˜ã€‹</code> ï¼Œç„¶è€Œåªæœ‰ <code>ã€ŠTypeScriptå®æˆ˜ã€‹</code>é˜…è¯»å®Œäº†ï¼Œå‰©ä½™ä¸¤æœ¬ä¹¦æˆ‘åˆ™æ˜¯åªçœ‹äº†ä¸€ä¸¢ä¸¢ï¼Œçœ‹æ¥åªèƒ½æ”¾åˆ° 2021 å¹´è¯»å®Œäº†ã€‚</p><h1 id="å¥¹"><a href="#å¥¹" class="headerlink" title="å¥¹"></a>å¥¹</h1><p>åœ¨ <code>2019Review</code> çš„æ–‡ç« é‡Œï¼Œæˆ‘æåˆ°äº†æˆ‘é‡åˆ°äº†ç”Ÿå‘½ä¸­çš„é‚£ä¸ªå¥¹ï¼Œè€Œ 2020 å¹´ï¼Œæˆ‘å’Œå¥¹ <code>ç»“å©š</code> å•¦ã€‚</p><p>åœ¨å®¶éš”ç¦»çš„æ—¥å­é‡Œï¼Œæœ‰å¥¹é™ªä¼´ç€æˆ‘ï¼Œè™½ç„¶è€å®¶çš„äººéƒ½æŒºæ•Œè§†ä»æ­¦æ±‰å›æ¥çš„æˆ‘ï¼Œä½†æ˜¯å¤§é—¨ä¸€å…³æˆ‘è°ä¹Ÿçœ‹ä¸åˆ°ï¼Œçœ¼ä¸è§å¿ƒä¸çƒ¦ï¼Œåœ¨å®¶ä¸€å—æ“éº»å°†æŒºå¥½çš„ï¼Œè¿˜ä¸€èµ·ç»ƒ (zao) ä¹  (ta)äº†å¨è‰ºï¼Œæœ‹å‹åœˆåšé¥­æ¯”èµ›ç¬¬ä¸€åã€‚</p><h1 id="å­¦ä¹ "><a href="#å­¦ä¹ " class="headerlink" title="å­¦ä¹ "></a>å­¦ä¹ </h1><p>è™½ç„¶æˆ‘è¯»ä¹¦æ‹‰åäº†ï¼Œä½†æ˜¯æˆ‘çš„è‹±è¯­ <code>åšæŒ</code> äº†ä¸‹æ¥ï¼Œæˆ‘ä½¿ç”¨å¤šé‚»å›½è¿›è¡Œè‹±è¯­å’Œæ—¥è¯­çš„å­¦ä¹ ï¼Œå·²ç»åšæŒå¿«6ä¸ªæœˆäº†ï¼Œéœ€è¦ç»§ç»­åŠ æ²¹åŠªåŠ›ï¼Œäº‰å–æ—©æ—¥æŠŠå­¦æ ¡é‡Œæ‹‰ä¸‹çš„è‹±è¯­ <code>è¡¥</code> å›æ¥ã€‚</p><img src="/2021/02/26/2020review/Untitled.png" class="" title="2020review&#x2F;Untitled.png"><h1 id="å·¥ä½œ"><a href="#å·¥ä½œ" class="headerlink" title="å·¥ä½œ"></a>å·¥ä½œ</h1><p>2020 å¹´æœ€å¤§çš„æ”¶ç›Šå¯èƒ½æ˜¯åˆ›å»ºäº† <code>deepin-git</code> çš„ä»“åº“ï¼Œæä¾›äº† <code>dde</code> æ‰€æœ‰ç»„ä»¶åœ¨ <code>arch</code> ä¸Šçš„gitç‰ˆï¼Œå¹¶ä¸”è¿˜æˆåŠŸç”³è¯·åˆ°äº† <code>archlinuxcn</code> çš„è´¡çŒ®è€…ã€‚</p><h1 id="æ–‡ç« "><a href="#æ–‡ç« " class="headerlink" title="æ–‡ç« "></a>æ–‡ç« </h1><p>2020 å¹´ä¸€å…±æ°´äº†18ç¯‡æ–‡ç« ã€‚</p><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="number">12</span>-<span class="number">23</span>   ccls</span><br><span class="line"><span class="number">11</span>-<span class="number">17</span>   <span class="title class_">Qt</span>å¤šçº¿ç¨‹</span><br><span class="line"><span class="number">09</span>-<span class="number">17</span>   deepin-wineä¸­æ–‡ä¹±ç </span><br><span class="line"><span class="number">09</span>-<span class="number">08</span>   ä½¿ç”¨rEFIndæ¥å®‰å…¨å¯åŠ¨ç³»ç»Ÿ</span><br><span class="line"><span class="number">09</span>-<span class="number">06</span>   deepin git version</span><br><span class="line"><span class="number">09</span>-<span class="number">03</span>   ä½¿ç”¨<span class="title class_">VSCode</span>è¿œç¨‹å¼€å‘<span class="variable constant_">DDE</span></span><br><span class="line"><span class="number">08</span>-<span class="number">06</span>   åœ¨<span class="title class_">ArchLinux</span>ä¸Šå¼€å‘startdde</span><br><span class="line"><span class="number">07</span>-<span class="number">27</span>   use github action to check dde-launcher</span><br><span class="line"><span class="number">07</span>-<span class="number">21</span>   ä½¿ç”¨perfå·¥å…·åˆ†æç¨‹åºæ€§èƒ½</span><br><span class="line"><span class="number">06</span>-<span class="number">16</span>   <span class="title class_">CTest</span> &amp; <span class="title class_">QTest</span>/<span class="title class_">GTest</span></span><br><span class="line"><span class="number">06</span>-<span class="number">15</span>   <span class="variable constant_">CPP</span>é¡¹ç›®çš„ä¸€äº›å‘</span><br><span class="line"><span class="number">06</span>-<span class="number">15</span>   ä½¿ç”¨inquireræä¾›äº¤äº’å¼git commit</span><br><span class="line"><span class="number">06</span>-<span class="number">01</span>   vue-routerè·¯ç”±å¤ç”¨åé¡µé¢æ²¡æœ‰åˆ·æ–°</span><br><span class="line"><span class="number">05</span>-<span class="number">31</span>   vue3å‡çº§é‡åˆ°çš„å‘</span><br><span class="line"><span class="number">02</span>-<span class="number">01</span>   <span class="title class_">JavaScript</span>å»ºé€ è€…æ¨¡å¼</span><br><span class="line"><span class="number">01</span>-<span class="number">31</span>   æµ…è°ˆ<span class="title class_">Javascript</span>æ„é€ å™¨æ¨¡å¼</span><br><span class="line"><span class="number">01</span>-<span class="number">01</span>   <span class="number">2019</span> <span class="title class_">Review</span></span><br><span class="line"><span class="number">01</span>-<span class="number">01</span>   ä½¿ç”¨ä¼ªå…ƒç´ åˆ›å»ºä¸€ä¸ªåœ†ç‚¹</span><br></pre></td></tr></table></figure><p>ç ”ç©¶äº† <code>vscode</code> çš„æ’ä»¶ï¼Œå¼€å‘äº†ä¸€ä¸ª <code>qmake</code> çš„æ’ä»¶åŸå‹ï¼Œå¯ä»¥æ‰“å¼€ <code>dtk</code> ç­‰ <code>qt pro</code> çš„é¡¹ç›®ï¼Œåˆ©ç”¨ <code>bear</code> æ‹¦æˆª <code>make</code> çš„ç¼–è¯‘ä¿¡æ¯ï¼Œç”Ÿæˆ <code>ccls</code> éœ€è¦çš„æ•°æ®åº“ï¼Œè¿™æ ·å°±å¯ä»¥ä¸ºé¡¹ç›®æä¾›è‡ªåŠ¨è¡¥å…¨å’Œè¯­æ³•æ£€æŸ¥ç­‰åŠŸèƒ½äº†ã€‚</p><p>å†™äº†ä¸€äº›å…³äºè¿œç¨‹å¼€å‘çš„æ–‡ç« ï¼Œä¹Ÿæ˜¯åˆ©ç”¨ <code>vscode</code> çš„è¿œç¨‹åŠŸèƒ½ï¼Œä¸å¾—ä¸è¯´ <code>vscode</code> çœŸçš„å¯ä»¥è¯´æ˜¯å®‡å®™ç¬¬ä¸€ç¼–è¾‘å™¨äº†ï¼Œè®©è€ç‰Œçš„ <code>vim</code> å’Œ <code>emacs</code> çŸ¥é“äº†ä»€ä¹ˆå«æ˜“ç”¨æ€§çš„åŠ›é‡ã€‚</p><h1 id="å±•æœ›"><a href="#å±•æœ›" class="headerlink" title="å±•æœ›"></a>å±•æœ›</h1><p>2021 å¹´ï¼Œä¸èƒ½æ¾æ‡ˆï¼Œä»Šå¹´è¦ç»§ç»­åŠªåŠ›å­¦ä¹ ï¼ŒåŠªåŠ›æå‡è‡ªå·±ã€‚</p><p>åœ¨ 2021 å¹´é‡Œï¼Œæˆ‘å°†ä¼šè´Ÿè´£ <code>deepin</code> çš„ç¤¾åŒºï¼Œç”±äºå‰ä¸¤å¹´å…¬å¸éœ€è¦å¿«é€Ÿæ‰©å¼ ï¼Œå¯¼è‡´å¿½ç•¥äº†ç¤¾åŒºï¼Œç°åœ¨æˆ‘ä»¬çš„é¦–è¦ä»»åŠ¡å°±æ˜¯æ¢å¤ç¤¾åŒºï¼Œå¹¶è®©ç¤¾åŒºè‰¯æ€§çš„è‡ªç”±å‘å±•ï¼Œç¤¾åŒºæ˜¯æˆ‘ä»¬çš„æ ¹æœ¬ã€‚</p><p>æŒ–äº†å¾ˆå¤šå‘ï¼Œä»Šå¹´äº‰å–éƒ½å¡«ä¸€ä¸‹ã€‚</p><h1 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h1><p>åˆæ¬å®¶äº†ï¼Œæ‰¾äº†ä¸€ä¸ªä¸€å®¤ä¸€å…ï¼Œå¼€å¯äº†äºŒäººçš„å°æ—¥å­ï¼Œè¿‡äº†å¹´ä»¥åæŠŠç‹—å­ä¹Ÿå¸¦æ¥äº†ï¼Œç°åœ¨å¤©å¤©æ—©ä¸Šèµ·æ¥æ‰“ç‹—ï¼Œæ™šä¸Šå›æ¥æ‰“ç‹—ã€‚</p><p>æˆ‘åˆç»™ <code>è‚ç–¼3</code> æ°ªäº†ä¸€ä¸ªæœˆå¡ï¼Œè¿™æ¬¡åªå¿˜äº†ä¸€å¤©æ²¡ç™»å½•ï¼Œä¸ç„¶ <code>30</code> å—å¤§æ´‹åˆè¦ç™½èŠ±äº†ã€‚</p><p>ç¥å¤§å®¶å¹¸ç¦å®‰åº·ï¼Œæ–°å¹´å¿«ä¹ï¼(<em>^â–½^</em>)</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ccls</title>
      <link href="/2020/12/23/ccls/"/>
      <url>/2020/12/23/ccls/</url>
      
        <content type="html"><![CDATA[<p>LSP(Language Server Protocol) è¯­è¨€æœåŠ¡åè®®ï¼Œæ­¤åè®®å®šä¹‰äº†åœ¨ç¼–è¾‘å™¨æˆ–IDEä¸è¯­è¨€æœåŠ¡å™¨ä¹‹é—´ä½¿ç”¨çš„åè®®ï¼Œè¯¥è¯­è¨€æœåŠ¡å™¨æä¾›äº†ä¾‹å¦‚è‡ªåŠ¨è¡¥å…¨ï¼Œè½¬åˆ°å®šä¹‰ï¼ŒæŸ¥æ‰¾æ‰€æœ‰å¼•ç”¨ç­‰çš„åŠŸèƒ½ï¼›è¯­è¨€æœåŠ¡å™¨ç´¢å¼•æ ¼å¼çš„ç›®æ ‡æ˜¯æ”¯æŒåœ¨å¼€å‘å·¥å…·ä¸­è¿›è¡Œä¸°å¯Œçš„ä»£ç å¯¼èˆªæˆ–è€…ä¸€ä¸ªæ— éœ€æœ¬åœ°æºç å‰¯æœ¬çš„WebUIã€‚</p><p>è€Œcclså°±æ˜¯ä¸ºc&#x2F;c++å¼€å‘çš„ä¸€ä¸ªçš„lspæœåŠ¡ï¼Œå¯ä»¥ä¸ºvimã€emacså’Œvscodeç­‰å·¥å…·æä¾›è‡ªåŠ¨è¡¥å…¨ï¼Œå®šä¹‰è·³è½¬ç­‰åŠŸèƒ½ã€‚</p><p>æ ¹æ®æœ¬æ–‡çš„æŒ‡å¯¼ï¼Œä½ å¯ä»¥å°†vimé…ç½®æˆä¸€ä¸ªä¸é”™çš„c++å¼€å‘å·¥å…·ã€‚</p><h1 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h1><p>ç”±äºå…¬å¸éƒ¨åˆ†é¡¹ç›®å¹¶ä¸æ˜¯CMakeå¼€å‘çš„ï¼Œæ‰€ä»¥vscodeæ— æ³•å®Œæˆèƒœä»»å¼€å‘å·¥ä½œï¼Œæ‰€ä»¥æˆ‘å¼€å§‹ä½¿ç”¨vimã€‚ç³»ç»Ÿæˆ‘ä½¿ç”¨çš„æ˜¯ArchLinux,æˆ‘ä¼šå°½é‡ä½¿ç”¨ä»“åº“ä¸­çš„åŒ…ï¼Œè€Œä¸æ˜¯é€šè¿‡pipç­‰å·¥å…·å®‰è£…ç»„ä»¶ã€‚</p><h1 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h1><p>å®‰è£…neovimã€cclså’Œbear,bearç›®å‰åªåœ¨archlinuxcnä»“åº“ï¼Œéœ€è¦æ³¨æ„ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo pacman -S neovim ccls bear python node</span><br></pre></td></tr></table></figure><p>ä¸‹è½½SpaceVimï¼Œç”±äºæˆ‘ä½¿ç”¨çš„æ˜¯neovim,æ‰€ä»¥ä¸‹è½½é…ç½®æ—¶é€‰æ‹©äº†neovim.</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">curl -sLf https://spacevim.org/cn/install.sh | bash -s -- --install neovim</span><br></pre></td></tr></table></figure><p>åˆ›å»ºè‡ªå·±çš„é…ç½®æ–‡ä»¶ç›®å½•</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mkdir ~/.SpaceVim.d/</span><br></pre></td></tr></table></figure><h1 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h1><p>é¦–å…ˆè¦å…ˆåˆ›å»ºåŸºæœ¬çš„SpaceVimé…ç½®æ–‡ä»¶ï¼Œé…ç½®æ–‡ä»¶å‚è€ƒäº†<a href="https://github.com/Martins3/My-Linux-config">https://github.com/Martins3/My-Linux-config</a>ã€‚</p><p>æ•´ä¸ªé…ç½®éƒ½åœ¨~&#x2F;.SpaceVim.dç›®å½•ä¸‹ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.SpaceVim.d</span><br><span class="line">â”œâ”€â”€ autoload</span><br><span class="line">â”‚Â  Â â””â”€â”€ myspacevim.vim</span><br><span class="line">â”œâ”€â”€ coc-settings.json</span><br><span class="line">â”œâ”€â”€ init.toml</span><br><span class="line">â””â”€â”€ plugin</span><br><span class="line">Â  Â  â”œâ”€â”€ coc.nvim</span><br><span class="line">Â  Â  â””â”€â”€ defx.nvim</span><br><span class="line">2 directories, 5 files</span><br></pre></td></tr></table></figure><p>åœ¨.SpaceVim.dç›®å½•ä¸‹åˆ›å»ºinit.toml</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># æ‰€æœ‰çš„ SpaceVim é€‰é¡¹éƒ½åˆ—åœ¨ [options] ä¹‹ä¸‹</span><br><span class="line">[options]</span><br><span class="line">Â  Â  # è®¾ç½® SpaceVim ä¸»é¢˜åŠèƒŒæ™¯ï¼Œé»˜è®¤çš„ä¸»é¢˜æ˜¯ gruvboxï¼Œå¦‚æœä½ éœ€è¦ä½¿ç”¨æ›´</span><br><span class="line">Â  Â  # å¤šçš„ä¸»é¢˜ï¼Œä½ å¯ä»¥è½½å…¥ colorscheme æ¨¡å—</span><br><span class="line">Â  Â  colorscheme = &quot;gruvbox&quot;</span><br><span class="line">Â  Â  # èƒŒæ™¯å¯ä»¥å–å€¼ &quot;dark&quot; æˆ– &quot;light&quot;</span><br><span class="line">Â  Â  colorscheme_bg = &quot;dark&quot;</span><br><span class="line">Â  Â  # å¯ç”¨/ç¦ç”¨ç»ˆç«¯çœŸè‰²ï¼Œåœ¨ç›®å‰å¤§å¤šæ•°ç»ˆç«¯ä¸‹éƒ½æ˜¯æ”¯æŒçœŸè‰²çš„ï¼Œå½“ç„¶ä¹Ÿæœ‰</span><br><span class="line">Â  Â  # ä¸€å°éƒ¨åˆ†ç»ˆç«¯ä¸æ”¯æŒçœŸè‰²ï¼Œå¦‚æœä½ çš„ SpaceVim é¢œè‰²çœ‹ä¸Šå»æ¯”è¾ƒæ€ªå¼‚</span><br><span class="line">Â  Â  # å¯ä»¥ç¦ç”¨ç»ˆç«¯çœŸè‰²ï¼Œå°†ä¸‹é¢çš„å€¼è®¾ä¸º false</span><br><span class="line">Â  Â  enable_guicolors = true</span><br><span class="line">Â  Â  # è®¾ç½®çŠ¶æ€æ ä¸Šåˆ†å‰²ç¬¦å·å½¢çŠ¶ï¼Œå¦‚æœå­—ä½“å®‰è£…å¤±è´¥ï¼Œå¯ä»¥å°†å€¼è®¾ä¸º &quot;nil&quot; ä»¥</span><br><span class="line">Â  Â  # ç¦ç”¨åˆ†å‰²ç¬¦å·ï¼Œé»˜è®¤ä¸ºç®­å¤´ &quot;arrow&quot;</span><br><span class="line">Â  Â  statusline_separator = &quot;nil&quot;</span><br><span class="line">Â  Â  statusline_iseparator = &quot;bar&quot;</span><br><span class="line">Â  Â  # è®¾ç½®é¡¶éƒ¨æ ‡ç­¾åˆ—è¡¨åºå·ç±»å‹ï¼Œæœ‰ä»¥ä¸‹äº”ç§ç±»å‹ï¼Œåˆ†åˆ«æ˜¯ 0 - 4</span><br><span class="line">Â  Â  # 0: 1 â› âŠ</span><br><span class="line">Â  Â  # 1: 1 â› â€</span><br><span class="line">Â  Â  # 2: 1 â› â“µ</span><br><span class="line">Â  Â  # 3: 1 â› Â¹</span><br><span class="line">Â  Â  # 4: 1 â› 1</span><br><span class="line">Â  Â  buffer_index_type = 4</span><br><span class="line">Â  Â  # æ˜¾ç¤º/éšè—é¡¶éƒ¨æ ‡ç­¾æ ä¸Šçš„æ–‡ä»¶ç±»å‹å›¾æ ‡ï¼Œè¿™ä¸€å›¾æ ‡éœ€è¦å®‰è£… nerd fontsï¼Œ</span><br><span class="line">Â  Â  # å¦‚æœæœªèƒ½æˆåŠŸå®‰è£…è¿™ä¸€å­—ä½“ï¼Œå¯ä»¥éšè—å›¾æ ‡</span><br><span class="line">Â  Â  enable_tabline_filetype_icon = true</span><br><span class="line">Â  Â  # æ˜¯å¦åœ¨çŠ¶æ€æ ä¸Šæ˜¾ç¤ºå½“å‰æ¨¡å¼ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œä¸æ˜¾ç¤º Normal/Insert ç­‰</span><br><span class="line">Â  Â  # å­—æ ·ï¼Œåªä»¥é¢œè‰²åŒºåˆ†å½“å‰æ¨¡å¼</span><br><span class="line">Â  Â  enable_statusline_mode = false</span><br><span class="line">Â  Â  filemanager = &quot;defx&quot;</span><br><span class="line">Â  Â  autocomplete_method = &quot;coc&quot;</span><br><span class="line">Â  Â  bootstrap_before = &quot;myspacevim#before&quot;</span><br><span class="line">Â  Â  bootstrap_after = &quot;myspacevim#after&quot;</span><br><span class="line"># SpaceVim æ¨¡å—è®¾ç½®ï¼Œä¸»è¦åŒ…æ‹¬å¯ç”¨/ç¦ç”¨æ¨¡å—</span><br><span class="line"># è®¡ç®—å™¨ æ—¥å† ä¹¦ç­¾ç­‰å°å·¥å…·</span><br><span class="line">[[layers]]</span><br><span class="line">Â  name = &#x27;tools&#x27;</span><br><span class="line">[[layers]]</span><br><span class="line">Â  name = &quot;checkers&quot;</span><br><span class="line">Â  enable = false</span><br><span class="line"># ç‰ˆæœ¬æ§åˆ¶</span><br><span class="line">[[layers]]</span><br><span class="line">Â  name = &quot;VersionControl&quot;</span><br><span class="line">Â  enable-gtm-status = true</span><br><span class="line">[[layers]]</span><br><span class="line">Â  name = &quot;git&quot;</span><br><span class="line">Â  git-plugin = &quot;fugitive&quot;</span><br><span class="line">[[layers]]</span><br><span class="line">Â  name = &quot;fzf&quot;</span><br><span class="line"># coc.nvim æ ¸å¿ƒé…ç½®ï¼Œä¸è¦åˆ é™¤</span><br><span class="line">[[custom_plugins]]</span><br><span class="line">Â  name = &#x27;neoclide/coc.nvim&#x27;</span><br><span class="line">Â  merge = 0</span><br><span class="line"># ä¸»è¦ç”¨äºå¿«é€Ÿæœç´¢ æ–‡ä»¶, buffer å’Œ å‡½æ•°</span><br><span class="line">[[custom_plugins]]</span><br><span class="line">Â  Â  name = &quot;Yggdroot/LeaderF&quot;</span><br><span class="line">Â  Â  build = &quot;./install.sh&quot;</span><br><span class="line"># æ›´åŠ ç¾è§‚çš„ tagbar</span><br><span class="line">[[custom_plugins]]</span><br><span class="line">Â  Â  name = &#x27;liuchengxu/vista.vim&#x27;</span><br><span class="line">[[custom_plugins]]</span><br><span class="line">Â  Â  name = &#x27;junegunn/fzf.vim&#x27;</span><br><span class="line"># æ›´åŠ æ–¹ä¾¿çš„è°ƒèŠ‚çª—å£çš„å¤§å°</span><br><span class="line">[[custom_plugins]]</span><br><span class="line">Â  Â  name = &#x27;simeji/winresizer&#x27;</span><br><span class="line"># åŸºäºlspçš„é«˜äº®æ’ä»¶</span><br><span class="line">[[custom_plugins]]</span><br><span class="line">Â  Â  name = &#x27;jackguo380/vim-lsp-cxx-highlight&#x27;</span><br><span class="line"># ä» http://cplusplus.com/ å’Œ http://cppreference.com/ è·å–æ–‡æ¡£</span><br><span class="line">[[custom_plugins]]</span><br><span class="line">Â  Â  name = &#x27;skywind3000/vim-cppman&#x27;</span><br><span class="line"># åˆ©ç”¨ git blame æ˜¾ç¤ºå½“å‰è¡Œçš„ commit message</span><br><span class="line">[[custom_plugins]]</span><br><span class="line">Â  Â  name = &#x27;rhysd/git-messenger.vim&#x27;</span><br><span class="line">Â  Â  lazy =Â  1</span><br><span class="line">Â  Â  on_cmd = &#x27;GitMessenger&#x27;</span><br><span class="line"># ä»¥æ‚¬æµ®çª—å£çš„å½¢å¼æ‰“å¼€ç»ˆç«¯</span><br><span class="line">[[custom_plugins]]</span><br><span class="line">Â  Â  name = &#x27;voldikss/vim-floaterm&#x27;</span><br><span class="line"># æ˜¾ç¤ºæœç´¢çš„æ ‡å·</span><br><span class="line">[[custom_plugins]]</span><br><span class="line">Â  Â  name = &#x27;google/vim-searchindex.git&#x27;</span><br><span class="line">[[custom_plugins]]</span><br><span class="line">Â  name = &#x27;kenn7/vim-arsync&#x27;</span><br><span class="line">[[custom_plugins]]</span><br><span class="line">Â  name = &#x27;fatih/vim-go&#x27;</span><br><span class="line"># ç¦ç”¨ shell æ¨¡å—ï¼Œç¦ç”¨æ¨¡å—æ—¶ï¼Œéœ€è¦åŠ å…¥ enable = false</span><br><span class="line">[[layers]]</span><br><span class="line">Â  Â  name = &quot;shell&quot;</span><br><span class="line">Â  Â  enable = false</span><br><span class="line"># æ·»åŠ è‡ªå®šä¹‰æ’ä»¶</span><br><span class="line">[[custom_plugins]]</span><br><span class="line">Â  Â  repo = &quot;lilydjwg/colorizer&quot;</span><br><span class="line">Â  Â  merged = false</span><br><span class="line">[[layers]]</span><br><span class="line">Â  name = &quot;format&quot;</span><br></pre></td></tr></table></figure><p>åˆ›å»ºpluginç›®å½•ï¼Œæ–°å»ºä¸¤ä¸ªæ–‡ä»¶ã€‚<br>coc.nvim</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&quot; coc.nvim çš„é…ç½®, æ¥è‡ªäº https://github.com/neoclide/coc.nvim</span><br><span class="line">&quot; Use &lt;c-space&gt; for trigger completion.</span><br><span class="line">inoremap &lt;silent&gt;&lt;expr&gt; &lt;c-space&gt; coc#refresh()</span><br><span class="line">set hidden</span><br><span class="line">&quot; Some servers have issues with backup files, see #649</span><br><span class="line">set nobackup</span><br><span class="line">set nowritebackup</span><br><span class="line">&quot; ä½¿ç”¨ Microsoft Python Language Server ä¸ç„¶ coc.nvim ä¼šè­¦å‘Š</span><br><span class="line">call coc#config(&quot;python.jediEnabled&quot;, v:false)</span><br><span class="line">call coc#config(&quot;smartf.wordJump&quot;, v:false)</span><br><span class="line">call coc#config(&quot;smartf.jumpOnTrigger&quot;, v:false)</span><br><span class="line">&quot; https://rust-analyzer.github.io/manual.html#rust-analyzer-language-server-binary</span><br><span class="line">call coc#config(&quot;rust-analyzer.serverPath&quot;, &quot;~/.cargo/bin/rust-analyzer&quot;)</span><br><span class="line">call coc#config(&#x27;coc.preferences&#x27;, &#123;</span><br><span class="line">\ &quot;autoTrigger&quot;: &quot;always&quot;,</span><br><span class="line">\ &quot;maxCompleteItemCount&quot;: 10,</span><br><span class="line">\ &quot;codeLens.enable&quot;: 1,</span><br><span class="line">\ &quot;diagnostic.virtualText&quot;: 1,</span><br><span class="line">\&#125;)</span><br><span class="line"></span><br><span class="line">&quot; coc.nvim æ’ä»¶ï¼Œç”¨äºæ”¯æŒ python java ç­‰è¯­è¨€</span><br><span class="line">let s:coc_extensions = [</span><br><span class="line">\ &#x27;coc-python&#x27;,</span><br><span class="line">\ &#x27;coc-java&#x27;,</span><br><span class="line">\ &#x27;coc-json&#x27;,</span><br><span class="line">Â  Â  Â  \ &#x27;coc-css&#x27;,</span><br><span class="line">Â  Â  Â  \ &#x27;coc-html&#x27;,</span><br><span class="line">Â  Â  Â  \ &#x27;coc-word&#x27;,</span><br><span class="line">Â  Â  Â  \ &#x27;coc-cmake&#x27;,</span><br><span class="line">Â  Â  Â  \ &#x27;coc-dictionary&#x27;,</span><br><span class="line">Â  Â  Â  \ &#x27;coc-rust-analyzer&#x27;,</span><br><span class="line">Â  Â  Â  \ &#x27;coc-vimlsp&#x27;,</span><br><span class="line">Â  Â  Â  \ &#x27;coc-ci&#x27;,</span><br><span class="line">Â  Â  Â  \ &#x27;coc-snippets&#x27;,</span><br><span class="line">Â  Â  Â  \ &#x27;coc-vimtex&#x27;,</span><br><span class="line">Â  Â  Â  \ &#x27;coc-smartf&#x27;,</span><br><span class="line">\]</span><br><span class="line">for extension in s:coc_extensions</span><br><span class="line">call coc#add_extension(extension)</span><br><span class="line">endfor</span><br><span class="line">inoremap &lt;silent&gt;&lt;expr&gt; &lt;TAB&gt;</span><br><span class="line">Â  Â  Â  \ pumvisible() ? &quot;\&lt;C-n&gt;&quot; :</span><br><span class="line">Â  Â  Â  \ &lt;SID&gt;check_back_space() ? &quot;\&lt;TAB&gt;&quot; :</span><br><span class="line">Â  Â  Â  \ coc#refresh()</span><br><span class="line">inoremap &lt;expr&gt;&lt;S-TAB&gt; pumvisible() ? &quot;\&lt;C-p&gt;&quot; : &quot;\&lt;C-h&gt;&quot;</span><br><span class="line">function! s:check_back_space() abort</span><br><span class="line">Â  let col = col(&#x27;.&#x27;) - 1</span><br><span class="line">Â  return !col || getline(&#x27;.&#x27;)[col - 1]Â  =~# &#x27;\s&#x27;</span><br><span class="line">endfunction</span><br><span class="line">&quot; æ–¹ä¾¿åœ¨ä¸­æ–‡ä¸­é—´ä½¿ç”¨ w å’Œ b ç§»åŠ¨</span><br><span class="line">nmap &lt;silent&gt; w &lt;Plug&gt;(coc-ci-w)</span><br><span class="line">nmap &lt;silent&gt; b &lt;Plug&gt;(coc-ci-b)</span><br><span class="line"></span><br><span class="line">&quot; Use &lt;cr&gt; for confirm completion, `&lt;C-g&gt;u` means break undo chain at current position.</span><br><span class="line">&quot; Coc only does snippet and additional edit on confirm.</span><br><span class="line">inoremap &lt;expr&gt; &lt;cr&gt; pumvisible() ? &quot;\&lt;C-y&gt;&quot; : &quot;\&lt;C-g&gt;u\&lt;CR&gt;&quot;</span><br><span class="line">&quot; Remap keys for gotos</span><br><span class="line">nmap &lt;silent&gt; gd &lt;Plug&gt;(coc-definition)</span><br><span class="line">nmap &lt;silent&gt; gy &lt;Plug&gt;(coc-type-definition)</span><br><span class="line">nmap &lt;silent&gt; gi &lt;Plug&gt;(coc-implementation)</span><br><span class="line">nmap &lt;silent&gt; gr &lt;Plug&gt;(coc-references)</span><br><span class="line">&quot; Use K for show documentation in preview window</span><br><span class="line">nnoremap &lt;silent&gt; K :call &lt;SID&gt;show_documentation()&lt;CR&gt;</span><br><span class="line">function! s:show_documentation()</span><br><span class="line">Â  if &amp;filetype == &#x27;vim&#x27;</span><br><span class="line">Â  Â  execute &#x27;h &#x27;.expand(&#x27;&lt;cword&gt;&#x27;)</span><br><span class="line">Â  else</span><br><span class="line">Â  Â  call CocAction(&#x27;doHover&#x27;)</span><br><span class="line">Â  endif</span><br><span class="line">endfunction</span><br><span class="line">&quot; Highlight symbol under cursor on CursorHold</span><br><span class="line">set updatetime=300</span><br><span class="line">autocmd CursorHold * silent call CocActionAsync(&#x27;highlight&#x27;)</span><br><span class="line">autocmd CursorHoldI * sil call CocActionAsync(&#x27;showSignatureHelp&#x27;)</span><br><span class="line">&quot; Remap for rename current word</span><br><span class="line">nmap &lt;leader&gt;rn &lt;Plug&gt;(coc-rename)</span><br><span class="line">&quot; æ³¨é‡Šæ‰ï¼Œä¸€èˆ¬ä½¿ç”¨ `Space` `r` `f` ç›´æ¥æ ¼å¼åŒ–æ•´ä¸ªæ–‡ä»¶</span><br><span class="line">&quot; Remap for format selected region</span><br><span class="line">&quot; vmap &lt;leader&gt;fÂ  &lt;Plug&gt;(coc-format-selected)</span><br><span class="line">&quot; nmap &lt;leader&gt;fÂ  &lt;Plug&gt;(coc-format-selected)</span><br><span class="line">augroup mygroup</span><br><span class="line">Â  autocmd!</span><br><span class="line">Â  &quot; Setup formatexpr specified filetype(s).</span><br><span class="line">Â  autocmd FileType typescript,json setl formatexpr=CocAction(&#x27;formatSelected&#x27;)</span><br><span class="line">Â  &quot; Update signature help on jump placeholder</span><br><span class="line">Â  autocmd User CocJumpPlaceholder call CocActionAsync(&#x27;showSignatureHelp&#x27;)</span><br><span class="line">augroup end</span><br><span class="line">&quot; Remap for do codeAction of selected region, ex: `&lt;leader&gt;aap` for current paragraph</span><br><span class="line">vmap &lt;leader&gt;aÂ  &lt;Plug&gt;(coc-codeaction-selected)</span><br><span class="line">nmap &lt;leader&gt;aÂ  &lt;Plug&gt;(coc-codeaction-selected)</span><br><span class="line">&quot; Remap for do codeAction of current line</span><br><span class="line">nmap &lt;leader&gt;acÂ  &lt;Plug&gt;(coc-codeaction)</span><br><span class="line">&quot; Fix autofix problem of current line</span><br><span class="line">nmap &lt;leader&gt;qfÂ  &lt;Plug&gt;(coc-fix-current)</span><br><span class="line">&quot; Use `:Format` for format current buffer</span><br><span class="line">&quot; command! -nargs=0 Format :call CocAction(&#x27;format&#x27;)</span><br><span class="line">call SpaceVim#custom#SPC(&#x27;nnoremap&#x27;, [&#x27;r&#x27;, &#x27;f&#x27;], &quot;call CocAction(&#x27;format&#x27;)&quot;, &#x27;format file with coc.nvim&#x27;, 1)</span><br><span class="line">&quot; Use `:Fold` for fold current buffer</span><br><span class="line">command! -nargs=? Fold :callÂ  Â  Â CocAction(&#x27;fold&#x27;, &lt;f-args&gt;)</span><br><span class="line">&quot; auto import for go on save</span><br><span class="line">autocmd BufWritePre *.go :call CocAction(&#x27;runCommand&#x27;, &#x27;editor.action.organizeImport&#x27;)</span><br><span class="line">&quot; è¿™ä¸ªå’Œ SpaceVim çš„ statusline/tabline å†²çªäº†</span><br><span class="line">&quot; Add diagnostic info for https://github.com/itchyny/lightline.vim</span><br><span class="line">&quot; let g:lightline = &#123;</span><br><span class="line">&quot;Â  Â  Â  Â \ &#x27;colorscheme&#x27;: &#x27;wombat&#x27;,</span><br><span class="line">&quot;Â  Â  Â  Â \ &#x27;active&#x27;: &#123;</span><br><span class="line">&quot;Â  Â  Â  Â \Â  Â &#x27;left&#x27;: [ [ &#x27;mode&#x27;, &#x27;paste&#x27; ],</span><br><span class="line">&quot;Â  Â  Â  Â \Â  Â  Â  Â  Â  Â  Â [ &#x27;cocstatus&#x27;, &#x27;readonly&#x27;, &#x27;filename&#x27;, &#x27;modified&#x27; ] ]</span><br><span class="line">&quot;Â  Â  Â  Â \ &#125;,</span><br><span class="line">&quot;Â  Â  Â  Â \ &#x27;component_function&#x27;: &#123;</span><br><span class="line">&quot;Â  Â  Â  Â \Â  Â &#x27;cocstatus&#x27;: &#x27;coc#status&#x27;</span><br><span class="line">&quot;Â  Â  Â  Â \ &#125;,</span><br><span class="line">&quot;Â  Â  Â  Â \ &#125;</span><br><span class="line"></span><br><span class="line">&quot; Using CocList</span><br><span class="line">&quot; Show all diagnostics</span><br><span class="line">nnoremap &lt;silent&gt; &lt;leader&gt;dÂ  :&lt;C-u&gt;CocList diagnostics&lt;cr&gt;</span><br><span class="line"></span><br><span class="line">&quot; ä¸‹é¢æ˜¯ ccls æä¾›çš„ LSP Extension</span><br><span class="line">&quot; https://github.com/MaskRay/ccls/wiki/coc.nvim</span><br><span class="line">&quot; Manage extensions</span><br><span class="line">&quot; nnoremap &lt;silent&gt; &lt;space&gt;eÂ  :&lt;C-u&gt;CocList extensions&lt;cr&gt;</span><br><span class="line">&quot; Show commands</span><br><span class="line">&quot; nnoremap &lt;silent&gt; &lt;space&gt;cÂ  :&lt;C-u&gt;CocList commands&lt;cr&gt;</span><br><span class="line">&quot; Find symbol of current document</span><br><span class="line">&quot; nnoremap &lt;silent&gt; &lt;space&gt;oÂ  :&lt;C-u&gt;CocList outline&lt;cr&gt;</span><br><span class="line">&quot; Search workspace symbols</span><br><span class="line">&quot; nnoremap &lt;silent&gt; &lt;space&gt;sÂ  :&lt;C-u&gt;CocList -I symbols&lt;cr&gt;</span><br><span class="line">&quot; Do default action for next item.</span><br><span class="line">&quot; nnoremap &lt;silent&gt; &lt;space&gt;jÂ  :&lt;C-u&gt;CocNext&lt;CR&gt;</span><br><span class="line">&quot; Do default action for previous item.</span><br><span class="line">&quot; nnoremap &lt;silent&gt; &lt;space&gt;kÂ  :&lt;C-u&gt;CocPrev&lt;CR&gt;</span><br><span class="line">&quot; Resume latest coc list</span><br><span class="line">&quot; nnoremap &lt;silent&gt; &lt;space&gt;pÂ  :&lt;C-u&gt;CocListResume&lt;CR&gt;</span><br><span class="line">nn &lt;silent&gt; xl :call CocLocations(&#x27;ccls&#x27;,&#x27;$ccls/navigate&#x27;,&#123;&#x27;direction&#x27;:&#x27;D&#x27;&#125;)&lt;cr&gt;</span><br><span class="line">nn &lt;silent&gt; xk :call CocLocations(&#x27;ccls&#x27;,&#x27;$ccls/navigate&#x27;,&#123;&#x27;direction&#x27;:&#x27;L&#x27;&#125;)&lt;cr&gt;</span><br><span class="line">nn &lt;silent&gt; xj :call CocLocations(&#x27;ccls&#x27;,&#x27;$ccls/navigate&#x27;,&#123;&#x27;direction&#x27;:&#x27;R&#x27;&#125;)&lt;cr&gt;</span><br><span class="line">nn &lt;silent&gt; xh :call CocLocations(&#x27;ccls&#x27;,&#x27;$ccls/navigate&#x27;,&#123;&#x27;direction&#x27;:&#x27;U&#x27;&#125;)&lt;cr&gt;</span><br><span class="line">noremap x &lt;Nop&gt;</span><br><span class="line">nn &lt;silent&gt; xb :call CocLocations(&#x27;ccls&#x27;,&#x27;$ccls/inheritance&#x27;)&lt;cr&gt;</span><br><span class="line">&quot; bases of up to 3 levels</span><br><span class="line">nn &lt;silent&gt; xb :call CocLocations(&#x27;ccls&#x27;,&#x27;$ccls/inheritance&#x27;,&#123;&#x27;levels&#x27;:3&#125;)&lt;cr&gt;</span><br><span class="line">&quot; derived</span><br><span class="line">nn &lt;silent&gt; xd :call CocLocations(&#x27;ccls&#x27;,&#x27;$ccls/inheritance&#x27;,&#123;&#x27;derived&#x27;:v:true&#125;)&lt;cr&gt;</span><br><span class="line">&quot; derived of up to 3 levels</span><br><span class="line">nn &lt;silent&gt; xD :call CocLocations(&#x27;ccls&#x27;,&#x27;$ccls/inheritance&#x27;,&#123;&#x27;derived&#x27;:v:true,&#x27;levels&#x27;:3&#125;)&lt;cr&gt;</span><br><span class="line">&quot; caller</span><br><span class="line">nn &lt;silent&gt; xc :call CocLocations(&#x27;ccls&#x27;,&#x27;$ccls/call&#x27;)&lt;cr&gt;</span><br><span class="line">&quot; callee</span><br><span class="line">nn &lt;silent&gt; xC :call CocLocations(&#x27;ccls&#x27;,&#x27;$ccls/call&#x27;,&#123;&#x27;callee&#x27;:v:true&#125;)&lt;cr&gt;</span><br><span class="line">&quot; $ccls/member</span><br><span class="line">&quot; member variables / variables in a namespace</span><br><span class="line">nn &lt;silent&gt; xm :call CocLocations(&#x27;ccls&#x27;,&#x27;$ccls/member&#x27;)&lt;cr&gt;</span><br><span class="line">&quot; member functions / functions in a namespace</span><br><span class="line">nn &lt;silent&gt; xf :call CocLocations(&#x27;ccls&#x27;,&#x27;$ccls/member&#x27;,&#123;&#x27;kind&#x27;:3&#125;)&lt;cr&gt;</span><br><span class="line">&quot; nested classes / types in a namespace</span><br><span class="line">nn &lt;silent&gt; xs :call CocLocations(&#x27;ccls&#x27;,&#x27;$ccls/member&#x27;,&#123;&#x27;kind&#x27;:2&#125;)&lt;cr&gt;</span><br><span class="line">nmap &lt;silent&gt; xt &lt;Plug&gt;(coc-type-definition)&lt;cr&gt;</span><br><span class="line">nn &lt;silent&gt; xv :call CocLocations(&#x27;ccls&#x27;,&#x27;$ccls/vars&#x27;)&lt;cr&gt;</span><br><span class="line">nn &lt;silent&gt; xV :call CocLocations(&#x27;ccls&#x27;,&#x27;$ccls/vars&#x27;,&#123;&#x27;kind&#x27;:1&#125;)&lt;cr&gt;</span><br><span class="line">nn xx x</span><br></pre></td></tr></table></figure><p>defx.nvim</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&quot; defx å°†ä¼šè‡ªåŠ¨å¿½ç•¥å¦‚ä¸‹çš„æ–‡ä»¶</span><br><span class="line">call defx#custom#option(&#x27;_&#x27;, &#123;</span><br><span class="line">Â  Â  \ &#x27;ignored_files&#x27;: &quot;.*,*.class,*.out,*.o,*.bc,*.a,compile_commands.json,*.d,*.mod*,*.cmd,.tmp_versions/,modules.order,Module.symvers,Mkfile.old,dkms.conf,*.ko,*.elf,*.img&quot;,</span><br><span class="line">Â  Â  \ &#125;)</span><br></pre></td></tr></table></figure><p>åˆ›å»ºautoloadç›®å½•ï¼Œæ–°å»ºmyspacevim.vim</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">func! myspacevim#before() abort</span><br><span class="line">Â  Â  let g:coc_config_home = &#x27;~/.SpaceVim.d/&#x27;</span><br><span class="line">Â  Â  &quot; ç„¦ç‚¹æ¶ˆå¤±çš„æ—¶å€™è‡ªåŠ¨ä¿å­˜</span><br><span class="line">Â  Â  au FocusLost * :wa</span><br><span class="line">Â  Â  au FocusGained,BufEnter * :checktime</span><br><span class="line">Â  Â  &quot; å½“æ–‡ä»¶è¢«å…¶ä»–ç¼–è¾‘å™¨ä¿®æ”¹æ—¶ï¼Œè‡ªåŠ¨åŠ è½½</span><br><span class="line">Â  Â  set autowrite</span><br><span class="line">Â  Â  set autoread</span><br><span class="line">Â  Â  &quot; è®¾ç½®æŒ‰ç…§syntaxé«˜äº®è¿›è¡ŒæŠ˜å </span><br><span class="line">Â  Â  set foldmethod=syntax</span><br><span class="line">Â  Â  set nofoldenable</span><br><span class="line">Â  Â  &quot; é‡æ–°æ˜ å°„ leader é”®</span><br><span class="line">Â  Â  let g:mapleader = &#x27;,&#x27;</span><br><span class="line">Â  Â  &quot; é‡æ–°æ˜ å°„ window é”®ä½</span><br><span class="line">Â  Â  let g:spacevim_windows_leader = &#x27;c&#x27;</span><br><span class="line">Â  Â  call SpaceVim#custom#SPC(&#x27;nnoremap&#x27;, [&#x27;s&#x27;, &#x27;f&#x27;], &#x27;Vista finder coc&#x27;, &#x27;search simbols&#x27;, 1)</span><br><span class="line">Â  Â  call SpaceVim#custom#SPC(&#x27;nnoremap&#x27;, [&#x27;s&#x27;, &#x27;F&#x27;], &#x27;LeaderfFunction!&#x27;, &#x27;list functions&#x27;, 1)</span><br><span class="line">Â  Â  let g:Lf_ShortcutF = &quot;&lt;leader&gt;s&quot;</span><br><span class="line">Â  Â  &quot; è®© leaderf å¯ä»¥æœç´¢ git çš„ submoduleï¼Œå¦åˆ™æ˜¯è‡ªåŠ¨å¿½ç•¥çš„</span><br><span class="line">Â  Â  let g:Lf_RecurseSubmodules = 1</span><br><span class="line">Â  Â  let g:spacevim_snippet_engine = &#x27;ultisnips&#x27;</span><br><span class="line">Â  Â  let g:table_mode_corner=&#x27;|&#x27;</span><br><span class="line">Â  Â  &quot; è°ƒèŠ‚ window å¤§å°</span><br><span class="line">Â  Â  let g:winresizer_start_key = &#x27;&lt;space&gt;wa&#x27;</span><br><span class="line">Â  Â  &quot; If you cancel and quit window resize mode by `q` (keycode 113)</span><br><span class="line">Â  Â  let g:winresizer_keycode_cancel = 113</span><br><span class="line">Â  Â  &quot; è®©file tree æ˜¾ç¤ºæ–‡ä»¶å›¾æ ‡ï¼Œéœ€è¦ terminal å®‰è£… nerd font</span><br><span class="line">Â  Â  let g:spacevim_enable_vimfiler_filetypeicon = 1</span><br><span class="line">Â  Â  &quot; è®© filetree æ˜¾ç¤º git çš„çŠ¶æ€ï¼Œä¼šå˜å¾—å¾ˆå¡ï¼Œæ‰€ä»¥å…³æ‰</span><br><span class="line">Â  Â  let g:spacevim_enable_vimfiler_gitstatus = 1</span><br><span class="line">Â  Â  &quot; é»˜è®¤ markdown preview åœ¨åˆ‡æ¢åˆ°å…¶ä»–çš„ buffer æˆ–è€… vim</span><br><span class="line">Â  Â  &quot; å¤±å»ç„¦ç‚¹çš„æ—¶å€™ä¼šè‡ªåŠ¨å…³é—­ previewï¼Œè®©</span><br><span class="line">Â  Â  let g:mkdp_auto_close = 0</span><br><span class="line">Â  Â  &quot; ä¹¦ç­¾é€‰ä¸­ä¹‹åè‡ªåŠ¨å…³é—­ quickfix window</span><br><span class="line">Â  Â  let g:bookmark_auto_close = 1</span><br><span class="line">Â  Â  &quot; vim-lsp-cxx-highlight å’Œè¿™ä¸ªé€‰é¡¹å­˜åœ¨å†²çª</span><br><span class="line">Â  Â  &quot; let g:rainbow_active = 1</span><br><span class="line">Â  Â  &quot; ctrl + ] æŸ¥è¯¢ cppman</span><br><span class="line">Â  Â  &quot; å¦‚æœæƒ³è®©è¯¥å¿«æ·é”®è‡ªåŠ¨æŸ¥è¯¢ manï¼Œå°†Cppman æ›¿æ¢ä¸º Cppman!</span><br><span class="line">Â  Â  autocmd FileType c,cpp noremap &lt;C-]&gt; &lt;Esc&gt;:execute &quot;Cppman &quot; . expand(&quot;&lt;cword&gt;&quot;)&lt;CR&gt;</span><br><span class="line">Â  Â  &quot; è®©å…‰æ ‡è‡ªåŠ¨è¿›å…¥åˆ°popup window ä¸­é—´</span><br><span class="line">Â  Â  let g:git_messenger_always_into_popup = v:true</span><br><span class="line">Â  Â  &quot; è®¾ç½®æ˜ å°„è§„åˆ™ï¼Œå’Œ spacevim ä¿æŒä¸€è‡´</span><br><span class="line">Â  Â  call SpaceVim#custom#SPC(&#x27;nnoremap&#x27;, [&#x27;g&#x27;, &#x27;m&#x27;], &#x27;GitMessenger&#x27;, &#x27;show commit message in popup window&#x27;, 1)</span><br><span class="line">Â  Â  call SpaceVim#custom#SPC(&#x27;nnoremap&#x27;, [&#x27;g&#x27;, &#x27;l&#x27;], &#x27;FloatermNew lazygit&#x27;, &#x27;open lazygit in floaterm&#x27;, 1)</span><br><span class="line">Â  Â  &quot; è®¾ç½®é»˜è®¤çš„pdfé˜…è§ˆå·¥å…·</span><br><span class="line">Â  Â  let g:vimtex_view_method = &#x27;zathura&#x27;</span><br><span class="line">Â  Â  &quot; å…³é—­æ‰€æœ‰éšè—è®¾ç½®</span><br><span class="line">let g:tex_conceal = &quot;&quot;</span><br><span class="line">Â  Â  &quot; å®ç°ä¸€é”®è¿è¡Œå„ç§æ–‡ä»¶ï¼Œé€‚åˆéäº¤äº’å¼çš„ï¼Œå°‘é‡çš„ä»£ç ï¼Œæ¯”å¦‚ leetcode</span><br><span class="line">Â  Â  func! QuickRun()</span><br><span class="line">Â  Â  Â  Â  exec &quot;w&quot;</span><br><span class="line">Â  Â  Â  Â  let ext = expand(&quot;%:e&quot;)</span><br><span class="line">Â  Â  Â  Â  let file = expand(&quot;%&quot;)</span><br><span class="line">Â  Â  Â  Â  if ext ==# &quot;sh&quot;</span><br><span class="line">Â  Â  Â  Â  Â  Â  exec &quot;!sh %&quot;</span><br><span class="line">Â  Â  Â  Â  elseif ext ==# &quot;cpp&quot;</span><br><span class="line">Â  Â  Â  Â  Â  Â  exec &quot;!clang++ % -Wall -O3 -g -std=c++17 -o %&lt;.out &amp;&amp; ./%&lt;.out&quot;</span><br><span class="line">Â  Â  Â  Â  elseif ext ==# &quot;c&quot;</span><br><span class="line">Â  Â  Â  Â  Â  Â  exec &quot;!clang % -Wall -g -std=c11 -o %&lt;.out &amp;&amp; ./%&lt;.out&quot;</span><br><span class="line">Â  Â  Â  Â  elseif ext ==# &quot;java&quot;</span><br><span class="line">Â  Â  Â  Â  Â  Â  let classPath = expand(&#x27;%:h&#x27;)</span><br><span class="line">Â  Â  Â  Â  Â  Â  let className = expand(&#x27;%:p:t:r&#x27;)</span><br><span class="line">Â  Â  Â  Â  Â  Â  &quot; echo classPath</span><br><span class="line">Â  Â  Â  Â  Â  Â  &quot; echo className</span><br><span class="line">Â  Â  Â  Â  Â  Â  exec &quot;!javac %&quot;</span><br><span class="line">Â  Â  Â  Â  Â  Â  exec &quot;!java -classpath &quot; . classPath . &quot; &quot; . className</span><br><span class="line">Â  Â  Â  Â  elseif ext ==# &quot;go&quot;</span><br><span class="line">Â  Â  Â  Â  Â  Â  exec &quot;!go run %&quot;</span><br><span class="line">Â  Â  Â  Â  elseif ext ==# &quot;js&quot;</span><br><span class="line">Â  Â  Â  Â  Â  Â  exec &quot;!node %&quot;</span><br><span class="line">Â  Â  Â  Â  elseif ext ==# &quot;bin&quot;</span><br><span class="line">Â  Â  Â  Â  Â  Â  exec &quot;!readelf -h %&quot;</span><br><span class="line">Â  Â  Â  Â  elseif ext ==# &quot;py&quot;</span><br><span class="line">Â  Â  Â  Â  Â  Â  exec &quot;!python3 %&quot;</span><br><span class="line">Â  Â  Â  Â  elseif ext ==# &quot;vim&quot;</span><br><span class="line">Â  Â  Â  Â  Â  Â  exec &quot;so %&quot;</span><br><span class="line">Â  Â  Â  Â  elseif ext ==# &quot;html&quot;</span><br><span class="line">Â  Â  Â  Â  Â  Â  exec &quot;!google-chrome-stable %&quot;</span><br><span class="line">Â  Â  Â  Â  elseif ext ==# &quot;rs&quot;</span><br><span class="line">Â  Â  Â  Â  Â  Â  call CargoRun()</span><br><span class="line">Â  Â  Â  Â  else</span><br><span class="line">Â  Â  Â  Â  Â  Â  echo &quot;Check file type !&quot;</span><br><span class="line">Â  Â  Â  Â  endif</span><br><span class="line">Â  Â  Â  Â  echo &#x27;done&#x27;</span><br><span class="line">Â  Â  endf</span><br><span class="line">Â  Â  &quot; ä¸€é”®è¿è¡Œ rust å·¥ç¨‹ï¼Œä¸æ–­å‘ä¸ŠæŸ¥æ‰¾ç›´åˆ°é‡åˆ° Cargo.tomlï¼Œç„¶åæ‰§è¡Œ cargo run</span><br><span class="line">Â  Â  func! CargoRun()</span><br><span class="line">Â  Â  Â  let cargo_run_path = fnamemodify(resolve(expand(&#x27;%:p&#x27;)), &#x27;:h&#x27;)</span><br><span class="line">Â  Â  Â  while cargo_run_path != &quot;/&quot;</span><br><span class="line">Â  Â  Â  Â  if filereadable(cargo_run_path . &quot;/Cargo.toml&quot;)</span><br><span class="line">Â  Â  Â  Â  Â  Â  echo cargo_run_path</span><br><span class="line">Â  Â  Â  Â  Â  Â  exec &quot;cd &quot; . cargo_run_path</span><br><span class="line">Â  Â  Â  Â  Â  Â  exec &quot;!cargo run&quot;</span><br><span class="line">Â  Â  Â  Â  Â  Â  exec &quot;cd -&quot;</span><br><span class="line">Â  Â  Â  Â  Â  Â  return</span><br><span class="line">Â  Â  Â  Â  endif</span><br><span class="line">Â  Â  Â  Â let cargo_run_path = fnamemodify(cargo_run_path, &#x27;:h&#x27;)</span><br><span class="line">Â  Â  Â  endwhile</span><br><span class="line">Â  Â  Â  echo &quot;Cargo.toml not found !&quot;</span><br><span class="line">Â  Â  endf</span><br><span class="line">endf</span><br><span class="line">func! myspacevim#after() abort</span><br><span class="line">Â  Â  &quot; &lt;F3&gt; æ‰“å¼€æ–‡ä»¶æ ‘</span><br><span class="line">Â  Â  nnoremapÂ  &lt;F4&gt;Â  :call QuickRun()&lt;CR&gt;</span><br><span class="line">Â  Â  &quot; &lt;F5&gt; floaterm toggle</span><br><span class="line">Â  Â  &quot; &lt;F7&gt; æ‰“å¼€å†å²è®°å½•</span><br><span class="line">Â  Â  tnoremapÂ  &lt;Esc&gt;Â  &lt;C-\&gt;&lt;C-n&gt;</span><br><span class="line">Â  Â  map &lt;Tab&gt; :wincmd w&lt;CR&gt;</span><br><span class="line">Â  Â  &quot; press &lt;esc&gt; to cancel.</span><br><span class="line">Â  Â  nmap f &lt;Plug&gt;(coc-smartf-forward)</span><br><span class="line">Â  Â  nmap F &lt;Plug&gt;(coc-smartf-backward)</span><br><span class="line">Â  Â  nmap ; &lt;Plug&gt;(coc-smartf-repeat)</span><br><span class="line">Â  Â  nmap , &lt;Plug&gt;(coc-smartf-repeat-opposite)</span><br><span class="line">Â  Â  augroup Smartf</span><br><span class="line">Â  Â  Â  autocmd User SmartfEnter :hi Conceal ctermfg=220 guifg=pink</span><br><span class="line">Â  Â  Â  autocmd User SmartfLeave :hi Conceal ctermfg=239 guifg=#504945</span><br><span class="line">Â  Â  augroup end</span><br><span class="line">Â  Â  inoremapÂ  Â &lt;silent&gt;Â  Â &lt;C-n&gt;Â  Â  Â :FloatermNew&lt;CR&gt;</span><br><span class="line">Â  Â  nnoremapÂ  Â &lt;silent&gt;Â  Â &lt;C-n&gt;Â  Â  :FloatermNew&lt;CR&gt;</span><br><span class="line">Â  Â  tnoremapÂ  Â &lt;silent&gt;Â  Â &lt;C-n&gt;Â  Â  &lt;C-\&gt;&lt;C-n&gt;:FloatermNew&lt;CR&gt;</span><br><span class="line">Â  Â  inoremapÂ  Â &lt;silent&gt;Â  Â &lt;C-h&gt;Â  Â  Â :FloatermPrev&lt;CR&gt;</span><br><span class="line">Â  Â  nnoremapÂ  Â &lt;silent&gt;Â  Â &lt;C-h&gt;Â  Â  :FloatermPrev&lt;CR&gt;</span><br><span class="line">Â  Â  tnoremapÂ  Â &lt;silent&gt;Â  Â &lt;C-h&gt;Â  Â  &lt;C-\&gt;&lt;C-n&gt;:FloatermPrev&lt;CR&gt;</span><br><span class="line">Â  Â  inoremapÂ  Â &lt;silent&gt;Â  Â &lt;C-l&gt;Â  Â  Â :FloatermNext&lt;CR&gt;</span><br><span class="line">Â  Â  nnoremapÂ  Â &lt;silent&gt;Â  Â &lt;C-l&gt;Â  Â  :FloatermNext&lt;CR&gt;</span><br><span class="line">Â  Â  tnoremapÂ  Â &lt;silent&gt;Â  Â &lt;C-l&gt;Â  Â  &lt;C-\&gt;&lt;C-n&gt;:FloatermNext&lt;CR&gt;</span><br><span class="line"></span><br><span class="line">Â  Â  &quot; ä¿è¯åœ¨æ’å…¥æ¨¡å¼&lt;F5&gt;å¯ä»¥ toggle floaterm</span><br><span class="line">Â  Â  &quot; æ¥ï¼Œæå‡ºä¸€ä¸ªè‡ªå·±çš„ç¬¬ä¸€ä¸ª pull request !</span><br><span class="line">Â  Â  inoremapÂ  &lt;silent&gt;Â  Â &lt;F5&gt;Â  Â :FloatermToggle!&lt;CR&gt;</span><br><span class="line">Â  Â  nnoremapÂ  &lt;silent&gt;Â  Â &lt;F5&gt;Â  Â :FloatermToggle!&lt;CR&gt;</span><br><span class="line">Â  Â  tnoremapÂ  &lt;silent&gt;Â  Â &lt;F5&gt;Â  Â &lt;C-\&gt;&lt;C-n&gt;:FloatermToggle!&lt;CR&gt;</span><br><span class="line">Â  Â  &quot; go highlight</span><br><span class="line">Â  Â  &quot; https://github.com/neoclide/coc.nvim/issues/472</span><br><span class="line">Â  Â  let g:go_list_type=&quot;quickfix&quot;</span><br><span class="line">Â  Â  let g:go_fmt_command=&quot;goimports&quot;</span><br><span class="line">Â  Â  let g:go_highlight_types=1</span><br><span class="line">Â  Â  let g:go_highlight_fields=1</span><br><span class="line">Â  Â  let g:go_highlight_functions=1</span><br><span class="line">Â  Â  let g:go_highlight_function_calls=1</span><br><span class="line">Â  Â  let g:go_fmt_fail_silently=1</span><br><span class="line">endf</span><br></pre></td></tr></table></figure><p>åˆ›å»ºcocçš„é»˜è®¤é…ç½®æ–‡ä»¶ï¼ŒåŸæœ¬cocçš„é…ç½®æ–‡ä»¶åº”è¯¥æ˜¯åœ¨~&#x2F;.SpaceVimä¸‹çš„ï¼Œä½†æ˜¯åœ¨autoloadçš„é…ç½®æ–‡ä»¶ä¸­ï¼Œè®¾ç½®äº†coc_config_homeï¼Œä¿®æ”¹ä¸º.SpaceVim.dä¸‹ï¼Œæ–¹ä¾¿æ§åˆ¶ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">&quot;languageserver&quot;: &#123;</span><br><span class="line">&quot;ccls&quot;: &#123;</span><br><span class="line">&quot;command&quot;: &quot;ccls&quot;,</span><br><span class="line">&quot;filetypes&quot;: [&quot;c&quot;, &quot;cpp&quot;],</span><br><span class="line">&quot;rootPatterns&quot;: [&quot;compile_commands.json&quot;, &quot;.git/&quot;],</span><br><span class="line">&quot;index&quot;: &#123;</span><br><span class="line">&quot;threads&quot;: 8</span><br><span class="line">&#125;,</span><br><span class="line">&quot;initializationOptions&quot;: &#123;</span><br><span class="line">&quot;cache&quot;: &#123;</span><br><span class="line">&quot;directory&quot;: &quot;build/.ccls-cache&quot;</span><br><span class="line">&#125;,</span><br><span class="line">&quot;highlight&quot;: &#123;</span><br><span class="line">&quot;lsRanges&quot;: true</span><br><span class="line">&#125;,</span><br><span class="line">&quot;compilationDatabaseDirectory&quot;: &quot;build&quot;</span><br><span class="line">&#125;,</span><br><span class="line">&quot;client&quot;: &#123;</span><br><span class="line">&quot;snippetSupport&quot;: true</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h1><p>å¯åŠ¨nvimçš„æ—¶å€™ï¼Œå°±ä¼šå¼€å§‹å®‰è£…æ‰€æœ‰çš„æ’ä»¶ï¼Œç­‰å¸¦æœ€ç»ˆé…ç½®å®Œæˆã€‚</p><p>ç°åœ¨è¿›å»ä¸€ä¸ªC++çš„é¡¹ç›®é‡Œï¼Œç”±äºcclséœ€è¦çŸ¥é“é¡¹ç›®éƒ½ä½¿ç”¨äº†å“ªäº›æ–‡ä»¶ï¼Œæ‰€ä»¥éœ€è¦æˆ‘ä»¬ä¸ºå®ƒåˆ›å»ºé…ç½®æ–‡ä»¶ï¼Œå¦‚æœé¡¹ç›®æ˜¯CMakeçš„ï¼Œå¯ä»¥ç›´æ¥æ‰§è¡Œå‘½ä»¤ç”Ÿæˆcompile_commands.jsonæ–‡ä»¶ï¼Œå¦‚æœä¸æ˜¯CMakeçš„é¡¹ç›®ï¼Œåˆ™éœ€è¦ä½¿ç”¨bearå¯¹Makefileè¿›è¡Œç¼–è¯‘ï¼Œbearä¼šæ‹¦æˆªç¼–è¯‘ä¿¡æ¯ï¼Œæœ€ç»ˆç”Ÿæˆcompile_commands.jsonã€‚</p><p>CMakeï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cmake -DCMAKE_EXPORT_COMPILE_COMMANDS=ON</span><br></pre></td></tr></table></figure><p>Makefileï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">bear -- make</span><br></pre></td></tr></table></figure><p>ç­‰æ–‡ä»¶ç”Ÿæˆå®Œæ¯•åï¼Œä½¿ç”¨lnå‘½ä»¤å°†æ–‡ä»¶è½¯é“¾å›é¡¹ç›®æ ¹ç›®å½•ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ln -sf build/compile_commands.json compile_commands.json</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶å·²ç»é…ç½®å®Œæˆä¸€åŠäº†ï¼Œæˆ‘ä»¬è¿˜éœ€è¦åœ¨æ ¹ç›®å½•åˆ›å»º.cclsæ–‡ä»¶ï¼Œå¹¶å†™å…¥ä¸€ä¸‹é…ç½®ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">%compile_commands.json</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶cclså°±å¯ä»¥è¯»å–compile_commands.jsonçš„ä¿¡æ¯ï¼Œä¸ºæˆ‘ä»¬æä¾›è‡ªåŠ¨è¡¥å…¨ç­‰åŠŸèƒ½äº†ã€‚</p><img src="/2020/12/23/ccls/ccls.png" class="" title="å›¾ç‰‡"><h1 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h1><h2 id="å¦‚æœå‡ºç°äº†æ‰¾ä¸åˆ°vimprocåŠ¨æ€åº“"><a href="#å¦‚æœå‡ºç°äº†æ‰¾ä¸åˆ°vimprocåŠ¨æ€åº“" class="headerlink" title="å¦‚æœå‡ºç°äº†æ‰¾ä¸åˆ°vimprocåŠ¨æ€åº“"></a>å¦‚æœå‡ºç°äº†æ‰¾ä¸åˆ°vimprocåŠ¨æ€åº“</h2><p>åœ¨nvimä¸­æ‰§è¡Œ <code>:VimProcInstall</code>è¿›è¡Œé‡æ–°ç¼–è¯‘ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> vim </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Qtå¤šçº¿ç¨‹</title>
      <link href="/2020/11/17/qt-multi-thread/"/>
      <url>/2020/11/17/qt-multi-thread/</url>
      
        <content type="html"><![CDATA[<p>ç±»å‹æ³¨å†Œ Qt æœ‰ä¸‰ç§å¤šçº¿ç¨‹çš„æ–¹å¼ï¼Œåˆ†åˆ«æ˜¯ç»§æ‰¿ QThreadã€ä½¿ç”¨ QObject çš„ moveToThread å‡½æ•°å’Œ Qtconcurrent åç¨‹ã€‚</p><p>åœ¨å¾ˆå¤šæ–‡ç« ä¸­ï¼Œå¤§å®¶éƒ½æ¨èç»§æ‰¿ QThread ç±»ï¼Œå¹¶é‡å†™ run æ–¹æ³•ï¼Œåœ¨ run ä¸­ä½¿ç”¨è€—æ—¶æ“ä½œä»£ç ã€‚è¿™ç§æ–¹å¼è®©æˆ‘ä»¬è§‰å¾— QThread æ˜¯çº¿ç¨‹çš„å®ä½“ã€‚åˆ›å»ºä¸€ä¸ª QThread å¯¹è±¡å°±è®¤ä¸ºæ˜¯å¼€è¾Ÿäº†ä¸€ä¸ªæ–°çš„çº¿ç¨‹ã€‚è¿™ç§è®¨å·§çš„æ–¹æ³•ä¼¼ä¹èƒ½å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿå…¥é—¨ï¼Œä½†æ˜¯åªè¦æ·±åº¦äº†è§£å¤šçº¿ç¨‹ç¼–ç¨‹å°±ä¼šå‘ç°ï¼Œè¿™æ ·å­åšä¼šä½¿ä»£ç è„±ç¦»æˆ‘ä»¬çš„æ§åˆ¶ï¼Œä»£ç è¶Šå†™è¶Šå¤æ‚ã€‚æœ€å…¸å‹çš„é—®é¢˜å°±æ˜¯æ˜æ˜å°†ä»£ç æ”¾å…¥äº†æ–°çº¿ç¨‹ï¼Œä½†æ˜¯ä»ç„¶åœ¨æ—§çº¿ç¨‹ä¸­è¿è¡Œã€‚</p><span id="more"></span><p><strong>æˆ‘ä»¬åº”è¯¥æŠŠè€—æ—¶ä»£ç æ”¾åœ¨å“ªé‡Œï¼Ÿ</strong></p><p>æš‚æ—¶ä¸è€ƒè™‘å¤šçº¿ç¨‹çš„æƒ…å†µï¼Œæˆ‘ä»¬ä¸€èˆ¬éƒ½ä¼šå°†è€—æ—¶ä»£ç å°è£…åˆ°ä¸€ä¸ªç±»ä¸­ã€‚åœ¨è€ƒè™‘å¤šçº¿ç¨‹çš„æƒ…å†µä¸‹ï¼Œéš¾é“æˆ‘ä»¬è¦å°†ä»£ç å‰¥ç¦»å‡ºæ¥æ”¾åˆ°æŸä¸ªåœ°æ–¹å—ï¼Ÿå…¶å®ä¸ç”¨è¿™ä¹ˆéº»çƒ¦ã€‚åœ¨ qt4 æ—¶ä»£ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ç»§æ‰¿ QThread çš„æ–¹æ³•ï¼Œè¿™æ ·ä¼šç ´åæˆ‘ä»¬åŸæœ‰çš„ä»£ç ç»“æ„ï¼Œå¹¶ä¸” run æ–¹æ³•åªèƒ½è¿è¡Œä¸€æ®µä»£ç ï¼Œå¦‚æœæˆ‘ä»¬æœ‰æˆåƒä¸Šä¸‡ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬æ€»ä¸èƒ½å°è£…å¦‚æ­¤å¤šçš„ QThreadã€‚</p><p>æ‰€ä»¥åœ¨ Qt5 ä¸­ï¼ŒQt åº“å®Œå–„äº†çº¿ç¨‹çš„äº²å’Œæ€§ä»¥åŠä¿¡å·æ§½æœºåˆ¶ï¼Œæˆ‘ä»¬æœ‰äº†æ›´ä¸ºä¼˜é›…çš„ä½¿ç”¨çº¿ç¨‹çš„æ–¹å¼ï¼Œå³ QObject::moveToThread()ã€‚è¿™ä¹Ÿæ˜¯å®˜æ–¹æ¨èçš„åšæ³•ã€‚</p><p>æˆ‘ä»¬å‡†å¤‡ä¸¤ä¸ªç±»æ¥ä»‹ç»å’Œè§£é‡Šä¸€ä¸‹å·¥ä½œæµç¨‹ã€‚</p><p>controller.hpp</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> CONTROLLER_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> CONTROLLER_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QObject&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QDebug&gt;</span></span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Controller</span> : <span class="keyword">public</span> QObject &#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">Controller</span><span class="params">(QObject *parent = <span class="literal">nullptr</span>)</span></span></span><br><span class="line"><span class="function">        : QObject(parent) &#123;</span>&#125;</span><br><span class="line">signals:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">requestPing</span><span class="params">()</span></span>;</span><br><span class="line"><span class="keyword">public</span> slots:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">pong</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">qDebug</span>() &lt;&lt; Q_FUNC_INFO &lt;&lt; <span class="keyword">this</span>-&gt;<span class="built_in">thread</span>();</span><br><span class="line">        <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;pong&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">// CONTROLLER_H</span></span></span><br></pre></td></tr></table></figure><p>handler.hpp</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> HANDLEER_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> HANDLEER_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QObject&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QDebug&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QThread&gt;</span></span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Handler</span> : <span class="keyword">public</span> QObject &#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">Handler</span><span class="params">(QObject *parent = <span class="literal">nullptr</span>)</span></span></span><br><span class="line"><span class="function">Â  Â  Â  Â  : QObject(parent) &#123;</span>&#125;</span><br><span class="line">signals:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">requestPong</span><span class="params">()</span></span>;</span><br><span class="line"><span class="keyword">public</span> slots:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">ping</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">qDebug</span>() &lt;&lt; Q_FUNC_INFO &lt;&lt; <span class="keyword">this</span>-&gt;<span class="built_in">thread</span>();</span><br><span class="line">        <span class="function">emit <span class="title">requestPong</span><span class="params">()</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">// HANDLEER_H</span></span></span><br></pre></td></tr></table></figure><p>åœ¨ main.cpp ä¸­åˆå§‹åŒ–å¯¹è±¡ï¼Œå¹¶è¿æ¥ä¿¡å·å’Œæ§½ã€‚</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QCoreApplication&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QThread&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;controller.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;handleer.h&quot;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span> </span>&#123;</span><br><span class="line">    <span class="function">QCoreApplication <span class="title">a</span><span class="params">(argc, argv)</span></span>;</span><br><span class="line">    QThread* handleThread = <span class="keyword">new</span> QThread;</span><br><span class="line">    Controller* controller = <span class="keyword">new</span> Controller;</span><br><span class="line">    Handler* handler = <span class="keyword">new</span> Handler;</span><br><span class="line">    <span class="comment">// ç§»åŠ¨å¯¹è±¡åˆ°æ–°çš„çº¿ç¨‹</span></span><br><span class="line">    handler-&gt;<span class="built_in">moveToThread</span>(handleThread);</span><br><span class="line">    handleThread-&gt;<span class="built_in">start</span>();</span><br><span class="line">    <span class="comment">// å°†å¯¹è±¡çš„ä¿¡å·çš„æ§½ç»‘å®šï¼Œæ³¨æ„å¿…é¡»åœ¨ moveToThread ä¹‹åé“¾æ¥ã€‚</span></span><br><span class="line">    QObject::<span class="built_in">connect</span>(controller, &amp;Controller::requestPing, handler, &amp;Handler::ping);</span><br><span class="line">    QObject::<span class="built_in">connect</span>(handler, &amp;Handler::requestPong, controller, &amp;Controller::pong);</span><br><span class="line">    emit controller-&gt;<span class="built_in">requestPing</span>();</span><br><span class="line">    <span class="keyword">return</span> a.<span class="built_in">exec</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çœ‹ä¸€ä¸‹æ‰§è¡Œç»“æœ:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">void Handler::ping() QThread(0x14ee080)</span><br><span class="line">void Controller::pong() QThread(0x14e9e60)</span><br><span class="line">pong</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºæ¥ä¸¤ä¸ªå‡½æ•°è·å–åˆ°çš„QThreadå¯¹è±¡å¹¶ä¸æ˜¯åŒä¸€ä¸ªäº†ã€‚<br>ä½¿ç”¨ movetothread å°†ä¸€ä¸ªå¯¹è±¡ç§»åŠ¨åˆ°æ–°çš„çº¿ç¨‹ï¼Œå¹¶é€šè¿‡ä¿¡å·è°ƒç”¨ç›®æ ‡å‡½æ•°ï¼Œä»è€Œè¾¾åˆ°åœ¨æ–°çº¿ç¨‹æ‰§è¡Œçš„ç›®çš„ã€‚</p><p>ä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥æ–¹ä¾¿çš„é€šè¿‡æ“ä½œQThreadå¯¹è±¡æ¥æ§åˆ¶çº¿ç¨‹çš„æ‰§è¡Œï¼Œä¾‹å¦‚è®¾ç½®çº¿ç¨‹çš„ä¼˜å…ˆçº§åˆ«ï¼Œæš‚åœçº¿ç¨‹æˆ–è€…æ¢å¤çº¿ç¨‹ã€‚å¹¶ä¸”è¿™ç§æ–¹å¼æ¯”ç»§æ‰¿QThreadå¯ä»¥æ›´åŠ ç›´è§‚çš„æ„Ÿå—åˆ°ï¼ŒQThreadåªæ˜¯ä¸€ä¸ªçº¿ç¨‹çš„ç®¡ç†ç±»ï¼Œè€Œä¸æ˜¯çº¿ç¨‹å®ä½“ï¼Œå¦‚æœé‡‡ç”¨ç»§æ‰¿çš„æ–¹å¼ï¼Œåˆ™ä¼šè®¤ä¸ºQThreadå°±æ˜¯çº¿ç¨‹å®ä½“ï¼Œä»è€Œé€ æˆä¸€å®šçš„è®¤çŸ¥æ··ä¹±ã€‚</p><p>è¿˜æœ‰ä¸€ç§å¤šçº¿ç¨‹çš„æ–¹å¼ï¼Œè¿™ç§æ–¹æ¡ˆæ›´åŠ çš„çµæ´»ï¼Œä¸éœ€è¦æˆ‘ä»¬newæ–°çš„QThreadå¯¹è±¡ï¼Œæ˜¯ä¸€ä¸ªè¾ƒé«˜å±‚æ¬¡çš„APIå°è£…ã€‚QtConCurrentå¯æ ¹æ®è®¡ç®—æœºçš„ CPU æ ¸æ•°ï¼Œè‡ªåŠ¨è°ƒæ•´è¿è¡Œçš„çº¿ç¨‹æ•°ç›®ã€‚</p><p>åœ¨ä½¿ç”¨Qtconcurrentä¹‹å‰éœ€è¦æ·»åŠ å¯¹åº”çš„Qtæ¨¡å—concurrentã€‚</p><p>åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ ä¸€ä¸ªQFutureWatcherå¯¹è±¡ï¼Œç”¨æ¥æ§åˆ¶å’Œæ‰§è¡Œä¸€ä¸ªQFutureå¯¹è±¡ï¼Œå¹¶ä¸”é€šè¿‡finishedä¿¡å·æ¥æ”¶QFutureå¯¹è±¡çš„æ‰§è¡Œç»“æœã€‚</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">QFutureWatcher&lt;<span class="type">bool</span>&gt;* watcher = <span class="keyword">new</span> <span class="built_in">QFutureWatcher</span>&lt;<span class="type">bool</span>&gt;();</span><br><span class="line">QObject::<span class="built_in">connect</span>(watcher, &amp;QFutureWatcher&lt;<span class="type">bool</span>&gt;::finished, watcher, [=] &#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">bool</span> result = watcher-&gt;<span class="built_in">result</span>();</span><br><span class="line">    <span class="built_in">qDebug</span>() &lt;&lt; result;</span><br><span class="line">    watcher-&gt;<span class="built_in">deleteLater</span>();</span><br><span class="line">&#125;);</span><br><span class="line">QFuture&lt;<span class="type">bool</span>&gt; future = QtConcurrent::<span class="built_in">run</span>([=]() -&gt; <span class="type">bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;);</span><br><span class="line">watcher-&gt;<span class="built_in">setFuture</span>(future);</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šå°±æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œä¸éš¾å‘ç°ï¼ŒQtä¸ºæˆ‘ä»¬æä¾›äº†ç›¸å½“ä¸é”™çš„è§£å†³æ–¹æ¡ˆï¼Œè¿™ç§å½¢å¼æ¯”è¾ƒç±»ä¼¼äºQDbuså¯¹è±¡ä½¿ç”¨QDbusPendingCallWatcheræ¥å¼‚æ­¥è·å–ç»“æœçš„æ–¹å¼ï¼Œä½¿ç”¨èµ·æ¥éå¸¸å®¹æ˜“ä¸Šæ‰‹ã€‚<br>åœ¨ä½¿ç”¨å¤šçº¿ç¨‹çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦æ³¨æ„ä¸€äº›äº‹æƒ…ï¼šäº’æ–¥ä¸åŒæ­¥åŒæ­¥ï¼Œç±»å‹æ³¨å†Œï¼Œåœ¨çº¿ç¨‹ä¸­å¼€è¾Ÿçº¿ç¨‹ã€‚</p><p>åœ¨å¤šçº¿ç¨‹å¼€å‘ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ³¨æ„çš„åœ°æ–¹å°±æœ‰ç‚¹å¤šäº†ï¼Œæœ€é‡è¦çš„å°±æ˜¯çº¿ç¨‹åŒæ­¥ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸€äº›æ‰‹æ®µï¼Œè®©ä¸åŒçº¿ç¨‹ä¸­çš„å‡½æ•°å¯ä»¥æ­£ç¡®çš„è®¿é—®çš„æ•°æ®ã€‚</p><ul><li>äº’æ–¥ï¼šä¸€ä¸ªå…¬å…±èµ„æºåŒä¸€æ—¶åˆ»åªèƒ½è¢«ä¸€ä¸ªè¿›ç¨‹æˆ–çº¿ç¨‹ä½¿ç”¨ï¼Œå¤šä¸ªè¿›ç¨‹æˆ–çº¿ç¨‹ä¸èƒ½åŒæ—¶ä½¿ç”¨å…¬å…±èµ„æºã€‚</li><li>åŒæ­¥ï¼šä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„è¿›ç¨‹æˆ–çº¿ç¨‹åœ¨è¿è¡Œè¿‡ç¨‹ä¸­ååŒæ­¥è°ƒï¼ŒæŒ‰é¢„å®šçš„å…ˆåæ¬¡åºè¿è¡Œã€‚</li></ul><p>è§£å†³æ–¹æ³•ï¼šäº’æ–¥é”ï¼Œæ¡ä»¶å˜é‡ï¼Œè¯»å†™é”ï¼Œè‡ªæ—‹é”ï¼Œä¿¡å·é‡ï¼ˆäº’æ–¥ä¸åŒæ­¥ï¼‰ã€‚</p><p>åœ¨Qtç¼–ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨Qtçš„ä¿¡å·ä¸æ§½æœºåˆ¶å®ç°ä¸¤ä¸ªå¯¹è±¡çš„é€šä¿¡ï¼Œæ— è®ºä¸¤ä¸ªå¯¹è±¡æ˜¯å¦åœ¨åŒä¸€ä¸ªçº¿ç¨‹ï¼Œä½†æ˜¯æˆ‘ä»¬ä¼ é€’å‚æ•°éœ€è¦æ³¨å†Œç»™Qtçš„å…ƒå¯¹è±¡ç³»ç»Ÿï¼Œå¦åˆ™Qtå°†æ— æ³•å®Œæˆæ•°æ®ä¼ é€’ã€‚</p><p>åœ¨Qtä¸­æ³¨å†Œè‡ªå®šä¹‰ç±»å‹æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯qRegisterMetaType<T>()å‡½æ•°å’ŒQ_DECLARE_METATYPE(Type)å®ã€‚</p><p>è¿™ä¸¤ç§æ³¨å†Œæ–¹å¼æœ‰ä¸åŒçš„ä½œç”¨ã€‚ä½¿ç”¨qRegisterMetaType<T>()å‡½æ•°å¯ä»¥è®©è‡ªå®šä¹‰ç±»å‹åœ¨Qtçš„ä¿¡å·æ§½ä¸­ä¼ é€’ï¼Œè€ŒQ_DECLARE_METATYPE(Type)å®åˆ™æ˜¯å¯ä»¥è®©æ³¨å†Œçš„è‡ªå®šä¹‰ç±»å‹ä½¿ç”¨QVariantè¿›è¡ŒåŒ…è£…ã€‚</p><p>åœ¨å¤šçº¿ç¨‹å¼€å‘ä¸­æˆ‘ä»¬è¿˜éœ€è¦æ³¨æ„ï¼ŒQtå­˜åœ¨åŠè‡ªåŠ¨å†…å­˜ç®¡ç†ï¼Œè¿™ä¸ªå†…å­˜ç®¡ç†æ–¹å¼ä¼šå½±å“ç€æˆ‘ä»¬ä½¿ç”¨å¤šçº¿ç¨‹å¼€å‘ã€‚æˆ‘ä»¬åœ¨åˆ›å»ºæ–°çš„QObjectå¯¹è±¡æ—¶ï¼Œå¦‚æœåˆ¶å®šäº†parentï¼Œåˆ™è¯¥å¯¹è±¡å°†ä¸çˆ¶å¯¹è±¡è¿›è¡Œçº¿ç¨‹ç»‘å®šã€‚å¦‚æœä¸¤ä¸ªå¯¹è±¡åœ¨ä¸åŒçš„çº¿ç¨‹ä¸­ï¼ŒQtä¼šè­¦å‘Šæˆ‘ä»¬çˆ¶å¯¹è±¡çš„çº¿ç¨‹å’Œå½“å‰å¯¹è±¡çš„çº¿ç¨‹ä¸æ˜¯åŒä¸€ä¸ªï¼Œä»–ä»¬å°†æ— æ³•ä½¿ç”¨Qtçš„connectå‡½æ•°è¿›è¡Œæ¶ˆæ¯ä¼ é€’ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Qt </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>deepin-wineä¸­æ–‡ä¹±ç </title>
      <link href="/2020/09/17/deepin-wine-chinese-problem/"/>
      <url>/2020/09/17/deepin-wine-chinese-problem/</url>
      
        <content type="html"><![CDATA[<p>ä¼—æ‰€å‘¨çŸ¥ï¼Œä½¿ç”¨wineæ¥è¿è¡Œwindowsä¸‹çš„ä¸€äº›è½¯ä»¶æ˜¯linuxç”¨æˆ·çš„å¸¸ç”¨æ“ä½œï¼Œdeepinä¸ºç¤¾åŒºè´¡çŒ®äº†å¥½å‡ æ¬¾ä¸­å›½ç”¨æˆ·å¿…å¤‡çš„è½¯ä»¶ï¼Œä¾‹å¦‚QQã€å¾®ä¿¡ã€ä¼ä¸šå¾®ä¿¡ï¼Œä»¥æ­¤æ¥è®©æ›´å¤šçš„äººæ— ç—›çš„åˆ‡æ¢åˆ°linuxæ¥ã€‚è¿‘å¹´æ¥valueä¹Ÿä¸€ç›´åœ¨linuxä¸Šå¸ƒå±€ï¼Œå…ˆåæ¨å‡ºäº†steamä¸»æœºå’Œproton,å‰è€…æ˜¯åŸºäºkvmå’Œsteamå¤§å±å¹•æ¨¡å¼çš„ç³»ç»Ÿï¼Œè€Œprotonåˆ™æ˜¯wineçš„åˆ†æ”¯ï¼Œvalueæä¾›äº†å‡ ç»„è¡¥ä¸ç”¨æ¥æé«˜æ€§èƒ½å’Œä¸Windowsæ¸¸æˆçš„å…¼å®¹æ€§ã€‚</p><p>Archä¸Šæœ‰éå¸¸æ–¹ä¾¿çš„aurä»“åº“ï¼Œæœ‰å¾ˆå¤šç”¨æˆ·éƒ½è‡ªå·±æäº¤ä¸€äº›è½¯ä»¶åˆ°aurä¸Šé¢ï¼Œå°±æœ‰å‡ ä¸ªç»´æŠ¤è€…å°†deepinæ‰“åŒ…çš„deepin wineå’Œå¯¹åº”çš„è½¯ä»¶åŒ…ç§»æ¤åˆ°Archä¸Šé¢æ¥ï¼Œå·²ç»æ˜¯å¾ˆå¤šäººåœ¨Archä¸Šé¢è¿è¡ŒQQå’Œå¾®ä¿¡çš„é¦–é€‰æ–¹æ¡ˆã€‚</p><p>ä½†æ˜¯ä½¿ç”¨çš„è¿‡ç¨‹ä¸­æˆ‘é‡åˆ°äº†ä»¥ä¸‹å‡ ä¸ªé—®é¢˜ï¼š</p><ul><li>è¾“å…¥æ¡†ä¸­æ–‡ä¹±ç </li><li>åœ¨DDEæ¡Œé¢ä½¿ç”¨kwinçš„æƒ…å†µä¸‹æœ€å°åŒ–ä¼šå¡æ­»</li><li>KDEæ¡Œé¢ç¯å¢ƒæ— æ³•ä½¿ç”¨deepin wineçš„ç¨‹åº</li></ul><p>ç¬¬äºŒä¸ªé—®é¢˜æ¯”è¾ƒç‰¹æ®Šï¼Œå› ä¸ºddeåœ¨deepinå’Œuosä¸‹è¿è¡Œçš„æ˜¯forkç‰ˆæœ¬çš„kwin,è€ŒArchä¸Šè¿è¡Œçš„åˆ™æ˜¯åŸç‰ˆçš„kwin,ä¸€äº›æ“ä½œä»£ç å¹¶ä¸å…·å¤‡ï¼Œæ‰€ä»¥ä¼šå‡ºç°ä¸€äº›å¥‡è‘©çš„çŠ¶å†µã€‚</p><p>ç¬¬ä¸‰ä¸ªé—®é¢˜åˆ™æ˜¯xsettingsçš„åŸå› ï¼Œåœ¨ç§»æ¤è€…çš„ä»“åº“æœ‰å¯¹åº”çš„issueè®¨è®º <a href="https://github.com/wszqkzqk/deepin-wine-ubuntu/issues/12">ã€ŠKDEç¯å¢ƒå®Œå…¨æ— æ³•ä½¿ç”¨wine-timã€‹</a></p><p>ç¬¬ä¸€ä¸ªé—®é¢˜è§£å†³èµ·æ¥ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œæ˜¯å› ä¸ºç¼ºå°‘äº†å®‹ä½“æ–‡ä»¶ï¼Œä»è€Œæ— æ³•æ­£ç¡®çš„æ¸²æŸ“ä¸­æ–‡å­—ä½“ã€‚è€Œæ¯”è¾ƒå¥‡è‘©çš„æ˜¯ï¼ŒæŠŠæ–¹å—å¤åˆ¶å†ç²˜è´´ï¼Œå°±å¯ä»¥æ­£ç¡®çš„æ¸²æŸ“äº†ã€‚</p><p>è§£å†³çš„æ–¹æ³•ä¹Ÿå¾ˆç®€å•ï¼ŒæŠŠwindowsçš„çš„å­—ä½“å¤åˆ¶è¿‡æ¥å°±å¯ä»¥äº†ã€‚ç”±äºç‰ˆæƒçš„é—®é¢˜ï¼Œæ²¡åŠæ³•ç›´æ¥æä¾›æ–‡ä»¶ï¼Œéœ€è¦å„ä½è‡ªå·±å¤åˆ¶äº†ã€‚</p><blockquote><p>å¼•ç”¨èµ„æ–™</p></blockquote><p><a href="https://github.com/wszqkzqk/deepin-wine-ubuntu/issues/136#issuecomment-517576733">https://github.com/wszqkzqk/deepin-wine-ubuntu/issues/136</a></p>]]></content>
      
      
      <categories>
          
          <category> æŠ€æœ¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨rEFIndæ¥å®‰å…¨å¯åŠ¨ç³»ç»Ÿ</title>
      <link href="/2020/09/08/use-refind-to-boot-system/"/>
      <url>/2020/09/08/use-refind-to-boot-system/</url>
      
        <content type="html"><![CDATA[<p>ä»Šå¹´çš„ä¸ƒå¤•ï¼Œæˆ‘è€å©†ç»™æˆ‘ä¹°äº†ä¸€å°surface laptop 2ä»£ï¼Œ8Gå†…å­˜ + 256Gå­˜å‚¨ç‰ˆæœ¬ï¼Œæˆ‘ä¹ŸæˆåŠŸçš„ç”¨ä¸Šäº†ç”°ç‰Œçš„æœºå™¨ã€‚</p><span id="more"></span><blockquote><p>2020&#x2F;09&#x2F;17æ›´æ–°ï¼š ä¸çŸ¥é“ä¸ºå•¥ï¼Œåæ­£æ˜¯å¼€äº†å¯¹å†…æ ¸ç­¾åä»¥åï¼Œå“ªæ€•æ˜¯BIOSå…³é—­äº†å®‰å…¨å¯åŠ¨ï¼Œä»ç„¶å‡ºç°mkinitcpioä¼šå¡åœ¨autodetectä¸Šï¼Œæ— å¥ˆå…¨éƒ¨éƒ½åˆ æ‰é‡æ¥äº†ï¼Œæ²¡æœ‰å¼„ç­¾åï¼Œå¸Œæœ›å„ä½çœ‹åˆ°æœ¬æ–‡ç« ä»¥åè§£å†³äº†è¿™ä¸ªé—®é¢˜èƒ½å›å¤ä¸€ä¸‹ï¼Œè°¢è°¢ã€‚</p></blockquote><p>surfaceé»˜è®¤æ˜¯å¼€å¯äº†å®‰å…¨å¯åŠ¨(Microsoftç­¾å)å’Œbitlockeræ¥ä¿éšœè®¾å¤‡å’Œç³»ç»Ÿå®‰å…¨ï¼Œæˆ‘ä½œä¸ºä¸€ä¸ªlinuxç³»ç»Ÿçš„å¼€å‘è€…ï¼Œå½“ç„¶æ˜¯éœ€è¦åœ¨surfaceä¸Šè£…ä¸€ä¸ªlinuxäº†ï¼Œä½†æ˜¯å‰ä¸¤å¹´zccrså·²ç»è¸©è¿‡å‘äº†ï¼Œlinuxä¸è¯†åˆ«surfaceé”®ç›˜ï¼ŒåŒæ ·çš„è§¦æ‘¸ã€ç½‘å¡ã€å£°å¡ç­‰è®¾å¤‡ä¹Ÿå·¥ä½œçš„ä¸æ˜¯å¾ˆæ­£å¸¸ï¼Œæœ¬æ¥ä»¥ä¸ºæˆ‘è¦å¼€å¯è¿œç¨‹å¼€å‘çš„ç”Ÿæ´»äº†ï¼Œè¿˜ç‰¹æ„å†™äº†ä¸€ç¯‡<a href="https://blog.justforlxz.com/2020/09/03/use-vscode-to-remotely-develop-dde/">ã€Šä½¿ç”¨VSCodeè¿œç¨‹å¼€å‘DDEã€‹</a>ï¼Œæ¥ç»™å…¬å¸é‡Œæœ‰åŒæ ·çƒ¦æ¼çš„äººï¼Œè®©ä»–ä»¬ä¹Ÿæ„Ÿå—ä¸€ä¸‹è¿œç¨‹å¼€å‘çš„é­…åŠ›ã€‚</p><p>è‹å¤©ä¸è´Ÿæœ‰å¿ƒäººï¼Œæˆ‘æˆåŠŸçš„ï¼</p><p>æˆ‘æˆåŠŸçš„ä½¿ç”¨ä¸Šäº†ArchLinux,å¹¶ä¸”å·¥ä½œçš„ååˆ†è‰¯å¥½ã€‚è¿™å¤šäºäº†githubä¸Šçš„ä¸€ä¸ªç»„ç»‡<a href="https://github.com/linux-surface/linux-surface/">linux-surface</a>ï¼Œæœ‰è¿™ä¹ˆä¸€äº›äººï¼Œä»–ä»¬ä»˜å‡ºåŠ³åŠ¨æ¥è®©æ‰‹é‡Œçš„surfaceè®¾å¤‡ä¹Ÿç”¨ä¸Šlinux,å¹¶ä¸”è¦å’Œæ™®é€šçš„x86å…¼å®¹æœºä¸€æ ·å·¥ä½œï¼Œæ„Ÿè°¢ä»–ä»¬çš„ä»˜å‡ºï¼Œä¹Ÿè®©æˆ‘åƒä¸Šäº†èƒèŸ¹ï¼Œå®‰è£…çš„è¿‡ç¨‹æˆ‘å°±ä¸åœ¨è¿™é‡Œè¯¦ç»†è¯´äº†ï¼Œå…¶å®éå¸¸ç®€å•ã€‚</p><p>é¦–å…ˆå› ä¸ºsurfaceåªæœ‰ä¸€ä¸ªusbå£ï¼Œè€Œé”®ç›˜å¹¶ä¸èƒ½å·¥ä½œï¼Œæ‰€ä»¥éœ€è¦ä¸€ä¸ªusbçš„æ‰©å±•å™¨ã€‚å…ˆæŒ‰fn+f6è¿›bioså…³é—­æ‰å®‰å…¨å¯åŠ¨ï¼Œä¿®æ”¹å¼•å¯¼é¡ºåºä¸ºusbä¼˜å…ˆï¼Œä¹‹åå°±æ˜¯æ­£å¸¸çš„å®‰è£…ç³»ç»Ÿï¼Œä½†æ˜¯ä¸éœ€è¦å®‰è£…ä»“åº“é‡Œçš„å†…æ ¸ï¼Œæˆ‘ä»¬éœ€è¦å®‰è£…linux-surfaceæä¾›çš„ä»“åº“é‡Œçš„å†…æ ¸ã€‚</p><p>è¿™äº›éƒ½æ˜¯éå¸¸æ­£å¸¸çš„æ­¥éª¤ï¼Œlinux-surfaceæä¾›äº†è‡ªå·±çš„ä»“åº“å’Œå†…æ ¸ï¼Œæˆ‘ä»¬æ­£å¸¸ä½¿ç”¨å³å¯ã€‚</p><p>è¿™é‡Œå¼€å§‹å°±æ˜¯æˆ‘ç ”ç©¶äº†åŠå¤©çš„å†…å®¹ï¼Œ <strong>å¼€å¯å®‰å…¨æ¨¡å¼!</strong></p><p>é¦–å…ˆæˆ‘çœ‹äº†ä¸€ä¸‹arch wikiä¸Šæœ‰å…³äºå®‰å…¨å¯åŠ¨çš„å†…å®¹ï¼Œå†™çš„æŒºè¯¦ç»†çš„ï¼Œå°±æ˜¯çœ‹ä¸æ‡‚ã€‚è®²äº†å„ç§çš„çŸ¥è¯†ç‚¹ï¼Œå„ç§ç­¾åçš„æ–¹å¼ï¼Œä½†æ˜¯çœŸæ­£åˆ°æˆ‘å¼€å§‹ç”¨çš„æ—¶å€™ï¼Œæˆ‘æ˜¯ä¸€ç›´å¤±è´¥çš„ï¼Œå¤±è´¥çš„æ–¹å¼æˆ‘å°±ä¸è¯´äº†ï¼Œç›´æ¥è¯´æˆ‘å¦‚ä½•æˆåŠŸçš„ã€‚</p><p>é¦–å…ˆæˆ‘æ”¾å¼ƒäº†grub,ä¸€ä¸ªåŸå› æ˜¯grubçš„å®‰å…¨å¯åŠ¨æˆ‘ä¸€ç›´æ²¡æœ‰å°è¯•æˆåŠŸï¼Œå¦å¤–ä¸€ä¸ªæ˜¯æˆ‘åªæœ‰ä¸€ä¸ªç³»ç»Ÿï¼Œæ²¡å¿…è¦ç”¨grubã€‚æˆ‘æ¢æˆäº†rEFIndæ¥ä½œä¸ºæˆ‘çš„bootloaderï¼Œé¦–å…ˆå®‰è£…rEFIndçš„å¼•å¯¼ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">yay -S refind shim-signed sbsigntools</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo refind-install --shim /usr/share/shim-signed/shimx64.efi --localkeys</span><br></pre></td></tr></table></figure><p>æ¥è§£é‡Šä¸€ä¸‹ä¸Šé¢ä¸¤æ¡æ˜ä»¤ã€‚ç¬¬ä¸€ä¸ªæ˜¯å®‰è£…å¿…è¦çš„è½¯ä»¶åŒ…ï¼Œrefindæ˜¯bootloaderæœ¬ä½“ï¼Œshim-signedæ˜¯auré‡Œé¢çš„ç”¨äºå®‰å…¨å¯åŠ¨çš„åŒ…ï¼Œshimæä¾›äº†ä¸€ç§å¹¶è¡Œçš„å®‰å…¨å¯åŠ¨éªŒè¯åŠŸèƒ½ï¼Œæˆ‘ä»¬ä½¿ç”¨å®ƒæ¥å¯åŠ¨refindçš„efi,å†é€šè¿‡refindçš„efiå¯åŠ¨å†…æ ¸ï¼Œè¾¾åˆ°ç»ˆæå¥—å¨ƒå¯åŠ¨ã€‚sbsigntoolsæ˜¯ç”¨äºç»™æ–‡ä»¶ç­¾åçš„å·¥å…·ï¼Œæˆ‘ä»¬å®‰è£…å®Œrefindä»¥åï¼Œrefindä¼šå¸®åŠ©æˆ‘ä»¬ç”Ÿæˆä¸€ä»½é»˜è®¤çš„key,æˆ‘ä»¬éœ€è¦ä½¿ç”¨è¿™ä¸ªkeyæ¥ä¸ºå†…æ ¸è¿›è¡Œç­¾åã€‚</p><p>åœ¨æ‰§è¡Œç¬¬äºŒæ¡æ˜ä»¤ä»¥åï¼Œä¼šæœ‰å‡ æ¬¡è¯¢é—®ï¼Œéƒ½é€‰æ‹©Yå›è½¦å°±è¡Œã€‚</p><p>ç„¶åä½¿ç”¨sbsigntoolsæ¥å¯¹å†…æ ¸è¿›è¡Œç­¾åã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo sbsign --key /etc/refind.d/keys/refind_local.key --cert /etc/refind.d/keys/refind_local.crt --output /boot/vmlinuz-linux-surface /boot/vmlinuz-linux-surface</span><br></pre></td></tr></table></figure><p>å‡†å¤‡å·¥ä½œå·²ç»è¿›è¡Œä¸€åŠäº†ï¼Œæˆ‘ä»¬åªéœ€è¦å†™ä¸€ä¸‹refindçš„é…ç½®æ–‡ä»¶ï¼Œå°±å¯ä»¥å¯åŠ¨äº†ã€‚</p><p>refindçš„é…ç½®æ–‡ä»¶æœ‰ä¸¤ä¸ªåœ°æ–¹ï¼Œä¸€ä¸ªæ˜¯bootåˆ†åŒºä¸‹é¢çš„refind_linux.confï¼Œè¿˜æœ‰ä¸€ä¸ªæ˜¯åœ¨efiåˆ†åŒºé‡Œçš„EFI&#x2F;refind&#x2F;refind.confï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹çš„æ˜¯åè€…ã€‚</p><p>é»˜è®¤é…ç½®æ–‡ä»¶éƒ½æ˜¯æ³¨é‡Šçš„ï¼Œå…¶å®æˆ‘ä»¬å…¨éƒ¨åˆ äº†å°±å¯ä»¥äº†ï¼Œæœ‰éœ€è¦ä¿®æ”¹çš„åœ°æ–¹å»çœ‹åŸå§‹æ–‡ä»¶æˆ–è€…æ–‡æ¡£å°±è¡Œäº†ã€‚</p><p>æ·»åŠ ä¸€ä¸ªmenuentryï¼Œå°±å¯ä»¥å¯åŠ¨ç³»ç»Ÿäº†ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">also_scan_dirs +,ArchFS/boot</span><br><span class="line">dont_scan_dirs ESP:/EFI/boot,EFI/boot</span><br><span class="line">dont_scan_files shim.efi,MokManager.efi,fbx64.efi,mmx64.efi,shimx64.efi</span><br><span class="line">scan_all_linux_kernels false</span><br><span class="line"></span><br><span class="line">menuentry &quot;Arch Linux&quot; &#123;</span><br><span class="line">    icon     /EFI/refind/icons/os_arch.png</span><br><span class="line">    volume   8B131F77-62D7-4B4A-82D4-B60D7ACA2F6C</span><br><span class="line">    loader   /ArchFS/boot/vmlinuz-linux-surface</span><br><span class="line">    initrd   /ArchFS/boot/intel-ucode.img</span><br><span class="line">    initrd   /ArchFS/boot/initramfs-linux-surface.img</span><br><span class="line">    options  &quot;root=UUID=9f8f9556-8ec1-4feb-9519-435beac8376f rw rootflags=subvol=ArchFS  loglevel=3 quiet add_efi_memmap&quot;</span><br><span class="line">    submenuentry &quot;Boot using fallback initramfs&quot; &#123;</span><br><span class="line">        initrd /ArchFS/boot/initramfs-linux-surface-fallback.img</span><br><span class="line">    &#125;</span><br><span class="line">    submenuentry &quot;Boot to terminal&quot; &#123;</span><br><span class="line">        add_options &quot;systemd.unit=multi-user.target&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ç”¨çš„æ˜¯btrfsæ–‡ä»¶ç³»ç»Ÿï¼Œæ‰€ä»¥é…ç½®æ–‡ä»¶æœ‰ç‚¹ç½—å—¦ã€‚è§£é‡Šä¸€ä¸‹ä¸Šé¢çš„å†…å®¹ã€‚</p><p>also_scan_dirsæ˜¯æŒ‡å®šæ‰«ææŸä¸ªç›®å½•ï¼Œå› ä¸ºæˆ‘æ˜¯btrfsæ–‡ä»¶ç³»ç»Ÿï¼Œå¿…é¡»ä½¿ç”¨è¿™ä¸ªæ‰èƒ½è®©refindæ‰«æåˆ°å†…æ ¸æ–‡ä»¶ï¼Œå¦åˆ™ä¼šæ— æ³•å¯åŠ¨ã€‚</p><p>dont_scan_dirsæ˜¯è·³è¿‡æŒ‡å®šçš„ç›®å½•ï¼Œå› ä¸ºrefindé»˜è®¤æ˜¯ä¼šæ‰«ææ‰€æœ‰çš„efiæ–‡ä»¶ï¼Œæˆ‘ä»¬è‡ªå·±æä¾›äº†emnuentry,æ‰€ä»¥ä¸éœ€è¦è®©å®ƒæ‰«æäº†ã€‚</p><p>dont_scan_filesæ˜¯è·³è¿‡æŒ‡å®šçš„æ–‡ä»¶ï¼Œè¿™é‡Œæ˜¯é˜²æ­¢å…¶ä»–ç›®å½•å‡ºç°å¯¹åº”çš„efiä¹Ÿè¢«æ‰«æåˆ°ã€‚</p><p>scan_all_linux_kernelsæ˜¯æ‰«ææ‰€æœ‰linuxå†…æ ¸ï¼Œè¿™æ ·æ‰€æœ‰çš„å†…æ ¸å°±ä¼šå‡ºç°åœ¨å¯åŠ¨åˆ—è¡¨é‡Œï¼Œæˆ‘ä»¬åŒæ ·ä¹Ÿæ˜¯ä¸éœ€è¦çš„ã€‚</p><p>menuentryé‡Œé¢éœ€è¦ä¿®æ”¹çš„åœ°æ–¹æœ‰ï¼Œvolumeæ˜¯åˆ†åŒºçš„partuuid,æˆ‘å› ä¸ºè¿™ä¸ªuuidå°±æµ‹è¯•äº†å¥½å‡ æ¬¡ï¼Œæœ€åæ‰ååº”è¿‡æ¥ä¸æ˜¯filesystem uuid,è¦æ±‚çš„æ˜¯partition uuid. æ‰€æœ‰é‡åˆ°ArchFSçš„åœ°æ–¹éƒ½æ˜¯ä¸éœ€è¦çš„ï¼Œå› ä¸ºbtrfsæ”¯æŒå­—å·ï¼Œæˆ‘çš„ç³»ç»Ÿæ˜¯åœ¨ä¸€ä¸ªå«ArchFSçš„å·é‡Œé¢çš„ï¼Œå¦‚æœä¸æ˜¯btrfsçš„æ–‡ä»¶ç³»ç»Ÿï¼Œè¿™ä¸ªæ˜¯ä¸éœ€è¦çš„ï¼ŒåŒæ ·optionsé‡Œçš„rootflagsé€‰é¡¹ä¹Ÿæ˜¯ä¸éœ€è¦çš„ï¼Œè¿™æ˜¯ä¼ é€’ç»™å†…æ ¸çš„å‚æ•°ï¼Œè®©å†…æ ¸å¯ä»¥æ­£ç¡®çš„åŠ è½½æ ¹åˆ†åŒºã€‚</p><p>è¿™æ ·å°±ç®—å®Œå·¥äº†ï¼Œé‡å¯ç³»ç»Ÿï¼Œç„¶åè¿›biosé‡ŒæŠŠå®‰å…¨å¯åŠ¨æ”¹æˆMicrosoft &amp; 3rd party CAï¼Œç„¶åé‡æ–°å¯åŠ¨ã€‚</p><p>å½“ç¬¬ä¸€æ¬¡åŠ è½½rEFIndçš„æ—¶å€™ï¼Œå› ä¸ºæˆ‘ä»¬çš„è¯ä¹¦æ˜¯æ‰ç”Ÿæˆçš„ï¼Œä¸»æ¿å¹¶æ²¡æœ‰å­˜å‚¨å¯¹åº”çš„ç­¾åï¼ŒrEFIndä¼šå¯åŠ¨mmx64.efiæ¥è®©æˆ‘ä»¬åŠ è½½è¯ä¹¦ï¼Œè¯ä¹¦çš„ä½ç½®åœ¨<code>/etc/refind.d/keys</code>ä¸‹ï¼Œé€‰æ‹©<code>refind_local.cer</code>å¯¼å…¥ï¼Œç„¶åé€‰æ‹©é‡å¯ï¼Œé‡æ–°è¿›å…¥ç³»ç»Ÿå°±å¯ä»¥äº†ã€‚</p><p>å¯¼å…¥è¯ä¹¦è¿™éƒ¨åˆ†æˆ‘å…¶å®ä¸å¤ªç¡®å®šï¼Œå› ä¸ºæˆ‘é™¤äº†ä½¿ç”¨shimæ–¹æ¡ˆï¼Œæˆ‘è¿˜æµ‹è¯•äº†preloaderæ–¹æ¡ˆï¼Œé‚£ä¸ªæ–¹æ¡ˆä¼šä¸€å¼€å§‹å°±å¯åŠ¨ä¸€ä¸ªMOKçš„å·¥å…·è¿›è¡Œè¯ä¹¦å¯¼å…¥ï¼Œæˆ‘è®°ä¸å¤ªæ¸…shimåˆ°åº•éœ€ä¸éœ€è¦æ‰‹åŠ¨å¯¼å…¥äº†ï¼Œå¦‚æœå‡ºç°äº†ï¼Œé‚£å°±å¯¼å…¥ä¸€ä¸‹å°±è¡Œäº†ï¼Œæ²¡å‡ºç°çš„è¯å°±èƒ½æ­£å¸¸çš„çœ‹åˆ°å¼•å¯¼ç•Œé¢å’Œè¿›å…¥ç³»ç»Ÿäº†ã€‚</p><p>è¿˜æœ‰ä¸€ä¸ªåç»­çš„åŠ¨ä½œéœ€è¦å¤„ç†ï¼Œå°±æ˜¯å†…æ ¸å‡çº§ä»¥åï¼Œæˆ‘ä»¬éœ€è¦å¯¹å†…æ ¸é‡æ–°ç­¾åï¼Œå¦åˆ™ä¼šè¢«biosæ‹’ç»å¯åŠ¨ã€‚</p><p>ç¼–è¾‘<code>/etc/pacman.d/hooks/99-secureboot.hook</code>,å¹¶å†™å…¥ä»¥ä¸‹é…ç½®ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[Trigger]</span><br><span class="line">Operation = Install</span><br><span class="line">Operation = Upgrade</span><br><span class="line">Type = Package</span><br><span class="line">Target = linux</span><br><span class="line">Target = linux-surface</span><br><span class="line">Target = systemd</span><br><span class="line"></span><br><span class="line">[Action]</span><br><span class="line">Description = Signing Kernel for SecureBoot</span><br><span class="line">When = PostTransaction</span><br><span class="line">Exec = /usr/bin/sh -c &quot;/usr/bin/find /boot/ -type f \( -name &#x27;vmlinuz-*&#x27; -o -name &#x27;systemd*&#x27; \) -exec /usr/bin/sh -c &#x27;if ! /usr/bin/sbverify --list &#123;&#125; 2&gt;/dev/null | /usr/bin/grep -q \&quot;signature certificates\&quot;; then /usr/bin/sbsign --key /etc/refind.d/keys/refind_local.key --cert /etc/refind.d/keys/refind_local.crt --output &#123;&#125; &#123;&#125;; fi&#x27; \;&quot;</span><br><span class="line">Depends = sbsigntools</span><br><span class="line">Depends = findutils</span><br><span class="line">Depends = grep</span><br></pre></td></tr></table></figure><p>äº«å—å®‰å…¨å¯åŠ¨å§ï½</p><img src="/2020/09/08/use-refind-to-boot-system/IMG_1089.JPG" class="" title="å›¾ç‰‡"><img src="/2020/09/08/use-refind-to-boot-system/IMG_1090.JPG" class="" title="å›¾ç‰‡"><img src="/2020/09/08/use-refind-to-boot-system/IMG_1091.JPG" class="" title="å›¾ç‰‡">]]></content>
      
      
      <categories>
          
          <category> æŠ€æœ¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>deepin git version</title>
      <link href="/2020/09/06/deepin-git-version/"/>
      <url>/2020/09/06/deepin-git-version/</url>
      
        <content type="html"><![CDATA[<p>This repository only provides the git version of deepin. You can replace the deepin group in the community by installing the deepin-git group.</p><span id="more"></span><p>The PKGBUILD for all packages are there <a href="https://github.com/justforlxz/deepin-git-repo">https://github.com/justforlxz/deepin-git-repo</a>, Each branch saves the corresponding software.</p><p>Before adding this repository, you should first add the key used to sign the packages in it. You can do this by running the following commands:</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">wget -qO - https://packages.justforlxz.com/deepingit.asc \</span><br><span class="line">    | sudo pacman-key --add -</span><br></pre></td></tr></table></figure><p>It is recommended that you now fingerprint it by running</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo pacman-key --finger DCAF15B4605D5BEB</span><br></pre></td></tr></table></figure><p>and in a final step, you have to locally sign the key to trust it via</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo pacman-key --lsign-key DCAF15B4605D5BEB</span><br></pre></td></tr></table></figure><p>More infos on this process can be found at <a href="https://wiki.archlinux.org/index.php/Pacman/Package_signing#Adding_unofficial_keys">https://wiki.archlinux.org/index.php/Pacman/Package_signing#Adding_unofficial_keys</a>. You can now add the repository by editing &#x2F;etc&#x2F;pacman.conf and adding</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[deepingit]</span><br><span class="line">Server = https://packages.justforlxz.com/</span><br></pre></td></tr></table></figure><p>at the end of the file. See <a href="https://wiki.archlinux.org/index.php/Pacman#Repositories_and_mirrors">https://wiki.archlinux.org/index.php/Pacman#Repositories_and_mirrors</a> for details.</p><p>to install deepin git version:</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo pacman -Syy deepin-git</span><br></pre></td></tr></table></figure><p>If you donâ€™t want to use the repository anymore, you can uninstall deepin git, or install the deepin group in Community.</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo pacman -Rscn deepin-git</span><br></pre></td></tr></table></figure><p>to install deepin group for community.</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo pacman -S deepin</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æŠ€æœ¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨VSCodeè¿œç¨‹å¼€å‘DDE</title>
      <link href="/2020/09/03/use-vscode-to-remotely-develop-dde/"/>
      <url>/2020/09/03/use-vscode-to-remotely-develop-dde/</url>
      
        <content type="html"><![CDATA[<p>æœ¬æ–‡å°†ä»‹ç»å¦‚ä½•ä½¿ç”¨VSCodeçš„è¿œç¨‹å¼€å‘å¥—ä»¶è¿æ¥åˆ°Deepinä¸»æœºï¼Œè¿›è¡ŒDDEå’Œå…¶ä»–è½¯ä»¶çš„å¼€å‘ä¸è°ƒè¯•.</p><span id="more"></span><h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>Visual Studio Codeï¼ˆç®€ç§°VS Codeï¼‰æ˜¯ä¸€ä¸ªç”±å¾®è½¯å¼€å‘ï¼ŒåŒæ—¶æ”¯æŒWindows ã€ Linuxå’ŒmacOSç­‰æ“ä½œç³»ç»Ÿçš„å…è´¹ä»£ç ç¼–è¾‘å™¨ï¼Œå®ƒæ”¯æŒæµ‹è¯•ï¼Œå¹¶å†…ç½®äº†Git ç‰ˆæœ¬æ§åˆ¶åŠŸèƒ½ï¼ŒåŒæ—¶ä¹Ÿå…·æœ‰å¼€å‘ç¯å¢ƒåŠŸèƒ½ï¼Œä¾‹å¦‚ä»£ç è¡¥å…¨ï¼ˆç±»ä¼¼äº IntelliSenseï¼‰ã€ä»£ç ç‰‡æ®µå’Œä»£ç é‡æ„ç­‰ã€‚è¯¥ç¼–è¾‘å™¨æ”¯æŒç”¨æˆ·ä¸ªæ€§åŒ–é…ç½®ï¼Œä¾‹å¦‚æ”¹å˜ä¸»é¢˜é¢œè‰²ã€é”®ç›˜å¿«æ·æ–¹å¼ç­‰å„ç§å±æ€§å’Œå‚æ•°ï¼ŒåŒæ—¶è¿˜åœ¨ç¼–è¾‘å™¨ä¸­å†…ç½®äº†æ‰©å±•ç¨‹åºç®¡ç†çš„åŠŸèƒ½ã€‚</p><p>åœ¨VSCodeå‡ºæ¥ä¹‹å‰ï¼ŒSublimeæ›¾ç»æ˜¯å‰ç«¯å¼€å‘è€…å¿…å¤‡çš„è½¯ä»¶ï¼Œå®ƒä½¿ç”¨pythonä½œä¸ºæ’ä»¶è¿è¡Œç¯å¢ƒï¼Œå¹¶ä¸”ä¹Ÿæ‹¥æœ‰ä¸å°‘çš„æ’ä»¶ï¼Œä½†æ˜¯å¾ˆé—æ†¾çš„æ˜¯æ’ä»¶ä¸èƒ½æ›´æ”¹ç•Œé¢å…ƒç´ ï¼Œå¯ç©æ€§ä¸æ˜¯å¾ˆé«˜ã€‚</p><p>å†åæ¥Atomä½œä¸ºGitHubçš„é¡¶æ¢æŸ±å‡ºç°äº†ï¼Œå®ƒåŸºäºä½¿ç”¨Chromiumå’ŒNode.jsçš„è·¨å¹³å°åº”ç”¨æ¡†æ¶Electronï¼ˆæœ€åˆåä¸ºAtom Shellï¼‰ï¼Œå¹¶ä½¿ç”¨CoffeeScriptå’ŒLessæ’°å†™ï¼Œå¹¶ä¸”æ”¯æŒjså¼€å‘çš„æ’ä»¶ï¼Œä¸€æ—¶é—´æ‹¥æœ‰éå¸¸å¤šçš„ç”¨æˆ·ï¼Œå¹¶ä¸”ä»Sublimeé‚£é‡Œæ‹‰æ‹¢äº†éå¸¸å¤šçš„å‰ç«¯å¼€å‘è€…ã€‚</p><p>ä½†æ˜¯ä¸€åˆ‡éƒ½åœ¨VSCodeé¢ä¸–ä»¥åå˜äº†ã€‚VSCodeåŒæ ·ä¹Ÿæ˜¯åŸºäºChromimå’ŒElectronå¼€å‘ï¼Œå¹¶ä¸”æ”¯æŒTypeScriptå¼€å‘æ’ä»¶ï¼Œè€Œä¸”å¯åŠ¨é€Ÿåº¦æ¯”Atomå¿«å¾ˆå¤šï¼Œè€Œä¸”ä½œä¸ºå¾®è½¯é¢å‘å¼€æºç¤¾åŒºçš„ä¸»åŠ›äº§å“ï¼Œå®ƒå’ŒTypeScriptä¸€æ ·ï¼Œå¸æ”¶äº†ç¤¾åŒºçš„å¾ˆå¤šæ„è§å’Œè´¡çŒ®ï¼Œä½¿å¾—è½¯ä»¶è¶Šæ¥è¶Šå¥½ç”¨ã€‚åœ¨è¯­è¨€æ”¯æŒæ–¹é¢ï¼Œå¯¹ C#ã€JavaScriptã€å’Œ TypeScript ç­‰ç¼–ç¨‹è¯­è¨€çš„åŸç”Ÿæ”¯æŒæœ€ä¸ºå®Œå–„ã€‚</p><h2 id="å®‰è£…VS-Code"><a href="#å®‰è£…VS-Code" class="headerlink" title="å®‰è£…VS Code"></a>å®‰è£…VS Code</h2><p>å®˜ç½‘æä¾›çš„æœ‰vscodeçš„å®‰è£…åŒ…ï¼Œwindowsç”¨æˆ·ä¸‹è½½stableç‰ˆæœ¬çš„exe(System Installer)ã€‚</p><p>System Installerå¯ä»¥è‡ªåŠ¨ä¸‹è½½å¯¹åº”è¯­è¨€çš„ç¯å¢ƒåŒ…ï¼Œæ¨èå®‰è£…æ­¤ç‰ˆæœ¬ã€‚</p><img src="/2020/09/03/use-vscode-to-remotely-develop-dde/W1KvXk0ylxHa9w8E.png" class="" title="å›¾ç‰‡"><p>å®‰è£…å®Œæˆåå°±å¯ä»¥å®‰è£…æ’ä»¶äº†ã€‚</p><h2 id="å®‰è£…æ’ä»¶"><a href="#å®‰è£…æ’ä»¶" class="headerlink" title="å®‰è£…æ’ä»¶"></a>å®‰è£…æ’ä»¶</h2><p>æ’ä»¶ç³»ç»Ÿæ˜¯ä¸€ä¸ªç¼–è¾‘å™¨çš„å·¦è†€å³è‡‚ï¼Œemacså’Œvimä½œä¸ºç»ˆç«¯ä¸‹å¼€å‘ç»å¸¸ä½¿ç”¨çš„ç¼–è¾‘å™¨ï¼Œå°±æ‹¥æœ‰éå¸¸ä¸°å¯Œçš„æ’ä»¶ï¼Œå‡ ä¹æ¯ä¸ªå¤§ä½¬ä½¿ç”¨çš„emacså’Œviméƒ½ä¸èƒ½äº’æ¢ä½¿ç”¨ã€‚</p><p>ddeçš„é¡¹ç›®å‡ ä¹éƒ½æ˜¯cmakeçš„é¡¹ç›®ï¼Œæ‰€ä»¥éœ€è¦å®‰è£…cmakeæ’ä»¶å’Œc++çš„æ’ä»¶ï¼Œå®‰è£…äº†è¿™ä¸¤ä¸ªæ’ä»¶ä»¥åã€‚vscodeæ‰“å¼€é¡¹ç›®å·¥ç¨‹å°±ä¼šè‡ªåŠ¨è§£æCMakeLists.txtï¼Œå¹¶ä¸”å¼€å¯vscodeçš„å¿«é€Ÿè°ƒè¯•åŠŸèƒ½ï¼Œè¿˜å¯ä»¥å¼€å§‹æ„å»ºé¡¹ç›®å’Œè°ƒè¯•é¡¹ç›®äº†ã€‚</p><img src="/2020/09/03/use-vscode-to-remotely-develop-dde/XvMxNUQrs9oyEYJF.png" class="" title="å›¾ç‰‡"><p>å®‰è£…CMakeã€CMake Toolsè¿™ä¸¤ä¸ªæ’ä»¶å°±å¯ä»¥å¼€å‘äº†ã€‚</p><img src="/2020/09/03/use-vscode-to-remotely-develop-dde/tBB60YiLW79oMLC1.png" class="" title="å›¾ç‰‡"><p>å®‰è£…C&#x2F;C++å’ŒC++ Intellisenseè¿™ä¸¤ä¸ªæ’ä»¶å¯ä»¥å¯¹é¡¹ç›®ä¸­çš„c++ä»£ç è¿›è¡Œæ™ºèƒ½æ„ŸçŸ¥å’Œä»£ç è¡¥å…¨ï¼Œæ¨èå®‰è£…ã€‚</p><img src="/2020/09/03/use-vscode-to-remotely-develop-dde/idQexXGZXPrqCBby.png" class="" title="å›¾ç‰‡"><p>å®‰è£…Remote - SSHæ’ä»¶ï¼Œå¯ä»¥è®©vscodeé€šè¿‡sshè¿æ¥åˆ°ç›®æ ‡æœºå™¨ï¼Œæ‰“å¼€è¿œç¨‹æœºå™¨çš„ç›®å½•å’Œæ–‡ä»¶ï¼Œå¹¶ä¸”åœ¨è¯¥æ¨¡å¼ä¸‹ï¼Œéƒ¨åˆ†æ’ä»¶å¯ä»¥è‡ªåŠ¨åˆ‡æ¢æˆæœ¬åœ°&#x2F;è¿œç¨‹æ¨¡å¼ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨æœ¬æœºç›´æ¥å¼€å‘ï¼Œä½†æ˜¯æ“ä½œçš„å†…å®¹éƒ½æ˜¯è¿œç¨‹ç¯å¢ƒçš„ã€‚</p><p>å®‰è£…å®ŒRemote - SSHæ’ä»¶ä»¥åï¼Œvscodeçš„å·¦ä¸‹è§’å°±ä¼šæœ‰ä¸€ä¸ªç»¿è‰²çš„æŒ‰é’®ï¼Œå¯ä»¥ç”¨æ¥åˆ‡æ¢æ¨¡å¼ã€‚</p><img src="/2020/09/03/use-vscode-to-remotely-develop-dde/MWorTAHEAsJRt47E.png" class="" title="å›¾ç‰‡"><h2 id="é…ç½®è¿œç¨‹ç¯å¢ƒ"><a href="#é…ç½®è¿œç¨‹ç¯å¢ƒ" class="headerlink" title="é…ç½®è¿œç¨‹ç¯å¢ƒ"></a>é…ç½®è¿œç¨‹ç¯å¢ƒ</h2><p>å› ä¸ºæ˜¯è¦åœ¨Windowsä¸Šè¿›è¡Œè¿œç¨‹å¼€å‘ï¼Œå¦‚æœæ˜¯ç›´æ¥åœ¨UOSæˆ–è€…Deepinä¸Šå¼€å‘DDEï¼Œè¿™ä¸€éƒ¨åˆ†æ˜¯å¯ä»¥ä¸ç”¨çœ‹çš„ï¼Œä¸Šé¢çš„æ’ä»¶å®‰è£…å®Œæˆä»¥åå°±å¯ä»¥å¼€å‘é¡¹ç›®äº†ã€‚</p><p>ç‚¹å‡»å·¦ä¸‹è§’çš„ç»¿è‰²æŒ‰é’®ï¼Œåœ¨å¼¹å‡ºçš„é¢æ¿é€‰æ‹©Remote-SSH: Connect to Hostã€‚</p><img src="/2020/09/03/use-vscode-to-remotely-develop-dde/WFN9jpqyRRXORtuP.png" class="" title="å›¾ç‰‡"><p>ä¼šç»§ç»­å¼¹å‡ºä¸€ä¸ªé¢æ¿ï¼Œç”¨æ¥é€‰æ‹©é…ç½®sshçš„è¿æ¥ã€‚</p><img src="/2020/09/03/use-vscode-to-remotely-develop-dde/Cw7Z7sF3rb8RiBzZ.png" class="" title="å›¾ç‰‡"><p>é€‰æ‹©Add New SSH Hostæ·»åŠ ä¸€ä¸ªæœåŠ¡å™¨ã€‚</p><img src="/2020/09/03/use-vscode-to-remotely-develop-dde/qcXsO8ayHXyTMr62.png" class="" title="å›¾ç‰‡"><p>è¾“å…¥sshçš„å‘½ä»¤ï¼Œä¾‹å¦‚ ssh <a href="mailto:&#x6c;&#120;&#122;&#64;&#x31;&#x30;&#46;&#50;&#48;&#x2e;&#x33;&#50;&#46;&#x35;&#x34;">&#x6c;&#120;&#122;&#64;&#x31;&#x30;&#46;&#50;&#48;&#x2e;&#x33;&#50;&#46;&#x35;&#x34;</a>ã€‚</p><img src="/2020/09/03/use-vscode-to-remotely-develop-dde/9Cla2rDtfzfsHVSh.png" class="" title="å›¾ç‰‡"><p>ç„¶åé€‰æ‹©ä¸€ä¸ªä¿å­˜é…ç½®çš„ä½ç½®ï¼Œä¸€èˆ¬é»˜è®¤é€‰æ‹©ç”¨æˆ·å®¶ç›®å½•çš„.sshç›®å½•å³å¯ã€‚ç„¶åå°±æç¤ºæ·»åŠ æˆåŠŸï¼Œæ­¤æ—¶å¯ä»¥ç‚¹å‡»ConnectæŒ‰é’®è¿›è¡Œè¿æ¥ã€‚</p><img src="/2020/09/03/use-vscode-to-remotely-develop-dde/Do8KoBS0lwM1g09G.png" class="" title="å›¾ç‰‡"><p>è¾“å…¥å¯†ç </p><img src="/2020/09/03/use-vscode-to-remotely-develop-dde/J7dPRyLYI4QBcma5.png" class="" title="å›¾ç‰‡"><p>ç™»å½•ä»¥åä¼šæ‰“å¼€ä¸€ä¸ªæ–°çš„çª—å£ï¼Œå¹¶æç¤ºæ­£åœ¨è¿æ¥ã€‚è¿æ¥æˆåŠŸä»¥åå¯ä»¥åœ¨å·¦ä¸‹è§’çœ‹åˆ°æœºå™¨çš„ä¿¡æ¯ã€‚</p><img src="/2020/09/03/use-vscode-to-remotely-develop-dde/LjLHBXGQeuvXMk8k.png" class="" title="å›¾ç‰‡"><img src="/2020/09/03/use-vscode-to-remotely-develop-dde/VJQhRC7LXbhWyWdN.png" class="" title="å›¾ç‰‡"><p>ç„¶åæ‰“å¼€å‘½ä»¤é¢æ¿ï¼Œé€‰æ‹©åœ¨SSHä¸­å®‰è£…æœ¬åœ°æ‰©å±•ã€‚</p><img src="/2020/09/03/use-vscode-to-remotely-develop-dde/XJEqsfmwIO5FpUKS.png" class="" title="å›¾ç‰‡"><p>åœ¨æ‰“å¼€çš„åˆ—è¡¨é€‰æ‹©å…¨é€‰ï¼Œç„¶åå®‰è£…ã€‚</p><img src="/2020/09/03/use-vscode-to-remotely-develop-dde/zmVjGPVL7gphBZ7h.png" class="" title="å›¾ç‰‡"><p>ç­‰å¾…å…¨éƒ¨å®‰è£…æˆåŠŸã€‚</p><img src="/2020/09/03/use-vscode-to-remotely-develop-dde/P1yXbz7pkrwXOEAS.png" class="" title="å›¾ç‰‡"><img src="/2020/09/03/use-vscode-to-remotely-develop-dde/WbxesoOf0RF1QqtZ.png" class="" title="å›¾ç‰‡"><h2 id="å¼€å‘å’Œè°ƒè¯•"><a href="#å¼€å‘å’Œè°ƒè¯•" class="headerlink" title="å¼€å‘å’Œè°ƒè¯•"></a>å¼€å‘å’Œè°ƒè¯•</h2><h3 id="åŠŸèƒ½ä»‹ç»"><a href="#åŠŸèƒ½ä»‹ç»" class="headerlink" title="åŠŸèƒ½ä»‹ç»"></a>åŠŸèƒ½ä»‹ç»</h3><p>CMakeæ’ä»¶æä¾›äº†ç¼–è¯‘ã€è¿è¡Œå’Œè°ƒè¯•çš„åŠŸèƒ½å’Œå‘½ä»¤ï¼Œå¯ä»¥ç‚¹å‡»ä¸‹æ–¹é¢æ¿ä¸­çš„select targetï¼Œé€‰æ‹©è¦è¿è¡Œçš„ç›®æ ‡ç¨‹åºï¼Œé€‰æ‹©åˆ‡æ¢ç¼–è¯‘æ¨¡å¼ï¼Œå¯ä»¥é€‰æ‹©Debugæˆ–è€…Releaseã€‚è¿˜å¯ä»¥é€‰æ‹©ä½¿ç”¨å“ªä¸ªç¼–è¯‘å™¨è¿›è¡Œæ„å»ºã€‚</p><img src="/2020/09/03/use-vscode-to-remotely-develop-dde/je8iADCEbmCT7sMZ.png" class="" title="å›¾ç‰‡"><img src="/2020/09/03/use-vscode-to-remotely-develop-dde/uUIxae7PVFDwSyUB.png" class="" title="å›¾ç‰‡"><img src="/2020/09/03/use-vscode-to-remotely-develop-dde/Ah6NUPpjjoDIL93K.png" class="" title="å›¾ç‰‡"><img src="/2020/09/03/use-vscode-to-remotely-develop-dde/UbibgDc1gL0tXNPy.png" class="" title="å›¾ç‰‡"><h3 id="è®¾ç½®å¯åŠ¨å‚æ•°"><a href="#è®¾ç½®å¯åŠ¨å‚æ•°" class="headerlink" title="è®¾ç½®å¯åŠ¨å‚æ•°"></a>è®¾ç½®å¯åŠ¨å‚æ•°</h3><p>å¦‚æœç¨‹åºå¯åŠ¨ä¸éœ€è¦æä¾›å‚æ•°ï¼Œåˆ™å¯ä»¥ç›´æ¥ç‚¹å‡»ä¸‹æ–¹é¢æ¿çš„DebugæŒ‰é’®ï¼Œæˆ–è€…æ‰“å¼€å‘½ä»¤é¢æ¿é€‰æ‹©CMake Debug Targetï¼Œå¦‚æœæ²¡æœ‰é€‰æ‹©è¿‡Targetï¼Œåˆ™ä¼šè¯¢é—®ä¸€æ¬¡è®¾ç½®Targetã€‚</p><p>ç‚¹å‡»å·¦ä¾§çš„è°ƒè¯•æŒ‰é’®ï¼Œé€‰æ‹©æ·»åŠ é…ç½®ã€‚</p><img src="/2020/09/03/use-vscode-to-remotely-develop-dde/kTjwUYxwt19QlwPt.png" class="" title="å›¾ç‰‡"><p>åœ¨å¼¹å‡ºçš„é¢æ¿é€‰æ‹©GDB</p><img src="/2020/09/03/use-vscode-to-remotely-develop-dde/5Q4JOQWUZnDMtBNx.png" class="" title="å›¾ç‰‡"><p>æ­¤æ—¶vscodeä¼šåˆ›å»ºå‡ºä¸€ä¸ªjsonæ–‡ä»¶ï¼Œå¹¶ç”Ÿæˆäº†é»˜è®¤çš„é…ç½®æ–‡ä»¶ã€‚</p><img src="/2020/09/03/use-vscode-to-remotely-develop-dde/l1IZdMrxfd0dH45a.png" class="" title="å›¾ç‰‡"><p>æˆ‘ä»¬éœ€è¦è¿›è¡Œä¸€äº›è°ƒæ•´ï¼Œä»¥ä¾¿ä½¿ç”¨è¯¥é…ç½®æ–‡ä»¶è¿›è¡Œè°ƒè¯•ã€‚</p><p>programå­—æ®µæ˜¯ç¨‹åºäºŒè¿›åˆ¶æ–‡ä»¶çš„ä½ç½®ï¼Œä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä»¬æ˜¯è¦æ‰‹åŠ¨å†™å¥½è·¯å¾„ï¼Œä½†æ˜¯å¦‚æœé¡¹ç›®çš„äºŒè¿›åˆ¶ç‰¹åˆ«å¤šï¼Œæ›´æ¢é…ç½®æ–‡ä»¶å°±ä¼šéå¸¸éº»çƒ¦ï¼Œè€Œä¸”é…ç½®æ–‡ä»¶é‡Œå†™æ­»è·¯å¾„ä¹Ÿä¸æ˜¯å¾ˆæ–¹ä¾¿ï¼Œæˆ‘æŸ¥é˜…äº†CMakeæ’ä»¶çš„æ–‡æ¡£ï¼Œå‘ç°CMakeæ’ä»¶æä¾›äº†ä¸¤ä¸ªå¾ˆé‡è¦çš„å˜é‡ï¼Œå¯ä»¥è®©æˆ‘ä»¬æ–¹ä¾¿çš„æŸ¥æ‰¾åˆ°è·¯å¾„ã€‚</p><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="attr">&quot;program&quot;</span><span class="punctuation">:</span>Â <span class="string">&quot;$&#123;command:cmake.launchTargetPath&#125;&quot;</span></span><br></pre></td></tr></table></figure><p>CMakeæ’ä»¶æä¾›äº†launchTargetPathçš„å˜é‡ï¼Œå®ƒå¯¹åº”çš„æ˜¯CMakeæ’ä»¶é€‰æ‹©çš„é»˜è®¤targetï¼Œå¯åŠ¨è°ƒè¯•ä¹‹å‰éœ€è¦æˆ‘ä»¬å…ˆé€‰æ‹©å¥½Targetã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&quot;value&quot;:Â &quot;$PATH:$&#123;command:cmake.launchTargetDirectory&#125;&quot;</span><br></pre></td></tr></table></figure><p>CMakeæ’ä»¶è¿˜æä¾›äº†launchTargetDirectoryå˜é‡ï¼Œç”¨äºè·å–ç¨‹åºå¯åŠ¨æ‰€åœ¨çš„ç›®å½•ï¼Œä¸€èˆ¬éœ€è¦æˆ‘ä»¬æŒ‡å®šåˆ°æœ¬æ¬¡è°ƒè¯•æ‰€éœ€çš„ç¯å¢ƒå˜é‡ä¸­ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&quot;environment&quot;: [</span><br><span class="line">  &#123;</span><br><span class="line">    &quot;name&quot;: &quot;PATH&quot;,</span><br><span class="line">    &quot;value&quot;: &quot;$PATH:$&#123;command:cmake.launchTargetDirectory&#125;&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥æ·»åŠ å¯åŠ¨å‚æ•°äº†ã€‚<br>argså­—æ®µä¿å­˜äº†ç¨‹åºå¯åŠ¨ä¼šä¼ é€’çš„å‚æ•°åˆ—è¡¨ï¼Œä¾‹å¦‚è¿™é‡Œä¼šç»™fuseä¼ é€’-då’Œ&#x2F;tmp&#x2F;xã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&quot;args&quot;: [</span><br><span class="line">  &quot;-d&quot;,</span><br><span class="line">  &quot;/tmp/x&quot;</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>å®Œæ•´çš„é…ç½®å¦‚ä¸‹ï¼š</p><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">Â Â Â Â <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span>Â <span class="string">&quot;(gdb)Â fuse&quot;</span><span class="punctuation">,</span></span><br><span class="line">Â Â Â Â <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span>Â <span class="string">&quot;cppdbg&quot;</span><span class="punctuation">,</span></span><br><span class="line">Â Â Â Â <span class="attr">&quot;request&quot;</span><span class="punctuation">:</span>Â <span class="string">&quot;launch&quot;</span><span class="punctuation">,</span></span><br><span class="line">Â Â Â Â <span class="attr">&quot;program&quot;</span><span class="punctuation">:</span>Â <span class="string">&quot;$&#123;command:cmake.launchTargetPath&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">Â Â Â Â <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span>Â <span class="punctuation">[</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="string">&quot;-d&quot;</span><span class="punctuation">,</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="string">&quot;/tmp/x&quot;</span></span><br><span class="line">Â Â Â Â <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">Â Â Â Â <span class="attr">&quot;stopAtEntry&quot;</span><span class="punctuation">:</span>Â <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">Â Â Â Â <span class="attr">&quot;cwd&quot;</span><span class="punctuation">:</span>Â <span class="string">&quot;$&#123;workspaceFolder&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">Â Â Â Â <span class="attr">&quot;environment&quot;</span><span class="punctuation">:</span>Â <span class="punctuation">[</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="punctuation">&#123;</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span>Â <span class="string">&quot;PATH&quot;</span><span class="punctuation">,</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span>Â <span class="string">&quot;$PATH:$&#123;command:cmake.launchTargetDirectory&#125;&quot;</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">Â Â Â Â <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">Â Â Â Â <span class="attr">&quot;externalConsole&quot;</span><span class="punctuation">:</span>Â <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">Â Â Â Â <span class="attr">&quot;MIMode&quot;</span><span class="punctuation">:</span>Â <span class="string">&quot;gdb&quot;</span><span class="punctuation">,</span></span><br><span class="line">Â Â Â Â <span class="attr">&quot;setupCommands&quot;</span><span class="punctuation">:</span>Â <span class="punctuation">[</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="punctuation">&#123;</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span>Â <span class="string">&quot;ä¸ºÂ gdbÂ å¯ç”¨æ•´é½æ‰“å°&quot;</span><span class="punctuation">,</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span>Â <span class="string">&quot;-enable-pretty-printing&quot;</span><span class="punctuation">,</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="attr">&quot;ignoreFailures&quot;</span><span class="punctuation">:</span>Â <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="punctuation">&#125;</span></span><br><span class="line">Â Â Â Â <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="gdbè°ƒè¯•"><a href="#gdbè°ƒè¯•" class="headerlink" title="gdbè°ƒè¯•"></a>gdbè°ƒè¯•</h3><p>æ­¤æ—¶æˆ‘ä»¬å°±å¯ä»¥å…ˆé€šè¿‡CMakeæ’ä»¶æ„å»ºæ•´ä¸ªé¡¹ç›®ï¼Œå†åˆ‡æ¢åˆ°è¿è¡Œé¢æ¿ï¼Œå¯åŠ¨è°ƒè¯•ã€‚</p><p>ç‚¹å‡»ä¸‹æ–¹é¢æ¿çš„BuildæŒ‰é’®ï¼Œæ„å»ºé¡¹ç›®ã€‚</p><img src="/2020/09/03/use-vscode-to-remotely-develop-dde/FAkfeLuV4JBsc4Mx.png" class="" title="å›¾ç‰‡"><p>å†ç‚¹å‡»å·¦ä¾§çš„gdb fuse(deepin-turbo)æŒ‰é’®ï¼Œå› ä¸ºé…ç½®æ–‡ä»¶é‡Œé¢æˆ‘ä»¬èµ·çš„åå­—æ˜¯gdb fuseã€‚æˆ‘ä»¬åœ¨mainå‡½æ•°æ·»åŠ ä¸€ä¸ªæ–­ç‚¹ï¼Œç”¨æ¥æµ‹è¯•gdbæ˜¯å¦å·¥ä½œæ­£å¸¸ã€‚</p><img src="/2020/09/03/use-vscode-to-remotely-develop-dde/mKDIuN2GI1pSfVpQ.png" class="" title="å›¾ç‰‡"><p>ä¸€åˆ‡éƒ½å·¥ä½œæ­£å¸¸ï¼Œåœ¨è°ƒè¯•æ§åˆ¶å°å¯ä»¥ä½¿ç”¨-execä½œä¸ºå‰ç¼€æ¥æ‰§è¡Œgdbçš„å‘½ä»¤ã€‚</p><img src="/2020/09/03/use-vscode-to-remotely-develop-dde/sxNL1dJG5uFm22O1.png" class="" title="å›¾ç‰‡"><h3 id="è°ƒè¯•å›¾å½¢ç¨‹åº"><a href="#è°ƒè¯•å›¾å½¢ç¨‹åº" class="headerlink" title="è°ƒè¯•å›¾å½¢ç¨‹åº"></a>è°ƒè¯•å›¾å½¢ç¨‹åº</h3><p>è°ƒè¯•å›¾å½¢ç¨‹åºç¨å¾®æœ‰ä¸€äº›éº»çƒ¦ï¼Œå› ä¸ºæ˜¯è¿œç¨‹å¼€å‘ï¼Œå›¾å½¢ç¨‹åºåˆåªèƒ½å·¥ä½œåœ¨ç›®æ ‡æœºå™¨ï¼Œè¿™é‡Œæä¾›ä¸¤ä¸ªå¯è¡Œçš„æ–¹æ¡ˆã€‚</p><ol><li>synergyä¹‹ç±»çš„é”®ç›˜é¼ æ ‡å…±äº«è½¯ä»¶</li><li>åœ¨windowså®‰è£…xserver</li></ol><p>ç¬¬ä¸€ç§æ–¹æ¡ˆæ˜¯é€šè¿‡å…±äº«æœ¬æœºçš„é”®ç›˜é¼ æ ‡åˆ°è¿œç¨‹æœºå™¨ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨è¿œç¨‹ç¯å¢ƒä¸Šé¢è¿›è¡Œç›´æ¥æ“ä½œï¼Œå¥½å¤„æ˜¯é™¤äº†è°ƒè¯•ï¼Œä¹Ÿå¯ä»¥åŒæ—¶æ“ä½œè¿œç¨‹æœºå™¨è¿›è¡Œä½¿ç”¨ã€‚</p><p>ç¬¬äºŒç§æ–¹æ¡ˆæ˜¯åˆ©ç”¨X11åè®®çš„ç½‘ç»œé€æ˜ï¼Œæ—¢å›¾å½¢ç¨‹åºå’Œæ˜¾ç¤ºæœåŠ¡ä¸ä¸€å®šåœ¨åŒä¸€å°æœºå™¨ä¸Šè¿è¡Œï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨Windowså®‰è£…XServerç¨‹åºï¼Œå°±å¯ä»¥è®©è¿œç¨‹æœºå™¨ä¸Šçš„ç¨‹åºçš„ç”»é¢æ˜¾ç¤ºåˆ°å½“å‰æœºå™¨ï¼Œå¹¶ä¸”å¯ä»¥æ“ä½œã€‚ä½†æ˜¯æ­¤æ–¹æ¡ˆæœ‰ç¼ºç‚¹ï¼Œè™½ç„¶è®¾è®¡ä¸Šè¿™ç§åˆ†ç¦»ç»“æ„è®¾è®¡çš„å¾ˆå·§å¦™ï¼Œä½†æ˜¯å› ä¸ºè¿œç¨‹OpenGLè°ƒç”¨å¹¶ä¸æ”¯æŒï¼Œæ‰€ä»¥å›¾å½¢æ— æ³•è°ƒç”¨3Dç¨‹åºæ¸²æŸ“ï¼Œå¹¶ä¸”å’Œè¿œç¨‹æœºå™¨æ²Ÿé€šéœ€è¦å¤§é‡çš„å¸¦å®½ï¼Œæ‰€ä»¥ç”¨èµ·æ¥ä½“éªŒå¹¶ä¸å¥½ã€‚</p><p>ä¸ºäº†ä½¿ç”¨è¿™ä¸¤ç§æ–¹æ¡ˆï¼Œæˆ‘ä»¬éƒ½éœ€è¦åœ¨è°ƒè¯•çš„launch.jsonä¸­æ·»åŠ ä¸€ä¸ªç¯å¢ƒå˜é‡ã€‚</p><p>åœ¨è¿è¡Œé¢æ¿ç‚¹å‡»é½¿è½®æŒ‰é’®ï¼Œå¯ä»¥ç¼–è¾‘å½“å‰æ–¹æ¡ˆã€‚</p><img src="/2020/09/03/use-vscode-to-remotely-develop-dde/X32Q5bhGX2B7CLGg.png" class="" title="å›¾ç‰‡"><p>åœ¨æ‰“å¼€çš„jsonæ–‡ä»¶ä¸­ï¼Œæ‰¾åˆ°environmentå­—æ®µï¼Œæ·»åŠ DISPLAYç¯å¢ƒå˜é‡ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&quot;environment&quot;: [</span><br><span class="line">  &#123;</span><br><span class="line">    &quot;name&quot;: &quot;DISPLAY&quot;,</span><br><span class="line">    &quot;value&quot;: &quot;:0&quot;</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>è¿™æ ·ç¨‹åºå¯åŠ¨å°±æœ‰DISPLAYç¯å¢ƒå˜é‡ï¼Œæˆ‘ä»¬å°±å¯ä»¥è®©ç¨‹åºåœ¨ç›®æ ‡æœºå™¨çš„å±å¹•ä¸Šè¿è¡Œäº†ã€‚</p><img src="/2020/09/03/use-vscode-to-remotely-develop-dde/7JuWfnnURIt1NrdR.png" class="" title="å›¾ç‰‡"><img src="/2020/09/03/use-vscode-to-remotely-develop-dde/20200903_023112910_iOS.jpg" class="" title="å›¾ç‰‡"><img src="/2020/09/03/use-vscode-to-remotely-develop-dde/20200903_023116260_iOS.jpg" class="" title="å›¾ç‰‡"><p>è¿˜æœ‰ä¸€ç§è‡ªåŠ¨åŒ–æµ‹è¯•çš„æ–¹æ¡ˆï¼Œè¯¥æ–¹æ¡ˆæ˜¯æˆ‘ä¸ªäººè®¤ä¸ºæ‰€æœ‰å¼€å‘éƒ½åº”è¯¥æŒæ¡çš„ï¼Œé€šè¿‡è‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œæˆ‘ä»¬å°±å¯ä»¥å®Œå…¨ä½¿ç”¨è¿œç¨‹å¼€å‘æ¥å®Œæˆå¼€å‘ä»»åŠ¡ï¼Œè°ƒè¯•çš„æ—¶å€™åªéœ€è¦ç­‰å¾…è‡ªåŠ¨æµ‹è¯•ç»“æœè¿”å›å³å¯ï¼Œè®¾æƒ³ä¸€ä¸‹ï¼ŒæŸä¸ªæ¨¡å—éœ€è¦ç‚¹å‡»å¾ˆå¤šåœ°æ–¹æ‰å¯ä»¥é‡ç°ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬åªéœ€è¦è®¾ç½®å¥½æ–­ç‚¹ï¼Œè®©ç¨‹åºè‡ªåŠ¨å¼€å§‹æ‰§è¡Œæ‰€æœ‰å‡½æ•°ï¼Œå¹¶åœ¨æœ€ç»ˆå‡ºç°é—®é¢˜çš„åœ°æ–¹åœä¸‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹æ‰‹åŠ¨å•æ­¥è·Ÿè¸ªé—®é¢˜ï¼Œå®Œå…¨ä¸éœ€è¦ä½¿ç”¨é¼ æ ‡äººå·¥ç‚¹å‡»ã€‚ï¼ˆç„¶è€Œç†æƒ³å¾ˆç¾å¥½ï¼Œç°å®å¾ˆæ®‹é…·ï¼Œæˆ‘ä¸ªäººç›®å‰éƒ½æ²¡æœ‰æŒæ¡è‡ªåŠ¨åŒ–æµ‹è¯•çš„æ–¹å¼ï¼Œç°åœ¨ä¹Ÿæ˜¯åªèƒ½é€šè¿‡é¼ æ ‡ç‚¹ç‚¹ç‚¹æ¥é‡ç°é—®é¢˜ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
          <category> æŠ€æœ¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> VS Code </tag>
            
            <tag> Windows </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åœ¨ArchLinuxä¸Šå¼€å‘startdde</title>
      <link href="/2020/08/06/develop-startdde-on-archlinux/"/>
      <url>/2020/08/06/develop-startdde-on-archlinux/</url>
      
        <content type="html"><![CDATA[<p>dde åç«¯ä½¿ç”¨ go ä½œä¸ºä¸»è¦çš„å¼€å‘è¯­è¨€ï¼Œä½¿ç”¨ dbus æä¾›æ¥å£ï¼Œä¸»è¦ä½¿ç”¨ gsettings æ¥ä¿å­˜é…ç½®ã€‚ æ‰€ä»¥åœ¨è¿›è¡Œåç«¯å¼€å‘å‰éœ€è¦å¯¹ä»¥ä¸Šå†…å®¹æœ‰åŸºæœ¬çš„äº†è§£ï¼Œè¿™é‡Œå‡å®šæœ¬æ–‡æ¡£çš„é˜…è¯»è€…ç†Ÿæ‚‰ dbus å’Œ gsettingsï¼Œå¹¶æœ‰ä¸€å®šçš„å¼€å‘ç»éªŒã€‚</p><span id="more"></span><h2 id="å®‰è£…ä¾èµ–"><a href="#å®‰è£…ä¾èµ–" class="headerlink" title="å®‰è£…ä¾èµ–"></a>å®‰è£…ä¾èµ–</h2><p>è™½ç„¶æœ¬é¡¹ç›®æ˜¯goè¯­è¨€å¼€å‘çš„ï¼Œä½†æ˜¯æˆ‘ä»¬å¹¶æ²¡æœ‰ç›´æ¥ä½¿ç”¨goçš„modä½œä¸ºä¾èµ–ç®¡ç†æ–¹æ¡ˆï¼Œè€Œæ˜¯èµ°ç³»ç»ŸåŒ…ç®¡ç†å™¨çš„æ–¹å¼ï¼Œæ‰€ä»¥è¦å…ˆå®‰è£…startddeçš„ç¼–è¯‘ä¾èµ–ã€‚</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo pacman -Sy golang-github-linuxdeepin-go-dbus-factory golang-deepin-gir golang-deepin-lib golang-deepin-dde-api go git jq golang-golang-x-net golang-github-linuxdeepin-go-x11-client</span><br></pre></td></tr></table></figure><p>è¿™äº›åŒ…ä¼šè¢«å®‰è£…åˆ°ç³»ç»Ÿçš„&#x2F;usr&#x2F;share&#x2F;gocodeç›®å½•ä¸‹ã€‚è¿˜éœ€è¦æ‰‹åŠ¨go getä¸€ä¸ªä¾èµ–åˆ°æœ¬åœ°çš„GOPATHä¸­ã€‚</p><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">go</span> get -v github.com/cryptix/wav</span><br></pre></td></tr></table></figure><h2 id="è®¾ç½®GOPATH"><a href="#è®¾ç½®GOPATH" class="headerlink" title="è®¾ç½®GOPATH"></a>è®¾ç½®GOPATH</h2><p>ä¸ºäº†æ–¹ä¾¿ä»¥åçš„å¼€å‘ï¼Œå¯ä»¥å°†GOPATHç¯å¢ƒå˜é‡å®šä¹‰åˆ°~&#x2F;.xprofileç­‰æ–‡ä»¶ä¸­ï¼Œæˆ–è€…shellçš„é…ç½®æ–‡ä»¶ã€‚ä¾‹å¦‚æˆ‘ä½¿ç”¨çš„zshï¼š</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">export GOPATH=$HOME/Develop/Go:/usr/share/gocode</span><br><span class="line">export PATH=$HOME/Develop/Go/bin:$PATH</span><br></pre></td></tr></table></figure><h2 id="è®¾ç½®é¡¹ç›®ç›®å½•"><a href="#è®¾ç½®é¡¹ç›®ç›®å½•" class="headerlink" title="è®¾ç½®é¡¹ç›®ç›®å½•"></a>è®¾ç½®é¡¹ç›®ç›®å½•</h2><p>goè¦æ±‚é¡¹ç›®ç›®å½•å¿…é¡»åœ¨GOPATHä¸­ï¼Œæ‰€ä»¥è¦å°†startddeæ”¾åˆ°GOPATHçš„pkg.deepin.io&#x2F;dde&#x2F;ç›®å½•ä¸‹ï¼Œä½†æ˜¯GOPATHæ¯æ¬¡è¿›å…¥ä¸æ–¹ä¾¿ï¼Œå¯ä»¥é‡‡ç”¨è½¯é“¾çš„å½¢å¼å°†startddeçš„ç›®å½•é“¾æ¥åˆ°GOPATHä¸‹ã€‚</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd ~/Develop/Deepin</span><br><span class="line">git clone https://github.com/linuxdeepin/startdde</span><br><span class="line">mkdir -p ~/Develop/Go/src/pkg.deepin.io/dde/</span><br><span class="line">ln -sf ~/Develop/Deepin/startdde ~/Develop/Go/src/pkg.deepin.io/dde/startdde</span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±å¯ä»¥åœ¨ä¸€ä¸ªæ–¹ä¾¿çš„ç›®å½•è¿›è¡Œå¼€å‘äº†ã€‚</p><h2 id="vscodeå¼€å‘å·¥å…·"><a href="#vscodeå¼€å‘å·¥å…·" class="headerlink" title="vscodeå¼€å‘å·¥å…·"></a>vscodeå¼€å‘å·¥å…·</h2><p>æˆ‘ä¸ªäººæ¨èä½¿ç”¨vscodeå½“ä½œå¼€å‘å·¥å…·ï¼Œæ‰“å¼€vscodeå®‰è£…goçš„æ’ä»¶ï¼Œæ‰“å¼€startddeç›®å½•ï¼Œvscodeä¼šæç¤ºå®‰è£…ä¸€äº›goçš„å·¥å…·ï¼Œé€‰æ‹©å…¨éƒ¨å®‰è£…å³å¯ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> dde </tag>
            
            <tag> go </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>use github action to check dde-launcher</title>
      <link href="/2020/07/27/use-github-action-to-check-dde-launcher/"/>
      <url>/2020/07/27/use-github-action-to-check-dde-launcher/</url>
      
        <content type="html"><![CDATA[<p>æœ¬æ¥æ‰“ç®—7æœˆä»½ç»™ddeæ·»åŠ github actionéªŒè¯ï¼Œä½†æ˜¯è¢«å„ç§äº‹æƒ…è€½è¯¯äº†ï¼Œç„¶åå‘ç°éº’éºŸå±…ç„¶æŠ¢åœ¨æˆ‘å‰é¢éƒ¨ç½²äº†å…¨å¥—çš„github actionï¼Œè¿™ä¸èƒ½å¿ï¼Œèµ¶ç´§æŠŠddeçš„github actionä¹Ÿæä¸Šæ—¥ç¨‹ã€‚å¹¶ä¸”æ‰“ç®—å¬<a href="https://github.com/felixonmars">è‚¥è‚¥çŒ«</a>å¤§ä½¬çš„è¯ï¼Œåœ¨aurç»™ddeå¼„ä¸€å¥—commitæ„å»ºåŒ…ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨archä¸Šä½¿ç”¨æ¯”testingä»“åº“æ›´testingçš„ddeäº†ï¼</p><span id="more"></span><p>github actionsæ˜¯githubå®˜æ–¹å‡ºçš„æŒç»­é›†æˆåŠŸèƒ½ï¼Œä»¥å‰å¤§å®¶åœ¨githubä¸Šçš„é¡¹ç›®éƒ½ä½¿ç”¨çš„ç¬¬ä¸‰æ–¹çš„Travis CIæˆ–è€…è‡ªå»ºjenkinsæ„å»ºï¼Œä½†æ˜¯githubè¢«å¾®è½¯æ”¶è´­ä»¥åï¼Œå¾®è½¯ä¸ºäº†è¡¨ç°å‡ºç»™ç¤¾åŒºå’Œç”¨æˆ·çš„è¯šæ„ï¼Œå°†å¤§é‡githubçš„ä»˜è´¹åŠŸèƒ½å…è´¹å…¬å¼€ç»™å¼€å‘è€…ä½¿ç”¨ï¼Œå¸Œæœ›èƒ½å°†githubæ‰“é€ æˆå¼€å‘è€…ä¸­å¿ƒï¼Œäºæ˜¯åœ¨2019å¹´å¾®è½¯æ¨å‡ºäº†å…è´¹çš„github actionsï¼Œæ¯ä¸ªé¡¹ç›®éƒ½å¯ä»¥å…è´¹ä½¿ç”¨å®˜æ–¹æä¾›çš„æŒç»­é›†æˆå’ŒæŒç»­éƒ¨ç½²åŠŸèƒ½ï¼Œè¿™å¯¹ç¬¬ä¸‰æ–¹ä¸šåŠ¡æ— ç–‘æ˜¯ä¸ªå·¨å¤§çš„æ‰“å‡»ï¼Œè™½ç„¶Travis CIå’Œjenkinsç­‰æ–¹å¼ä»ç„¶æœ‰ä¸€å®šçš„å¸‚åœºï¼Œä½†æ˜¯å¯¹äºä¸­å°é¡¹ç›®çš„å¼€æºé¡¹ç›®ï¼Œä½¿ç”¨å®˜æ–¹æä¾›çš„åŠŸèƒ½æ— ç–‘æ˜¯æ–¹ä¾¿çš„ã€‚</p><p>github actionsçš„é…ç½®ååˆ†ç®€å•ï¼Œåªéœ€è¦å‡ ä¸ªç®€å•çš„æ­¥éª¤å°±å¯ä»¥å®ç°æ„å»ºã€æ‰§è¡Œå’Œæµ‹è¯•ä»£ç ã€‚å¹¶ä¸”å¯ä»¥ä½¿ç”¨Linuxã€Windowså’ŒMacOSç¯å¢ƒï¼Œæœºå™¨æ€§èƒ½ä¹Ÿååˆ†å¼ºåŠ²ï¼Œç¼–è¯‘é€Ÿåº¦éå¸¸çš„å¿«ã€‚</p><p>è¿™æ˜¯ç»™dde-launcherçš„ä¸€ä»½åŸºç¡€é…ç½®ï¼Œéœ€è¦å°†é…ç½®æ–‡ä»¶æ”¾åœ¨.github&#x2F;workflows&#x2F;ç›®å½•ä¸‹ï¼Œä»¥build.yamlæ–‡ä»¶åä¿å­˜ã€‚</p><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">CI</span> <span class="string">Build</span></span><br><span class="line"></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="attr">push:</span></span><br><span class="line">    <span class="attr">branches:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">uos</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">pull_request:</span></span><br><span class="line">    <span class="attr">branches:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">uos</span></span><br><span class="line"></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="attr">archlinux:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">Archlinux</span> <span class="string">Build</span> <span class="string">Check</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span></span><br><span class="line">    <span class="attr">container:</span> <span class="string">docker.io/library/archlinux:latest</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Checkout</span> <span class="string">branch</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/checkout@v2</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Refresh</span> <span class="string">pacman</span> <span class="string">repository</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">pacman</span> <span class="string">-Syy</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Install</span> <span class="string">build</span> <span class="string">dependencies</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">pacman</span> <span class="string">-S</span> <span class="string">--noconfirm</span> <span class="string">base-devel</span> <span class="string">cmake</span> <span class="string">ninja</span> <span class="string">qt5-tools</span> <span class="string">deepin-qt-dbus-factory</span> <span class="string">dtkwidget</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">CMake</span> <span class="string">&amp;</span> <span class="string">Make</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          mkdir build</span></span><br><span class="line"><span class="string">          cd build</span></span><br><span class="line"><span class="string">          cmake ../ -G Ninja</span></span><br><span class="line"><span class="string">          ninja</span></span><br></pre></td></tr></table></figure><p>ä»‹ç»ä¸€ä¸‹é…ç½®æ–‡ä»¶å§ï¼Œnameæ˜¯è®¾ç½®ciçš„åå­—ï¼Œgithubå…è®¸æœ‰å¤šä¸ªciå­˜åœ¨ï¼Œå¯ä»¥åšä¸åŒçš„äº‹æƒ…ï¼Œä¾‹å¦‚éƒ¨ç½²ä¸‰ä¸ªciï¼Œä¸€ä¸ªåšè¯­æ³•æ£€æŸ¥ï¼Œä¸€ä¸ªåšé™æ€æ£€æŸ¥ï¼Œä¸€ä¸ªåšç¼–è¯‘æ£€æŸ¥ã€‚nameå°±æ˜¯ç”¨æ¥åœ¨ç•Œé¢ä¸Šæ˜¾ç¤ºçš„ã€‚onæ˜¯è®¾ç½®ciå¯¹å“ªäº›äº‹ä»¶æ„Ÿå…´è¶£ï¼Œåœ¨è¿™é‡Œæˆ‘è®¾ç½®äº†pushå’Œpull_requestï¼Œå½“å‘ç”Ÿpushå’Œpull requestæ—¶ï¼Œè¿™ä¸ªciå°±ä¼šè¢«å¯åŠ¨ï¼Œæ‰§è¡Œæ¥ä¸‹æ¥çš„jobsçš„å†…å®¹ã€‚jobsé‡Œæ˜¯å¯ä»¥è®¾ç½®å¤šä¸ªä»»åŠ¡çš„ï¼ŒåŒæ ·nameå­—æ®µä¹Ÿæ˜¯ç”¨æ¥å±•ç¤ºæœ¬æ¬¡åŠ¨ä½œçš„åç§°ã€‚runs-onæ˜¯è®¾ç½®è¯¥jobå·¥ä½œçš„ç¯å¢ƒï¼Œubuntu-latestæ˜¯linuxç¯å¢ƒï¼Œcontaineræ˜¯æŒ‡ä½¿ç”¨å“ªä¸ªdockerå®¹å™¨ï¼Œgithub actionsæ˜¯å¯ä»¥ä½¿ç”¨dockerçš„ï¼Œä¹Ÿå¯ä»¥å°†è‡ªå·±çš„cié…ç½®å…±äº«ç»™å…¶ä»–äººä½¿ç”¨ã€‚runå°±æ˜¯æ‰§è¡Œå‘½ä»¤äº†ï¼Œåœ¨é…ç½®æ–‡ä»¶ä¸­æˆ‘æ‰‹åŠ¨è¿è¡Œäº†åˆ·æ–°ä»“åº“å’Œç¼–è¯‘é¡¹ç›®æ‰€éœ€çš„å‘½ä»¤ã€‚jobçš„stepså¯ä»¥ç†è§£æˆshellä¸­ä¸€æ¬¡åŠ¨ä½œçš„æ‰§è¡Œï¼Œusesæ˜¯ä½¿ç”¨å…¶ä»–äººå°è£…å¥½çš„å‘½ä»¤ï¼Œrunåˆ™æ˜¯æ‰§è¡Œæœ¬åœ°å‘½ä»¤ã€‚</p><p>å¯ä»¥çœ‹å‡ºgithub actionsçš„é…ç½®æ˜¯ååˆ†ç®€å•çš„ï¼Œå¹¶ä¸”æ„å»ºé€Ÿåº¦ä¹Ÿéå¸¸çš„å¿«ï¼Œå¹¶ä¸”æ„å»ºç¯å¢ƒæ˜¯ä½¿ç”¨çš„arch linuxç¯å¢ƒï¼Œä¸ºä»€ä¹ˆè¦é€‰æ‹©archä½œä¸ºciçš„åŸºç¡€æ„å»ºç¯å¢ƒå‘¢ï¼ŒåŸå› å½“ç„¶ä¸æ˜¯å› ä¸ºå’Œè‚¥è‚¥çŒ«æœ‰pyäº¤æ˜“ï¼Œarchä¸Šçš„ddeæ›´æ–°é€Ÿåº¦å¾ˆå¿«ï¼Œå¹¶ä¸”å¾ˆå¤šç”¨æˆ·éƒ½ä½¿ç”¨arch+ddeçš„æ–¹å¼ä½¿ç”¨linuxï¼Œdeepinè‡ªå·±ç»´æŠ¤çš„å‘è¡Œç‰ˆå› ä¸ºåŸºç¡€ä»“åº“æ›´æ–°è¾ƒæ…¢ï¼Œä¸é€‚åˆä¸€äº›ç”¨æˆ·ï¼Œæ‰€ä»¥ä¸ºäº†èƒ½è®©ddeè¢«æ›´å¤šçš„äººæ¥å—å’Œä½¿ç”¨ï¼Œåœ¨archä¸ŠåŠæ—¶æ›´æ–°ddeæ˜¯ååˆ†æœ‰å¿…è¦çš„ã€‚æ‰€ä»¥æ‰é€‰æ‹©actionsçš„ç¯å¢ƒä¸ºarch linuxã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æŠ€æœ¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨perfå·¥å…·åˆ†æç¨‹åºæ€§èƒ½</title>
      <link href="/2020/07/21/use-perf-to-analytics-program/"/>
      <url>/2020/07/21/use-perf-to-analytics-program/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨å¯¹DDEè¿›è¡Œæ€§èƒ½ä¼˜åŒ–ï¼Œæ‰€ä»¥è¡¥ä¹ äº†ä¸€ä¸‹linuxä¸‹çš„å„ç§åˆ†æå·¥å…·çš„ä½¿ç”¨æ–¹æ³•ã€‚</p><img src="/2020/07/21/use-perf-to-analytics-program/bpf_performance_tools_book.png" class="" title="bpf_performance_tools_book.png"><p>è¿™å¼ å›¾æ˜¯æ¥è‡ªBrendan Greggå¤§ä½¬æä¾›çš„linuxåˆ†æå·¥å…·çš„åº”ç”¨åœºæ™¯ï¼Œå¯ä»¥çœ‹å‡ºå‡ ä¹åŒ…å«äº†ç³»ç»Ÿæ¯ä¸ªåœ°æ–¹åº”è¯¥ç”¨ä»€ä¹ˆå·¥å…·å»åˆ†æã€‚</p><span id="more"></span><h2 id="Linux-Perf-Tool"><a href="#Linux-Perf-Tool" class="headerlink" title="Linux Perf Tool"></a>Linux Perf Tool</h2><h3 id="å…è®¸ç³»ç»Ÿè¿›è¡Œåˆ†æ"><a href="#å…è®¸ç³»ç»Ÿè¿›è¡Œåˆ†æ" class="headerlink" title="å…è®¸ç³»ç»Ÿè¿›è¡Œåˆ†æ"></a>å…è®¸ç³»ç»Ÿè¿›è¡Œåˆ†æ</h3><p>ä¸ºäº†èƒ½å¤Ÿæ­£å¸¸åˆ†æï¼Œé¦–å…ˆéœ€è¦æ‰“å¼€ç³»ç»Ÿçš„è°ƒè¯•åŠŸèƒ½ï¼Œå…è®¸æˆ‘ä»¬å»å¯¹å…¶ä»–è¿›ç¨‹è¿›è¡Œè®¿é—®ã€‚</p><h3 id="SysCtl"><a href="#SysCtl" class="headerlink" title="SysCtl"></a>SysCtl</h3><p>è¾ƒæ–°çš„Linuxå†…æ ¸å…·æœ‰sysfså¯è°ƒå‚æ•°<code>/proc/sys/kernel/perf_event_paranoid</code>ï¼Œè¯¥å‚æ•°å…è®¸ç”¨æˆ·è°ƒæ•´perf_eventsérootç”¨æˆ·çš„å¯ç”¨åŠŸèƒ½ï¼Œæ•°é‡è¶Šå¤§åˆ™è¶Šå®‰å…¨ï¼ˆç›¸åº”åœ°æä¾›è¾ƒå°‘çš„åŠŸèƒ½ï¼‰ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Consider tweaking /proc/sys/kernel/perf_event_paranoid:</span><br><span class="line"> -1 - Not paranoid at all</span><br><span class="line">  0 - Disallow raw tracepoint access for unpriv</span><br><span class="line">  1 - Disallow cpu events for unpriv</span><br><span class="line">  2 - Disallow kernel profiling for unpriv</span><br></pre></td></tr></table></figure><p>é»˜è®¤å€¼æ˜¯ä¸å…è®¸è·å–ä»»ä½•ä¿¡æ¯ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¿®æ”¹ä¸º1æˆ–è€…0ï¼Œå…è®¸æˆ‘ä»¬è®¿é—®CPUçš„äº‹ä»¶ä¿¡æ¯ã€‚</p><ul><li>ä¸´æ—¶ä¿®æ”¹</li></ul><p>æ‰§è¡Œå‘½ä»¤å‘å†…æ ¸æ¥å£ç›´æ¥å†™å…¥å€¼ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo tee /proc/sys/kernel/perf_event_paranoid &lt;&lt;&lt; 1</span><br></pre></td></tr></table></figure><ul><li>æ°¸ä¹…ä¿®æ”¹</li></ul><p>ä½¿ç”¨sysctlæ¥é…ç½®å…¶å€¼ï¼Œåˆ›å»º<code>/etc/sysctl.d/50_perf_event_paranoid.conf</code>æ–‡ä»¶ï¼Œå¹¶å†™å…¥<code>kernel.perf_event_paranoid=1</code>ï¼Œæ‰§è¡Œ<code>sysctl -p</code>æ¥åˆ·æ–°ç³»ç»Ÿé…ç½®ã€‚</p><h3 id="perf-é‡‡æ ·"><a href="#perf-é‡‡æ ·" class="headerlink" title="perf é‡‡æ ·"></a>perf é‡‡æ ·</h3><blockquote><p>æ€§èƒ½ä¼˜åŒ–ç›¸å…³çš„ä¸‰ç§ç±»å‹çš„å·¥å…·ï¼Œä¸€ç§æ˜¯samplingç±»å‹çš„ï¼Œå³é‡‡æ ·ï¼Œè¿™ç§å·¥å…·å°±æ˜¯ä¸åœâ€œè¯¢é—®â€ç¨‹åºåœ¨åšä»€ä¹ˆï¼Œperfåœ¨æˆ‘ä»¬ä½¿ç”¨çš„è¿™ç§æ¨¡å¼ä¸‹å°±æ˜¯ samplingæ¨¡å¼ï¼Œå¦‚æœæ˜¯è¿½è¸ªæŸäº›eventï¼Œå°±å·¥ä½œåœ¨traceæ¨¡å¼ï¼Œå®é™…ä¸Šå°±æ˜¯ç¬¬äºŒç§ç±»å‹çš„å·¥å…·ï¼Œè¿™ç§å·¥å…·ä¸»è¦ä¾é äº‹ä»¶æˆ–è€…hookï¼Œç¨‹åºåœ¨è¿è¡Œçš„è¿‡ç¨‹ä¸­ä¸åœä¸»åŠ¨å‘Šè¯‰å·¥å…·å®ƒè‡ªå·±åœ¨åšä»€ä¹ˆï¼Œæ¯”å¦‚ straceï¼›ç¬¬ä¸‰ç§æ˜¯ instrument ç±»å‹çš„ï¼Œè¿™ç§ä¸»è¦å°±æ˜¯ä¾èµ–ç¼–è¯‘å™¨è¿›è¡Œæ’æ¡©ï¼Œç²¾ç¡®çŸ¥é“ä»£ç è¡Œçº§åˆ«çš„æ‰§è¡Œæƒ…å†µï¼ˆå‚è€ƒgcc instrumentation ï¼‰ã€‚</p><p>by hualet on <a href="https://docsin.uniontech.com/?p=735">deepin 15.7</a></p></blockquote><p>æˆ‘ä»¬é€šè¿‡perf recordå‘½ä»¤æ‰å¯¹ç¨‹åºè¿›è¡Œé‡‡æ ·è®°å½•ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">perf record -g --call-graph=dwarf -F 99 /usr/bin/dde-shutdown</span><br></pre></td></tr></table></figure><p>å‘½ä»¤ä»‹ç»ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-g: å³é‡‡æ ·å…¨éƒ¨ä¿¡æ¯</span><br><span class="line">--call-graph: è®¾ç½®å¹¶å¯ç”¨è°ƒç”¨å›¾ï¼ˆå †æ ˆé“¾/å›æº¯ï¼‰è®°å½•ï¼Œå‚æ•°æœ‰fp(frame pointers)ã€dwarf(debug information)å’Œlbr(Last Branch Record)ã€‚</span><br><span class="line">-F: é‡‡æ ·ç‡</span><br></pre></td></tr></table></figure><p>perfå¯ä»¥ç›´æ¥å¯åŠ¨ä¸€ä¸ªç¨‹åºè¿›è¡Œåˆ†æï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨-på‚æ•°æŒ‡å®šä¸€ä¸ªpidè¿›è¡Œé‡‡æ ·ã€‚</p><h3 id="æŸ¥çœ‹-perf-çš„é‡‡æ ·ç»“æœ"><a href="#æŸ¥çœ‹-perf-çš„é‡‡æ ·ç»“æœ" class="headerlink" title="æŸ¥çœ‹ perf çš„é‡‡æ ·ç»“æœ"></a>æŸ¥çœ‹ perf çš„é‡‡æ ·ç»“æœ</h3><p>å½“æˆ‘ä»¬é€šè¿‡perf recordå®Œæˆé‡‡æ ·ä»¥åï¼Œä¼šåœ¨æ‰§è¡Œç›®å½•ç”Ÿæˆperf.dataæ–‡ä»¶ï¼Œæ­¤æ—¶æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨perf reportå‘½ä»¤å¯¹dataæ–‡ä»¶è¿›è¡Œæ•°æ®åˆ†æäº†ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">perf report --stdio</span><br></pre></td></tr></table></figure><p>perf reportä¼šè‡ªåŠ¨æ‰“å¼€å½“å‰ç›®å½•ä¸‹çš„perf.dataæ–‡ä»¶ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥åœ¨æœ€åæŒ‡å®šperf.dataæ–‡ä»¶çš„è·¯å¾„ã€‚</p><p>perf reportä¼šæ ¹æ®â€“call-graphå‚æ•°æ¥ç”Ÿæˆä¸åŒçš„å›¾ï¼Œä½¿ç”¨dwarfå‚æ•°æ—¶ä¼šä»¥å‡½æ•°è°ƒç”¨æ ˆçš„é¡ºåºæ¥æ˜¾ç¤ºï¼Œä½¿ç”¨è¿™ç§æ–¹å¼å¯ä»¥æ–¹ä¾¿çš„çœ‹å‡ºå“ªä¸ªå‡½æ•°æ‰§è¡Œçš„æ—¶é—´æ¯”è¾ƒé•¿ï¼Œå› ä¸ºæ¯æ¬¡é‡‡æ ·éƒ½èƒ½è½åˆ°è¯¥å‡½æ•°ä¸Šï¼Œä¹Ÿå°±æ„å‘³ç€å‡½æ•°æ‰§è¡Œçš„æ—¶é—´éå¸¸é•¿ï¼Œå†é€šè¿‡è°ƒç”¨æ ˆçš„æ·±åº¦æ¥åˆ†æå‡½æ•°æ‰§è¡ŒæœŸé—´éƒ½åœ¨åšä»€ä¹ˆäº‹æƒ…ã€‚</p><h3 id="hotspotç«ç„°å›¾"><a href="#hotspotç«ç„°å›¾" class="headerlink" title="hotspotç«ç„°å›¾"></a>hotspotç«ç„°å›¾</h3><p>åœ¨å‘½ä»¤è¡Œä¸‹æŸ¥çœ‹å‡½æ•°è°ƒç”¨ä¸æ˜¯ç‰¹åˆ«æ–¹ä¾¿ï¼Œæ‰€ä»¥å°±æœ‰å›¾å½¢åŒ–çš„å·¥å…·ç”¨æ¥æ–¹ä¾¿çš„æŸ¥çœ‹perfå·¥å…·çš„ç”Ÿæˆç»“æœï¼Œå…¶ä¸­ä½¿ç”¨æ¯”è¾ƒå‹å¥½çš„æ˜¯kdeå¼€å‘çš„hotspotå·¥å…·ï¼Œè¯¥å·¥å…·å¯ä»¥ç›´æ¥æ‰“å¼€perf.dataæ–‡ä»¶ï¼Œå¹¶ç”Ÿæˆå¯¹åº”çš„ç«ç„°å›¾ï¼Œç«ç„°å›¾æ˜¯å‡½æ•°è°ƒç”¨çš„å¦ä¸€ç§è¡¨ç°å½¢å¼ï¼Œç«ç„°è¶Šé«˜ï¼Œä¹Ÿå°±æ„å‘³ç€è°ƒç”¨æ ˆè¶Šæ·±ï¼Œç«ç„°è¶Šå¹¿ï¼Œä¹Ÿå°±æ„å‘³ç€å‡½æ•°æ‰§è¡Œçš„æ—¶é—´å¾ˆé•¿ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ä¼˜åŒ– </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTest &amp; QTest/GTest</title>
      <link href="/2020/06/16/CTest%20&amp;%20QTEST/"/>
      <url>/2020/06/16/CTest%20&amp;%20QTEST/</url>
      
        <content type="html"><![CDATA[<p>æœ¬æ–‡ä¼šä»‹ç»ä¸€ä¸‹QTestå’ŒGTestçš„ä¸€äº›åŠŸèƒ½å’ŒåŒºåˆ«ã€‚</p><span id="more"></span><h1 id="å•å…ƒæµ‹è¯•"><a href="#å•å…ƒæµ‹è¯•" class="headerlink" title="å•å…ƒæµ‹è¯•"></a>å•å…ƒæµ‹è¯•</h1><h2 id="ctest"><a href="#ctest" class="headerlink" title="ctest"></a>ctest</h2><p>ctestæ˜¯CMakeæä¾›çš„è¿è¡Œå•å…ƒæµ‹è¯•çš„å·¥å…·ï¼Œåœ¨ä½¿ç”¨CMakeLists.txtæ–‡ä»¶ç¼–è¯‘å·¥ç¨‹çš„æ—¶å€™ï¼ŒCTestä¼šè‡ªåŠ¨configureã€buildã€testå’Œå±•ç°æµ‹è¯•ç»“æœã€‚</p><p>ctestæœ‰ä¸¤ä¸ªæ¨¡å¼ï¼š</p><ul><li>æ¨¡å¼ä¸€ï¼šä½¿ç”¨CMake configureå’Œbuildå·¥ç¨‹ï¼Œåœ¨CMakeLists.txtï¼Œä½¿ç”¨ç‰¹æ®Šçš„å‘½ä»¤åˆ›å»ºtestsã€‚ä½¿ç”¨CTestæ¥æ‰§è¡Œé‚£äº›æµ‹è¯•ã€‚</li><li>æ¨¡å¼äºŒï¼šä½¿ç”¨CTestæ¥æ‰§è¡Œä¸€ä¸ªscriptï¼Œè¿™ä¸ªscriptçš„è¯­æ³•å¿…é¡»å’ŒCMakeLists.txtç›¸åŒã€‚</li></ul><p>ä½¿ç”¨æ–¹æ³•ï¼š</p><p>åœ¨CMakeLists.txtä½¿ç”¨include(CTest)å’Œinclude(Dart)æ¥å¯¼å…¥CTestæ¨¡å—å’Œå¼€å¯ctestã€‚ä½¿ç”¨add_test()æ¥æ·»åŠ ä¸€ä¸ªæµ‹è¯•ç¨‹åºï¼Œæµ‹è¯•ç¨‹åºæ˜¯ä¸€ä¸ªæ™®é€šçš„äºŒè¿›åˆ¶ï¼Œåªä¸è¿‡å†…éƒ¨è¿è¡Œçš„æ˜¯qtestæˆ–è€…gtestç¼–å†™çš„æµ‹è¯•ç”¨ä¾‹ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">include(CTest)</span><br><span class="line">include(Dart)</span><br><span class="line">add_executable(tests tests/test.cpp)</span><br><span class="line">add(NAME tests COMMAND $&lt;TARGET_FILE:tests&gt;)</span><br></pre></td></tr></table></figure><h2 id="qt-qtest"><a href="#qt-qtest" class="headerlink" title="qt qtest"></a>qt qtest</h2><p>qtestæ˜¯Qtæä¾›çš„å•å…ƒæµ‹è¯•æ¡†æ¶ï¼ŒQt Testæ˜¯ç”¨äºå¯¹åŸºäºQtçš„åº”ç”¨ç¨‹åºå’Œåº“è¿›è¡Œå•å…ƒæµ‹è¯•çš„æ¡†æ¶ã€‚Qt Testæä¾›äº†å•å…ƒæµ‹è¯•æ¡†æ¶ä¸­å¸¸è§çš„æ‰€æœ‰åŠŸèƒ½ä»¥åŠç”¨äºæµ‹è¯•å›¾å½¢ç”¨æˆ·ç•Œé¢çš„æ‰©å±•ã€‚</p><p>Qtæµ‹è¯•æ—¨åœ¨ç®€åŒ–åŸºäºQtçš„åº”ç”¨ç¨‹åºå’Œåº“çš„å•å…ƒæµ‹è¯•çš„ç¼–å†™ï¼š</p><table><thead><tr><th align="left">ç‰¹å¾</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">è½»é‡</td><td align="left">Qt Testå¤§çº¦æœ‰6000è¡Œä»£ç å’Œ60ä¸ªå¯¼å‡ºç¬¦å·ç»„æˆ</td></tr><tr><td align="left">è‡ªæˆä½“ç³»</td><td align="left">Qt Testä»…éœ€è¦Qt Coreæ¨¡å—ä¸­çš„å‡ ä¸ªç¬¦å·å³å¯è¿›è¡ŒéGUIæµ‹è¯•</td></tr><tr><td align="left">å¿«é€Ÿæµ‹è¯•</td><td align="left">Qt Testä¸éœ€è¦ç‰¹æ®Šçš„æµ‹è¯•è¿è¡Œç¨‹åºï¼Œæ²¡æœ‰ç‰¹æ®Šçš„æµ‹è¯•æ³¨å†Œ</td></tr><tr><td align="left">æ•°æ®é©±åŠ¨æµ‹è¯•</td><td align="left">å¯ä»¥ä½¿ç”¨ä¸åŒçš„æ•°æ®è¿›è¡Œå¤šæ¬¡çš„æµ‹è¯•</td></tr><tr><td align="left">åŸºæœ¬çš„GUIæµ‹è¯•</td><td align="left">Qt Testæä¾›äº†ç”¨äºé¼ æ ‡å’Œé”®ç›˜çš„æ¨¡æ‹ŸåŠŸèƒ½</td></tr><tr><td align="left">æ ‡æ†ç®¡ç†</td><td align="left">Qt Testæ”¯æŒåŸºå‡†æµ‹è¯•ï¼Œå¹¶æä¾›å¤šä¸ªæµ‹é‡åç«¯</td></tr><tr><td align="left">IDEå‹å¥½</td><td align="left">Qt Testè¾“å‡ºå¯ä»¥ç”±Qt Creatorã€Visual Studioç­‰IDEè§£é‡Šçš„æ¶ˆæ¯</td></tr><tr><td align="left">çº¿ç¨‹å®‰å…¨</td><td align="left">é”™è¯¯æŠ¥å‘Šæ˜¯çº¿ç¨‹å®‰å…¨å’ŒåŸå­çš„</td></tr><tr><td align="left">ç±»å‹å®‰å…¨</td><td align="left">æ¨¡æ¿çš„å¹¿æ³›ä½¿ç”¨å¯ä»¥é˜²æ­¢éšå¼ç±»å‹è½¬æ¢å¼•èµ·çš„é”™è¯¯</td></tr><tr><td align="left">æ˜“äºæ‰©å±•</td><td align="left">å¯ä»¥å°†è‡ªå®šä¹‰ç±»å‹è½»æ¾æ·»åŠ åˆ°æµ‹è¯•æ•°æ®å’Œæµ‹è¯•è¾“å‡ºä¸­</td></tr></tbody></table><h3 id="æ–­è¨€"><a href="#æ–­è¨€" class="headerlink" title="æ–­è¨€"></a>æ–­è¨€</h3><p>QVERIFY() ç”¨äºéªŒè¯æ•°æ®æ˜¯å¦æ­£ç¡®ã€‚</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="built_in">QVERIFY</span>(<span class="number">1</span> == <span class="number">1</span>);</span><br><span class="line"><span class="built_in">QVERIFY2</span>(<span class="number">1</span> != <span class="number">1</span>, <span class="string">&quot;1ä¸ç­‰äº1&quot;</span>);</span><br></pre></td></tr></table></figure><h3 id="å¾ªç¯"><a href="#å¾ªç¯" class="headerlink" title="å¾ªç¯"></a>å¾ªç¯</h3><p>QFETCH_GLOBAL() è¯¥å®ä»å…¨å±€æ•°æ®è¡¨ä¸­çš„ä¸€è¡Œä¸­è·å–ç±»å‹ç±»å‹ä¸ºnameçš„å˜é‡ã€‚ åç§°å’Œç±»å‹å¿…é¡»ä¸å…¨å±€æ•°æ®è¡¨ä¸­çš„åˆ—åŒ¹é…ã€‚ è¿™æ˜¯æ–­è¨€ï¼Œå¦‚æœæ–­è¨€å¤±è´¥ï¼Œåˆ™æµ‹è¯•å°†ä¸­æ­¢ã€‚</p><p>QFETCH() å®ä¼šåœ¨å †æ ˆä¸Šåˆ›å»ºä¸€ä¸ªç±»å‹ä¸ºnameçš„æœ¬åœ°å˜é‡ã€‚ åç§°å’Œç±»å‹å¿…é¡»ä¸æµ‹è¯•æ•°æ®è¡¨ä¸­çš„åˆ—åŒ¹é…ã€‚ è¿™æ˜¯æ–­è¨€ï¼Œå¦‚æœæ–­è¨€å¤±è´¥ï¼Œåˆ™æµ‹è¯•å°†ä¸­æ­¢ã€‚</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="built_in">QFETCH</span>(QString, aString);</span><br><span class="line"><span class="built_in">QFETCH_GLOBAL</span>(QLocale, locale);</span><br></pre></td></tr></table></figure><h3 id="æ¯”è¾ƒ"><a href="#æ¯”è¾ƒ" class="headerlink" title="æ¯”è¾ƒ"></a>æ¯”è¾ƒ</h3><p>QCOMPAREå®ç”¨äºåˆ¤æ–­ä¸¤ä¸ªå€¼æ˜¯å¦ç›¸ç­‰ï¼Œå¦‚æœå®é™…å€¼å’Œé¢„æœŸå€¼åŒ¹é…ï¼Œå°†ä¼šç»§ç»­è¿è¡Œï¼Œå¦åˆ™å°†å¤±è´¥è®°å½•åœ¨æµ‹è¯•æ—¥è‡³ä¸­ï¼Œå¹¶ä¸”æµ‹è¯•å°†è¢«ç»ˆæ­¢ï¼Œä¸ä¼šå°è¯•ä»»ä½•åç»­æ“ä½œã€‚</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="built_in">QCOMPARE</span>(<span class="built_in">QString</span>(<span class="string">&quot;hello&quot;</span>).<span class="built_in">toUpper</span>(), <span class="built_in">QString</span>(<span class="string">&quot;HELLO&quot;</span>));</span><br></pre></td></tr></table></figure><h3 id="æ·»åŠ æ•°æ®"><a href="#æ·»åŠ æ•°æ®" class="headerlink" title="æ·»åŠ æ•°æ®"></a>æ·»åŠ æ•°æ®</h3><p>é€šè¿‡åœ¨åŒ…å«_data()çš„å‡½æ•°ä¸­è°ƒç”¨QTest::addColumnå’ŒQTest::newRowå‘æµ‹è¯•ç”¨ä¾‹å¢åŠ æ•°æ®ï¼Œå¹¶é€šè¿‡QFETCHå®åœ¨æµ‹è¯•ç”¨ä¾‹ä¸­è®¿é—®æ•°æ®ã€‚</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">TestQString::toInt_data</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    QTest::<span class="built_in">addColumn</span>&lt;QString&gt;(<span class="string">&quot;aString&quot;</span>);</span><br><span class="line">    QTest::<span class="built_in">addColumn</span>&lt;<span class="type">int</span>&gt;(<span class="string">&quot;expected&quot;</span>);</span><br><span class="line">    QTest::<span class="built_in">newRow</span>(<span class="string">&quot;positive value&quot;</span>) &lt;&lt; <span class="string">&quot;42&quot;</span> &lt;&lt; <span class="number">42</span>;</span><br><span class="line">    QTest::<span class="built_in">newRow</span>(<span class="string">&quot;negative value&quot;</span>) &lt;&lt; <span class="string">&quot;-42&quot;</span> &lt;&lt; <span class="number">-42</span>;</span><br><span class="line">    QTest::<span class="built_in">newRow</span>(<span class="string">&quot;zero&quot;</span>) &lt;&lt; <span class="string">&quot;0&quot;</span> &lt;&lt; <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">TestQString::toInt</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">     <span class="built_in">QFETCH</span>(QString, aString);</span><br><span class="line">     <span class="built_in">QFETCH</span>(<span class="type">int</span>, expected);</span><br><span class="line">     <span class="built_in">QCOMPARE</span>(aString.<span class="built_in">toInt</span>(), expected);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åˆ›å»ºæµ‹è¯•"><a href="#åˆ›å»ºæµ‹è¯•" class="headerlink" title="åˆ›å»ºæµ‹è¯•"></a>åˆ›å»ºæµ‹è¯•</h3><p>è¦åˆ›å»ºæµ‹è¯•ï¼Œéœ€è¦æ´¾ç”Ÿè‡ªQObjectï¼Œå¹¶æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªä¸“ç”¨æ§½å‡½æ•°ã€‚æ¯ä¸ªä¸“ç”¨æ§½å‡½æ•°éƒ½æ˜¯æµ‹è¯•ä¸­çš„ä¸€ä¸ªæµ‹è¯•åŠŸèƒ½ä¸”å¿…é¡»ä¸ºprivateã€‚å‡½æ•°å‘½åæ–¹æ³•ä»¥casen_å‡½æ•°åæˆ–è€…ä»¥testç»“å°¾çš„æ–¹å¼ã€‚</p><p>ä½¿ç”¨QTest::qExec()å¯ç”¨äºæ‰§è¡Œæµ‹è¯•å¯¹è±¡ä¸­çš„æ‰€æœ‰æµ‹è¯•åŠŸèƒ½ã€‚</p><p>æ­¤å¤–ï¼Œè¿˜å¯ä»¥å®šä¹‰ä¸ç”¨äºæµ‹è¯•åŠŸèƒ½çš„ä¸“ç”¨æ§½å‡½æ•°ã€‚å¦‚æœå­˜åœ¨ï¼Œå®ƒä»¬å°†ç”±æµ‹è¯•æ¡†æ¶æ‰§è¡Œï¼Œå¹¶ç”¨äºåˆå§‹åŒ–å’Œæ¸…é™¤æ•´ä¸ªæµ‹è¯•æˆ–å½“å‰çš„æµ‹è¯•åŠŸèƒ½ã€‚</p><ul><li><strong>initTestCase()</strong> å°†åœ¨ç¬¬ä¸€ä¸ªæµ‹è¯•åŠŸèƒ½æ‰§è¡Œä¹‹å‰è¢«è°ƒç”¨</li><li><strong>initTestCase_data()</strong> å°†è¢«è°ƒç”¨ä»¥åˆ›å»ºå…¨å±€æµ‹è¯•æ•°æ®è¡¨</li><li><strong>cleanupTestCase()</strong> åœ¨æœ€åä¸€ä¸ªæµ‹è¯•å‡½æ•°æ‰§è¡Œåè¢«è°ƒç”¨</li><li><strong>init()</strong> å°†åœ¨æ¯ä¸ªæµ‹è¯•åŠŸèƒ½æ‰§è¡Œä¹‹å‰è¢«è°ƒç”¨</li><li><strong>cleanup()</strong> å°†åœ¨æ¯ä¸ªæµ‹è¯•å‡½æ•°ä¹‹åè°ƒç”¨</li></ul><p>ä½¿ç”¨initTestCase()å‡†å¤‡æµ‹è¯•ã€‚æ¯æ¬¡æµ‹è¯•éƒ½åº”ä½¿ç³»ç»Ÿå¤„äºå¯ç”¨çŠ¶æ€ï¼Œå› æ­¤å¯ä»¥é‡å¤è¿è¡Œã€‚æ¸…ç†æ“ä½œåº”åœ¨cleanupTestCase()ä¸­å¤„ç†ï¼Œå› æ­¤å³ä½¿æµ‹è¯•å¤±è´¥ä¹Ÿå¯ä»¥è¿è¡Œæ¸…ç†æ“ä½œã€‚</p><p>ä½¿ç”¨init()åˆ›å»ºæµ‹è¯•åŠŸèƒ½ã€‚æ¯ä¸ªæµ‹è¯•åŠŸèƒ½éƒ½åº”ä½¿ç³»ç»Ÿä¿æŒå¯ç”¨çŠ¶æ€ï¼Œä»¥ä¾¿å¯ä»¥é‡å¤è¿è¡Œã€‚æ¸…ç†æ“ä½œåº”åœ¨cleanup()ä¸­ï¼Œå³ä½¿æµ‹è¯•åŠŸèƒ½å¤±è´¥å¹¶æå‰é€€å‡ºï¼Œæ¸…ç†åŠ¨ä½œä¹Ÿå¯ä»¥è¿è¡Œã€‚</p><p>å¦å¤–ï¼Œå¯ä»¥ä½¿ç”¨RAII,å¹¶åœ¨ææ„å‡½æ•°ä¸­è°ƒç”¨æ¸…é™¤æ“ä½œï¼Œä»¥ç¡®ä¿ä»–ä»¬åœ¨æµ‹è¯•å‡½æ•°è¿”å›ä¸”å¯¹è±¡ç§»å‡ºä½œç”¨åŸŸæ—¶å‘ç”Ÿã€‚</p><p>å¦‚æœinitTestCase()å¤±è´¥ï¼Œå°†ä¸æ‰§è¡Œä»»ä½•æµ‹è¯•åŠŸèƒ½ã€‚å¦‚æœinit()å¤±è´¥ï¼Œåˆ™ä¸æ‰§è¡Œä»¥ä¸‹æµ‹è¯•åŠŸèƒ½ï¼Œæµ‹è¯•å°†ç»§ç»­è¿›è¡Œä¸‹ä¸€ä¸ªæµ‹è¯•åŠŸèƒ½ã€‚</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Test</span> : <span class="keyword">public</span> QObject &#123;</span><br><span class="line">  Q_OBJECT</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">  <span class="function"><span class="type">bool</span> <span class="title">verify</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="keyword">private</span> slots:</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">initTestCase</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;init test case&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">firstTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">QVERIFY</span>(<span class="literal">true</span>);</span><br><span class="line">    <span class="built_in">QCOMPARE</span>(<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">secondTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">QVERIFY</span>(<span class="built_in">verify</span>());</span><br><span class="line">    <span class="built_in">QVERIFY</span>(<span class="number">1</span> != <span class="number">2</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">cleanupTestCase</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;clean test case&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æœ€åï¼Œå¦‚æœæµ‹è¯•ç±»å…·æœ‰é™æ€ä¸”å…¬å…±çš„void initMain()æ–¹æ³•ï¼Œåˆ™åœ¨å®ä¾‹åŒ–QApplicationå¯¹è±¡ä¹‹å‰ï¼Œç”±QTEST_MAINå®è°ƒç”¨è¯¥æ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œè¿™å…è®¸è®¾ç½®åº”ç”¨ç¨‹åºçš„å±æ€§ï¼Œä¾‹å¦‚Qt::AA_DisableHighDpiScalingã€‚è¿™æ˜¯åœ¨Qt5.14æ·»åŠ çš„ã€‚</p><h3 id="ä½¿ç”¨CMakeå’ŒCTestæ„å»ºæµ‹è¯•é¡¹ç›®"><a href="#ä½¿ç”¨CMakeå’ŒCTestæ„å»ºæµ‹è¯•é¡¹ç›®" class="headerlink" title="ä½¿ç”¨CMakeå’ŒCTestæ„å»ºæµ‹è¯•é¡¹ç›®"></a>ä½¿ç”¨CMakeå’ŒCTestæ„å»ºæµ‹è¯•é¡¹ç›®</h3><p>CMakeè¿˜æœ‰å…¶ä»–ä¼˜ç‚¹ã€‚ä¾‹å¦‚ï¼Œå‡ ä¹å¯ä»¥æ¯«ä¸è´¹åŠ›åœ°ä½¿ç”¨CDashå°†æµ‹è¯•è¿è¡Œçš„ç»“æœå‘å¸ƒåˆ°WebæœåŠ¡å™¨ä¸Šã€‚</p><p>CTestå¯ä»¥æ‰©å±•åˆ°éå¸¸ä¸åŒçš„å•å…ƒæµ‹è¯•æ¡†æ¶ï¼Œå¹¶ä¸”å¯ä»¥ä¸QTestä¸€èµ·ä½¿ç”¨ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">project(mytest LANGUAGES CXX)</span><br><span class="line">include(CTest)</span><br><span class="line">include(Dart)</span><br><span class="line">find_package(Qt5 COMPONENTS Test REQUIRED)</span><br><span class="line">set(CMAKE_INCLUDE_CURRENT_DIR ON)</span><br><span class="line">set(CMAKE_AUTOMOC ON)</span><br><span class="line">add_executable(mytest tst_mytest.cpp)</span><br><span class="line">add_test(NAME mytest COMMAND mytest)</span><br><span class="line">target_link_libraries(mytest PRIVATE Qt5::Test)</span><br></pre></td></tr></table></figure><h2 id="google-test"><a href="#google-test" class="headerlink" title="google test"></a>google test</h2><p>google test(gtest)æ˜¯googleå…¬å¸æ¨å‡ºçš„c++å•å…ƒæµ‹è¯•æ¡†æ¶ï¼ŒåŸºäºxUnitæ¶æ„ï¼Œå¹¶ä¸”æ”¯æŒLinuxã€Windowså’Œmacï¼Œå¹¶ä¸”æ”¯æŒä»»ä½•ç±»å‹çš„æµ‹è¯•å’Œæ¨¡æ‹Ÿï¼Œè€Œä¸ä»…ä»…æ˜¯å•å…ƒæµ‹è¯•ã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h3><p>å½“ä½¿ç”¨gtestæ—¶ï¼Œé€šè¿‡ç¼–å†™æ–­è¨€æ¥æ£€æŸ¥æ¡ä»¶æ˜¯å¦ä¸ºçœŸã€‚æ–­è¨€çš„ç»“æœå¯èƒ½æ˜¯æˆåŠŸã€éè‡´å‘½å¤±è´¥æˆ–è€…è‡´å‘½å¤±è´¥ã€‚å¦‚æœå‘ç”Ÿè‡´å‘½æ•…éšœï¼Œå°†ç»ˆæ­¢å½“å‰åŠŸèƒ½ï¼Œå¦åˆ™å°†ç»§ç»­è¿è¡Œã€‚</p><p>ä¸€ä¸ªæµ‹è¯•å¥—ä»¶åŒ…å«ä¸€ä¸ªæˆ–è€…å¤šä¸ªæµ‹è¯•ã€‚å½“æµ‹è¯•å¥—ä»¶ä¸­çš„å¤šä¸ªæµ‹è¯•éœ€è¦å…±äº«é€šç”¨å¯¹è±¡å’Œå­ä¾‹ç¨‹æ—¶ï¼Œå¯ä»¥å°†ä»–ä»¬æ”¾å…¥ä¸€ä¸ªæµ‹è¯•æ¡¶ä¸­ã€‚</p><p>ä¸€ä¸ªæµ‹è¯•ç¨‹åºå¯ä»¥åŒ…å«å¤šä¸ªæµ‹è¯•å¥—ä»¶ã€‚</p><h3 id="æ–­è¨€-1"><a href="#æ–­è¨€-1" class="headerlink" title="æ–­è¨€"></a>æ–­è¨€</h3><p>gtestæ–­è¨€ç±»ä¼¼äºå‡½æ•°è°ƒç”¨çš„å®ï¼Œå¯ä»¥é€šè¿‡æ–­è¨€å…¶è¡Œä¸ºæ¥æµ‹è¯•ç±»æˆ–è€…å‡½æ•°ã€‚æ–­è¨€å¤±è´¥æ—¶ï¼Œgtestä¼šè¾“å‡ºæ–­è¨€çš„æºæ–‡ä»¶å’Œè¡Œå·ä½ç½®ä»¥åŠå¤±è´¥æ¶ˆæ¯ã€‚è¿˜å¯ä»¥æä¾›è‡ªå®šä¹‰å¤±è´¥æ¶ˆæ¯ï¼Œè¯¥æ¶ˆæ¯å°†ä¼šé™„åŠ åˆ°gtestçš„æ¶ˆæ¯ä¹‹åã€‚</p><p>æ–­è¨€æˆå¯¹å‡ºç°ï¼Œæµ‹è¯•ç›¸åŒçš„äº‹ç‰©ï¼Œä½†æ˜¯å¯¹å½“å‰å‡½æ•°æœ‰ä¸åŒçš„å½±å“ã€‚ASSERT_*ç‰ˆæœ¬å¤±è´¥æ—¶ä¼šäº§ç”Ÿè‡´å‘½é”™è¯¯ï¼Œå¹¶ç»ˆæ­¢å½“å‰åŠŸèƒ½ã€‚EXPECT_*ä¼šäº§ç”Ÿéè‡´å‘½é”™è¯¯ï¼Œä¸ä¼šå¯¼è‡´å½“å‰æµ‹è¯•å¤±è´¥ã€‚é€šå¸¸EXPECT_*æ˜¯é¦–é€‰ï¼Œå› ä¸ºä»–ä»¬å…è®¸åœ¨æµ‹è¯•ä¸­æŠ¥å‘Šå¤šä¸ªé¼“æŒï¼Œä½†æ˜¯å¦‚æœåœ¨æ–­è¨€å¤±è´¥æ—¶ç»§ç»­è¿è¡Œå°†æ²¡æœ‰æ„ä¹‰æ—¶åº”å½“ä½¿ç”¨ASSERT_*ã€‚</p><p>ç”±äºASSERT_*å¤±è´¥ä¼šä»å½“å‰å‡½æ•°ç«‹å³è¿”å›ï¼Œå¯èƒ½ä¼šè·³è¿‡å…¶åçš„æ¸…ç†ä»£ç ï¼Œå¯¼è‡´å†…å­˜æ³„æ¼ã€‚</p><h3 id="åŸºæœ¬æ–­è¨€"><a href="#åŸºæœ¬æ–­è¨€" class="headerlink" title="åŸºæœ¬æ–­è¨€"></a>åŸºæœ¬æ–­è¨€</h3><p>åŸºæœ¬æ–­è¨€å¯ä»¥è¿›è¡ŒåŸºæœ¬çš„çœŸ&#x2F;å‡æ¡ä»¶æµ‹è¯•</p><table><thead><tr><th align="left">è‡´å‘½æ–­è¨€</th><th align="left">éè‡´å‘½æ–­è¨€</th><th align="left">éªŒè¯</th></tr></thead><tbody><tr><td align="left">ASSERT_TRUE(condition);</td><td align="left">EXPECT_TRUE(condition);</td><td align="left">conditionæ˜¯çœŸçš„</td></tr><tr><td align="left">ASSERT_FALSE(condition);</td><td align="left">EXPECT_FLASE(condition);</td><td align="left">conditionæ˜¯å‡çš„</td></tr></tbody></table><p>è¯·è®°ä½ï¼Œå½“å®ƒä»¬å¤±è´¥æ—¶ï¼Œå°†å¯¼è‡´ASSERT_*è‡´å‘½æ•…éšœå¹¶ä»å½“å‰å‡½æ•°è¿”å›ï¼Œè€Œå½“å®ƒä»¬å‘ç”ŸEXPECT_*éè‡´å‘½æ•…éšœæ—¶ï¼Œå°†å…è®¸è¯¥å‡½æ•°ç»§ç»­è¿è¡Œã€‚æ— è®ºå“ªç§æƒ…å†µï¼Œæ–­è¨€å¤±è´¥éƒ½æ„å‘³ç€å…¶åŒ…å«æµ‹è¯•å¤±è´¥ã€‚</p><h3 id="å­—ç¬¦ä¸²æ¯”è¾ƒ"><a href="#å­—ç¬¦ä¸²æ¯”è¾ƒ" class="headerlink" title="å­—ç¬¦ä¸²æ¯”è¾ƒ"></a>å­—ç¬¦ä¸²æ¯”è¾ƒ</h3><p>è¯¥ç»„ä¸­çš„æ–­è¨€æ¯”è¾ƒä¸¤ä¸ªCå­—ç¬¦ä¸²ã€‚å¦‚æœè¦æ¯”è¾ƒä¸¤ä¸ªstringå¯¹è±¡ï¼Œè¯·æ”¹ç”¨EXPECT_EQï¼ŒEXPECT_NEç­‰ã€‚</p><table><thead><tr><th align="center">è‡´å‘½æ–­è¨€</th><th align="center">éè‡´å‘½æ–­è¨€</th><th align="center">éªŒè¯</th></tr></thead><tbody><tr><td align="center">ASSERT_STREQ(str1,str2);</td><td align="center">EXPECT_STREQ(str1,str2);</td><td align="center">è¿™ä¸¤ä¸ªCå­—ç¬¦ä¸²çš„å†…å®¹ç›¸åŒ</td></tr><tr><td align="center">ASSERT_STRNE(str1,str2);</td><td align="center">EXPECT_STRNE(str1,str2);</td><td align="center">ä¸¤ä¸ªCå­—ç¬¦ä¸²çš„å†…å®¹ä¸åŒ</td></tr><tr><td align="center">ASSERT_STRCASEEQ(str1,str2);</td><td align="center">EXPECT_STRCASEEQ(str1,str2);</td><td align="center">ä¸¤ä¸ªCå­—ç¬¦ä¸²çš„å†…å®¹ç›¸åŒï¼Œå¿½ç•¥å¤§å°å†™</td></tr><tr><td align="center">ASSERT_STRCASENE(str1,str2);</td><td align="center">EXPECT_STRCASENE(str1,str2);</td><td align="center">ä¸¤ä¸ªCå­—ç¬¦ä¸²çš„å†…å®¹ä¸åŒï¼Œå¿½ç•¥å¤§å°å†™</td></tr></tbody></table><p>æ³¨æ„ï¼Œæ–­è¨€åç§°ä¸­çš„â€œ CASEâ€è¡¨ç¤ºå¿½ç•¥å¤§å°å†™ã€‚ä¸€ä¸ªNULL æŒ‡é’ˆå’Œä¸€ä¸ªç©ºå­—ç¬¦ä¸²è¢«è®¤ä¸ºæ˜¯ä¸åŒçš„ã€‚</p><p><em>STREQ</em>å¹¶<em>STRNE</em>æ¥å—å®½Cå­—ç¬¦ä¸²ï¼ˆwchar_t*ï¼‰ã€‚å¦‚æœä¸¤ä¸ªå®½å­—ç¬¦ä¸²çš„æ¯”è¾ƒå¤±è´¥ï¼Œåˆ™å®ƒä»¬çš„å€¼å°†æ‰“å°ä¸ºUTF-8çª„å­—ç¬¦ä¸²ã€‚</p><h3 id="ç®€å•æµ‹è¯•"><a href="#ç®€å•æµ‹è¯•" class="headerlink" title="ç®€å•æµ‹è¯•"></a>ç®€å•æµ‹è¯•</h3><p>åˆ›å»ºæµ‹è¯•ï¼š</p><ol><li>ä½¿ç”¨TEST()å®å®šä¹‰å’Œå‘½åæµ‹è¯•åŠŸèƒ½ã€‚è¿™äº›æ˜¯æ²¡æœ‰è¿”å›å€¼çš„æ™®é€šC++å‡½æ•°ã€‚</li><li>åœ¨æ­¤å‡½æ•°ï¼Œè¦ä¸åŒ…å«çš„æ‰€æœ‰æœ‰æ•ˆC++è¯­å¥ä¸€èµ·ä½¿ç”¨å„ç§gtestæ–­è¨€æ¥æ£€æŸ¥ã€‚</li><li>æµ‹è¯•ç»“æœç”±æ–­è¨€ç¡®å®šï¼Œå¦‚æœæµ‹è¯•ä¸­çš„ä»»ä½•å£°æ˜å¤±è´¥ï¼ˆè‡´å‘½æˆ–éè‡´å‘½ï¼‰ï¼Œæˆ–è€…æµ‹è¯•å´©æºƒï¼Œæ•´ä¸ªæµ‹è¯•éƒ½ä¼šå¤±è´¥ï¼Œå¦åˆ™æµ‹è¯•åº”å½“æˆåŠŸã€‚</li></ol><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">TEST(TestSuiteName, TestName) &#123;</span><br><span class="line">  ...æµ‹è¯•ä»£ç ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>TEST()å‡½æ•°ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æµ‹è¯•å¥—ä»¶çš„åç§°ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æµ‹è¯•å¥—ä»¶å†…çš„æµ‹è¯•åç§°ã€‚è¿™ä¸¤ä¸ªåç§°éƒ½å¿…é¡»æ˜¯æœ‰æ•ˆçš„C++æ ‡è¯†ç¬¦ï¼Œå¹¶ä¸”ä¸åº”åŒ…å«ä»»ä½•ä¸‹åˆ’çº¿ã€‚æ¥è‡ªä¸åŒæµ‹è¯•å¥—ä»¶çš„æµ‹è¯•å¯ä»¥å…·æœ‰ç›¸åŒçš„åç§°ã€‚</p><h1 id="å‚è€ƒèµ„æ–™ï¼š"><a href="#å‚è€ƒèµ„æ–™ï¼š" class="headerlink" title="å‚è€ƒèµ„æ–™ï¼š"></a>å‚è€ƒèµ„æ–™ï¼š</h1><h2 id="qtest"><a href="#qtest" class="headerlink" title="qtest"></a>qtest</h2><p><a href="https://doc.qt.io/qt-5/qtest.html">https://doc.qt.io/qt-5/qtest.html</a></p><h2 id="gtest"><a href="#gtest" class="headerlink" title="gtest"></a>gtest</h2><p><a href="https://github.com/google/googletest/blob/master/googletest/docs/primer.md">https://github.com/google/googletest/blob/master/googletest/docs/primer.md</a></p>]]></content>
      
      
      <categories>
          
          <category> unit test </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
            <tag> Qt </tag>
            
            <tag> CMake </tag>
            
            <tag> GTest </tag>
            
            <tag> CTest </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CPPé¡¹ç›®çš„ä¸€äº›å‘</title>
      <link href="/2020/06/15/CPP%E9%A1%B9%E7%9B%AE%E7%9A%84%E4%B8%80%E4%BA%9B%E5%9D%91/"/>
      <url>/2020/06/15/CPP%E9%A1%B9%E7%9B%AE%E7%9A%84%E4%B8%80%E4%BA%9B%E5%9D%91/</url>
      
        <content type="html"><![CDATA[<p>æœ¬ç¯‡æ–‡ç« è®°å½•è¿™å‡ å¹´é¡¹ç›®ä¸­C++çš„ä¸€äº›é—®é¢˜å’Œä¼˜åŒ–æ–¹æ³•ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä»£ç ä¼˜åŒ–æ²¡æœ‰ä¸€æœ¬ä¸‡åˆ©çš„æ–¹æ³•ï¼Œåªèƒ½è§æ‹›æ‹†æ‹›ï¼Œè€Œä¸”è¿˜è¦é¿å…è¿‡æ—©ä¼˜åŒ–ç­‰é—®é¢˜ï¼Œä»£ç ä¼˜åŒ–ä¸€å®šæ˜¯è¦ä¸­åæœŸæ‰å¯ä»¥ï¼Œè€Œä¸”ä¸è¦ä¸ºäº†ä¼˜åŒ–è€Œä¼˜åŒ–ã€‚</p><span id="more"></span><h2 id="constå’Œconst"><a href="#constå’Œconst" class="headerlink" title="constå’Œconst &amp;"></a>constå’Œconst &amp;</h2><p>åœ¨æ¥æ”¶ä¸€ä¸ªè¿”å›å€¼æˆ–è€…å£°æ˜å±€éƒ¨åªè¯»å˜é‡æ—¶æ²¡æœ‰ä½¿ç”¨constä¿®é¥°ã€‚constçš„ç›®çš„ä¸ä»…ä»…æ˜¯ä¸ºäº†åªè¯»ï¼Œæ›´å¤šçš„æ˜¯ç¼–è¯‘å™¨å¯ä»¥åœ¨æ­¤å¤„æä¾›ä¼˜åŒ–ã€‚</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">QRectâ€¯rectâ€¯=â€¯m_displayInter-&gt;<span class="built_in">primaryRawRect</span>();</span><br><span class="line">qrealâ€¯scaleâ€¯=â€¯qApp-&gt;<span class="built_in">primaryScreen</span>()-&gt;<span class="built_in">devicePixelRatio</span>();</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸¤è¡Œä¾‹å­ä¸­ï¼Œreactå’Œscaleéƒ½åœ¨å½“å‰å‡½æ•°å†…æ²¡æœ‰ä»»ä½•ä¿®æ”¹ï¼Œè€Œä¸”ä¸åº”è¯¥ä¿®æ”¹ï¼Œéœ€è¦æ·»åŠ constæ¥ä¿®é¥°åªè¯»ï¼Œå¹¶ä¸”QRectåº”è¯¥ä½¿ç”¨&amp;æ¥å‡å°‘å†…å­˜å¤åˆ¶å¸¦æ¥çš„é¢å¤–å½±å“ã€‚</p><h2 id="ç±»å‹å¼ºè½¬"><a href="#ç±»å‹å¼ºè½¬" class="headerlink" title="ç±»å‹å¼ºè½¬"></a>ç±»å‹å¼ºè½¬</h2><p>åœ¨éƒ¨åˆ†ä»£ç ä¸­ï¼Œç»å¸¸èƒ½çœ‹åˆ°Cé£æ ¼çš„ä»£ç å¼ºè½¬ï¼Œåº”å½“æ ¹æ®å…·ä½“æƒ…å†µä½¿ç”¨static_castã€dynamic_castå’Œreinterpret_castã€‚</p><p>static_castæ˜¯ä½¿ç”¨çš„æ¯”è¾ƒå¤šçš„castï¼Œç»å¸¸ç”¨äºæ´¾ç”Ÿç±»å’ŒåŸºç±»ä¹‹é—´è½¬æ¢ã€‚dynamic_castä¹Ÿç”¨äºæ´¾ç”Ÿç±»å’ŒåŸºç±»çš„è½¬æ¢ï¼Œå¦‚æœç±»å‹Tæ˜¯æŒ‡é’ˆç±»å‹ï¼Œè‹¥è½¬æ¢å¤±è´¥ï¼Œåˆ™è¿”å›Tç±»å‹çš„ç©ºæŒ‡é’ˆï¼Œå¦‚æœæ—¶Tæ˜¯å¼•ç”¨ç±»å‹ï¼Œåˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œè¿”å›std::bad_castã€‚reinterpret_castå¹¶ä¸ä¼šåšå®é™…çš„è½¬æ¢ï¼Œåªä¼šåœ¨ç¼–è¯‘æ—¶è¿›è¡Œæ£€æŸ¥ï¼Œå¦‚æœä¸èƒ½è¿›è¡Œcastè½¬æ¢ï¼Œåˆ™ç¼–è¯‘æŠ¥é”™ã€‚</p><h2 id="è¿‡å¤šçš„åµŒå¥—"><a href="#è¿‡å¤šçš„åµŒå¥—" class="headerlink" title="è¿‡å¤šçš„åµŒå¥—"></a>è¿‡å¤šçš„åµŒå¥—</h2><p>è¿‡å¤šçš„åµŒå¥—ä¼šä¸¥é‡å½±å“ä»£ç é˜…è¯»ï¼Œç»å¸¸å‡ºç°åªæœ‰ifé€šè¿‡æ‰ä¼šè¿›å…¥æ‰§è¡Œçš„æƒ…å†µï¼Œè¿™ç§æƒ…å†µåº”è¯¥ä¿®æ”¹ä¸ºä¸é€šè¿‡å°±ä¸è¦ç»§ç»­æ‰§è¡Œï¼Œæˆ–è€…å®‰æ’åˆç†çš„ifå°†æ¡ä»¶é™åˆ¶åœ¨ä¹‹å‰ã€‚</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">BluetoothWorker::setAdapterPowered</span><span class="params">(<span class="type">const</span> Adapter *adapter, <span class="type">const</span> <span class="type">bool</span> &amp;powered)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">QDBusObjectPath <span class="title">path</span><span class="params">(adapter-&gt;id())</span></span>;</span><br><span class="line">    <span class="comment">//å…³é—­è“ç‰™ä¹‹å‰åˆ é™¤å†å²è“ç‰™è®¾å¤‡åˆ—è¡¨ï¼Œç¡®ä¿å®Œå…¨æ˜¯åˆ é™¤åå†è®¾ç½®å¼€å…³</span></span><br><span class="line">    <span class="keyword">if</span> (!powered) &#123;</span><br><span class="line">        QDBusPendingCall call = m_bluetoothInter-&gt;<span class="built_in">ClearUnpairedDevice</span>();</span><br><span class="line">        QDBusPendingCallWatcher *watcher = <span class="keyword">new</span> <span class="built_in">QDBusPendingCallWatcher</span>(call, <span class="keyword">this</span>);</span><br><span class="line">        <span class="built_in">connect</span>(watcher, &amp;QDBusPendingCallWatcher::finished, [ = ] &#123;</span><br><span class="line">            <span class="keyword">if</span> (!call.<span class="built_in">isError</span>()) &#123;</span><br><span class="line">                QDBusPendingCall adapterPoweredOffCall  = m_bluetoothInter-&gt;<span class="built_in">SetAdapterPowered</span>(path, <span class="literal">false</span>);</span><br><span class="line">                QDBusPendingCallWatcher *watcher = <span class="keyword">new</span> <span class="built_in">QDBusPendingCallWatcher</span>(adapterPoweredOffCall, <span class="keyword">this</span>);</span><br><span class="line">                <span class="built_in">connect</span>(watcher, &amp;QDBusPendingCallWatcher::finished, [<span class="keyword">this</span>, adapterPoweredOffCall, adapter] &#123;</span><br><span class="line">                    <span class="keyword">if</span> (!adapterPoweredOffCall.<span class="built_in">isError</span>()) &#123;</span><br><span class="line">                        <span class="built_in">setAdapterDiscoverable</span>(adapter-&gt;<span class="built_in">id</span>());</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="built_in">qWarning</span>() &lt;&lt; adapterPoweredOffCall.<span class="built_in">error</span>().<span class="built_in">message</span>();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="built_in">qWarning</span>() &lt;&lt; call.<span class="built_in">error</span>().<span class="built_in">message</span>();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        QDBusPendingCall adapterPoweredOnCall  = m_bluetoothInter-&gt;<span class="built_in">SetAdapterPowered</span>(path, <span class="literal">true</span>);</span><br><span class="line">        QDBusPendingCallWatcher *watcher = <span class="keyword">new</span> <span class="built_in">QDBusPendingCallWatcher</span>(adapterPoweredOnCall, <span class="keyword">this</span>);</span><br><span class="line">        <span class="built_in">connect</span>(watcher, &amp;QDBusPendingCallWatcher::finished, [<span class="keyword">this</span>, adapterPoweredOnCall, adapter] &#123;</span><br><span class="line">            <span class="keyword">if</span> (!adapterPoweredOnCall.<span class="built_in">isError</span>()) &#123;</span><br><span class="line">                <span class="built_in">setAdapterDiscoverable</span>(adapter-&gt;<span class="built_in">id</span>());</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="built_in">qWarning</span>() &lt;&lt; adapterPoweredOnCall.<span class="built_in">error</span>().<span class="built_in">message</span>();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„ä»£ç å…¶å®æ˜¯å¯ä»¥ä¼˜åŒ–çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‰å…ƒè¡¨è¾¾å¼è·å–æŸä¸ªQDBusPendingCallï¼Œè¿™æ ·å°±å¯ä»¥ä½¿ç”¨ä¸€ä¸ªQDBusPendingCallWatcherå¯¹è±¡ï¼Œç„¶åå°†åŸæœ¬çš„lambdaå†…å®¹æå–åˆ°å…¶ä»–å‡½æ•°å†…ï¼Œåœ¨æ–°çš„lambdaä¸­åŒæ ·ä½¿ç”¨ä¸‰å…ƒè¡¨è¾¾å¼è¿è¡Œå¯¹åº”çš„å‡½æ•°ï¼Œè¿™æ ·æ‹†åˆ†ä»£ç çš„å¥½å¤„æ˜¯ï¼Œé˜…è¯»ä»£ç æ—¶çš„é¡ºåºä¼šå’Œæ‰§è¡Œé¡ºåºä¸€è‡´ï¼Œåˆ†æ”¯åˆ¤æ–­å¯¹æœºå™¨å’Œäººç±»éƒ½ä¸æ˜¯å¤ªå‹å¥½ï¼Œç‰¹åˆ«æ˜¯åˆ¤æ–­ä½“å†…æœ‰å¾ˆé•¿çš„ä»£ç æ®µï¼Œæ‰¾åˆ°elseæ®µæ˜¯ä¸€ä»¶ä¸å®¹æ˜“çš„äº‹æƒ…ï¼Œé€šè¿‡é™ä½if elseå—æ¥æé«˜ä»£ç å¯è¯»æ€§ã€‚åŒæ—¶åº”æå–ç›¸åŒåŠ¨ä½œçš„ä»£ç åˆ°å…¬å…±åŒºåŸŸï¼Œä»¥å…å°†æ¥ä¿®æ”¹æ—¶å‘ç°æ²¡æœ‰å°†æ‰€æœ‰çš„åœ°æ–¹éƒ½åšä¿®æ”¹ã€‚</p><h2 id="å¾ªç¯"><a href="#å¾ªç¯" class="headerlink" title="å¾ªç¯"></a>å¾ªç¯</h2><p>é¿å…ä½¿ç”¨æ•°ç»„çš„æ–¹å¼æ¥è®¿é—®å…ƒç´ ï¼Œä½¿ç”¨è¿­ä»£å™¨çš„æ–¹å¼ç»Ÿä¸€å¾ªç¯æ–¹å¼ã€‚</p><p>æˆ‘æ³¨æ„åˆ°æœ‰äº›æƒ…å†µä¸‹ï¼Œæœ‰äººåœ¨forå¾ªç¯å†…ç›´æ¥å®šä¹‰é™æ€å˜é‡ï¼Œè¿™ç§æ–¹å¼ä½¿ç”¨çš„æ—¶å€™éœ€è¦æ³¨æ„ï¼Œé™æ€å˜é‡å°†ä¼šæ°¸è¿œå­˜åœ¨ï¼Œä½†æ˜¯å¤§éƒ¨åˆ†forå¾ªç¯å†…éœ€è¦ä¿å­˜çš„æ•°æ®éƒ½æ˜¯æˆå‘˜å˜é‡ï¼Œå¦åˆ™å†…å­˜ç©ºé—´å°†æ°¸è¿œä¸ä¼šé‡Šæ”¾ï¼Œå¯¹å†…å­˜æœ‰æµªè´¹ã€‚</p><p>è€Œä¸”ç»å¸¸é‡åˆ°çš„é—®é¢˜å°±æ˜¯foreachå®å’Œforæ··ç”¨ï¼Œåœ¨è¯­æ³•ä¸Šå°±æ²¡æœ‰ç»Ÿä¸€ä½¿ç”¨ã€‚</p><p>æˆ‘æ¨èçš„æ–¹å¼æ˜¯for+è¿­ä»£å™¨çš„æ–¹å¼ï¼Œå¦‚æœæ˜¯ç®€å•éå†ï¼Œä½¿ç”¨åŸç”Ÿçš„foreachè¯­æ³•å³å¯ã€‚</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">std::list&lt;<span class="type">int</span>&gt; list&#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åŸç”Ÿforeachè¯­æ³•ï¼Œæ¨èåªè¯»éå†ä½¿ç”¨</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> item: list) &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// for+è¿­ä»£å™¨ï¼Œåªè¯»éå†</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> it = list.<span class="built_in">cbegin</span>(); it != list.<span class="built_in">cend</span>(); ++it) &#123;</span><br><span class="line">    <span class="comment">// itæ˜¯è¿­ä»£å™¨å¯¹è±¡ï¼Œéœ€è¦è§£å¼•ç”¨ä½¿ç”¨ã€‚</span></span><br><span class="line">    *it</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// for+è¿­ä»£å™¨æ–¹å¼ï¼Œæ¨èéœ€è¦ä¿®æ”¹å®¹å™¨çš„é•¿åº¦ä½¿ç”¨</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> it = list.<span class="built_in">begin</span>(); it != list.<span class="built_in">end</span>();) &#123;</span><br><span class="line">    <span class="comment">// æ³¨æ„ï¼Œå¦‚æœè¦ç§»é™¤æŸä¸ªå…ƒç´ ï¼Œéœ€è¦æ‰‹åŠ¨ä¸‹ä¸€æ­¥</span></span><br><span class="line">    <span class="keyword">if</span> (*it == <span class="number">2</span>) &#123;</span><br><span class="line">        it = list.<span class="built_in">erase</span>(it);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        ++it;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å†…å­˜æ³„æ¼"><a href="#å†…å­˜æ³„æ¼" class="headerlink" title="å†…å­˜æ³„æ¼"></a>å†…å­˜æ³„æ¼</h2><p>ç»å¸¸é‡åˆ°ä½¿ç”¨å®¹å™¨å°†æŒ‡é’ˆä¿å­˜ä¸‹æ¥çš„åœºæ™¯ï¼Œä½†æ˜¯å½“å¯¹è±¡è¢«ææ„æˆ–è€…å®¹å™¨è¢«æ¸…ç©ºçš„æ—¶å€™ï¼Œæœ‰æ—¶å€™ä¼šå¿˜è®°åˆ é™¤å†…éƒ¨çš„å¯¹è±¡ï¼Œæˆ–è€…åˆ é™¤äº†ä¸è¯¥åˆ é™¤çš„å¯¹è±¡ã€‚å¯¹æ•°æ®çš„å¤„ç†åº”è¯¥ä¿æŒRAIIåŸåˆ™ï¼Œé¿å…ç›´æ¥ä½¿ç”¨è£¸æŒ‡é’ˆï¼Œè€Œæ˜¯é€šè¿‡æ™ºèƒ½æŒ‡é’ˆå°†æŒ‡é’ˆä¿å­˜èµ·æ¥ï¼Œå½“æœ€åä¸€ä¸ªå¯¹è±¡ä¸å†æŒæœ‰æ™ºèƒ½æŒ‡é’ˆå¯¹è±¡æ—¶ï¼Œæ™ºèƒ½æŒ‡é’ˆä¼šåˆ é™¤æŒæœ‰çš„å¯¹è±¡ï¼Œå®Œæˆå†…å­˜é‡Šæ”¾ã€‚</p><p>æ™ºèƒ½æŒ‡é’ˆçš„ç±»å‹</p><p>æ™ºèƒ½æŒ‡é’ˆåŒ…å«æœ‰ä¸‰ç§ï¼šç‹¬å æŒ‡é’ˆ<code>unique_ptr</code>ã€å…±äº«æŒ‡é’ˆ<code>shared_ptr</code>å’Œå¼±å¼•ç”¨æŒ‡é’ˆ<code>week_ptr</code>ã€‚</p><h3 id="ç‹¬å æŒ‡é’ˆ"><a href="#ç‹¬å æŒ‡é’ˆ" class="headerlink" title="ç‹¬å æŒ‡é’ˆ"></a>ç‹¬å æŒ‡é’ˆ</h3><p>ç‹¬å æŒ‡é’ˆ<code>std::unique_ptr</code>å¯ä»¥é¿å…å¯¹è±¡è¢«è½¬ç§»åˆ°å…¶ä»–å¯¹è±¡ä¸­ï¼Œå¦‚æœæŸä¸ªå¯¹è±¡æŒæœ‰<code>unique_ptr</code>ï¼Œåˆ™è¯¥pträ¸å…è®¸è½¬ç§»ç»™å…¶ä»–å¯¹è±¡ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨<code>std::move</code>æ¥è½¬ç§»æ§åˆ¶æƒï¼Œæ³¨æ„è¿™å’Œæ™®é€šçš„è½¬ç§»ä¸ä¸€æ ·ï¼Œ<code>unique_ptr</code>ç¦æ­¢çš„æ˜¯æ‹·è´ï¼Œä½†æ˜¯æ²¡æœ‰ç¦æ­¢ç§»åŠ¨ï¼Œæˆ‘ä»¬å¯ä»¥è½¬ç§»æ§åˆ¶è½¬ï¼Œ<code>unique_ptr</code>ä¿è¯çš„æ˜¯åªæœ‰ä¸€ä¸ªæ™ºèƒ½æŒ‡é’ˆæŒæœ‰å¯¹è±¡ã€‚</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">std::unique_ptr&lt;T&gt; p1 = std::<span class="built_in">move</span>(ptr);</span><br></pre></td></tr></table></figure><h3 id="å…±äº«æŒ‡é’ˆ"><a href="#å…±äº«æŒ‡é’ˆ" class="headerlink" title="å…±äº«æŒ‡é’ˆ"></a>å…±äº«æŒ‡é’ˆ</h3><p>å…±äº«æŒ‡é’ˆ<code>std::shared_ptr</code>é¡¾åæ€ä¹‰æ˜¯ç”¨ä½œå…±äº«çš„ï¼Œå’Œç‹¬å æŒ‡é’ˆä¸åŒçš„æ˜¯ï¼Œå®ƒæ”¯æŒå¤åˆ¶ï¼Œå†…éƒ¨é€šè¿‡å¼•ç”¨è®¡æ•°æ¥ç»´æŒå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼Œå½“æ²¡æœ‰ä»»ä½•ä¸€ä¸ªå¯¹è±¡æŒæœ‰å…±äº«æŒ‡é’ˆæ—¶ï¼Œä¹Ÿå°±æ„å‘³ç€æ²¡æœ‰ä»»ä½•ä¸€ä¸ªå¯¹è±¡å¯ä»¥è®¿é—®åˆ°å†…éƒ¨å¯¹è±¡äº†ï¼Œå°±å¯ä»¥å®‰å…¨çš„åˆ é™¤å¯¹è±¡ï¼Œé‡Šæ”¾å†…å­˜ã€‚</p><h4 id="å¼±å¼•ç”¨æŒ‡é’ˆ"><a href="#å¼±å¼•ç”¨æŒ‡é’ˆ" class="headerlink" title="å¼±å¼•ç”¨æŒ‡é’ˆ"></a>å¼±å¼•ç”¨æŒ‡é’ˆ</h4><p>å¼±å¼•ç”¨æŒ‡é’ˆ<code>std::week_ptr</code>æ˜¯ä¸ºäº†é¿å…ä¸¤ä¸ªå…±äº«æŒ‡é’ˆç›¸äº’æŒæœ‰å¯¼è‡´å¼•ç”¨è®¡æ•°æ°¸è¿œä¸ä¼šå½’é›¶ï¼Œå¯¼è‡´å†…å­˜æ°¸è¿œä¸é‡Šæ”¾è€Œæå‡ºçš„è§£å†³æ–¹æ¡ˆï¼Œå…·ä½“å°±æ˜¯å¼±å¼•ç”¨æŒ‡é’ˆä¸ä¼šå¯¼è‡´å¼•ç”¨è®¡æ•°å¢åŠ ï¼Œä½†æ˜¯week_ptråŒæ ·ä¸æ”¯æŒå¤åˆ¶ï¼Œå¿…é¡»è½¬æ¢ä¸ºå…±äº«æŒ‡é’ˆ<code>std::shared_ptr</code>ã€‚</p><h2 id="ä¼˜åŒ–åˆ¤æ–­æ¡ä»¶"><a href="#ä¼˜åŒ–åˆ¤æ–­æ¡ä»¶" class="headerlink" title="ä¼˜åŒ–åˆ¤æ–­æ¡ä»¶"></a>ä¼˜åŒ–åˆ¤æ–­æ¡ä»¶</h2><p>å¯¹äºå¸¸æ•°çš„åˆ¤æ–­ï¼Œå°½é‡ä½¿ç”¨å®æˆ–è€…å®šä¹‰é™æ€å¸¸é‡æ¥é¿å…ç›´æ¥ä½¿ç”¨æ•°å­—æˆ–è€…å­—ç¬¦åˆ¤æ–­ã€‚</p><h2 id="æ’åº"><a href="#æ’åº" class="headerlink" title="æ’åº"></a>æ’åº</h2><p>å‘ç°å¾ˆå¤šäººåœ¨éœ€è¦æ’åºçš„æ—¶å€™æ€»æ˜¯ä½¿ç”¨å†’æ³¡ç®—æ³•ï¼Œæˆ‘ä»‹ç»å‡ ä¸ªæ¯”è¾ƒæ–¹ä¾¿çš„æ’åºæ–¹æ³•ã€‚</p><h3 id="ä½¿ç”¨std-sort"><a href="#ä½¿ç”¨std-sort" class="headerlink" title="ä½¿ç”¨std::sort"></a>ä½¿ç”¨std::sort</h3><p>C++æ ‡å‡†åº“æä¾›äº†<code>std::sort</code>æ–¹æ³•æ¥æ–¹ä¾¿çš„æ’åºï¼Œå®ƒæœ‰ä¸‰ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å®¹å™¨çš„beginè¿­ä»£å™¨ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯endè¿­ä»£å™¨ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ¥æ”¶ä¸€ä¸ªè¿”å›å€¼ä¸ºboolç±»å‹çš„å‡½æ•°ï¼Œè¯¥å‡½æ•°ç”¨äºå®ç°æ‰‹åŠ¨æ§åˆ¶æ’åºçš„åˆ¤æ–­ã€‚</p><p>æˆ‘ä»¬å¯ä»¥æä¾›ä¸€ä¸ªlambdaè¡¨è¾¾å¼æ¥æ–¹ä¾¿çš„æ§åˆ¶æ’åºï¼Œæˆ–è€…æä¾›ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆã€‚</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">std::list&lt;<span class="type">int</span>&gt; list&#123; <span class="number">10</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">5</span> &#125;;</span><br><span class="line"></span><br><span class="line">std::<span class="built_in">sort</span>(list.<span class="built_in">begin</span>(), list.<span class="built_in">end</span>(), [](<span class="type">int</span> num1, <span class="type">int</span> num2) &#123;</span><br><span class="line">    <span class="keyword">return</span> num1 &lt; num2;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>è¿™ç§æ’åºæ–¹å¼æ˜¯ç›´æ¥å¯¹åŸå§‹å®¹å™¨è¿›è¡Œæ“ä½œçš„ï¼Œå¦‚æœä¸å¸Œæœ›æ•°æ®æˆä¸ºè„æ•°æ®ï¼Œåº”è¯¥å…ˆå¤åˆ¶ä¸€ä»½ã€‚</p><h3 id="ä½¿ç”¨å®¹å™¨"><a href="#ä½¿ç”¨å®¹å™¨" class="headerlink" title="ä½¿ç”¨å®¹å™¨"></a>ä½¿ç”¨å®¹å™¨</h3><p>ä½¿ç”¨å®¹å™¨çš„æ–¹å¼æ¯”è¾ƒéº»çƒ¦ä¸€äº›ï¼Œæˆ‘ä»¬éœ€è¦å¯¹è±¡è‡ªå·±æ”¯æŒå¤§å°æ¯”è¾ƒï¼Œæˆ–è€…é¡ºåºæ˜¯å¤–éƒ¨æŸä¸ªåˆ—è¡¨åˆ—è¡¨æ§åˆ¶çš„ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨mapå°†å†…éƒ¨æ•°æ®å’Œæ ‡è®°æ•°æ®å»ºç«‹æ˜ å°„å…³ç³»ï¼Œå†é€šè¿‡å¤–éƒ¨çš„listæˆ–è€…å…¶ä»–æ–¹å¼ï¼Œä»mapä¸­å°†æ•°æ®è¯»å‡ºæ¥ï¼Œæ·»åŠ åˆ°æ–°çš„åˆ—è¡¨å®¹å™¨ä¸­ï¼Œä»è€Œå®Œæˆæ’åºã€‚</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">[</span><br><span class="line">    <span class="string">&quot;page1&quot;</span>, <span class="string">&quot;page2&quot;</span>, <span class="string">&quot;page3&quot;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">std::map&lt;String, QWidget*&gt; map;</span><br><span class="line">â€¦</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> StringList &amp; list = QJsonDocument::<span class="built_in">fromJson</span>(<span class="built_in">readAll</span>(â€œorder.jsonâ€)).<span class="built_in">toStdList</span>();</span><br><span class="line"></span><br><span class="line">QList&lt;QWidget*&gt; pages;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">const</span> QString&amp; key : list) &#123;</span><br><span class="line">    pages &lt;&lt; map[key];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨inquireræä¾›äº¤äº’å¼git commit</title>
      <link href="/2020/06/15/%E4%BD%BF%E7%94%A8inquirer%E6%8F%90%E4%BE%9B%E4%BA%A4%E4%BA%92%E5%BC%8Fgit-commit/"/>
      <url>/2020/06/15/%E4%BD%BF%E7%94%A8inquirer%E6%8F%90%E4%BE%9B%E4%BA%A4%E4%BA%92%E5%BC%8Fgit-commit/</url>
      
        <content type="html"><![CDATA[<p>å…¬å¸è®¡åˆ’è§„èŒƒæ‰€æœ‰commitæäº¤ï¼Œå¼€å‘éƒ¨é—¨ç»¼åˆå‡ºæ¥äº†ä¸€ä»½æ¨¡æ¿ã€‚</p><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">titleï¼ˆåº”å½“ä½¿ç”¨é™ˆè¿°å¥ï¼Œç®€çŸ­çš„æè¿°è¿™ä¸ªæäº¤æ‰€åšçš„äº‹æƒ…ï¼‰</span><br><span class="line"></span><br><span class="line">Descriptionï¼ˆè¯¦ç»†è¯´æ˜ä»£ç çš„æ”¹åŠ¨ï¼ŒåŒ…å«ä»£ç çš„å®ç°æ€è·¯ï¼Œä»¥åŠä¸ºä»€ä¹ˆè¿™ä¹ˆåšï¼Œå¯èƒ½ä¼šå½±å“å“ªäº›åŠŸèƒ½ã€‚å¯¹äºä»£ç çš„å®¡æ ¸è€…ï¼Œéœ€è¦ä»è¿™æ®µæè¿°ä¸­èƒ½å®Œå…¨ç†è§£ä»£ç ä¸­æ‰€æœ‰æ”¹åŠ¨çš„å†…å®¹ï¼‰</span><br><span class="line"></span><br><span class="line">Log: å†™ä¸€æ®µé¢å‘äºäº§å“çš„æ€»ç»“æ€§å†…å®¹ï¼Œç”¨äºè‡ªåŠ¨ç”Ÿæˆcrpä¸Šçš„changlogï¼Œéœ€è¦æ³¨æ„çš„äº‹ï¼Œè¿™æ®µæè¿°å¿…é¡»ä»äº§å“çš„è§’åº¦è€ƒè™‘ã€‚</span><br><span class="line">Bug: https://xxxxxxxxxxx å¯¹åº”pms bugçš„é“¾æ¥</span><br><span class="line">Issue: fix #xx æ‰€ä¿®å¤çš„bugå¯¹äºçš„github issueï¼Œå…¶ä¸­ &quot;fix #xx&quot;æ˜¯githubå…³é—­issueçš„è§„åˆ™ï¼Œæ­¤å¤„å†…å®¹åªéœ€è¦æ»¡è¶³githubçš„è¦æ±‚å³å¯ï¼Œè¯¦æƒ…è¯·å‚è€ƒ https://help.github.com/en/enterprise/2.16/user/github/managing-your-work-on-github/closing-issues-using-keywords</span><br><span class="line">Task: http://xxxxxxxxxxxx å¯¹åº”pmsä»»åŠ¡çš„é“¾æ¥</span><br></pre></td></tr></table></figure><span id="more"></span><h2 id="python-inquirer"><a href="#python-inquirer" class="headerlink" title="python inquirer"></a>python inquirer</h2><p>ä¹‹å‰åœ¨æ˜é‡‘ä¸Šçœ‹åˆ°æœ‰äººåœ¨ä½¿ç”¨äº¤äº’å¼çš„commitæ¥è§„èŒƒcommitä¿¡æ¯ï¼Œè§‰å¾—ç”¨èµ·æ¥æŒºä¸é”™çš„ï¼Œåˆšå¥½ç¬¦åˆæœ¬æ¬¡å…¬å¸çš„è¦æ±‚ï¼Œä¸è¿‡åŸé¡¹ç›®æ˜¯nodejsçš„ï¼Œé¡¹ç›®é‡Œè‚¯å®šä¸èƒ½è®©æ¯ä¸ªå¼€å‘éƒ½å®‰è£…ä¸€ä¸ªnode,æ‰€ä»¥å°±æ‰¾ä¸€ä¸‹ä»£æ›¿å“ï¼Œç„¶åå°±å‘ç°äº†<a href="https://github.com/magmax/python-inquirer">python-inquirer</a>ã€‚</p><p>ä½¿ç”¨èµ·æ¥ä¹Ÿéå¸¸çš„æ–¹ä¾¿ï¼Œé€šè¿‡inquirer.Textã€inquirer.Listã€inquirer.Checkboxå°±å¯ä»¥åˆ›å»ºç›¸åº”çš„äº¤äº’ï¼Œå¹¶æŠŠç»„åˆå¥½çš„åˆ—è¡¨äº¤ç»™inquirer.promptå¤„ç†ï¼Œè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œå†…éƒ¨åŒ…å«äº†æ‰€æœ‰åšå‡ºçš„é€‰æ‹©ã€‚</p><h3 id="Text"><a href="#Text" class="headerlink" title="Text"></a>Text</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> inquirer</span><br><span class="line">questions = [</span><br><span class="line">  inquirer.Text(<span class="string">&#x27;name&#x27;</span>, message=<span class="string">&quot;What&#x27;s your name&quot;</span>),</span><br><span class="line">  inquirer.Text(<span class="string">&#x27;surname&#x27;</span>, message=<span class="string">&quot;What&#x27;s your surname&quot;</span>),</span><br><span class="line">  inquirer.Text(<span class="string">&#x27;phone&#x27;</span>, message=<span class="string">&quot;What&#x27;s your phone number&quot;</span>,</span><br><span class="line">                validate=<span class="keyword">lambda</span> _, x: re.<span class="keyword">match</span>(<span class="string">&#x27;\+?\d[\d ]+\d&#x27;</span>, x),</span><br><span class="line">                )</span><br><span class="line">]</span><br><span class="line">answers = inquirer.prompt(questions)</span><br></pre></td></tr></table></figure><h3 id="List"><a href="#List" class="headerlink" title="List"></a>List</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> inquirer</span><br><span class="line">questions = [</span><br><span class="line">  inquirer.<span class="type">List</span>(<span class="string">&#x27;size&#x27;</span>,</span><br><span class="line">                message=<span class="string">&quot;What size do you need?&quot;</span>,</span><br><span class="line">                choices=[<span class="string">&#x27;Jumbo&#x27;</span>, <span class="string">&#x27;Large&#x27;</span>, <span class="string">&#x27;Standard&#x27;</span>, <span class="string">&#x27;Medium&#x27;</span>, <span class="string">&#x27;Small&#x27;</span>, <span class="string">&#x27;Micro&#x27;</span>],</span><br><span class="line">            ),</span><br><span class="line">]</span><br><span class="line">answers = inquirer.prompt(questions)</span><br></pre></td></tr></table></figure><h3 id="CheckBox"><a href="#CheckBox" class="headerlink" title="CheckBox"></a>CheckBox</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> inquirer</span><br><span class="line">questions = [</span><br><span class="line">  inquirer.Checkbox(<span class="string">&#x27;interests&#x27;</span>,</span><br><span class="line">                    message=<span class="string">&quot;What are you interested in?&quot;</span>,</span><br><span class="line">                    choices=[<span class="string">&#x27;Computers&#x27;</span>, <span class="string">&#x27;Books&#x27;</span>, <span class="string">&#x27;Science&#x27;</span>, <span class="string">&#x27;Nature&#x27;</span>, <span class="string">&#x27;Fantasy&#x27;</span>, <span class="string">&#x27;History&#x27;</span>],</span><br><span class="line">                    ),</span><br><span class="line">]</span><br><span class="line">answers = inquirer.prompt(questions)</span><br></pre></td></tr></table></figure><h2 id="å…¬å¸çš„æ¨¡æ¿"><a href="#å…¬å¸çš„æ¨¡æ¿" class="headerlink" title="å…¬å¸çš„æ¨¡æ¿"></a>å…¬å¸çš„æ¨¡æ¿</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/bin/python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> inquirer</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> Template</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">number_validation</span>(<span class="params">answers, current</span>):</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">int</span>(current)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">empty_validation</span>(<span class="params">answers, current</span>):</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">bool</span>(current)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">no_validation</span>(<span class="params">answers, current</span>):</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">addList</span>(<span class="params">name, message, <span class="built_in">list</span></span>):</span><br><span class="line">  <span class="keyword">return</span> inquirer.<span class="type">List</span>(name, message, <span class="built_in">list</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">addText</span>(<span class="params">name, message, valid</span>):</span><br><span class="line">  <span class="keyword">return</span> inquirer.Text(name, message, validate=valid)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">addCheck</span>(<span class="params">_name, _message, _choices</span>):</span><br><span class="line">  <span class="keyword">return</span> inquirer.Checkbox(_name, message=_message, choices=_choices)</span><br><span class="line"></span><br><span class="line">questions = [</span><br><span class="line">  addCheck(<span class="string">&quot;action&quot;</span>, <span class="string">&quot;é€‰æ‹©éé€‰é¡¹&quot;</span>, [<span class="string">&#x27;Bug&#x27;</span>, <span class="string">&#x27;Issue&#x27;</span>, <span class="string">&#x27;Task&#x27;</span>])</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">optinalAnswers = inquirer.prompt(questions)</span><br><span class="line"></span><br><span class="line">questions = [</span><br><span class="line">  addList(<span class="string">&#x27;action&#x27;</span>, <span class="string">&quot;select you action&quot;</span>, [<span class="string">&#x27;fix&#x27;</span>, <span class="string">&#x27;feat&#x27;</span>, <span class="string">&#x27;refactor&#x27;</span>, <span class="string">&#x27;docs&#x27;</span>, <span class="string">&#x27;chore&#x27;</span>, <span class="string">&#x27;style&#x27;</span>, <span class="string">&#x27;pref&#x27;</span>, <span class="string">&#x27;test&#x27;</span>]),</span><br><span class="line">  addText(<span class="string">&quot;module&quot;</span>, <span class="string">&quot;input module name&quot;</span>, no_validation),</span><br><span class="line">  addText(<span class="string">&#x27;title&#x27;</span>, <span class="string">&quot;input title&quot;</span>, empty_validation),</span><br><span class="line">  addText(<span class="string">&#x27;description&#x27;</span>, <span class="string">&quot;input description&quot;</span>, empty_validation),</span><br><span class="line">  addText(<span class="string">&quot;log&quot;</span>, <span class="string">&quot;input log&quot;</span>, empty_validation),</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">optinal = &#123;</span><br><span class="line">  <span class="string">&quot;Bug&quot;</span>: addText(<span class="string">&quot;bug&quot;</span>, <span class="string">&quot;input bug id&quot;</span>, number_validation),</span><br><span class="line">  <span class="string">&quot;Issue&quot;</span>: addText(<span class="string">&quot;issue&quot;</span>, <span class="string">&quot;input issue id&quot;</span>, empty_validation),</span><br><span class="line">  <span class="string">&quot;Task&quot;</span>: addText(<span class="string">&quot;task&quot;</span>, <span class="string">&quot;input task id&quot;</span>, number_validation),</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">optinalMap = &#123;</span><br><span class="line">  <span class="string">&quot;Bug&quot;</span>: <span class="string">&quot;bug&quot;</span>,</span><br><span class="line">  <span class="string">&quot;Issue&quot;</span>: <span class="string">&quot;issue&quot;</span>,</span><br><span class="line">  <span class="string">&quot;Task&quot;</span>: <span class="string">&quot;task&quot;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> action <span class="keyword">in</span> optinalAnswers[<span class="string">&quot;action&quot;</span>]:</span><br><span class="line">  questions.append(optinal[action])</span><br><span class="line"></span><br><span class="line">answers = inquirer.prompt(questions)</span><br><span class="line"></span><br><span class="line">template = <span class="string">&#x27;$&#123;action&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> answers[<span class="string">&quot;module&quot;</span>]:</span><br><span class="line">  template += <span class="string">&#x27;($&#123;module&#125;)&#x27;</span></span><br><span class="line"></span><br><span class="line">template += <span class="string">&#x27;: $&#123;title&#125;\n\nDescription: $&#123;description&#125;\n\nLog: $&#123;log&#125;\n&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> action <span class="keyword">in</span> optinalAnswers[<span class="string">&quot;action&quot;</span>]:</span><br><span class="line">  template += action + <span class="string">&quot;: $&#123;&quot;</span> + optinalMap[action] + <span class="string">&quot;&#125;\n&quot;</span></span><br><span class="line"></span><br><span class="line">subprocess.run([<span class="string">&quot;git&quot;</span>, <span class="string">&quot;commit&quot;</span>, <span class="string">&quot;-m&quot;</span>, Template(template).substitute(answers)])</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="ä¿®æ”¹git-editor"><a href="#ä¿®æ”¹git-editor" class="headerlink" title="ä¿®æ”¹git editor"></a>ä¿®æ”¹git editor</h3><p>å°†ä¸Šé¢çš„å†…å®¹ä¿å­˜åˆ°&#x2F;usr&#x2F;bin&#x2F;git-inquirerã€‚</p><p>å½“æˆ‘ä»¬æ‰§è¡Œgit inquirerçš„æ—¶å€™å°±èƒ½çœ‹åˆ°äº¤äº’ï¼Œå½“æ“ä½œå®Œæˆåå¯ä»¥çœ‹åˆ°git logä¸­messageå·²ç»æ˜¯æŒ‰æ¨¡æ¿å¡«å……äº†ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vue-routerè·¯ç”±å¤ç”¨åé¡µé¢æ²¡æœ‰åˆ·æ–°</title>
      <link href="/2020/06/01/vue-router%E8%B7%AF%E7%94%B1%E5%A4%8D%E7%94%A8%E5%90%8E%E9%A1%B5%E9%9D%A2%E6%B2%A1%E6%9C%89%E5%88%B7%E6%96%B0/"/>
      <url>/2020/06/01/vue-router%E8%B7%AF%E7%94%B1%E5%A4%8D%E7%94%A8%E5%90%8E%E9%A1%B5%E9%9D%A2%E6%B2%A1%E6%9C%89%E5%88%B7%E6%96%B0/</url>
      
        <content type="html"><![CDATA[<p>vue-routeræä¾›äº†é¡µé¢è·¯ç”±åŠŸèƒ½ï¼Œå¯ä»¥ç”¨æ¥æ„å»ºå•é¡µé¢åº”ç”¨ï¼Œåœ¨ä½¿ç”¨vue-routerçš„åŠ¨æ€è·¯ç”±åŒ¹é…çš„æ—¶å€™ï¼Œé‡åˆ°äº†urlå˜åŒ–äº†ï¼Œä½†æ˜¯é¡µé¢å´æ²¡æœ‰ä»»ä½•åŠ¨é™çš„é—®é¢˜ï¼Œè®°å½•ä¸€ä¸‹ã€‚</p><span id="more"></span><p>åŠ¨æ€è·¯ç”±åŒ¹é…urlå˜åŒ–äº†ï¼Œä½†æ˜¯ç»„ä»¶æ²¡æœ‰å˜åŒ–æ˜¯å› ä¸ºvueè¿›è¡Œäº†ç»„ä»¶å¤ç”¨ï¼Œå› ä¸ºä¸¤ä¸ªè·¯ç”±éƒ½æ¸²æŸ“åŒä¸ªç»„ä»¶ï¼Œæ¯”èµ·é”€æ¯å†åˆ›å»ºï¼Œå¤ç”¨åˆ™æ˜¾å¾—æ›´åŠ é«˜æ•ˆã€‚ä¸è¿‡ï¼Œè¿™ä¹Ÿæ„å‘³ç€ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸé’©å­ä¸ä¼šå†è¢«è°ƒç”¨ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨è¿›è¡Œæ•°æ®åˆ·æ–°ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ç®€å•çš„ä½¿ç”¨watchæ¥ç›‘å¬å½“å‰çš„è·¯ç”±å˜åŒ–ï¼Œä»è€Œå®ç°æ•°æ®åˆ·æ–°ã€‚</p><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; watch &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&quot;./router&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="title function_">setup</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// vue2</span></span><br><span class="line">        <span class="comment">// watch: &#123;</span></span><br><span class="line">        <span class="comment">//     $route(to, from) &#123;</span></span><br><span class="line">        <span class="comment">//         // å¯¹è·¯ç”±å˜åŒ–ä½œå‡ºå“åº”...</span></span><br><span class="line">        <span class="comment">//     &#125;</span></span><br><span class="line">        <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// vue3</span></span><br><span class="line">        <span class="title function_">watch</span>(router.<span class="property">currentRoute</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;è·¯ç”±å‘ç”Ÿäº†å˜åŒ–&quot;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥ä½¿ç”¨2.2ä¸­æ–°åŠ çš„beforeRouteUpdateè·¯ç”±å®ˆå«ï¼š</p><figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="title function_">setup</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">beforeRouteUpdate</span>(<span class="function">(<span class="params">to, <span class="keyword">from</span>, next</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// ä¸è¦åœ¨è¿™é‡Œè°ƒç”¨next</span></span><br><span class="line">        <span class="comment">// é€šè¿‡toæ¥åˆ¤æ–­æ˜¯å¦é‡è½½æ•°æ®</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;è·¯ç”±å‘ç”Ÿäº†å˜åŒ–&quot;</span>);</span><br><span class="line">    &#125;),</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šå°±æ˜¯vue3ä¸­ä½¿ç”¨vue-router-nextæ¥å¤„ç†åŠ¨æ€è·¯ç”±å˜åŒ–å¯¼è‡´é¡µé¢ä¸åˆ·æ–°çš„æ–¹æ³•ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vue3å‡çº§é‡åˆ°çš„å‘</title>
      <link href="/2020/05/31/vue3-upgrade/"/>
      <url>/2020/05/31/vue3-upgrade/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘ä¸€ç›´å¿™å·¥ä½œä¸Šçš„äº‹ï¼Œå¯¹æé«˜è‡ªèº«èƒ½åŠ›çš„äº‹æœ‰ç‚¹è½ä¸‹äº†ï¼Œè¶ç€ä»Šå¤©æŠŠä¹‹å‰æ€è€ƒçš„ä¸€äº›é—®é¢˜éƒ½ç»™è§£å†³äº†ï¼Œä¹Ÿé¡ºæ‰‹ç»™è‡ªå·±çš„VueBlogæŠŠvueå’Œwebpackéƒ½å‡çº§åˆ°æœ€æ–°çš„betaç‰ˆæœ¬ï¼Œç„¶åé‡åˆ°äº†å¾ˆå¤šå‘ï¼Œä»Šå¤©å°±æŠŠå‘éƒ½è®°å½•ä¸€ä¸‹ï¼Œå…çš„ä»¥åå¿˜äº†ã€‚</p><p>VueBlogç›®å‰ä½¿ç”¨çš„æ˜¯webpack5 + vue3 + vue-router-next + typescriptæ„å»ºï¼Œç›®çš„åœ¨äºæ›¿æ¢å½“å‰çš„hexoç«™ç‚¹ï¼ŒåŒæ ·ä¹Ÿæ˜¯ä¸€ä¸ªé™æ€åšå®¢ç”Ÿæˆå™¨ï¼Œä¸è¿‡å’Œhexoçš„å®šä½ä¸åŒï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯å•é¡µé¢è®¾è®¡ï¼Œè€Œä¸æ˜¯ç»™æ¯ä¸ªé¡µé¢ç”Ÿæˆå¯¹åº”çš„htmlæ–‡ä»¶ï¼Œæ‰€ä»¥å¯¹SEOä¸å‹å¥½ï¼Œä»¥åå†æƒ³åŠæ³•å§ã€‚</p><span id="more"></span><h2 id="å‡çº§Vue3"><a href="#å‡çº§Vue3" class="headerlink" title="å‡çº§Vue3"></a>å‡çº§Vue3</h2><p>é¦–å…ˆä½¿ç”¨<code>vue add vue-next</code>æ¥å‡çº§vueåˆ°betaç‰ˆæœ¬ï¼Œæ‰§è¡Œä»¥åvueä¼šå¯¹ä»£ç è¿›è¡Œä¸€æ¬¡è½¬æ¢ï¼Œå°†æ—§ç‰ˆæœ¬çš„ä¸€äº›apiè½¬æ¢ä¸ºæ–°ç‰ˆæœ¬ã€‚</p><h3 id="App"><a href="#App" class="headerlink" title="App"></a>App</h3><p>ä¾‹å¦‚å°†main.tsä¸­åˆ›å»ºAppå¯¹è±¡çš„ä»£ç è½¬æ¢ä¸ºæ–°çš„ï¼Œåœ¨vue2ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡new Vue()æ¥åˆ›å»ºappå¯¹è±¡ï¼Œå¹¶è°ƒç”¨$mountå‡½æ•°æŒ‚åœ¨å…ƒç´ ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import App from &quot;./App.vue&quot;;</span><br><span class="line">const app = new Vue(App);</span><br><span class="line">app.$mount(&#x27;#app&#x27;)</span><br></pre></td></tr></table></figure><p>åœ¨vue3ä¸­ï¼Œä¸»ä½“æ€æƒ³éƒ½å°½é‡é€šè¿‡å‡½æ•°æ¥è¿›è¡Œäº†ï¼Œå› ä¸ºå¯ä»¥é€šè¿‡å‡½æ•°çš„å‚æ•°å’Œè¿”å›å€¼è¿›è¡Œç±»å‹æ¨å¯¼ã€‚åœ¨vue3ä¸­ï¼Œåˆ›å»ºappå¯¹è±¡é€šè¿‡createAppå‡½æ•°æ¥è¿›è¡Œï¼Œå†é€šè¿‡mountå‡½æ•°æŒ‚è½½domå…ƒç´ ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import App from &quot;./App.vue&quot;;</span><br><span class="line">const app = createApp(APp);</span><br><span class="line">app.mount(&quot;#app&quot;);</span><br></pre></td></tr></table></figure><h3 id="Vur-Router"><a href="#Vur-Router" class="headerlink" title="Vur Router"></a>Vur Router</h3><p>å¦‚æœä½¿ç”¨çš„æœ‰vue-routerä¹‹ç±»çš„æ’ä»¶ï¼Œä½¿ç”¨æ–¹æ³•ä¹Ÿæœ‰ä¸€äº›å˜åŒ–ï¼Œrouterä¹Ÿéœ€è¦é€šè¿‡å¯¹åº”çš„createå‡½æ•°åˆ›å»ºã€‚é¦–å…ˆéœ€è¦å…ˆå‡çº§vue-routerï¼Œvue-routerçš„ä¸‹ä¸€ä¸ªç‰ˆæœ¬å«<a href="https://github.com/vuejs/vue-router-next">vue-router-next</a>ã€‚åœ¨vue-routerä¸­ï¼Œåˆ›å»ºrouterå¯¹è±¡çš„å‡½æ•°ä»VueRouterå‡½æ•°æ”¹ä¸ºcreateRouterã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const router = new VueRouter(&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">export default router;</span><br></pre></td></tr></table></figure><p>åœ¨vue3ä¸­åˆ™éœ€è¦ä½¿ç”¨æ–°çš„å‡½æ•°è¿”å›ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const router = createRouter(&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">export default router;</span><br></pre></td></tr></table></figure><p>å†…å®¹ä¹Ÿæ”¹äº†ä¸€éƒ¨åˆ†ï¼Œå¯ä»¥è®¿é—®<a href="https://github.com/vuejs/vue-router-next">github</a>ä»“åº“æ¥çœ‹æ–‡æ¡£ã€‚</p><h3 id="composition-API"><a href="#composition-API" class="headerlink" title="composition API"></a>composition API</h3><p>composition apiæ˜¯vue3æå‡ºçš„æ ¸å¿ƒåŠŸèƒ½ï¼Œå…¶æ ¸å¿ƒç›®çš„æ˜¯é€šè¿‡å°†åˆ†æ•£åœ¨å„å¤„çš„æ•°æ®éƒ½æ•´åˆåˆ°ä¸€ä¸ªsetupå‡½æ•°ä¸­è¿›è¡Œåˆå§‹åŒ–ï¼Œå¹¶ä¾èµ–vueçš„å“åº”å¼æ•°æ®æ”¹å˜æ¥å®ŒæˆåŠŸèƒ½å®ç°ã€‚</p><p>åœ¨RFCä¸­å°±æœ‰composition apiçš„åŠ¨æœºã€‚</p><blockquote><h4 id="æ›´å¥½çš„é€»è¾‘å¤ç”¨ä¸ä»£ç ç»„ç»‡"><a href="#æ›´å¥½çš„é€»è¾‘å¤ç”¨ä¸ä»£ç ç»„ç»‡" class="headerlink" title="æ›´å¥½çš„é€»è¾‘å¤ç”¨ä¸ä»£ç ç»„ç»‡"></a>æ›´å¥½çš„é€»è¾‘å¤ç”¨ä¸ä»£ç ç»„ç»‡</h4><ol><li>éšç€åŠŸèƒ½çš„å¢é•¿ï¼Œå¤æ‚ç»„ä»¶çš„ä»£ç å˜å¾—è¶Šæ¥è¶Šéš¾ä»¥é˜…è¯»å’Œç†è§£ã€‚è¿™ç§æƒ…å†µåœ¨å¼€å‘äººå‘˜é˜…è¯»ä»–äººç¼–å†™çš„ä»£ç æ—¶å°¤ä¸ºå¸¸è§ã€‚æ ¹æœ¬åŸå› æ˜¯ Vue ç°æœ‰çš„ API è¿«ä½¿æˆ‘ä»¬é€šè¿‡é€‰é¡¹ç»„ç»‡ä»£ç ï¼Œä½†æ˜¯æœ‰çš„æ—¶å€™é€šè¿‡é€»è¾‘å…³ç³»ç»„ç»‡ä»£ç æ›´æœ‰æ„ä¹‰ã€‚</li><li>ç›®å‰ç¼ºå°‘ä¸€ç§ç®€æ´ä¸”ä½æˆæœ¬çš„æœºåˆ¶æ¥æå–å’Œé‡ç”¨å¤šä¸ªç»„ä»¶ä¹‹é—´çš„é€»è¾‘ã€‚</li></ol><h4 id="æ›´å¥½çš„ç±»å‹æ¨å¯¼"><a href="#æ›´å¥½çš„ç±»å‹æ¨å¯¼" class="headerlink" title="æ›´å¥½çš„ç±»å‹æ¨å¯¼"></a>æ›´å¥½çš„ç±»å‹æ¨å¯¼</h4><p>å¦ä¸€ä¸ªæ¥è‡ªå¤§å‹é¡¹ç›®å¼€å‘è€…çš„å¸¸è§éœ€æ±‚æ˜¯æ›´å¥½çš„ TypeScript æ”¯æŒã€‚Vue å½“å‰çš„ API åœ¨é›†æˆ TypeScript æ—¶é‡åˆ°äº†ä¸å°çš„éº»çƒ¦ï¼Œå…¶ä¸»è¦åŸå› æ˜¯ Vue ä¾é ä¸€ä¸ªç®€å•çš„ this ä¸Šä¸‹æ–‡æ¥æš´éœ² propertyï¼Œæˆ‘ä»¬ç°åœ¨ä½¿ç”¨ this çš„æ–¹å¼æ˜¯æ¯”è¾ƒå¾®å¦™çš„ã€‚ï¼ˆæ¯”å¦‚ methods é€‰é¡¹ä¸‹çš„å‡½æ•°çš„ this æ˜¯æŒ‡å‘ç»„ä»¶å®ä¾‹çš„ï¼Œè€Œä¸æ˜¯è¿™ä¸ª methods å¯¹è±¡ï¼‰ã€‚</p><p>æ¢å¥è¯è¯´ï¼ŒVue ç°æœ‰çš„ API åœ¨è®¾è®¡ä¹‹åˆæ²¡æœ‰ç…§é¡¾åˆ°ç±»å‹æ¨å¯¼ï¼Œè¿™ä½¿é€‚é… TypeScript å˜å¾—å¤æ‚ã€‚<br>ç›¸æ¯”è¾ƒè¿‡åï¼Œæœ¬ RFC ä¸­æå‡ºçš„æ–¹æ¡ˆæ›´å¤šåœ°åˆ©ç”¨äº†å¤©ç„¶å¯¹ç±»å‹å‹å¥½çš„æ™®é€šå˜é‡ä¸å‡½æ•°ã€‚ç”¨è¯¥ææ¡ˆä¸­çš„ API æ’°å†™çš„ä»£ç ä¼šå®Œç¾äº«ç”¨ç±»å‹æ¨å¯¼ï¼Œå¹¶ä¸”ä¹Ÿä¸ç”¨åšå¤ªå¤šé¢å¤–çš„ç±»å‹æ ‡æ³¨ã€‚</p><p>è¿™ä¹ŸåŒæ ·æ„å‘³ç€ä½ å†™å‡ºçš„ JavaScript ä»£ç å‡ ä¹å°±æ˜¯ TypeScript çš„ä»£ç ã€‚å³ä½¿æ˜¯é TypeScript å¼€å‘è€…ä¹Ÿä¼šå› æ­¤å¾—åˆ°æ›´å¥½çš„ IDE ç±»å‹æ”¯æŒè€Œè·ç›Šã€‚</p><p><a href="https://composition-api.vuejs.org/zh/api.html">composition api</a> æ–‡æ¡£å®˜æ–¹</p><p><a href="https://composition-api.vuejs.org/zh">vue3 rfc</a> rfcç½‘ç«™</p></blockquote><p>setupå‡½æ•°ç”¨èµ·æ¥ç¡®å®èˆ’æœï¼Œæ‰€æœ‰æœ‰ç”¨çš„ä¸œè¥¿éƒ½å¯ä»¥æ”¾åœ¨ä¸€å—ï¼Œä»£ç æ•´ç†ä¹Ÿæ–¹ä¾¿ï¼Œä¸åƒä»¥å‰ä¸€æ ·éœ€è¦åˆ†æ•£åˆ°å„ç§hookå’Œè®¡ç®—å±æ€§ã€dataå‡½æ•°ä¸­ã€‚ä½†æ˜¯ä¹Ÿæœ‰æˆ‘ç”¨èµ·æ¥ä¸èˆ’æœçš„åœ°æ–¹ï¼ŒåŸºæœ¬ç±»å‹å’Œå¯¹è±¡éƒ½éœ€è¦ä½¿ç”¨refå‡½æ•°å’Œreactiveå‡½æ•°è¿›è¡ŒåŒ…è£…ï¼Œæœ‰çš„æ—¶å€™ç”¨èµ·æ¥å°±å„ç§éº»çƒ¦ï¼Œéœ€è¦å¤šæ³¨æ„ä¸€äº›ã€‚ä¸è¿‡è¿™ä¸ªé—®é¢˜å€’ä¸æ˜¯ä»€ä¹ˆå¤§é—®é¢˜ï¼Œå’Œå†™c++çš„æ—¶å€™æ‰€æœ‰çš„å¯¹è±¡ç”¨æ™ºèƒ½æŒ‡é’ˆåŒ…è£¹ä¸€å±‚ä¸€æ ·ï¼Œç”¨å¤šäº†å°±ä¹ æƒ¯äº†ã€‚</p><p>è¿™æ˜¯ä¸€ä¸ªvue2çš„ç»å…¸ä¾‹å­ï¼Œé€šè¿‡dataå‡½æ•°å’Œè®¡ç®—å±æ€§æ¥è¿”å›ä¸åŒçš„æ•°æ®ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">export default new Vue(&#123;</span><br><span class="line">    data: function() &#123;</span><br><span class="line">        return &#123;</span><br><span class="line">            message: &quot;hello&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    computed: &#123;</span><br><span class="line">        reversedMessage: function () &#123;</span><br><span class="line">            return this.message.split(&#x27;&#x27;).reverse().join(&#x27;&#x27;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>åœ¨vue3ä¸­å°±å¯ä»¥å…¨éƒ¨é›†ä¸­åˆ°setupå‡½æ•°ï¼Œå¹¶ä¸”ä¸€å¹¶è¿”å›ï¼Œæ¨¡æ¿å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import &#123; ref, computed &#125; from &quot;vue&quot;;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">    setup() &#123;</span><br><span class="line">        const message = ref(&quot;hello&quot;);</span><br><span class="line">        const reversedMessage = computed(() =&gt; &#123;</span><br><span class="line">            return message.value.split(&#x27;&#x27;).reverse().join(&#x27;&#x27;);</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        return &#123; message, reversedMessage &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºä½¿ç”¨setupå‡½æ•°å¯ä»¥å°†æ¨¡æ¿æ‰€éœ€çš„å†…å®¹ä¸€å—è¿”å›ï¼Œç»“æ„æ›´ä¸ºæ¸…æ™°ï¼Œvue2çš„æ¨¡å¼ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œåªä¸è¿‡ä¾§é‡ç‚¹ä¸ä¸€æ ·ï¼Œvue2çš„ç›®çš„æ˜¯ä¸€ç§åŠ¨ä½œçš„æ•°æ®åº”è¯¥è¢«æ”¾åœ¨ä¸€å—ï¼Œè€Œvue3çš„setupå‡½æ•°åˆ™æ˜¯å°†æ•°æ®å¤„ç†éƒ½æ”¾åœ¨ä¸€å—ï¼Œè¿™æ ·å¯¹æ•°æ®çš„çš„æ•´ç†æ¯”è¾ƒæ–¹ä¾¿å’Œé›†ä¸­ã€‚</p><h3 id="Props"><a href="#Props" class="headerlink" title="Props"></a>Props</h3><p>propsæ˜¯åœ¨ç»„ä»¶ä¸Šæ³¨å†Œçš„è‡ªå®šä¹‰å±æ€§ï¼Œå½“ä¸€ä¸ªå€¼ä¼ é€’ç»™propsçš„æ—¶å€™ï¼Œå®ƒå°±ä¼šæˆä¸ºé‚£ä¸ªç»„ä»¶çš„ä¸€ä¸ªpropertyã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;hello v-bind:message=&quot;message&quot; /&gt;</span><br></pre></td></tr></table></figure><p>helloç»„ä»¶å¯ä»¥é€šè¿‡å®šä¹‰propså‡½æ•°æ¥æ¥æ”¶è‡ªå®šä¹‰å±æ€§ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">export default new Vue(&#123;</span><br><span class="line">    props: &#123;</span><br><span class="line">        message: String</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±å¯ä»¥åœ¨helle.vueä¸­ä½¿ç”¨messageè¿™ä¸ªå±æ€§ï¼Œä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œhelloç»„ä»¶ä¸è¦ä¿®æ”¹ä¼ é€’è¿›æ¥çš„message,å¦åˆ™ä¼šç ´åæ•°æ®çš„æµå‘ã€‚</p><p>åœ¨vue3ä¸­ä½¿ç”¨ä¼šæ›´åŠ æ–¹ä¾¿ï¼Œå› ä¸ºç±»å‹æ¨å¯¼æ›´åŠ æ–¹ä¾¿ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">interface Props &#123;</span><br><span class="line">    message?: String</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">    props: &#123;</span><br><span class="line">        message: &#123;</span><br><span class="line">            type: String,</span><br><span class="line">            require: false,</span><br><span class="line">            default: &quot;&quot;,</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    setup(props: Props) &#123;</span><br><span class="line">        const reversedMessage = computed(() =&gt; &#123;</span><br><span class="line">            if (props.message === undefined) &#123;</span><br><span class="line">                return String;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            const innerMessage = props.message;</span><br><span class="line">            return innerMessage.split(&#x27;&#x27;).reverse().join(&#x27;&#x27;);</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        return &#123; reversedMessage &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>åœ¨vue3å’Œtypescriptä¸­ä½¿ç”¨propséœ€è¦æœ‰ä¸€äº›æ³¨æ„çš„åœ°æ–¹ï¼Œé¦–å…ˆPropsé‡Œéœ€è¦è®¾ç½®å€¼å¯èƒ½ä¸ºç©ºï¼Œå¦åˆ™setupå‡½æ•°çš„ç­¾åå°†æ— æ³•åŒ¹é…ã€‚å…¶æ¬¡è®¿é—®propsæ•°æ®éœ€è¦å¼€å¯setupå‡½æ•°çš„propså‚æ•°ï¼Œè¿˜æœ‰ä¸€ä¸ªcontextå‚æ•°ï¼Œå¯ä»¥è®¿é—®ä¸Šä¸‹æ–‡çš„å†…å®¹ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScriptå»ºé€ è€…æ¨¡å¼</title>
      <link href="/2020/02/01/JavaScript%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F/"/>
      <url>/2020/02/01/JavaScript%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<p>å»ºé€ è€…æ¨¡å¼å°±æ˜¯æŒ‡å°†ç±»çš„æ„é€ å’Œå…¶è¡¨ç¤ºåˆ†ç¦»å¼€æ¥ï¼Œè°ƒç”¨è€…å¯ä»¥é€šè¿‡ä¸åŒçš„æ„å»ºè¿‡ç¨‹åˆ›é€ å‡ºä¸åŒè¡¨ç¤ºçš„å¯¹è±¡ã€‚ä¸»è¦è§£å†³åœ¨è½¯ä»¶ç³»ç»Ÿä¸­ï¼Œæœ‰æ—¶å€™é¢ä¸´ç€â€ä¸€ä¸ªå¤æ‚å¯¹è±¡â€çš„åˆ›å»ºå·¥ä½œï¼Œç”±äºéœ€æ±‚çš„å˜åŒ–ï¼Œè¿™ä¸ªå¤æ‚å¯¹è±¡çš„æŸäº›éƒ¨åˆ†ç»å¸¸é¢ä¸´ç€å‰§çƒˆçš„å˜åŒ–ï¼Œä¸€äº›åŸºæœ¬éƒ¨ä»¶ä¸ä¼šå˜ã€‚æ‰€ä»¥éœ€è¦å°†å˜ä¸ä¸å˜åˆ†ç¦»ã€‚ä¸æŠ½è±¡å·¥å‚çš„åŒºåˆ«ï¼šåœ¨å»ºé€ è€…æ¨¡å¼é‡Œï¼Œæœ‰ä¸ªæŒ‡å¯¼è€…(Director)ï¼Œç”±æŒ‡å¯¼è€…æ¥ç®¡ç†å»ºé€ è€…ï¼Œç”¨æˆ·æ˜¯ä¸æŒ‡å¯¼è€…è”ç³»çš„ï¼ŒæŒ‡å¯¼è€…è”ç³»å»ºé€ è€…æœ€åå¾—åˆ°äº§å“ã€‚å³å»ºé€ è€…æ¨¡å¼å¯ä»¥å¼ºåˆ¶å®è¡Œä¸€ç§åˆ†æ­¥éª¤è¿›è¡Œçš„å»ºé€ è¿‡ç¨‹ã€‚</p><span id="more"></span><h2 id="å»ºé€ è€…æ¨¡å¼å››è¦ç´ "><a href="#å»ºé€ è€…æ¨¡å¼å››è¦ç´ " class="headerlink" title="å»ºé€ è€…æ¨¡å¼å››è¦ç´ "></a>å»ºé€ è€…æ¨¡å¼å››è¦ç´ </h2><ol><li>äº§å“ç±»Product: ä¸€èˆ¬æ˜¯ä¸€ä¸ªè¾ƒä¸ºå¤æ‚çš„å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´åˆ›å»ºå¯¹è±¡çš„è¿‡ç¨‹æ¯”è¾ƒå¤æ‚ï¼Œä¸€èˆ¬ä¼šæœ‰è¾ƒå¤šçš„ä»£ç ã€‚</li><li>æŠ½è±¡å»ºé€ è€…ç±»Builder: å°†å»ºé€ çš„å…·ä½“è¿‡ç¨‹äº¤äºˆå®ƒçš„å­ç±»æ¥å®ç°ã€‚</li><li>å»ºé€ è€…ç±»ConcreateBuilder: ç»„ä»¶äº§å“ï¼Œè¿”å›ç»„ä»¶å¥½çš„äº§å“</li><li>æŒ‡å¯¼ç±»Director: è´Ÿè´£è°ƒç”¨é€‚å½“çš„å»ºé€ è€…æ¥ç»„ä»¶äº§å“ï¼ŒæŒ‡å¯¼ç±»ä¸€èˆ¬ä¸ä¸äº§å“ç±»å‘ç”Ÿä¾èµ–å…³ç³»ï¼Œä¸æŒ‡å¯¼ç±»ç›´æ¥äº¤äº’çš„æ˜¯å»ºé€ è€…ç±»ã€‚</li></ol><h2 id="å»ºé€ è€…æ¨¡å¼çš„ä¼˜ç‚¹"><a href="#å»ºé€ è€…æ¨¡å¼çš„ä¼˜ç‚¹" class="headerlink" title="å»ºé€ è€…æ¨¡å¼çš„ä¼˜ç‚¹"></a>å»ºé€ è€…æ¨¡å¼çš„ä¼˜ç‚¹</h2><p>å»ºé€ è€…æ¨¡å¼çš„å°è£…å¾ˆå¥½ï¼Œä½¿ç”¨å»ºé€ è€…æ¨¡å¼å¯ä»¥è¿›è¡Œæœ‰æ•ˆçš„å°è£…å˜åŒ–ï¼Œåœ¨ä½¿ç”¨å»ºé€ è€…æ¨¡å¼çš„åœºæ™¯ä¸­ï¼Œäº§å“ç±»å’Œå»ºé€ è€…ç±»æ˜¯æ¯”è¾ƒç¨³å®šçš„ï¼Œå› æ­¤ï¼Œå°†ä¸»è¦çš„ä¸šåŠ¡é€»è¾‘å°è£…åœ¨æŒ‡å¯¼è€…ç±»ä¸­å¯¹æ•´ä½“å¯ä»¥å–å¾—æ¯”è¾ƒå¥½çš„ç¨³å®šæ€§ã€‚</p><p>å»ºé€ è€…ç±»ä¹Ÿå¾ˆæ–¹ä¾¿æ‰©å±•ï¼Œå¦‚æœæœ‰æ–°çš„éœ€æ±‚ï¼Œåªéœ€è¦å®ç°ä¸€ä¸ªæ–°çš„å»ºé€ è€…ç±»å³å¯ã€‚</p><p>äº§å“ç±» product.ts</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">class Product &#123;</span><br><span class="line">    private _name: String;</span><br><span class="line">    public name(): String &#123;</span><br><span class="line">        return this._name;</span><br><span class="line">    &#125;</span><br><span class="line">    public setName(name: String) &#123;</span><br><span class="line">        this._name = name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŠ½è±¡å»ºé€ ç±» builder.ts</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">interface Builder &#123;</span><br><span class="line">    _product: Product;</span><br><span class="line">    setName(name: String): Product;</span><br><span class="line">    build(): Product;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å»ºé€ ç±» concreatebuilder.ts</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">class ConcreateBuilder implements Builder &#123;</span><br><span class="line">    _product: Product = new Product;</span><br><span class="line">    public setName(name: String): Product &#123;</span><br><span class="line">        this._product.setName(name);</span><br><span class="line">        return this._product;</span><br><span class="line">    &#125;</span><br><span class="line">    public build(): Product &#123;</span><br><span class="line">        return this._product;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class HelloworldBuilder extends ConcreateBuilder &#123;</span><br><span class="line">    public build(): Product &#123;</span><br><span class="line">        this._product.setName(&quot;hello world!&quot;);</span><br><span class="line">        return this._product;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŒ‡å¯¼ç±» director.ts</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">class Director &#123;</span><br><span class="line">    private _defaultBuilder: ConcreateBuilder = new ConcreateBuilder;</span><br><span class="line">    private _helloworldBuilder: HelloworldBuilder = new HelloworldBuilder;</span><br><span class="line">    public buildForDefault(): Product  &#123;</span><br><span class="line">        return this._defaultBuilder.build();</span><br><span class="line">    &#125;</span><br><span class="line">    public buildForHelloworld(): Product &#123;</span><br><span class="line">        return this._helloworldBuilder.build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•è¿è¡Œ:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let director = new Director();</span><br><span class="line">console.log(director.buildForDefault().name());</span><br><span class="line">console.log(director.buildForHelloworld().name());</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œç»“æœ</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">undefined</span><br><span class="line">hello world!</span><br></pre></td></tr></table></figure><p>é€šè¿‡ä¸åŒçš„builderå°±å¯ä»¥æ„å»ºä¸åŒçš„å¯¹è±¡å‡ºæ¥ï¼Œå½“éœ€æ±‚å˜åŠ¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬åªéœ€è¦æ‰©å±•å‡ºä¸åŒçš„Builderå’ŒDirectorå°±å¯ä»¥æ»¡è¶³ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æµ…è°ˆJavascriptæ„é€ å™¨æ¨¡å¼</title>
      <link href="/2020/01/31/%E6%B5%85%E8%B0%88Javascript%E6%9E%84%E9%80%A0%E5%99%A8%E6%A8%A1%E5%BC%8F/"/>
      <url>/2020/01/31/%E6%B5%85%E8%B0%88Javascript%E6%9E%84%E9%80%A0%E5%99%A8%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<p>ä¸ºäº†ç®€åŒ–æ“ä½œï¼ŒJavaScriptæä¾›äº†newå…³é”®å­—ã€‚newå…³é”®å­—ç”¨äºåˆ›å»ºä¸€ä¸ªç”¨æˆ·å®šä¹‰ç±»å‹çš„å®ä¾‹ï¼Œæˆ–è€…å…·æœ‰æ„é€ å‡½æ•°çš„å†…ç½®å¯¹è±¡çš„å®ä¾‹ã€‚</p><span id="more"></span><p>æ¯å½“æˆ‘ä»¬åœ¨ä¸€ä¸ªå‡½æ•°è°ƒç”¨å‰ä½¿ç”¨newå…³é”®å­—ï¼Œè¯¥å‡½æ•°ä¾¿ä¼šä»¥ä¸€ç§ç‰¹æ®Šæ¨¡å¼â€”â€”æ„é€ æ¨¡å¼æ¥è¿è¡Œï¼Œåœ¨æ­¤æ¨¡å¼ä¸­ï¼ŒJavaScriptå¯ä»¥è‡ªåŠ¨å®Œæˆä¸€äº›æ“ä½œã€‚åŸºæœ¬ä¸Šå®ƒæ˜¯æŒ‡è§£é‡Šå™¨åœ¨ä½ çš„ä»£ç ä¸­åµŒå…¥å‡ è¡Œæ“ä½œä»£ç ã€‚</p><p>åœ¨JavaScriptä¸­ï¼Œæ„é€ å‡½æ•°é€šå¸¸æ˜¯è®¤ä¸ºç”¨æ¥å®ç°å®ä¾‹çš„ï¼Œä½†æ˜¯JavaScriptä¸­æ²¡æœ‰ç±»çš„æ¦‚å¿µï¼Œä½†æ˜¯æœ‰ç‰¹æ®Šçš„æ„é€ å‡½æ•°ï¼Œé€šè¿‡newå…³é”®å­—æ¥è°ƒç”¨å®šä¹‰çš„æ„é€ å‡½æ•°ï¼Œä½ å¯ä»¥å‘Šè¯‰JavaScriptä½ éœ€è¦åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œå¹¶ä¸”æ–°å¯¹è±¡çš„æˆå‘˜å£°æ˜éƒ½æ˜¯æ„é€ å‡½æ•°é‡Œå®šä¹‰çš„ã€‚åœ¨æ„é€ å‡½æ•°å†…éƒ¨ï¼Œthiså¼•ç”¨çš„æ˜¯æ–°åˆ›å»ºçš„å¯¹è±¡ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function People(name: String, age: Number) &#123;</span><br><span class="line">    this.name = name;</span><br><span class="line">    this.age = age;</span><br><span class="line">    this.output = function() &#123;</span><br><span class="line">        return this.name + &quot;å·²ç»&quot; + this.age + &quot;å²äº†&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let people = new People(&quot;justforlxz&quot;, 24);</span><br><span class="line"></span><br><span class="line">console.log(people.output());</span><br></pre></td></tr></table></figure><p>ä¸Šé¢æ˜¯ä¸ªå¾ˆç®€å•çš„æ„é€ å‡½æ•°æ¨¡å¼ï¼Œæˆ‘ä»¬ä»å­—é¢ä¸Šthisæ˜¯peopleå¯¹è±¡ï¼Œä½†æ˜¯å…¶å®å¹¶ä¸æ˜¯è¿™æ ·çš„ï¼Œnewè¿ç®—ç¬¦å¸®åŠ©æˆ‘ä»¬ç”Ÿæˆäº†thisçš„åˆå§‹åŒ–ä»£ç ã€‚</p><p>newè¿ç®—ç¬¦ä¸€å…±åšäº†ä¸‰ä»¶äº‹ï¼š</p><ol><li>åˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡</li><li>å°†ç©ºå¯¹è±¡çš„åŸå‹èµ‹å€¼ä¸ºæ„é€ å™¨å‡½æ•°çš„åŸå‹</li><li>æ›´æ”¹æ„é€ å™¨å‡½æ•°å†…éƒ¨çš„thisï¼Œå°†å…¶æŒ‡å‘æ–°åˆ›å»ºçš„å¯¹è±¡</li></ol><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let tmp = new Object();</span><br><span class="line">tmp.__proto__ = People.prototype;</span><br><span class="line">People.call(tmp);</span><br></pre></td></tr></table></figure><p>æœ€åä¼šç»è¿‡ä¸€ä¸ªåˆ¤æ–­ï¼Œå¦‚æœæ„é€ å™¨å‡½æ•°è®¾ç½®äº†è¿”å›å€¼ï¼Œå¹¶ä¸”è¿”å›å€¼æ˜¯ä¸€ä¸ªObjectç±»å‹çš„è¯ï¼Œå°±ç›´æ¥è¿”å›è¯¥Objectï¼Œå¦åˆ™å°±ä¼šè¿”å›æ–°åˆ›å»ºçš„ç©ºå¯¹è±¡ã€‚</p><p>æ€»ç»“ä¸€ä¸‹ï¼š JavaScriptæ²¡æœ‰ç±»çš„æ¦‚å¿µï¼Œä½†æ˜¯ä¸ºäº†å®ç°OOPï¼Œå°±é€šè¿‡newå…³é”®å­—å®ç°å¯¹å‡½æ•°è¿›è¡Œæ’å…¥ä»£ç æ¥å®ç°å¯¹è±¡å®ä¾‹çš„åˆå§‹åŒ–ã€‚æ„é€ å™¨æ¨¡å¼å°±æ˜¯é€šè¿‡ä¸€ä¸ªæ–¹æ³•æ¥newå‡ºä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªæ“ä½œå°±å«æ„é€ å™¨æ¨¡å¼ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019 Review</title>
      <link href="/2020/01/01/2019review/"/>
      <url>/2020/01/01/2019review/</url>
      
        <content type="html"><![CDATA[<p>ä¸Šä¸€æ¬¡å†™å¹´ç»ˆæ€»ç»“è¿˜æ˜¯18å¹´å›å®¶çš„åŠ¨è½¦ä¸Šï¼Œå¯æƒœå†™äº†ä¸€åŠæ²¡å‘è¡¨ï¼Œè§‰å¾—ä¸€å¹´äº†æ²¡æœ‰ä»€ä¹ˆèƒ½å¤Ÿå›æƒ³èµ·æ¥çš„ï¼Œå°±åˆåˆ é™¤äº†ã€‚ä»Šå¹´ä¸åŒäº†ï¼Œä»Šå¹´æœ‰å¥½å¤šæƒ³è¯´çš„ã€‚</p><span id="more"></span><h2 id="è„±å•"><a href="#è„±å•" class="headerlink" title="è„±å•"></a>è„±å•</h2><p><strong>ç¬¬ä¸€ä»¶é‡è¦çš„äº‹æ˜¯æˆ‘é‡åˆ°äº†ç”Ÿå‘½ä¸­çš„å¥¹ã€‚</strong></p><p>è‡ªä»å·¥ä½œä»¥åï¼Œæˆ‘å¦ˆå¤©å¤©å¿µå¨æˆ‘çš„å°±æ˜¯æ‰¾å¯¹è±¡ï¼Œå’Œæˆ‘é¢„æƒ³çš„æ²¡é”™ï¼Œä¸Šå­¦çš„æ—¶å€™ç›¼æˆ‘æ¯•ä¸šï¼Œæ¯•ä¸šä»¥åç›¼æˆ‘å·¥ä½œï¼Œå·¥ä½œä»¥åç›¼æˆ‘æ‰¾å¯¹è±¡ç»“å©šï¼Œæ‰¾å¯¹è±¡ä»¥åç›¼æˆ‘èµ¶ç´§ç”Ÿä¸ªå¨ƒè®©å¥¹æŠ±ã€‚<del>ï¼ˆå¤§å®¶çš„çˆ¶æ¯åº”è¯¥éƒ½è¿™æ ·ï¼‰</del></p><h2 id="åŠ è–ª"><a href="#åŠ è–ª" class="headerlink" title="åŠ è–ª"></a>åŠ è–ª</h2><p>è¿™ä»¶äº‹ç¡®å®ä¹Ÿä»¤æˆ‘æŒºå¼€å¿ƒçš„ï¼Œæˆ‘çš„å·¥èµ„åœ¨2019å¹´æˆåŠŸæ¶¨åˆ°äº†0.375ä¹”(1ä¹”ç­‰äº**å…ƒ  <a href="https://blog.nanpuyue.com/">@nanpuyue</a>)</p><p>æ¶¨å·¥èµ„è°ä¸é«˜å…´ï¼Œæˆ‘ä¼°è®¡ä¹Ÿå°±é©¬äº‘ä¸é«˜å…´äº†ï¼Œæ¯•ç«Ÿä»–çœ‹ä¸ä¸Šé’±ã€‚</p><h2 id="å­¦ä¹ "><a href="#å­¦ä¹ " class="headerlink" title="å­¦ä¹ "></a>å­¦ä¹ </h2><p>ä»Šå¹´çœ‹äº†å¾ˆå¤šC++çš„èµ„æ–™ï¼Œå¯¹C++å’Œç¼–è¯‘å™¨éƒ½æœ‰äº†æ›´æ·±çš„äº†è§£ã€‚æƒ³2016å¹´åŠå¤œ<a href="https://zcc.rs/">@zccrs</a>åœ¨å®¶æ•™æˆ‘ç¼–è¯‘åŸç†ï¼Œåˆ°ç°åœ¨æˆ‘å¯ä»¥ç†è§£ä¸€é—¨è¯­è¨€ä»è®¾è®¡åˆ°å®ç°ï¼Œå†åˆ°ä½¿ç”¨æ¨¡æ¿å®Œæˆç¼–è¯‘æ—¶è®¡ç®—ï¼Œæˆ‘èµ°äº†å¿«ä¸‰å¹´ï¼Œè¿™ä¸‰å¹´é‡Œæˆ‘ä¸€ç›´æ²¡åœä¸‹å­¦ä¹ çš„è„šæ­¥ï¼Œåœ¨å­¦ä¹ å„ç§çŸ¥è¯†ï¼Œä»å„ç§ç¼–ç¨‹è¯­è¨€åˆ°å„ç§æ¡†æ¶åŸç†ï¼Œåˆ°å›¾å½¢ç•Œé¢çš„å®ç°ã€‚è¿˜å­¦ä¹ äº†å•å…ƒæµ‹è¯•ï¼Œå¹¶ä¸”<a href="https://hualet.org/">@hualet</a>å¤§ä½¬ç»™æˆ‘è®²äº†å•å…ƒæµ‹è¯•æ˜¯ä»€ä¹ˆï¼Œä»¥åŠå•å…ƒæµ‹è¯•çš„é‡è¦æ€§ï¼Œä»é‚£ä»¥åæˆ‘æ‰ç®—çœŸæ­£çš„äº†è§£å•å…ƒæµ‹è¯•çš„é‡è¦æ€§ï¼Œä¹Ÿä½¿æˆ‘åœ¨å†™ä»£ç çš„æ—¶å€™æ³¨é‡é€šè¿‡å•å…ƒæµ‹è¯•æ¥ä¿éšœæˆ‘çš„åŠŸèƒ½ã€‚</p><p>å»å¹´å¯¹æ·±åº¦å­¦ä¹ è¿›è¡Œäº†ä¸€æ³¢å­¦ä¹ ï¼Œä»Šå¹´å¯¹Webå·¥ç¨‹åŒ–å’ŒTypeScriptä¹Ÿå­¦ä¹ äº†ä¸€ä¸‹ï¼Œä¹Ÿç®—æ˜¯å¯¹ç›®å‰æœ€çƒ­é—¨çš„ä¸¤ä¸ªé¢†åŸŸè¿›è¡Œäº†ä¸€å®šçš„äº†è§£ã€‚</p><h2 id="è¯»ä¹¦"><a href="#è¯»ä¹¦" class="headerlink" title="è¯»ä¹¦"></a>è¯»ä¹¦</h2><p>å»å¹´ä¹°çš„TensorFlowçœ‹äº†æ²¡ä¸€åŠï¼Œä»Šå¹´å€’æ˜¯æ²¡ä¹°ä¹¦ï¼Œå¼€å§‹åœ¨å¾®ä¿¡è¯»ä¹¦ä¸Šè¯»ä¹¦ï¼Œåˆ©ç”¨ä¸€äº›ç©ºä½™æ—¶é—´è¯»ä¸€ç‚¹ï¼Œæˆ‘ä¹Ÿæ¨èå¤§å®¶å¤šåˆ©ç”¨ç©ºé—²æ—¶é—´è¯»è¯»ä¹¦ï¼Œå°‘åˆ·æŠ–éŸ³å’Œbilibiliã€‚</p><ul><li>ã€ŠTensorFlowã€‹æœªè¯»å®Œ</li><li>ã€ŠTypeScriptå®æˆ˜ã€‹æ­£åœ¨è¯»</li></ul><h2 id="åšå®¢"><a href="#åšå®¢" class="headerlink" title="åšå®¢"></a>åšå®¢</h2><p>2019å¹´æˆ‘ä¸€å…±æ°´äº†15ç¯‡æ–‡ç« ã€‚</p><ul><li><p>12-26 <a href="https://blog.justforlxz.com/2019/12/26/use-serial-port-debug-deepin-on-archlinux/">åœ¨ArchLinuxé€šè¿‡ä¸²å£è°ƒè¯•VMwareè™šæ‹Ÿæœºä¸­çš„deepin</a></p></li><li><p>12-26 <a href="https://blog.justforlxz.com/2019/12/26/cpp-sort/">ä½¿ç”¨æ ‡å‡†åº“std::sortå‡½æ•°è¿›è¡Œæ’åº</a></p></li><li><p>12-09 <a href="https://blog.justforlxz.com/2019/12/09/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%AA%E5%9D%91%E7%88%B9%E7%9A%84usb%E7%BD%91%E5%8D%A1/">è®°å½•ä¸€ä¸ªå‘çˆ¹çš„usbç½‘å¡</a></p></li><li><p>12-09 <a href="https://blog.justforlxz.com/2019/12/09/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%AA%E5%9D%91%E7%88%B9%E7%9A%84usb%E7%BD%91%E5%8D%A1/">ä½¿ç”¨github actionsè‡ªåŠ¨éƒ¨ç½²hexoæ–‡ç« åˆ°htmlä»“åº“</a></p></li><li><p>12-08 <a href="https://blog.justforlxz.com/2019/12/08/vue-component-props/">Vueçˆ¶å­ç»„ä»¶ä¼ å€¼ â€”â€” props &amp; $emit</a></p></li><li><p>12-08 <a href="https://blog.justforlxz.com/2019/12/08/vue-transitions/">æ·»åŠ VueåŠ¨ç”»</a></p></li><li><p>11-25 <a href="https://blog.justforlxz.com/2019/11/25/%E4%BD%BF%E7%94%A8webpack-dev-server%E6%9D%A5%E7%9B%91%E5%90%AC%E9%A1%B9%E7%9B%AE%E5%8F%98%E5%8C%96/">ä½¿ç”¨webpack-dev-serveræ¥ç›‘å¬é¡¹ç›®å˜åŒ–</a></p></li><li><p>10-24 <a href="https://blog.justforlxz.com/2019/10/24/%E7%BB%99Archlinux%E5%BC%80%E5%90%AFBFQ%E5%92%8CMuQSS/">ç»™Archlinuxå¼€å¯BFQå’ŒMuQSS</a></p></li><li><p>10-22 <a href="https://blog.justforlxz.com/2019/10/22/%E4%BD%BF%E7%94%A8webpack%E6%89%93%E5%8C%85Vue%E5%92%8CTypeScript/">ä½¿ç”¨webpackæ‰“åŒ…Vueå’ŒTypeScript</a></p></li><li><p>10-14 <a href="https://blog.justforlxz.com/2019/10/14/webpack%E5%85%A5%E9%97%A8/">webpackå…¥é—¨</a></p></li><li><p>06-16 <a href="https://blog.justforlxz.com/2019/06/16/wsl2%E7%9A%84%E4%BD%BF%E7%94%A8%E4%BD%93%E9%AA%8C/">wsl2çš„ä½¿ç”¨ä½“éªŒ</a></p></li><li><p>06-15 <a href="https://blog.justforlxz.com/2019/06/15/%E5%85%A5%E5%9D%91typescript%E4%BA%86/">å…¥å‘typescriptäº†</a></p></li><li><p>05-23 <a href="https://blog.justforlxz.com/2019/05/23/CMake-CTests-for-dde-control-center/">CMake CTests for dde-control-center</a></p></li><li><p>02-21 <a href="https://blog.justforlxz.com/2019/02/21/how-to-use-LNMP-on-deepin/">å¦‚ä½•åœ¨Deepinä¸Šä½¿ç”¨LNMP</a></p></li><li><p>02-23 <a href="https://blog.justforlxz.com/2019/01/23/fuck-taobao/">è§£å†³ç”¨äº†xposedåæ·˜å®é—ªé€€</a></p></li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">2019</span><br><span class="line">â”œâ”€â”€ 01</span><br><span class="line">â”‚Â Â  â””â”€â”€ 23</span><br><span class="line">â”‚Â Â      â””â”€â”€ fuck-taobao</span><br><span class="line">â”‚Â Â          â””â”€â”€ index.html</span><br><span class="line">â”œâ”€â”€ 02</span><br><span class="line">â”‚Â Â  â””â”€â”€ 21</span><br><span class="line">â”‚Â Â      â””â”€â”€ how-to-use-LNMP-on-deepin</span><br><span class="line">â”‚Â Â          â””â”€â”€ index.html</span><br><span class="line">â”œâ”€â”€ 05</span><br><span class="line">â”‚Â Â  â””â”€â”€ 23</span><br><span class="line">â”‚Â Â      â””â”€â”€ CMake-CTests-for-dde-control-center</span><br><span class="line">â”‚Â Â          â””â”€â”€ index.html</span><br><span class="line">â”œâ”€â”€ 06</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ 15</span><br><span class="line">â”‚Â Â  â”‚Â Â  â””â”€â”€ å…¥å‘typescriptäº†</span><br><span class="line">â”‚Â Â  â”‚Â Â      â”œâ”€â”€ æ·±åº¦å½•å±_é€‰æ‹©åŒºåŸŸ_20190615202044.gif</span><br><span class="line">â”‚Â Â  â”‚Â Â      â””â”€â”€ index.html</span><br><span class="line">â”‚Â Â  â””â”€â”€ 16</span><br><span class="line">â”‚Â Â      â””â”€â”€ wsl2çš„ä½¿ç”¨ä½“éªŒ</span><br><span class="line">â”‚Â Â          â”œâ”€â”€ index.html</span><br><span class="line">â”‚Â Â          â”œâ”€â”€ Snipaste_2019-06-16_21-49-15.png</span><br><span class="line">â”‚Â Â          â””â”€â”€ Snipaste_2019-06-16_21-52-42.png</span><br><span class="line">â”œâ”€â”€ 10</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ 14</span><br><span class="line">â”‚Â Â  â”‚Â Â  â””â”€â”€ webpackå…¥é—¨</span><br><span class="line">â”‚Â Â  â”‚Â Â      â””â”€â”€ index.html</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ 22</span><br><span class="line">â”‚Â Â  â”‚Â Â  â””â”€â”€ ä½¿ç”¨webpackæ‰“åŒ…Vueå’ŒTypeScript</span><br><span class="line">â”‚Â Â  â”‚Â Â      â””â”€â”€ index.html</span><br><span class="line">â”‚Â Â  â””â”€â”€ 24</span><br><span class="line">â”‚Â Â      â””â”€â”€ ç»™Archlinuxå¼€å¯BFQå’ŒMuQSS</span><br><span class="line">â”‚Â Â          â””â”€â”€ index.html</span><br><span class="line">â”œâ”€â”€ 11</span><br><span class="line">â”‚Â Â  â””â”€â”€ 25</span><br><span class="line">â”‚Â Â      â””â”€â”€ ä½¿ç”¨webpack-dev-serveræ¥ç›‘å¬é¡¹ç›®å˜åŒ–</span><br><span class="line">â”‚Â Â          â””â”€â”€ index.html</span><br><span class="line">â””â”€â”€ 12</span><br><span class="line">    â”œâ”€â”€ 08</span><br><span class="line">    â”‚Â Â  â”œâ”€â”€ vue-component-props</span><br><span class="line">    â”‚Â Â  â”‚Â Â  â””â”€â”€ index.html</span><br><span class="line">    â”‚Â Â  â””â”€â”€ vue-transitions</span><br><span class="line">    â”‚Â Â      â””â”€â”€ index.html</span><br><span class="line">    â”œâ”€â”€ 09</span><br><span class="line">    â”‚Â Â  â”œâ”€â”€ è®°å½•ä¸€ä¸ªå‘çˆ¹çš„usbç½‘å¡</span><br><span class="line">    â”‚Â Â  â”‚Â Â  â””â”€â”€ index.html</span><br><span class="line">    â”‚Â Â  â””â”€â”€ use-github-actions-to-depoly-hexo</span><br><span class="line">    â”‚Â Â      â””â”€â”€ index.html</span><br><span class="line">    â””â”€â”€ 26</span><br><span class="line">        â”œâ”€â”€ cpp-sort</span><br><span class="line">        â”‚Â Â  â””â”€â”€ index.html</span><br><span class="line">        â””â”€â”€ use-serial-port-debug-deepin-on-archlinux</span><br><span class="line">            â””â”€â”€ index.html</span><br><span class="line"></span><br><span class="line">34 directories, 18 files</span><br></pre></td></tr></table></figure><h2 id="ç§‘æ™®è§†é¢‘"><a href="#ç§‘æ™®è§†é¢‘" class="headerlink" title="ç§‘æ™®è§†é¢‘"></a>ç§‘æ™®è§†é¢‘</h2><ol><li>å¦ˆå’ªå” (ä¸€ä¸ªè¾ƒçœŸçš„ç†å·¥ç”·)</li></ol><p>è¿™ä¸ªåå­—æˆ‘ç¬¬ä¸€çœ¼çœ‹åˆ°çš„æ—¶å€™ï¼Œè¿˜ä»¥ä¸ºæ˜¯ä¸ªå–æ¯å©´çš„ï¼Œæ²¡æƒ³åˆ°å±…ç„¶æ˜¯ä¸ªæç§‘æ™®çš„ï¼Œè€Œä¸”å†…å®¹è®²çš„ä¹Ÿå¾ˆå¥½ï¼Œæœ‰æ•°å­¦ã€ç‰©ç†ã€åŒ–å­¦å’Œå¤©æ–‡å­¦ã€‚</p><ol start="2"><li>ææ°¸ä¹è€å¸ˆ</li></ol><p>ä»¥å‰å¶å°”çœ‹è¿‡è€å¸ˆçš„è§†é¢‘ï¼Œå› ä¸ºä¸€ç›´éƒ½åœ¨çƒ­æ¦œï¼Œæ‰€ä»¥æ²¡æƒ³åˆ°å…³æ³¨ï¼Œåæ¥æ˜¯youtubeä¸Šçœ‹åˆ°äº†ï¼Œå°±ç‚¹äº†å…³æ³¨ï¼Œyoutubeä¸Šæ›´æ–°çš„å’Œbilibiliçš„è¿˜ä¸æ˜¯ä¸€æ ·çš„ï¼Œçœ‹æœ€åç»“å°¾çš„æ—¶å€™youtubeçš„åªè¯´youtubeå¸å·å…³æ³¨ï¼Œè€Œbilibiliçš„æ˜¯bilibiliï¼Œæœ‰æ—¶å€™è¿˜è¦å¤šä¸ªå¹³å°å»çœ‹ã€‚</p><ol start="3"><li>èç‹äºŒå·</li></ol><p>ä¹‹å‰åœ¨ç§‘æ™®åŒºéšä¾¿çœ‹çš„æ—¶å€™ï¼Œå¯¹ç”Ÿç‰©å­¦äº§ç”Ÿäº†ä¸€äº›å…´è¶£ï¼Œèç‹è®²çš„é£æ ¼æˆ‘å¾ˆå–œæ¬¢ï¼Œç‰¹åˆ«æ˜¯ä»–æ³¨é‡æ˜†è™«åˆ†ç±»å­¦(éª¨åŒ…çš®ï¼Œçš®åŒ…éª¨å•Š2333)ï¼Œè¿˜æœ‰ä¸€äº›è¾Ÿè°£è§†é¢‘ã€‚</p><ol start="4"><li>èŠ³æ–¯å¡”å¤« (é¬¼å¤)</li></ol><p>ä¹Ÿä½¿å¯¹ç”Ÿç‰©å­¦äº§ç”Ÿäº†ä¸€äº›å…´è¶£ï¼Œé¬¼å¤è¯´ä»¥ä»–å¾ˆä¸­äºŒçš„é£æ ¼å¸¦é¢†æˆ‘å­¦ä¹ äº†ä¸€æ³¢å¤ç”Ÿç‰©çš„ç›¸å…³çŸ¥è¯†(æ—§æ—¥æ”¯é…è€…ï¼ï¼ï¼)ã€‚</p><ol start="5"><li>æœ¨å¶å›</li></ol><p>å’Œé¬¼å¤ä¸€æ ·æ˜¯ä¸“é—¨è®²å¤ç”Ÿç‰©çš„ï¼Œä¸è¿‡æ¯æ¬¡ç»“æŸçš„æ¯”è¾ƒä»“ä¿ƒï¼Œçªç„¶å°±ç»“æŸäº†ã€‚</p><ol start="6"><li>æœ¨é±¼æ°´å¿ƒ</li></ol><p>æœ¨é±¼å¹¶ä¸æ˜¯ä»Šå¹´æ‰å…³æ³¨çš„ï¼Œæœ€å¼€å§‹å…³æ³¨æ˜¯ä»–åšEVAå‰§åœºç‰ˆè§£æï¼Œåæ¥ã€Šæœ¨é±¼è¯´ã€‹å¼€å§‹åšä¸€äº›ç§‘æ™®ï¼Œæˆ‘å¼€å§‹ä¸€ç›´å…³æ³¨äº†ã€‚</p><ol start="7"><li>å®‡å®™è§†è§‰ (æ°¸è¿œä¸è¦åœæ­¢æ€è€ƒ)</li></ol><p>ä¸€ä¸ªè®²å¤©æ–‡çš„ç§‘æ™®upï¼Œä¸è¿‡å¹´åº•çš„æ—¶å€™æ¢äº†é…éŸ³ï¼Œç–‘ä¼¼é…éŸ³å‡ºå»å•å¹²äº†ã€‚</p><h2 id="ç”µå½±"><a href="#ç”µå½±" class="headerlink" title="ç”µå½±"></a>ç”µå½±</h2><ol><li>æµæµªåœ°çƒ</li><li>é˜¿ä¸½å¡”ï¼šæˆ˜æ–—å¤©ä½¿</li><li>æˆ˜ç‹¼2</li><li>æƒŠå¥‡é˜Ÿé•¿</li><li>å¤ä»‡è€…è”ç›Ÿ4</li><li>ä½•ä»¥ä¸ºå®¶</li><li>é€Ÿåº¦ä¸æ¿€æƒ…ï¼š ç‰¹åˆ«è¡ŒåŠ¨</li><li>å¶é—®4</li></ol><h2 id="çºªå½•ç‰‡"><a href="#çºªå½•ç‰‡" class="headerlink" title="çºªå½•ç‰‡"></a>çºªå½•ç‰‡</h2><ol><li>æ··æ²Œï¼šæ•°å­¦æ¢ç§˜</li><li>ç»´åº¦ï¼šæ•°å­¦æ¼«æ­¥</li></ol><h2 id="åŠ¨æ¼«"><a href="#åŠ¨æ¼«" class="headerlink" title="åŠ¨æ¼«"></a>åŠ¨æ¼«</h2><ol><li>åˆ€å‰‘ç¥åŸŸ</li><li>ç´«ç½—å…°æ°¸æ’èŠ±å›­</li><li>darling in the franxx</li><li>å¿ƒç†æµ‹é‡è€…</li><li>è¿›å‡»çš„å·¨äººç¬¬ä¸‰å­£</li><li>äº”ç­‰åˆ†çš„æ–°å¨˜</li><li>citrusï½æŸ‘æ©˜å‘³é¦™æ°”ï½</li></ol>]]></content>
      
      
      <categories>
          
          <category> å¹´åº¦æ€»ç»“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 2019 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨ä¼ªå…ƒç´ åˆ›å»ºä¸€ä¸ªåœ†ç‚¹</title>
      <link href="/2020/01/01/%E4%BD%BF%E7%94%A8%E4%BC%AA%E5%85%83%E7%B4%A0%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%9C%86%E7%82%B9/"/>
      <url>/2020/01/01/%E4%BD%BF%E7%94%A8%E4%BC%AA%E5%85%83%E7%B4%A0%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%9C%86%E7%82%B9/</url>
      
        <content type="html"><![CDATA[<p>æˆ‘æœ€æ—©æ¥è§¦åˆ°CSSä¸­çš„ä¼ªå…ƒç´ æ˜¯åœ¨ä¸€æ¬¡å†™èƒŒæ™¯æ¨¡ç³Šçš„æ—¶å€™ï¼ŒCSSä¸­çš„blurä¼šæ¨¡ç³Šä¸‹é¢æ‰€æœ‰çš„å…ƒç´ ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡ä¼ªå…ƒç´ åœ¨beforeä¸­å…ˆæ¨¡ç³Šï¼Œè¿™æ ·ä¸‹å±‚æ˜¯æ²¡æœ‰ä»»ä½•å…ƒç´ çš„ï¼Œè‡ªç„¶ä¹Ÿä¸ä¼šæœ‰å…ƒç´ è¢«æ¨¡ç³Šã€‚</p><p>ä¼ªå…ƒç´ å°±å¦‚åŒå®ƒçš„åå­—ä¸€æ ·ï¼Œæ˜¯å‡çš„å…ƒç´ ï¼Œåªæ˜¯CSSå¼•æ“åœ¨æ’ç‰ˆçš„æ—¶å€™åˆ›å»ºå‡ºæ¥çš„ï¼Œåœ¨DOMæ ‘ä¸­æ˜¯ä¸å­˜åœ¨çš„ï¼Œæ‰€ä»¥javascriptæ˜¯æ²¡åŠæ³•æ“ä½œä¼ªå…ƒç´ çš„ã€‚ä¼ªå…ƒç´ åˆ†ä¸ºbeforeå’Œafterï¼Œå¯ä»¥åœ¨å…ƒç´ çš„å‰é¢æˆ–è€…åé¢åˆ›å»ºä¸€ä¸ªå‡çš„å…ƒç´ ï¼Œä¼ªå…ƒç´ é€‰æ‹©å™¨çš„æ ‡å¿—ç¬¦å·æ˜¯<code>::</code>ã€‚</p><ol><li><code>div::before</code> åœ¨divå…ƒç´ çš„å‰é¢åˆ›å»ºä¸€ä¸ªå…ƒç´ ï¼Œé…åˆcontentå±æ€§ä¸€èµ·ä½¿ç”¨ã€‚</li><li><code>div::after</code> åœ¨divå…ƒç´ çš„åé¢åˆ›å»ºä¸€ä¸ªå…ƒç´ ï¼Œé…åˆcontentå±æ€§ä¸€èµ·ä½¿ç”¨ã€‚</li></ol><img src="/2020/01/01/%E4%BD%BF%E7%94%A8%E4%BC%AA%E5%85%83%E7%B4%A0%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%9C%86%E7%82%B9/16-57-30%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE.png" class="" width="1657"><p>ä½¿ç”¨ä¼ªå…ƒç´ é€‰æ‹©å™¨éœ€è¦æ³¨æ„ä¸€ç‚¹çš„æ˜¯ï¼Œå¿…é¡»ä½¿ç”¨contentå±æ€§ï¼Œå¦åˆ™å°†ä¸èµ·ä»»ä½•ä½œç”¨ã€‚</p><p>ä¼ªå…ƒç´ é€‰æ‹©å™¨ç”Ÿæ•ˆä»¥åï¼Œå¯ä»¥åœ¨DOMä¸­çœ‹åˆ°::beforeæˆ–è€…::afterï¼Œè¿™é‡Œæä¾›ä¸€ä¸ªä¾‹å­ã€‚</p><p>htmléƒ¨åˆ†ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        Text</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure><p>csséƒ¨åˆ†ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">div::before &#123;</span><br><span class="line">  content: &quot;This is before Text, &quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">div::after &#123;</span><br><span class="line">  content: &quot;, This is after Text.&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶é¡µé¢ä¸Šä¼šçœ‹åˆ°è¾“å‡ºè¿™ä¹ˆä¸€å¥è¯ï¼Œ<code>This  is before Text, Text , This is after Text.</code>ï¼Œå¹¶ä¸”ä½¿ç”¨é¼ æ ‡åªèƒ½é€‰æ‹©åˆ°æœ€ä¸­é—´çš„Textæ–‡æœ¬ã€‚</p><img src="/2020/01/01/%E4%BD%BF%E7%94%A8%E4%BC%AA%E5%85%83%E7%B4%A0%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%9C%86%E7%82%B9/16-57-16.png" class="" width="1657"><p>ä»£ç å¯ä»¥ç‚¹å‡»<a href="https://jsfiddle.net/justforlxz/shg21kvb/18/">è¿™é‡Œ</a>æŸ¥çœ‹ã€‚</p><p>ä»Šå¤©å†™è¿™ç¯‡æ–‡ç« å‘¢ï¼Œæ˜¯å› ä¸ºä»Šå¤©æˆ‘åœ¨å®ç°hexoçš„Nextä¸»é¢˜ï¼Œçœ‹åˆ°å®ƒåœ¨åˆ—è¡¨ä¸­ä½¿ç”¨afteråˆ›å»ºäº†ä¸€ä¸ªå°åœ†ç‚¹ï¼Œå¹¶ä¸”æˆ‘é‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼Œæ‰€ä»¥å†™è¿™ç¯‡æ–‡ç« è®°å½•ä¸€ä¸‹ã€‚</p><p>Nextç”¨çš„æ˜¯æµ®åŠ¨å¸ƒå±€æ¥å®ç°çš„ï¼Œè€Œæˆ‘å†³å®šflexä¸€æŠŠæ¢­ï¼Œæ•´ä½“å¸ƒå±€æ˜¯å‚ç›´çš„flexï¼Œé¦–é¡µã€åˆ†ç±»ç­‰åˆ—è¡¨å†…éƒ¨æ˜¯ç”¨æ°´å¹³çš„inline-flexå®ç°çš„ï¼Œæœ€å·¦è¾¹æ˜¯å›¾æ ‡ï¼Œæ¥è‡ªfortawesomeï¼Œä¸­é—´çš„æ–‡æœ¬ä½¿ç”¨spanåŒ…è£¹ä¸€ä¸‹ï¼Œå®ç°å·¦å¯¹é½ï¼Œç„¶åé€šè¿‡ä¼ªå…ƒç´ åœ¨æœ€å³è¾¹åˆ›å»ºä¸€ä¸ªå°åœ†ç‚¹ï¼Œè®¾ç½®aå…ƒç´ çš„å®½åº¦ä¸º100%ï¼Œå°±å¯ä»¥å®ç°åœ†ç‚¹åœ¨æœ€å³è¾¹ã€‚</p><p>å‘å°±æ˜¯åœ¨è¿™é‡Œé‡åˆ°çš„ï¼Œå¦‚æœaå…ƒç´ çš„å®½åº¦è®¾ç½®ä¸º100%ï¼Œä¼ªå…ƒç´ åˆ›å»ºçš„å°åœ†ç‚¹å°±ä¸èƒ½å®Œå…¨æ˜¾ç¤ºï¼Œå°‘1åƒç´ æˆ–è€…å¤š1åƒç´ å°±å¯ä»¥å®Œå…¨æ˜¾ç¤ºã€‚æœ€ç»ˆçš„è§£å†³åŠæ³•æ˜¯ç»™å°åœ†ç‚¹çš„å‘¨å›´å¢åŠ äº†1åƒç´ çš„paddingè§£å†³äº†ï¼Œä½†æ˜¯åŸå› ä½ç½®ï¼Œè°çœ‹åˆ°è¿™ç¯‡æ–‡ç« å¹¶ä¸”æ°å¥½çŸ¥é“åŸå› çš„ï¼Œè¿˜è¯·å¸®å¿™è¯„è®ºå›å¤ä¸€ä¸‹ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;div id=&quot;site-nav&quot;&gt;</span><br><span class="line">  &lt;ul&gt;</span><br><span class="line">    &lt;li v-for=&quot;item in items&quot; v-bind:key=&quot;item.title&quot;&gt;</span><br><span class="line">      &lt;a v-bind:href=&quot;item.link&quot;&gt;</span><br><span class="line">        &lt;span id=&quot;menu-left&quot; v-bind:class=&quot;item.class&quot;&gt;&lt;/span&gt;</span><br><span class="line">        &lt;span id=&quot;menu-text&quot;&gt;</span><br><span class="line">          &#123;&#123; item.title &#125;&#125;</span><br><span class="line">        &lt;/span&gt;</span><br><span class="line">      &lt;/a&gt;</span><br><span class="line">    &lt;/li&gt;</span><br><span class="line">  &lt;/ul&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#site-nav &#123;</span><br><span class="line">  background: white;</span><br><span class="line">  padding: 20px 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ul &#123;</span><br><span class="line">  margin: 0;</span><br><span class="line">  padding: 0 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#site-nav li &#123;</span><br><span class="line">  list-style-type: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#site-nav li a &#123;</span><br><span class="line">  padding: 5px 0px;</span><br><span class="line">  text-align: left;</span><br><span class="line">  line-height: inherit;</span><br><span class="line">  transition-property: background-color;</span><br><span class="line">  transition-duration: 0.2s;</span><br><span class="line">  transition-timing-function: ease-in-out;</span><br><span class="line">  transition-delay: 0s;</span><br><span class="line">  display: flex;</span><br><span class="line">  justify-content: space-between;</span><br><span class="line">  align-items: center;</span><br><span class="line">  text-decoration: none;</span><br><span class="line">  font-size: 13px;</span><br><span class="line">  border-bottom: 1px solid transparent;</span><br><span class="line">  color: #555;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#site-nav li a:hover &#123;</span><br><span class="line">  background: #f9f9f9;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#menu-left &#123;</span><br><span class="line">  align-content: center;</span><br><span class="line">  margin-left: 10px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#menu-text &#123;</span><br><span class="line">  width: 100%;</span><br><span class="line">  margin-left: 10px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#site-nav li a::after &#123;</span><br><span class="line">  content: &#x27; &#x27;;</span><br><span class="line">  background: #bbb;</span><br><span class="line">  width: 6px;</span><br><span class="line">  height: 6px;</span><br><span class="line">  border-radius: 50%;</span><br><span class="line">  margin: 0 10px 0 0;</span><br><span class="line">  min-width: 6px;</span><br><span class="line">  min-height: 6px;</span><br><span class="line">  max-height: 6px;</span><br><span class="line">  max-width: 6px;</span><br><span class="line">  display: block;</span><br><span class="line">  box-sizing: border-box;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½†æˆ‘æå–äº†åŸºæœ¬ç»“æ„å’Œcssï¼Œdemoæ˜¯èƒ½å¤Ÿæ­£å¸¸æ˜¾ç¤ºå°åœ†ç‚¹çš„ï¼Œä½†æ˜¯è‡ªå·±çš„Vueå´ä¸èƒ½æ­£å¸¸æ˜¾ç¤ºï¼Œåæ¥å‘ç°æ˜¯displayå†™æˆå—çº§å…ƒç´ ç”¨çš„flexäº†ï¼Œæ”¹æˆinline-flexå°±èƒ½æ­£å¸¸æ˜¾ç¤ºäº†ï¼Œä½†æ˜¯åœ¨è°ƒæ•´å®½åº¦çš„æ—¶å€™ï¼Œå°±å‘ç°äº†ä¸Šé¢çš„é—®é¢˜ï¼Œå®ƒåˆä¸æ­£å¸¸æ˜¾ç¤ºäº†ï¼Œå®åœ¨è§£å†³ä¸äº†äº†ï¼Œå°±ç”¨paddingå¤„ç†äº†ã€‚</p><p>å‚è€ƒèµ„æ–™ï¼š <a href="https://github.com/qianguyihao/Web/blob/master/02-CSS%E5%9F%BA%E7%A1%80/10-CSS3%E9%80%89%E6%8B%A9%E5%99%A8%E8%AF%A6%E8%A7%A3.md">åƒå¤å£¹å·</a></p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åœ¨ArchLinuxé€šè¿‡ä¸²å£è°ƒè¯•VMwareè™šæ‹Ÿæœºä¸­çš„deepin</title>
      <link href="/2019/12/26/use-serial-port-debug-deepin-on-archlinux/"/>
      <url>/2019/12/26/use-serial-port-debug-deepin-on-archlinux/</url>
      
        <content type="html"><![CDATA[<p>ç”µè„‘ä¸»æ¿ä¸Šçš„æ¥å£ï¼šè¿›è¡Œä¸²è¡Œä¼ è¾“çš„æ¥å£ï¼Œå®ƒä¸€æ¬¡åªèƒ½ä¼ è¾“1Bitã€‚ä¸²è¡Œç«¯å£å¯ä»¥ç”¨äºè¿æ¥å¤–ç½®è°ƒåˆ¶è§£è°ƒå™¨ã€ç»˜å›¾ä»ªæˆ–ä¸²è¡Œæ‰“å°æœºã€‚å®ƒä¹Ÿå¯ä»¥æ§åˆ¶å°è¿æ¥çš„æ–¹å¼è¿æ¥ç½‘ç»œè®¾å¤‡ï¼Œä¾‹å¦‚è·¯ç”±å™¨å’Œäº¤æ¢æœºï¼Œä¸»è¦ç”¨æ¥é…ç½®å®ƒä»¬ã€‚æ¶ˆè´¹æ€§ç”µå­å·²ç»ç”±USBå–ä»£ä¸²åˆ—æ¥å£ï¼›ä½†åœ¨éæ¶ˆè´¹æ€§ç”¨é€”ï¼Œå¦‚ç½‘ç»œè®¾å¤‡ç­‰ï¼Œä¸²åˆ—æ¥å£ä»æ˜¯ä¸»è¦çš„ä¼ è¾“æ§åˆ¶æ–¹å¼ã€‚</p><span id="more"></span><p>é¦–å…ˆç»™è™šæ‹Ÿæœºåˆ†é…ä¸€ä¸ªä¸²å£è®¾å¤‡ï¼Œé€‰æ‹©Settings-&gt;Add-&gt;Serial Portã€‚åˆ†é…å¥½ä¸²å£è®¾å¤‡ä»¥åï¼Œæˆ‘ä»¬éœ€è¦é€‰æ‹©ä¸€ä¸ªä¸²å£è®¾å¤‡çš„è°ƒè¯•æ–¹å¼ï¼Œä¸€ä¸ªæ˜¯å°†è¾“å‡ºè½¬å‘ä¸€ä¸ªæ–‡ä»¶ï¼Œæˆ–è€…æ˜¯é€šè¿‡socketã€‚</p><p>å¦‚æœåªæ˜¯æŸ¥çœ‹æ–¹å¼ï¼Œé€‰æ‹©outpu fileå³å¯ã€‚å¦‚æœéœ€è¦è°ƒè¯•ï¼Œåˆ™å¯ä»¥é€šè¿‡socketæ–¹å¼æ¥è¿›è¡Œã€‚</p><p>socketæ–¹å¼éœ€è¦ç»™ä¸€ä¸ªå›ºå®šçš„è·¯å¾„åˆ†é…&#x2F;tmp&#x2F;<socket>ï¼Œæˆ‘è°ƒè¯•çš„æ—¶å€™ç»™å‡ºçš„æ˜¯&#x2F;tmp&#x2F;vhostï¼ŒFromé€‰æ‹©Serverï¼ŒToé€‰æ‹©An Applicationã€‚Fromçš„æ„æ€æ˜¯ä¿¡æ¯ä»å“ªé‡Œæ¥ï¼Œä¿¡æ¯æ˜¯è™šæ‹Ÿæœºé‡Œçš„ç³»ç»Ÿå‘å‡ºçš„ï¼Œæ‰€ä»¥è¿™é‡Œé€‰æ‹©çš„æ˜¯Serverï¼Œå¦‚æœæ˜¯åå‘æ“ä½œï¼Œéœ€è¦é€‰æ‹©Clientã€‚Toä¹Ÿæ˜¯æœ‰ä¸¤ä¸ªé€‰é¡¹ï¼Œç¬¬ä¸€ä¸ªæ˜¯An Virtual Machineï¼Œç¬¬äºŒä¸ªæ˜¯An Applicationã€‚ç”¨äºæŠŠæ¶ˆæ¯å‘é€ç»™å¦å¤–çš„è™šæ‹Ÿæœºï¼Œæˆ–è€…æ˜¯å®¿ä¸»æœºçš„ä¸€ä¸ªåº”ç”¨ç¨‹åºã€‚</p><p>å®‰è£…minicomåŒ…ï¼Œç”¨äºè¿›è¡Œè°ƒè¯•ï¼Œminicomè¿™ä¸ªä¸œè¥¿ï¼Œä¸æ˜¯å¤ªå¥½ç”¨ï¼Œé€€å‡ºæ–¹å¼æ˜¯å…ˆæŒ‰Ctrl+Aï¼Œç„¶åæŒ‰qï¼Œæœ‰æ—¶å€™è¿˜ä¸ä¸€å®šç®¡ç”¨ï¼Œä¸çŸ¥é“æ˜¯æ²¡æ¥å—åˆ°ï¼Œè¿˜æ˜¯æŒ‰é”™äº†ã€‚</p><p>å…ˆminicom -s è¿›è¡Œåˆå§‹åŒ–ï¼Œé€‰æ‹©<code>Serial port setup</code>ï¼ŒæŒ‰Aç¼–è¾‘<code>Serial Device</code>ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„ä¸€ä¸‹ï¼Œé€šè¿‡socketè¿›è¡Œè°ƒè¯•ï¼Œéœ€è¦ä½¿ç”¨<code>unix#</code>å‰ç¼€ï¼Œç„¶ååŠ ä¸Šåœ¨è™šæ‹Ÿæœºé‡Œå†™çš„è·¯å¾„ <code>unix#/tmp/vhost</code>ã€‚ç„¶åä¿å­˜ï¼Œé€‰æ‹©Exitï¼Œé€€å‡ºä»¥åå…¶å®é‡å¯minicomï¼Œå°±è¿›å…¥minicomçš„è°ƒè¯•ç•Œé¢äº†ï¼Œç„¶åæ­¤æ—¶å¼€å¯è™šæ‹Ÿæœºï¼Œç»™å†…æ ¸æ·»åŠ ä¸€ä¸ªconsole&#x3D;ttyS0çš„å‚æ•°ï¼Œå°±çœ‹åˆ°minicomæ˜¾ç¤ºè¾“å‡ºçš„ä¿¡æ¯äº†ï¼Œè¿˜å¯ä»¥äº¤äº’ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[    3.855725] [drm:vmw_fb_setcolreg [vmwgfx]] *ERROR* Bad regno 254.</span><br><span class="line">[    3.857125] [drm:vmw_fb_setcolreg [vmwgfx]] *ERROR* Bad regno 255.</span><br><span class="line">deepin Login:</span><br><span class="line"></span><br><span class="line">CTRL-A Z for help | unix-socket | NOR | Minicom 2.7.1 | VT102 | Offline | unix#/tmp/vhost</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶å°±å¯ä»¥äº¤äº’äº†ï¼Œç”¨æ³•å’Œttyä¸€æ ·ï¼Œæœ€åä¸€è¡Œæ˜¯minicomçš„è¾“å‡ºï¼Œå¯ä»¥çœ‹åˆ°CTRL-A Zå¯ä»¥çœ‹helpï¼Œminicomçš„ç‰ˆæœ¬ï¼Œå’Œè®¿é—®çš„ä¸²å£socketã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨æ ‡å‡†åº“std::sortå‡½æ•°è¿›è¡Œæ’åº</title>
      <link href="/2019/12/26/cpp-sort/"/>
      <url>/2019/12/26/cpp-sort/</url>
      
        <content type="html"><![CDATA[<p>stdçš„sortæ–¹æ³•æ¥å—ä¸¤ä¸ªè¿­ä»£å™¨beginå’Œendã€‚é€šè¿‡è¿­ä»£å™¨æ¥æŠ½è±¡å…ƒç´ çš„è®¿é—®ï¼Œéšè—å†…éƒ¨å®ç°ã€‚</p><span id="more"></span><p>è¿™æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">std::list&lt;int&gt; list &#123;</span><br><span class="line">    0,</span><br><span class="line">    4,</span><br><span class="line">    2,</span><br><span class="line">    1,</span><br><span class="line">    3,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">std::sort(list.begin(), list.end());</span><br></pre></td></tr></table></figure><p>ç»“æœå°±æ˜¯listè¢«æ’åºäº†ï¼Œè‡³äºä½¿ç”¨äº†ä»€ä¹ˆæ’åºç®—æ³•ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦å…³å¿ƒã€‚å®é™…ä¸Šæ ‡å‡†åº“ä¼šé€šè¿‡å…ƒç´ çš„æ•°é‡æ¥å†³å®šä½¿ç”¨ä»€ä¹ˆç®—æ³•ï¼ŒåŸºäºIntrospective Sorting(å†…çœå¼æ’åº)ã€‚<br>å®ƒæ˜¯ä¸€ç§æ··åˆå¼çš„æ’åºç®—æ³•ï¼š</p><ul><li><p>åœ¨æ•°æ®é‡å¾ˆå¤§æ—¶é‡‡ç”¨æ­£å¸¸çš„å¿«é€Ÿæ’åºï¼Œæ­¤æ—¶æ•ˆç‡ä¸ºO(logN)ã€‚</p></li><li><p>ä¸€æ—¦åˆ†æ®µåçš„æ•°æ®é‡å°äºæŸä¸ªé˜ˆå€¼ï¼Œå°±æ”¹ç”¨æ’å…¥æ’åºï¼Œå› ä¸ºæ­¤æ—¶è¿™ä¸ªåˆ†æ®µæ˜¯åŸºæœ¬æœ‰åºçš„ï¼Œè¿™æ—¶æ•ˆç‡å¯è¾¾O(N)ã€‚</p></li><li><p>åœ¨é€’å½’è¿‡ç¨‹ä¸­ï¼Œå¦‚æœé€’å½’å±‚æ¬¡è¿‡æ·±ï¼Œåˆ†å‰²è¡Œä¸ºæœ‰æ¶åŒ–å€¾å‘æ—¶ï¼Œå®ƒèƒ½å¤Ÿè‡ªåŠ¨ä¾¦æµ‹å‡ºæ¥ï¼Œä½¿ç”¨å †æ’åºæ¥å¤„ç†ï¼Œåœ¨æ­¤æƒ…å†µä¸‹ï¼Œä½¿å…¶æ•ˆç‡ç»´æŒåœ¨å †æ’åºçš„O(N logN)ï¼Œä½†è¿™åˆæ¯”ä¸€å¼€å§‹ä½¿ç”¨å †æ’åºå¥½ã€‚</p></li></ul><p>é»˜è®¤æƒ…å†µä¸‹æ’åºæ˜¯å‡åºæ’åºï¼Œæ—¢ç»“æœä»å°åˆ°å¤§ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨std::equal_to<T>ã€std::not_equal_to<T>ã€std::greater<T>ã€std::less<T>ã€std::greater_equal<T>å’Œstd::less_equal<T>æ¥æ§åˆ¶æ’åºã€‚</p><p>ä»¥ä¸Šæ˜¯é€šè¿‡æ ‡å‡†åº“å†…ç½®çš„ä¸€äº›æ–¹å¼æ¥æ§åˆ¶æ’åºï¼Œä¸”é€‚ç”¨äºå…ƒç´ å·²å®ç°äº†è‡ªå®šä¹‰æ¯”è¾ƒ(Compare)çš„è¦æ±‚ã€‚</p><p>æ¯”è¾ƒ (Compare) æ˜¯ä¸€äº›æ ‡å‡†åº“è®¾æ–½é’ˆå¯¹ç”¨æˆ·æä¾›çš„å‡½æ•°å¯¹è±¡ç±»å‹æ‰€æœŸå¾…çš„ä¸€ç»„è¦æ±‚ã€‚</p><p>å¯¹æ»¡è¶³æ¯”è¾ƒ (Compare) çš„ç±»å‹çš„å¯¹è±¡è¿ç”¨å‡½æ•°è°ƒç”¨æ“ä½œçš„è¿”å›å€¼ï¼Œå½“æŒ‰è¯­å¢ƒè½¬æ¢æˆ bool æ—¶ï¼Œè‹¥æ­¤ç±»å‹æ‰€å¼•å…¥çš„ä¸¥æ ¼å¼±åºå…³ç³»ä¸­ï¼Œè¯¥è°ƒç”¨çš„ç¬¬ä¸€å®å‚å…ˆäºç¬¬äºŒå®å‚ï¼Œåˆ™ç”Ÿæˆ trueï¼Œå¦åˆ™ç”Ÿæˆ falseã€‚</p><p>ä¸ä»»ä½•äºŒå…ƒè°“è¯ (BinaryPredicate) ç›¸åŒï¼Œä¸å…è®¸è¯¥è¡¨è¾¾å¼çš„æ±‚å€¼é€šè¿‡è§£å¼•ç”¨çš„è¿­ä»£å™¨è°ƒç”¨é const å‡½æ•°ã€‚</p><p>ç”¨äººè¯æ¥è¯´å°±æ˜¯ï¼ŒCompareå¿…é¡»æä¾›å‡ºå¯¹æ¯”ç»“æœã€‚</p><p>çœ‹ä¸€ä¸ªä¾‹å­:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">struct Test &#123;</span><br><span class="line">    int i;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">std::list&lt;Test&gt; list &#123;</span><br><span class="line">    new Test(2),</span><br><span class="line">    new Test(1),</span><br><span class="line">    new Test(4),</span><br><span class="line">    new Test(3),</span><br><span class="line">    new Test(5),</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">std::sort(list.begin(), list.end(), [=] (const Test&amp; test1, const Test&amp; test2) -&gt; bool &#123;</span><br><span class="line">    return test1.i &lt; test2.i;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªä¾‹å­æä¾›äº†ä¸€ä¸ªCompareï¼Œé€šè¿‡lambdaæ¥æä¾›è‡ªå®šä¹‰çš„å¯¹æ¯”å‡½æ•°ï¼Œè¿”å›å€¼å¿…é¡»æ˜¯boolï¼Œå¦åˆ™å°†ä¸æ»¡è¶³å¯¹æ¯”å‡½æ•°çš„è¦æ±‚ã€‚</p><p>é€šè¿‡ä»¥ä¸Šä¸‰ç§æ–¹å¼å¯ä»¥çœ‹å‡ºï¼Œæ ‡å‡†åº“çš„sortå‡½æ•°å¯ä»¥å¾ˆæ–¹ä¾¿çš„ä¸ºä½¿ç”¨è€…æä¾›æ ‡å‡†å¯¹æ¯”å’Œè‡ªå®šä¹‰å¯¹æ¯”ã€‚å¦‚æœå…ƒç´ è‡ªå·±å·²å®ç°operator&lt;ï¼Œåˆ™åªéœ€è¦ä½¿ç”¨æ ‡å‡†åº“å†…ç½®çš„å¯¹æ¯”å‡½æ•°å³å¯ï¼Œä½†æ˜¯å¤§éƒ¨åˆ†æƒ…å†µå…¶å®å¹¶ä¸ä¼šæ¶‰åŠåˆ°å…ƒç´ çš„æ’åºï¼Œä»…åœ¨ä¸´æ—¶æƒ…å†µä¸‹éœ€è¦åˆ—è¡¨æœ‰åºï¼Œæ‰€ä»¥æˆ‘ä¸ªäººå€¾å‘äºé€šè¿‡lambdaæä¾›Compareå‡½æ•°æ¥å®Œæˆåˆ—è¡¨çš„æ’åºã€‚</p><p><a href="https://zh.cppreference.com/w/cpp/algorithm/sort">std::sort</a><br><a href="http://feihu.me/blog/2014/sgi-std-sort/">çŸ¥æ— æ¶¯ä¹‹std::sortæºç å‰–æ</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>è®°å½•ä¸€ä¸ªå‘çˆ¹çš„usbç½‘å¡</title>
      <link href="/2019/12/09/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%AA%E5%9D%91%E7%88%B9%E7%9A%84usb%E7%BD%91%E5%8D%A1/"/>
      <url>/2019/12/09/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%AA%E5%9D%91%E7%88%B9%E7%9A%84usb%E7%BD%91%E5%8D%A1/</url>
      
        <content type="html"><![CDATA[<p>ç½‘å¡å‹å·æ˜¯Realtek RTL8811CU&#x2F;RTL8821CU USB Wi-Fi adapterï¼Œä¹°æ¥æ˜¯ä¸ºäº†è®©é»‘è‹¹æœä¸Šç½‘çš„ï¼Œwindowsä¸‹ä¹Ÿä¼šè‡ªåŠ¨ä¸‹è½½å’Œå®‰è£…é©±åŠ¨ï¼Œä½†æ˜¯linuxæ¯”è¾ƒéš¾å—ï¼Œå†…æ ¸ä¸æä¾›è¿™æ ·çš„é©±åŠ¨ï¼Œåªèƒ½å»å®˜æ–¹æ‹¿æºç æï¼Œä»Šå¤©åœ¨archä¸Šæ‰“ç®—è£…ä¸€ä¸‹é©±åŠ¨ï¼Œç»“æœé‡åˆ°äº†å¾ˆå¤šé—®é¢˜ã€‚</p><p>wikiä¸Šæ¨èçš„8821åº”è¯¥ä½¿ç”¨rtl88xxau-aircrack-dkms-gitï¼Œä½†æ˜¯æˆ‘å®‰è£…ä»¥åå‹æ ¹ä¸èƒ½ç”¨ï¼Œä¸€ç‚¹å˜åŒ–éƒ½æ²¡æœ‰ï¼Œè€Œä¸”modprobeä¹Ÿæ²¡æœ‰ä½œè€…ç»™å‡ºçš„88XXauï¼Œæ— å¥ˆåªå¾—æ”¾å¼ƒã€‚</p><p>ç»§ç»­è°·æ­Œä¹‹ï¼Œåœ¨<a href="https://forum.mxlinux.org/viewtopic.php?f=107&t=50579">https://forum.mxlinux.org/viewtopic.php?f=107&t=50579</a>çœ‹åˆ°äº†åˆ«äººç»™çš„æ–¹æ¡ˆï¼Œç„¶åæœæ–­cloneå¹¶make,ç„¶åå°±å› ä¸ºæ²¡æœ‰é€‚é…5.xçš„å†…æ ¸ç¼–è¯‘å¤±è´¥ï¼Œè¿™å¯ä¸è¡Œï¼Œç¿»äº†ä¸€ä¸‹issueï¼Œçœ‹åˆ°ä½œè€…åœ¨<a href="https://github.com/whitebatman2/rtl8821CU/issues/33">https://github.com/whitebatman2/rtl8821CU/issues/33</a>æåˆ°äº†ä¸€ä¸ª<a href="https://github.com/whitebatman2/rtl8821CU/issues/23">#23</a>ï¼Œè¿™æ ‡é¢˜å†™çš„å¤Ÿå¯ä»¥ï¼Œ<code>Newer version 5.4.1 (Support Linux versions from 4.4.x up to 5.4.x) </code>ï¼Œèµ¶ç´§æèµ·ï¼Œå»æºåœ°å€cloneå’Œmake,æˆåŠŸä½¿ç”¨ä¸Šäº†é©±åŠ¨ï¼ŒæŒ‰ç…§ä½œè€…æåˆ°çš„å®‰è£…<code>usb_modeswitch</code>ï¼Œå¹¶åˆ‡æ¢usbæ¨¡å¼ï¼Œæˆ‘æˆåŠŸçš„ä½¿ç”¨ä¸Šäº†è¿™ä¸ªusbç½‘å¡ã€‚</p><blockquote><p>åæ§½ä¸€ä¸‹ï¼Œå¼€å‘ç¯å¢ƒè¿˜æ˜¯linuxä¸‹èˆ’æœï¼Œä»“åº“çš„åŒ…å®‰è£…ä¸€ä¸‹å°±å¯ä»¥å¼€å‘äº†ï¼Œwindowsä¸‹è¦è‡ªå·±å†™è·¯å¾„ï¼Œmacä¸‹brewé™åˆ¶å¤ªæ­»ï¼Œä¸€äº›åº“å®‰è£…ä»¥åè¿˜è¦è‡ªå·±æ‰‹åŠ¨åšäº›å¤„ç†ï¼Œä¸€ä¸å°å¿ƒå°±æŠŠshellçš„ç¯å¢ƒå˜é‡æä¸è¡Œäº†ï¼Œæˆ–è€…å‹æ ¹ä¸èƒ½æ­£å¸¸å·¥ä½œã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨github actionsè‡ªåŠ¨éƒ¨ç½²hexoæ–‡ç« åˆ°htmlä»“åº“</title>
      <link href="/2019/12/09/use-github-actions-to-depoly-hexo/"/>
      <url>/2019/12/09/use-github-actions-to-depoly-hexo/</url>
      
        <content type="html"><![CDATA[<p>è¯·å…ˆå…è®¸æˆ‘å¤§å–Šä¸€å£°ï¼šå¾®è½¯ç‰›é€¼ï¼</p><p>æœ¬æ–‡æ²¡æœ‰å•¥å«é‡‘é‡ï¼Œå°±æ˜¯ç®€å•çš„è¯´ä¸€ä¸‹å¦‚ä½•éƒ¨ç½²github-actionsæ¥è‡ªåŠ¨ç”Ÿæˆhexoçš„publicï¼Œå¹¶ä¸”å†æ¨é€åˆ°htmlä»“åº“çš„ã€‚</p><p>æˆ‘çš„åšå®¢ä»“åº“ä¸€å…±åˆ†ä¸ºä¸¤ä¸ªï¼Œblogä»“åº“æ˜¯ç§æœ‰çš„ï¼Œéœ€è¦é€šè¿‡æˆ‘çš„ç§é’¥æ‰èƒ½è®¿é—®ï¼Œhtmlä»“åº“æ˜¯å…¬å¼€çš„ï¼Œhexoç”Ÿæˆçš„é™æ€å†…å®¹ä¼šè¢«ä¸Šä¼ åˆ°è¿™é‡Œã€‚</p><p>é¦–å…ˆåœ¨package.jsonä¸­æ·»åŠ ä¸€äº›å‘½ä»¤ï¼Œæ–¹ä¾¿æˆ‘ä»¬ä¸€é”®ç¼–è¯‘å’Œæäº¤:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">  &quot;build&quot;: &quot;hexo clean &amp;&amp; hexo g&quot;,</span><br><span class="line">  &quot;deploy&quot;: &quot;yarn run build &amp;&amp; hexo d&quot;,</span><br><span class="line">  &quot;backup&quot;: &quot;hexo b&quot;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å› ä¸ºCIç¯å¢ƒéœ€è¦æäº¤ä»£ç åˆ°ä»“åº“ï¼Œæ‰€ä»¥ç”³è¯·ä¸€ä¸ªä¸ªäººç”¨çš„tokenï¼Œè®¿é—®<a href="https://github.com/settings/tokens">https://github.com/settings/tokens</a>åˆ›å»ºä¸€ä¸ªæ–°çš„ï¼Œå‹¾é€‰ä¸Š<code>repo</code>ï¼Œç”Ÿæˆå®Œtokenä»¥åï¼Œä¿®æ”¹ä¸€ä¸‹<code>_config.yml</code>ä¸­å¯¹deployä»“åº“çš„urlï¼Œæ ¼å¼å›ºå®šä¸º<code>https://x-access-token:ä½ çš„token@github.com/ä½ çš„åå­—/ä»“åº“å.git</code>,ä¾‹å¦‚æˆ‘è¿™é‡Œæ˜¯<code>https://x-access-token:xxxxxxxxxx@github.com/justforlxz/html.git</code>ã€‚</p><p>ç„¶åæ–°å®¶ä¸€ä¸ªgithub actionsï¼Œé€‰æ‹©nodejsç¯å¢ƒï¼Œæˆ‘ä»¬åªéœ€è¦ä¿®æ”¹æœ€åä¸€ä¸ªæ­¥éª¤ï¼Œæ‰§è¡Œæˆ‘ä»¬è‡ªå·±çš„å‘½ä»¤å³å¯ã€‚</p><ul><li>è®¾ç½®gitçš„ç”¨æˆ·åå’Œé‚®ç®±åœ°å€</li><li>npm install -g yarn</li><li>yarn run deploy</li></ul><p>å¦‚æœä½ è¿˜æœ‰ä¸€äº›å…¶ä»–æ­¥éª¤ï¼Œå¯ä»¥è‡ªè¡Œæ‰©å±•ï¼Œæ¯”å¦‚æˆ‘å°±æœ‰ä¸»é¢˜ç›¸å…³çš„æ“ä½œï¼Œå…·ä½“çš„å†…å®¹å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">- name: npm install, build, and deploy</span><br><span class="line">  run: |</span><br><span class="line">    git config --global user.email &quot;justforlxz@gmail.com&quot;</span><br><span class="line">    git config --global user.name &quot;justforlxz&quot;</span><br><span class="line">    git submodule update --init</span><br><span class="line">    cd themes/next</span><br><span class="line">    git checkout dev</span><br><span class="line">    cd ../../</span><br><span class="line">    npm install -g yarn</span><br><span class="line">    yarn</span><br><span class="line">    yarn run deploy</span><br></pre></td></tr></table></figure><p>ç„¶åå°±å¯ä»¥æ„‰å¿«çš„è‡ªåŠ¨éƒ¨ç½²äº†ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Vueçˆ¶å­ç»„ä»¶ä¼ å€¼ â€”â€” props &amp; $emit</title>
      <link href="/2019/12/08/vue-component-props/"/>
      <url>/2019/12/08/vue-component-props/</url>
      
        <content type="html"><![CDATA[<p>Vueçš„çˆ¶å­ç»„ä»¶ä¼ å€¼æ¯”è¾ƒæœ‰æ„æ€ï¼Œçˆ¶ç»„ä»¶é€šè¿‡å±æ€§ç»‘å®šï¼ŒæŠŠè‡ªèº«çš„å€¼å’Œå­ç»„ä»¶çš„ä¸€ä¸ªå±æ€§ç»‘å®šèµ·æ¥ï¼Œå­ç»„ä»¶é€šè¿‡propså±æ€§æ¥æ”¶ï¼Œè¯¥å±æ€§ç±»å‹ä¸ºæ•°ç»„ï¼Œæ˜¯Vueå¯¹è±¡ä¸­æ¯”è¾ƒå°‘æœ‰çš„ç±»å‹ï¼Œdataã€computerã€methodsç­‰æ–¹æ³•éƒ½æ˜¯å¯¹è±¡çš„å½¢å¼ï¼Œpropsåˆ™æ˜¯æ•°ç»„çš„å½¢å¼ã€‚çˆ¶ç»„ä»¶é€šè¿‡v-onæ¥ç›‘å¬å­ç»„ä»¶å‘å‡ºçš„äº‹ä»¶æ¥æ¥æ”¶å­ç»„ä»¶çš„è°ƒç”¨ã€‚åœ¨è¿™é‡Œæˆ‘æ˜¯ç†è§£æˆå­ç»„ä»¶å‘é€ä¿¡å·æ¥é€šçŸ¥ä¸Šå±‚ï¼Œæ¯•ç«Ÿè°ƒç”¨çš„æ˜¯this.$emitæ¥åšåˆ°çš„ã€‚</p><span id="more"></span><p>æˆ‘ä»¬å‡è®¾å­ç»„ä»¶åä¸º<hello>ï¼Œæˆ‘ä»¬é€šè¿‡v-bindæ¥ç»‘å®šä¸€ä¸ªå€¼ç»™å®ƒã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div id=&quot;#app&quot;&gt;</span><br><span class="line">        // é€šè¿‡v-bindç»‘å®šçˆ¶å­ç»„ä»¶çš„å±æ€§</span><br><span class="line">        &lt;hello v-bind:messageFromParent=&quot;message&quot;/&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot;&gt;</span><br><span class="line">import Vue from &#x27;vue&#x27;;</span><br><span class="line">import Hello from &#x27;./Hello.vue&#x27;;</span><br><span class="line">export default Vue.extend(&#123;</span><br><span class="line">    data: &#123;</span><br><span class="line">        message: &quot;this message from parent&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    components: &#123;</span><br><span class="line">        &quot;hello&quot;: Hello</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>å­ç»„ä»¶hello.vueé€šè¿‡propså±æ€§æ¥æ”¶ï¼Œå†…å®¹æ˜¯è¿™æ ·çš„ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &#123;&#123; messageFromParent &#125;&#125;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot;&gt;</span><br><span class="line">import Vue from &#x27;vue&#x27;;</span><br><span class="line">export default Vue.extend(&#123;</span><br><span class="line">    // é€šè¿‡propsæ•°ç»„æ¥æ”¶</span><br><span class="line">    props: [ &quot;messageFromParent&quot; ]</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæœ‰ä¸ªéœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼Œçˆ¶ç»„ä»¶ç»™å­ç»„ä»¶çš„æ•°æ®æ˜¯å•å‘çš„ï¼Œè™½ç„¶å­ç»„ä»¶ä¹Ÿå¯ä»¥ä¿®æ”¹çˆ¶ç»„ä»¶ä¼ å…¥çš„æ•°æ®ï¼Œä½†æ˜¯ä¼šäº§ç”Ÿä¸€ä¸ªé”™è¯¯ï¼Œå¹¶æ‰“å°åœ¨ç»ˆç«¯é‡Œã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬æ€ä¹ˆæ‰èƒ½ä¿®æ”¹çˆ¶ç»„ä»¶çš„å€¼å‘¢ï¼Ÿç­”æ¡ˆæ˜¯<code>this.$emit</code>ã€‚</p><p>æˆ‘ä»¬ç»™å­ç»„ä»¶ç»‘å®šä¸Šv-onï¼Œæ¥ç›‘å¬å­ç»„ä»¶çš„äº‹ä»¶ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div id=&quot;#app&quot;&gt;</span><br><span class="line">        // é€šè¿‡v-bindç»‘å®šçˆ¶å­ç»„ä»¶çš„å±æ€§ï¼Œé€šè¿‡v-onç›‘å¬å­ç»„ä»¶çš„å±æ€§å˜åŒ–</span><br><span class="line">        &lt;hello v-bind:messageFromParent=&quot;message&quot; v-on:changeParentData=&quot;changeData&quot;/&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot;&gt;</span><br><span class="line">import Vue from &#x27;vue&#x27;;</span><br><span class="line">import Hello from &#x27;./Hello.vue&#x27;;</span><br><span class="line">export default Vue.extend(&#123;</span><br><span class="line">    data: &#123;</span><br><span class="line">        message: &quot;this message from parent&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    components: &#123;</span><br><span class="line">        &quot;hello&quot;: Hello</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">        changeData: function(data: string) &#123;</span><br><span class="line">            message = data;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>å­ç»„ä»¶åªéœ€è¦å‘é€å‡ºä¿®æ”¹å³å¯ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;button v-on:click=&quot;change&quot;&gt;ä¿®æ”¹çˆ¶ç»„ä»¶æ•°æ®&lt;/button&gt;</span><br><span class="line">        &#123;&#123; messageFromParent &#125;&#125;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot;&gt;</span><br><span class="line">import Vue from &#x27;vue&#x27;;</span><br><span class="line">export default Vue.extend(&#123;</span><br><span class="line">    // é€šè¿‡propsæ•°ç»„æ¥æ”¶</span><br><span class="line">    props: [ &quot;messageFromParent&quot; ],</span><br><span class="line">    methods: &#123;</span><br><span class="line">        change: function() &#123;</span><br><span class="line">            // è°ƒç”¨this.$emitæ–¹æ³•ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯äº‹ä»¶çš„åç§°ï¼Œåé¢å…¨éƒ¨éƒ½æ˜¯å‚æ•°ã€‚</span><br><span class="line">            // this.$emitæ–¹æ³•å…¶å®æ˜¯è‡ªå®šä¹‰äº†ä¸€ä¸ªäº‹ä»¶ï¼Œé€šè¿‡è¿™ç§æ–¹å¼æ¥å®Œæˆå­ç»„ä»¶å‘çˆ¶ç»„ä»¶ä¼ é€’æ¶ˆæ¯ã€‚</span><br><span class="line">            this.$emit(&quot;changeParentData&quot;, &quot;change data by child&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šå°±æ˜¯Vueçˆ¶å­ç»„ä»¶ä¼ å€¼çš„ä¸€ç§å¸¸ç”¨æ–¹æ³•ï¼Œé€‚ç”¨äºç›¸é‚»ç»„ä»¶çš„ï¼Œå¦‚æœéš”ä»£äº†ï¼Œé‚£ä¹ˆè¿™ç§æ–¹å¼å°±ä¸å¥½ç”¨äº†ï¼Œä¸­é—´è·¯è¿‡çš„ç»„ä»¶éƒ½éœ€è¦è½¬å‘è¿™ä¸ªäº‹ä»¶ï¼Œå¤„ç†è¿™ç§æƒ…å†µå°±éœ€è¦ä½¿ç”¨<code>provide/ inject</code>äº†ï¼Œä¸è¿‡é‚£å°±æ˜¯å¦ä¸€ç¯‡æ–‡ç« å•¦ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ·»åŠ VueåŠ¨ç”»</title>
      <link href="/2019/12/08/vue-transitions/"/>
      <url>/2019/12/08/vue-transitions/</url>
      
        <content type="html"><![CDATA[<p>ä»¥å‰ä¸€ç›´æä¸æ‡‚åŠ¨ç”»æ˜¯æ€ä¹ˆåšçš„ï¼Œå®ƒæ€ä¹ˆè¿™ä¹ˆç¥å¥‡ï¼Œå†™äº†ä¸€ç‚¹çœ‹ä¸æ‡‚çš„ä»£ç ï¼Œå°±å®ç°äº†éå¸¸ä¸°å¯Œçš„æ•ˆæœï¼Œç°åœ¨åšäº†ä¸‰å¹´Qtå¼€å‘ï¼Œæ¥è§¦åˆ°äº†Qtçš„åŠ¨ç”»ç±»ï¼Œæ˜ç™½äº†åŠ¨ç”»æ˜¯æ€ä¹ˆä¸€ä¼šå„¿äº‹ï¼Œç°åœ¨æ¥çœ‹å½“åˆçš„cssåŠ¨ç”»ä»£ç ï¼Œä¹Ÿæ˜ç™½äº†å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„äº†ã€‚æœ¬æ–‡ä¼šä»‹ç»ä¸€ä¸‹Vueæä¾›çš„ç»„ä»¶è¿‡æ¸¡åŠ¨ç”»æ¨¡å—â€”â€”transitionsã€‚</p><span id="more"></span><h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>Vueåœ¨æ’å…¥ã€æ›´æ–°å’Œç§»é™¤DOMå…ƒç´ æ—¶ï¼Œæä¾›äº†å¤šç§ä¸åŒæ–¹å¼çš„åº”ç”¨è¿‡æ¸¡æ•ˆæœã€‚åŒ…å«ä»¥ä¸‹å·¥å…·ï¼š</p><ul><li>åœ¨cssè¿‡æ¸¡å’ŒåŠ¨ç”»ä¸­è‡ªåŠ¨åº”ç”¨class</li><li>å¯ä»¥é…åˆç¬¬ä¸‰æ–¹åŠ¨ç”»cssç±»ï¼Œä¾‹å¦‚Animae.css</li><li>æä¾›é’©å­å‡½æ•°æ¥ä½¿JSæ“ä½œDOMå…ƒç´ </li><li>å¯ä»¥é…åˆä½¿ç”¨ç¬¬ä¸‰æ–¹JavaScriptåŠ¨ç”»åº“ï¼Œä¾‹å¦‚Velocity.js</li></ul><h2 id="å•å…ƒç´ -ç»„ä»¶è¿‡æ¸¡"><a href="#å•å…ƒç´ -ç»„ä»¶è¿‡æ¸¡" class="headerlink" title="å•å…ƒç´ &#x2F;ç»„ä»¶è¿‡æ¸¡"></a>å•å…ƒç´ &#x2F;ç»„ä»¶è¿‡æ¸¡</h2><p>Vueæä¾›äº† <code>transitions</code> çš„å°è£…ç»„ä»¶ï¼Œåœ¨ä¸‹é¢çš„æƒ…å†µä¸­ï¼Œå¯ä»¥ç»™ä»»æ„å…ƒç´ æˆ–ç»„ä»¶æ·»åŠ è¿›å…¥å’Œç¦»å¼€çš„è¿‡æ¸¡æ•ˆæœã€‚</p><ul><li>æ¡ä»¶æ¸²æŸ“ (ä½¿ç”¨ <code>v-show</code>)</li><li>æŒ‰éœ€æ¸²æŸ“ (ä½¿ç”¨ <code>v-if</code>)</li><li>åŠ¨æ€èŠ‚ç‚¹</li><li>ç»„ä»¶æ ¹å…ƒç´ </li></ul><p>è¿™æ˜¯ä¸€ä¸ªåŸºæœ¬çš„ä¾‹å­ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;div id=&quot;app&quot;&gt;</span><br><span class="line">    &lt;button v-on:click=&quot;show = !show&quot;&gt;</span><br><span class="line">    Toggle</span><br><span class="line">    &lt;/button&gt;</span><br><span class="line">    &lt;transitions name=&quot;fade&quot;&gt;</span><br><span class="line">        &lt;p v-if=&quot;show&quot;&gt; hello! &lt;/p&gt;</span><br><span class="line">    &lt;transitions&gt;</span><br><span class="line">&lt;div&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">new Vue(&#123;</span><br><span class="line">    el: &quot;#app&quot;,</span><br><span class="line">    data: &#123;</span><br><span class="line">        show: false</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>åœ¨headä¸­æ·»åŠ styleï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.fade-enter-active,</span><br><span class="line">.fade-leave-active &#123;</span><br><span class="line">  transition: opacity .5s;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.fade-enter,</span><br><span class="line">.fade-leave-to &#123;</span><br><span class="line">  opacity: 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæœ‰ä¸‰ç‚¹éœ€è¦æ³¨æ„ä¸€ä¸‹ï¼Œéœ€è¦åŠ¨ç”»çš„å…ƒç´ éœ€è¦ä½¿ç”¨transitionsèŠ‚åŒ…è£¹èµ·æ¥ï¼Œtransitionséœ€è¦ä¸€ä¸ªnameï¼Œcssä¸­éœ€è¦ä½¿ç”¨å›ºå®šçš„æ‹¼å†™æ¥åº”ç”¨åŠ¨ç”»ï¼Œå…¥åœºåŠ¨ç”»å’Œç¦»åœºåŠ¨ç”»çš„çŠ¶æ€æ˜¯ä¸€è‡´çš„ï¼Œæ‰€ä»¥å†™åœ¨äº†ä¸€ç»„é‡Œã€‚</p><p>å½“æ’å…¥å’Œåˆ é™¤åŒ…å«åœ¨ <code>transitions</code> ç»„ä»¶ä¸­çš„å…ƒç´ æ—¶ï¼ŒVueä¼šåšä»¥ä¸‹çš„äº‹æƒ…ï¼š</p><ul><li>è‡ªåŠ¨å—…æ¢ç»„ä»¶æ˜¯å¦åº”ç”¨äº†cssçš„è¿‡æ¸¡æˆ–åŠ¨ç”»ï¼Œå¦‚æœæœ‰ï¼Œåˆ™åœ¨æ°å½“çš„å®é™…æ·»åŠ &#x2F;åˆ é™¤cssç±»åã€‚</li><li>å¦‚æœ <code>transitions</code> ç»„ä»¶æä¾›äº†é’©å­å‡½æ•°ï¼ŒVueä¼šåœ¨æ°å½“çš„æ—¶æœºè°ƒç”¨é’©å­å‡½æ•°ã€‚</li><li>å¦‚æœæ²¡æœ‰æ‰¾åˆ°cssè¿‡æ¸¡å’ŒåŠ¨ç”»ï¼Œä¹Ÿæ²¡æœ‰æ‰¾åˆ°é’©å­å‡½æ•°ï¼Œåˆ™DOMçš„æ“ä½œ(æ’å…¥å’Œåˆ é™¤)åœ¨ä¸‹ä¸€å¸§ä¸­ç«‹å³æ‰§è¡Œã€‚(æ³¨æ„æ˜¯æŒ‡æµè§ˆå™¨çš„é€å¸§åŠ¨ç”»ï¼Œè€Œä¸æ˜¯Vueçš„nextTickæœºåˆ¶)</li></ul><h3 id="è¿‡æ¸¡çš„ç±»å"><a href="#è¿‡æ¸¡çš„ç±»å" class="headerlink" title="è¿‡æ¸¡çš„ç±»å"></a>è¿‡æ¸¡çš„ç±»å</h3><p>Vueçš„è¿‡æ¸¡åŠ¨ç”»ä¸€å…±æœ‰6ä¸ªçŠ¶æ€ï¼š</p><ol><li><code>v-enter</code>: å®šä¹‰è¿›å…¥è¿‡æ¸¡çš„å¼€å§‹çŠ¶æ€ï¼Œåœ¨å…ƒç´ è¢«æ’å…¥ä¹‹å‰ç”Ÿæ•ˆï¼Œå¾…å…ƒç´ æ’å…¥ä»¥åè¢«ç§»é™¤ã€‚</li><li><code>v-enter-active</code>: å®šä¹‰è¿›å…¥è¿‡æ¸¡ç”Ÿæ•ˆæ—¶çš„çŠ¶æ€ï¼Œåœ¨æ•´ä¸ªè¿›å…¥è¿‡æ¸¡çš„é˜¶æ®µä¸­åº”ç”¨ï¼Œåœ¨å…ƒç´ æ’å…¥ä¹‹å‰ç”Ÿæ•ˆï¼Œåœ¨è¿‡æ¸¡&#x2F;åŠ¨ç”»å®Œæˆåè¢«ç§»é™¤ã€‚è¿™ä¸ªç±»å¯ä»¥å®šä¹‰è¿‡æ¸¡æ—¶é—´ã€å»¶è¿Ÿå’ŒåŠ¨ç”»æ›²çº¿ã€‚</li><li><code>v-enter-to</code>: <strong>åœ¨2.1.8ç‰ˆæœ¬åŠä»¥ä¸Š</strong> å®šä¹‰è¿›å…¥è¿‡æ¸¡çš„ç»“æŸçŠ¶æ€ï¼Œåœ¨å…ƒç´ è¢«æ’å…¥çš„ä¸‹ä¸€å¸§ç”Ÿæ•ˆ(ä¸æ­¤åŒæ—¶ <code>v-enter</code> è¢«ç§»é™¤)ï¼Œåœ¨è¿‡æ¸¡&#x2F;åŠ¨ç”»å®Œæˆåç§»é™¤ã€‚</li><li><code>v-leave</code>: å®šä¹‰ç¦»å¼€è¿‡æ¸¡çš„å¼€å§‹çŠ¶æ€ï¼Œåœ¨ç¦»å¼€è¿‡æ¸¡è¢«è§¦å‘æ—¶ç«‹å³ç”Ÿæ•ˆï¼Œä¸‹ä¸€å¸§è¢«ç§»é™¤ã€‚</li><li><code>v-leave-active</code>: å®šä¹‰ç¦»å¼€è¿‡æ¸¡ç”Ÿæ•ˆæ—¶çš„çŠ¶æ€ï¼Œåœ¨æ•´ä¸ªç¦»å¼€è¿‡æ¸¡çš„é˜¶æ®µä¸­åº”ç”¨ï¼Œåœ¨ç¦»å¼€è¿‡æ¸¡è§¦å‘æ—¶ç«‹å³ç”Ÿæ•ˆï¼Œåœ¨è¿‡æ¸¡&#x2F;åŠ¨ç”»å®Œæˆåç«‹å³è¢«ç§»é™¤ã€‚è¿™ä¸ªç±»å¯ä»¥å®šä¹‰ç¦»å¼€è¿‡æ¸¡çš„è¿‡ç¨‹æ—¶é—´ã€å»¶è¿Ÿå’ŒåŠ¨ç”»æ›²çº¿ã€‚</li><li><code>v-leave-to</code>: <strong>åœ¨2.1ã€‚8ç‰ˆæœ¬åŠä»¥ä¸Š</strong> å®šä¹‰ç¦»å¼€è¿‡æ¸¡çš„ç»“æŸçŠ¶æ€ï¼Œåœ¨ç¦»å¼€è¿‡æ¸¡è¢«è§¦å‘ä¹‹åçš„ä¸‹ä¸€å¸§è¢«ç§»é™¤(ä¸æ­¤åŒæ—¶<code>v-leave</code>ä¹Ÿè¢«åˆ é™¤)<br>ï¼Œåœ¨è¿‡æ¸¡&#x2F;åŠ¨ç”»å®Œæˆä¹‹åç§»é™¤ã€‚</li></ol><p><img src="https://cn.vuejs.org/images/transition.png" alt="transitions"></p><p>å¯ä»¥çœ‹å‡ºä¸€å…±ä¸¤ç»„åŠ¨ç”»ï¼Œè¿›å…¥å’Œç¦»å¼€çš„activeã€‚å¹¶ä¸”åˆ†åˆ«æœ‰ä¸¤ä¸ªçŠ¶æ€ï¼Œenterå’Œenter-toï¼Œè¿™6ä¸ªçŠ¶æ€æ§åˆ¶äº†å…¥åœºåŠ¨ç”»å’Œç¦»åœºåŠ¨ç”»ã€‚(åæ§½ä¸€ä¸‹Qtçš„åŠ¨ç”»ç³»ç»Ÿï¼Œå®šä¹‰ä¸€ä¸ªQAnimationåªèƒ½åšåŠåœºåŠ¨ç”»ï¼Œæƒ³åšåˆ°Vueè¿™æ ·çš„è¦å®šä¹‰ä¸¤ç»„ï¼Œæˆ–è€…åå‘æ’­æ”¾)</p><p>å¯¹äºé‚£äº›æ­£åœ¨è¿‡æ¸¡ä¸­åˆ‡æ¢çš„ç±»åæ¥è¯´ï¼Œå¦‚æœä½¿ç”¨äº†æ²¡æœ‰<code>name</code>å±æ€§çš„<code>transition</code>ï¼ŒVueä¼šä½¿ç”¨v-å½“åšé»˜è®¤å‰ç¼€ã€‚ä¸ºäº†é¿å…å¤šç»„åŠ¨ç”»å†²çªï¼Œæˆ‘ä¸ªäººå»ºè®®æ¯ä¸€ä¸ª<code>transition</code>ç»„ä»¶éƒ½æä¾›nameå±æ€§ã€‚</p><h3 id="JavaScripté’©å­å‡½æ•°"><a href="#JavaScripté’©å­å‡½æ•°" class="headerlink" title="JavaScripté’©å­å‡½æ•°"></a>JavaScripté’©å­å‡½æ•°</h3><p><code>transition</code>ä¹Ÿæä¾›äº†é’©å­å‡½æ•°ï¼Œä½¿æˆ‘ä»¬å¯ä»¥é€šè¿‡JavaScriptæ¥æ§åˆ¶DOMå…ƒç´ ï¼Œä¸€å…±ä¹ŸåŒ…å«äº†8ä¸ªå‡½æ•°ï¼š</p><ol><li>beforeEnter</li><li>enter</li><li>afterEnter</li><li>enterCancelled</li><li>beforeLeave</li><li>leave</li><li>afterLeave</li><li>leaveCancelled</li></ol><p>å’Œcssä¸Šè¦æ±‚çš„å‘½åä¿æŒä¸€è‡´ï¼Œåªæ˜¯å¢åŠ äº†ä¸¤ä¸ªå–æ¶ˆçš„æ¥å£ï¼Œå½“åŠ¨ç”»è¢«å–æ¶ˆçš„æ—¶å€™è¢«è°ƒç”¨ã€‚</p><p>è¿™äº›é’©å­å‡½æ•°å¯ä»¥ç»“åˆCSS <code>transition/animations</code> ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥å•ç‹¬ä½¿ç”¨ã€‚</p><blockquote><p>å½“åªä½¿ç”¨JavaScriptè¿‡æ¸¡çš„æ—¶å€™ï¼Œå¿…é¡»åœ¨ <strong>enter</strong> å’Œ <strong>leave</strong> æ˜¾å¼è°ƒç”¨<code>done()</code>è¿›è¡Œå›è°ƒï¼Œå¦åˆ™ä»–ä»¬å°†è¢«åŒæ­¥è°ƒç”¨ï¼Œè¿‡æ¸¡ä¼šç«‹å³å®Œæˆã€‚</p></blockquote><blockquote><p>æ¨èå¯¹äºä»…ä½¿ç”¨JavaScriptè¿‡æ¸¡çš„å…ƒç´ æ·»åŠ <code>v-bind:css=&quot;false&quot;</code>ï¼ŒVueä¼šè·³è¿‡CSSçš„æ£€æµ‹ï¼Œè¿™ä¹Ÿå¯ä»¥é¿å…è¿‡æ¸¡è¿‡ç¨‹ä¸­cssçš„å½±å“ã€‚</p></blockquote><h2 id="åˆ—è¡¨å…ƒç´ çš„è¿‡æ¸¡"><a href="#åˆ—è¡¨å…ƒç´ çš„è¿‡æ¸¡" class="headerlink" title="åˆ—è¡¨å…ƒç´ çš„è¿‡æ¸¡"></a>åˆ—è¡¨å…ƒç´ çš„è¿‡æ¸¡</h2><p>ä»¥ä¸Šæˆ‘åˆ†äº«çš„éƒ½æ˜¯å•å…ƒç´ &#x2F;ç»„ä»¶çš„è¿‡æ¸¡ï¼Œé‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œåˆ—è¡¨è¿™ç§é€šè¿‡v-foråˆ›å»ºçš„å…ƒç´ è¯¥å¦‚ä½•å¢åŠ è¿‡æ¸¡æ•ˆæœå‘¢ï¼Ÿ</p><p>Vueæä¾›äº†<code>&lt;transition-group&gt;</code>ç»„ä»¶ï¼Œåœ¨æ·±å…¥äº†è§£ä¹‹å‰ï¼Œéœ€è¦å…ˆä»‹ç»ä¸€ä¸‹è¿™ä¸ªç»„ä»¶çš„ä¸€äº›ç‰¹ç‚¹ï¼š</p><ul><li>ä¸åŒäº<code>&lt;transition&gt;</code>ï¼Œ<code>&lt;transition-group&gt;</code>ä¼šåˆ›å»ºä¸€ä¸ªçœŸå®çš„DOMå…ƒç´ ï¼Œé»˜è®¤æ˜¯<span>ï¼Œå¯ä»¥é€šè¿‡tagå±æ€§åˆ‡æ¢ä¸ºå…¶ä»–å…ƒç´ ã€‚</li><li>è¿‡æ¸¡æ¨¡å¼ä¸å†å¯ç”¨ï¼Œå› ä¸ºæˆ‘ä»¬ä¸å†ç›¸äº’åˆ‡æ¢ç‰¹æœ‰çš„å…ƒç´ </li><li>å†…éƒ¨å…ƒç´ æ€»æ˜¯éœ€è¦æä¾›å”¯ä¸€çš„keyå€¼æ¥è¿›è¡ŒåŒºåˆ†</li><li>CSSè¿‡æ¸¡å°†ä¼šåº”ç”¨åœ¨å†…éƒ¨çš„å…ƒç´ ä¸­ï¼Œè€Œä¸æ˜¯è¿™ä¸ªç»„&#x2F;å®¹å™¨æœ¬èº«</li></ul><h3 id="åˆ—è¡¨çš„è¿›å…¥-ç¦»å¼€è¿‡æ¸¡"><a href="#åˆ—è¡¨çš„è¿›å…¥-ç¦»å¼€è¿‡æ¸¡" class="headerlink" title="åˆ—è¡¨çš„è¿›å…¥&#x2F;ç¦»å¼€è¿‡æ¸¡"></a>åˆ—è¡¨çš„è¿›å…¥&#x2F;ç¦»å¼€è¿‡æ¸¡</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;div id=&quot;app&quot;&gt;</span><br><span class="line">&lt;button v-on:click=&quot;add&quot;&gt;add&lt;/button&gt;</span><br><span class="line">&lt;button v-on:click=&quot;remove&quot;&gt;remove&lt;/button&gt;</span><br><span class="line">&lt;transition-group name=&quot;group&quot; tag=&quot;ul&quot;&gt;</span><br><span class="line">&lt;li v-for=&quot;item in items&quot; v-bind:key=&quot;item&quot;&gt;</span><br><span class="line">  &#123;&#123; item &#125;&#125;</span><br><span class="line">&lt;/li&gt;</span><br><span class="line">&lt;/transition-group&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">new Vue(&#123;</span><br><span class="line">el: &quot;#app&quot;,</span><br><span class="line">data: &#123;</span><br><span class="line">items: [1,2,3]</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">  add() &#123;</span><br><span class="line">  this.items.push(0)</span><br><span class="line">  &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.group-enter,</span><br><span class="line">.group-leave-to &#123;</span><br><span class="line">  opacity: 0;</span><br><span class="line">  transform: translateY(10px)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.group-enter-active,</span><br><span class="line">.group-leave-active &#123;</span><br><span class="line">  transition: all 1s;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»£ç åœ¨<a href="https://jsfiddle.net/justforlxz/9denwmor/20/">è¿™é‡Œï¼Œç‚¹å‡»è®¿é—®</a>ï¼Œåªå®ç°äº†æ·»åŠ å…ƒç´ çš„è¿‡æ¸¡æ•ˆæœã€‚</p><p>å¸Œæœ›æœ¬æ–‡å¯ä»¥å¸®åŠ©ä½ ç†è§£Vueæ˜¯å¦‚ä½•å¤„ç†è¿‡æ¸¡åŠ¨ç”»ï¼Œæœ¬æ–‡æ˜¯åŸºäºå®˜ç½‘çš„çŸ¥è¯†å’Œdemoæ‰€ç¼–å†™çš„ï¼Œæœ¬æ–‡åªå†™äº†ä¸€éƒ¨åˆ†æˆ‘è§‰å¾—éœ€è¦æŒæ¡çš„åŸºæœ¬åŠŸèƒ½ï¼ŒVueçš„transitionç»„ä»¶è¿˜æœ‰å¾ˆå¤šåŠŸèƒ½ç­‰å¾…ä½ çš„æŒ–æ˜ï¼Œ<a href="https://cn.vuejs.org/v2/guide/transitions.html">ç‚¹å‡»å‰å¾€Vueå®˜ç½‘æ–‡æ¡£</a></p>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨webpack-dev-serveræ¥ç›‘å¬é¡¹ç›®å˜åŒ–</title>
      <link href="/2019/11/25/%E4%BD%BF%E7%94%A8webpack-dev-server%E6%9D%A5%E7%9B%91%E5%90%AC%E9%A1%B9%E7%9B%AE%E5%8F%98%E5%8C%96/"/>
      <url>/2019/11/25/%E4%BD%BF%E7%94%A8webpack-dev-server%E6%9D%A5%E7%9B%91%E5%90%AC%E9%A1%B9%E7%9B%AE%E5%8F%98%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<p>webpackçš„å‡ºç°æ–¹ä¾¿äº†å‰ç«¯å¼€å‘è€…ï¼Œä½¿å¼€å‘å’Œéƒ¨ç½²åˆ†æˆäº†ä¸¤éƒ¨åˆ†ï¼Œå¼€å‘è€…å¯ä»¥æ­£å¸¸æ ¹æ®å·¥ç¨‹åŒ–çš„è¦æ±‚è¿›è¡Œå¼€å‘ï¼Œéƒ¨ç½²æ—¶é€šè¿‡webpackå®ç°ä»£ç çš„è£å‰ªå’Œä¼˜åŒ–ã€‚</p><p>æœ¬æ¬¡å°±ä»‹ç»ä¸€ä¸ªwebpackçš„åŠŸèƒ½ <code>webpack-dev-server</code></p><p>å°†webpackä¸æä¾›å®æ—¶é‡è½½çš„å¼€å‘æœåŠ¡å™¨ä¸€èµ·ä½¿ç”¨ã€‚è¿™ä»…åº”ç”¨äºå¼€å‘ã€‚<br>å®ƒåœ¨åå°ä½¿ç”¨äº†webpack-dev-middlewareï¼Œå®ƒæä¾›äº†å¯¹Webpackèµ„äº§çš„å¿«é€Ÿå†…å­˜è®¿é—®ã€‚</p><span id="more"></span><p>webpack-dev-serveræä¾›äº†ä¸€ä¸ªå°å‹çš„expressçš„httpæœåŠ¡å™¨ï¼Œè¿™ä¸ªhttpæœåŠ¡å™¨å’Œclientä½¿ç”¨äº†websocketé€šè®¯åè®®ï¼ŒåŸå§‹æ–‡ä»¶ä½œå‡ºæ”¹åŠ¨åï¼Œwebpack-dev-serverä¼šå®æ—¶çš„ç¼–è¯‘ï¼Œä½†æ˜¯æœ€åçš„ç¼–è¯‘çš„æ–‡ä»¶å¹¶æ²¡æœ‰è¾“å‡ºåˆ°ç›®æ ‡æ–‡ä»¶å¤¹ã€‚</p><p><strong>æ³¨æ„ï¼šå¯åŠ¨webpack-dev-serveråï¼Œåœ¨ç›®æ ‡æ–‡ä»¶å¤¹ä¸­æ˜¯çœ‹ä¸åˆ°ç¼–è¯‘åçš„æ–‡ä»¶çš„,ç¼–è¯‘åçš„æ–‡ä»¶éƒ½ä¿å­˜åˆ°äº†å†…å­˜å½“ä¸­æ¥åŠ é€Ÿè®¿é—®ã€‚</strong></p><h2 id="å¯ç”¨webpack-dev-server"><a href="#å¯ç”¨webpack-dev-server" class="headerlink" title="å¯ç”¨webpack-dev-server"></a>å¯ç”¨webpack-dev-server</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">npm install -D webpack-dev-server</span><br></pre></td></tr></table></figure><p>åœ¨webpack.config.jsä¸­æ·»åŠ devServerå¯¹è±¡ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var path = require(&#x27;path&#x27;);</span><br><span class="line"></span><br><span class="line">module.exports = &#123;</span><br><span class="line">  //...</span><br><span class="line">  devServer: &#123;</span><br><span class="line">    contentBase: path.join(__dirname, &#x27;dist&#x27;),</span><br><span class="line">    compress: true, // å¼€å¯å‹ç¼©</span><br><span class="line">    port: 9000 // æŒ‡å®šè¿è¡Œçš„ç«¯å£</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ç„¶åé€šè¿‡<code>npx webpack-dev-server</code>å¯åŠ¨ï¼Œç»ˆç«¯ä¸Šä¼šè¾“å‡ºä¸€äº›ä¿¡æ¯ï¼Œä¸€èˆ¬æˆ‘ä»¬ä¼šå¢åŠ ä¸€äº›å‚æ•°æ¥ä½¿è¾“å‡ºæ›´åŠ å¥½çœ‹:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">webpack-dev-server --devtool eval-source-map --progress --colors --hot --inline</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„å‘½ä»¤å¢åŠ ä¸€ä¸ªå¼€å‘å·¥å…· <code>eval-source-map</code>ï¼Œå¼€å¯äº†progressè¿›åº¦æ˜¾ç¤ºï¼Œå¼€å¯äº†colorsé¢œè‰²ï¼Œhotçƒ­æ›´æ–°å’Œinlineæ›´æ–°æ¨¡å¼ã€‚ä¸Šé¢çš„å‚æ•°ä¹Ÿå¯ä»¥æ·»åŠ åˆ°devServerçš„å±æ€§ä¸­ã€‚</p><p>ç»ˆç«¯è¾“å‡ºçš„å†…å®¹å¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">10% building 1/1 modules 0 activeâ„¹ ï½¢wdsï½£: Project is running at http://localhost:9000/</span><br><span class="line">â„¹ ï½¢wdsï½£: webpack output is served from /dist/</span><br><span class="line">â„¹ ï½¢wdsï½£: Content not from webpack is served from /home/justforlxz/Projects/VueBlog/dist</span><br><span class="line">â„¹ ï½¢wdmï½£: Hash: ff9005d9f6ffafd11cd4</span><br><span class="line">Version: webpack 4.41.0</span><br><span class="line">Time: 2938ms</span><br><span class="line">Built at: 11/25/2019 6:03:50 PM</span><br><span class="line">  Asset      Size  Chunks             Chunk Names</span><br><span class="line">main.js  2.09 MiB    main  [emitted]  main</span><br><span class="line">Entrypoint main = main.js</span><br><span class="line">[0] multi (webpack)-dev-server/client?http://localhost:9000 (webpack)/hot/dev-server.js ./src/main.ts 52 bytes &#123;main&#125; [built]</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡localhost:9000æ¥è®¿é—®æˆ‘ä»¬çš„åº”ç”¨äº†ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºæˆ‘ä»¬ç»å¸¸æŠŠå†…å®¹è¾“å‡ºåˆ°distç›®å½•ï¼Œä½†æ˜¯webpackè¿è¡Œæ˜¯åœ¨é¡¹ç›®ç›®å½•çš„ï¼Œè®¿é—®webpackç”Ÿæˆåœ¨distç›®å½•çš„main.jsæ—¶ï¼Œéœ€è¦å†™ä¸Šç›¸å¯¹äºwebpackçš„ç›®å½•ï¼Œä¾‹å¦‚dist&#x2F;main.jsã€‚å¦åˆ™ä¼šæ‰¾ä¸åˆ°æ–‡ä»¶ã€‚</p><p>å¦‚æœé‡åˆ°é—®é¢˜ï¼Œå¯¼èˆªåˆ° &#x2F;webpack-dev-server è·¯å¾„ï¼Œå¯ä»¥æ˜¾ç¤ºå‡ºæ–‡ä»¶çš„æœåŠ¡ä½ç½®ã€‚ ä¾‹å¦‚ï¼Œ<a href="http://localhost:9000/webpack-dev-server%E3%80%82">http://localhost:9000/webpack-dev-serverã€‚</a></p><h2 id="é…ç½®webpack"><a href="#é…ç½®webpack" class="headerlink" title="é…ç½®webpack"></a>é…ç½®webpack</h2><p>webpack-dev-serveræ”¯æŒåœ¨æœåŠ¡å†…éƒ¨è°ƒç”¨ä¸­é—´ä»¶å¯¹æ•°æ®è¿›è¡Œå¤„ç†ã€‚</p><h3 id="devServer-before"><a href="#devServer-before" class="headerlink" title="devServer.before"></a>devServer.before</h3><p><code>function (app, server)</code></p><p>åœ¨æœåŠ¡å†…éƒ¨çš„æ‰€æœ‰å…¶ä»–ä¸­é—´ä»¶ä¹‹å‰ï¼Œ æä¾›æ‰§è¡Œè‡ªå®šä¹‰ä¸­é—´ä»¶çš„åŠŸèƒ½ã€‚ è¿™å¯ä»¥ç”¨æ¥é…ç½®è‡ªå®šä¹‰å¤„ç†ç¨‹åºï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">  //...</span><br><span class="line">  devServer: &#123;</span><br><span class="line">    before: function(app, server) &#123;</span><br><span class="line">      app.get(&#x27;/some/path&#x27;, function(req, res) &#123;</span><br><span class="line">        res.json(&#123; custom: &#x27;response&#x27; &#125;);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="devServer-after"><a href="#devServer-after" class="headerlink" title="devServer.after"></a>devServer.after</h3><p>åŒdevServer.beforeï¼Œåœ¨æœåŠ¡å†…éƒ¨çš„æ‰€æœ‰ä¸­é—´ä»¶ä¹‹åï¼Œæä¾›æ‰§è¡Œè‡ªå®šä¹‰ä¸­é—´ä»¶çš„åŠŸèƒ½ã€‚</p><h3 id="devServer-allowedHosts"><a href="#devServer-allowedHosts" class="headerlink" title="devServer.allowedHosts"></a>devServer.allowedHosts</h3><p>å…è®¸æ·»åŠ ç™½åå•æœåŠ¡ï¼Œå…è®¸ä¸€äº›å¼€å‘æœåŠ¡å™¨è®¿é—®ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">  //...</span><br><span class="line">  devServer: &#123;</span><br><span class="line">    allowedHosts: [</span><br><span class="line">      &#x27;host.com&#x27;,</span><br><span class="line">      &#x27;subdomain.host.com&#x27;,</span><br><span class="line">      &#x27;subdomain2.host.com&#x27;,</span><br><span class="line">      &#x27;host2.com&#x27;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ¨¡ä»¿ django çš„ ALLOWED_HOSTSï¼Œä»¥ . å¼€å¤´çš„å€¼å¯ä»¥ç”¨ä½œå­åŸŸé€šé…ç¬¦ã€‚.host.com å°†ä¼šåŒ¹é… host.com, <a href="http://www.host.com/">www.host.com</a> å’Œ host.com çš„ä»»ä½•å…¶ä»–å­åŸŸåã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">  //...</span><br><span class="line">  devServer: &#123;</span><br><span class="line">    // è¿™å®ç°äº†ä¸ç¬¬ä¸€ä¸ªç¤ºä¾‹ç›¸åŒçš„æ•ˆæœï¼Œ</span><br><span class="line">    // å¦‚æœæ–°çš„å­åŸŸåéœ€è¦è®¿é—® dev serverï¼Œ</span><br><span class="line">    // åˆ™æ— éœ€æ›´æ–°æ‚¨çš„é…ç½®</span><br><span class="line">    allowedHosts: [</span><br><span class="line">      &#x27;.host.com&#x27;,</span><br><span class="line">      &#x27;host2.com&#x27;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="devServer-clientLogLevel"><a href="#devServer-clientLogLevel" class="headerlink" title="devServer.clientLogLevel"></a>devServer.clientLogLevel</h3><p><code>string: &#39;none&#39; | &#39;info&#39; | &#39;error&#39; | &#39;warning&#39;</code></p><p>å½“ä½¿ç”¨å†…è”æ¨¡å¼(inline mode)æ—¶ï¼Œä¼šåœ¨å¼€å‘å·¥å…·(DevTools)çš„æ§åˆ¶å°(console)æ˜¾ç¤ºæ¶ˆæ¯ï¼Œä¾‹å¦‚ï¼šåœ¨é‡æ–°åŠ è½½ä¹‹å‰ï¼Œåœ¨ä¸€ä¸ªé”™è¯¯ä¹‹å‰ï¼Œæˆ–è€… æ¨¡å—çƒ­æ›¿æ¢(Hot Module Replacement) å¯ç”¨æ—¶ã€‚é»˜è®¤å€¼æ˜¯ infoã€‚</p><p>devServer.clientLogLevel å¯èƒ½ä¼šæ˜¾å¾—å¾ˆç¹çï¼Œä½ å¯ä»¥é€šè¿‡å°†å…¶è®¾ç½®ä¸º â€˜noneâ€™ æ¥å…³é—­ logã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">  //...</span><br><span class="line">  devServer: &#123;</span><br><span class="line">    clientLogLevel: &#x27;none&#x27;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="devServer-color-åªç”¨äºå‘½ä»¤è¡Œå·¥å…·-CLI"><a href="#devServer-color-åªç”¨äºå‘½ä»¤è¡Œå·¥å…·-CLI" class="headerlink" title="devServer.color  - åªç”¨äºå‘½ä»¤è¡Œå·¥å…·(CLI)"></a>devServer.color  - åªç”¨äºå‘½ä»¤è¡Œå·¥å…·(CLI)</h3><p>åªåœ¨ç»ˆç«¯ä¸‹å¯ç”¨ï¼Œå¯ç”¨&#x2F;ç¦ç”¨æ§åˆ¶å°çš„å½©è‰²è¾“å‡ºã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">webpack-dev-server --color</span><br></pre></td></tr></table></figure><h3 id="devServer-compress"><a href="#devServer-compress" class="headerlink" title="devServer.compress"></a>devServer.compress</h3><p><code>boolean</code></p><p>ä¸€åˆ‡æœåŠ¡éƒ½å¼€å¯gzipå‹ç¼©ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">  //...</span><br><span class="line">  devServer: &#123;</span><br><span class="line">    compress: true</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="devServer-contentBase"><a href="#devServer-contentBase" class="headerlink" title="devServer.contentBase"></a>devServer.contentBase</h3><p><code>boolean: false string [string] number</code></p><p>å‘Šè¯‰æœåŠ¡å™¨ä»å“ªä¸ªç›®å½•ä¸­æä¾›å†…å®¹ã€‚åªæœ‰åœ¨ä½ æƒ³è¦æä¾›é™æ€æ–‡ä»¶æ—¶æ‰éœ€è¦ã€‚devServer.publicPath å°†ç”¨äºç¡®å®šåº”è¯¥ä»å“ªé‡Œæä¾› bundleï¼Œå¹¶ä¸”æ­¤é€‰é¡¹ä¼˜å…ˆã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå°†ä½¿ç”¨å½“å‰å·¥ä½œç›®å½•ä½œä¸ºæä¾›å†…å®¹çš„ç›®å½•ã€‚å°†å…¶è®¾ç½®ä¸º false ä»¥ç¦ç”¨ contentBaseã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">  //...</span><br><span class="line">  devServer: &#123;</span><br><span class="line">    contentBase: path.join(__dirname, &#x27;public&#x27;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥ä»å¤šä¸ªç›®å½•æä¾›å†…å®¹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">  //...</span><br><span class="line">  devServer: &#123;</span><br><span class="line">    contentBase: [path.join(__dirname, &#x27;public&#x27;), path.join(__dirname, &#x27;assets&#x27;)]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="devServer-disableHostCheck"><a href="#devServer-disableHostCheck" class="headerlink" title="devServer.disableHostCheck"></a>devServer.disableHostCheck</h3><p><code>boolean</code></p><p>è®¾ç½®ä¸º true æ—¶ï¼Œæ­¤é€‰é¡¹ç»•è¿‡ä¸»æœºæ£€æŸ¥ã€‚ä¸å»ºè®®è¿™æ ·åšï¼Œå› ä¸ºä¸æ£€æŸ¥ä¸»æœºçš„åº”ç”¨ç¨‹åºå®¹æ˜“å—åˆ° DNS é‡æ–°è¿æ¥æ”»å‡»ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">  //...</span><br><span class="line">  devServer: &#123;</span><br><span class="line">    disableHostCheck: true</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="devServer-filename"><a href="#devServer-filename" class="headerlink" title="devServer.filename"></a>devServer.filename</h3><p><code>string</code></p><p>åœ¨ lazy mode(æƒ°æ€§æ¨¡å¼) ä¸­ï¼Œæ­¤é€‰é¡¹å¯å‡å°‘ç¼–è¯‘ã€‚ é»˜è®¤åœ¨ lazy mode(æƒ°æ€§æ¨¡å¼)ï¼Œæ¯ä¸ªè¯·æ±‚ç»“æœéƒ½ä¼šäº§ç”Ÿå…¨æ–°çš„ç¼–è¯‘ã€‚ä½¿ç”¨ filenameï¼Œå¯ä»¥åªåœ¨æŸä¸ªæ–‡ä»¶è¢«è¯·æ±‚æ—¶ç¼–è¯‘ã€‚</p><p>å¦‚æœ output.filename è®¾ç½®ä¸º â€˜bundle.jsâ€™ ï¼ŒdevServer.filename ç”¨æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">  //...</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: &#x27;bundle.js&#x27;</span><br><span class="line">  &#125;,</span><br><span class="line">  devServer: &#123;</span><br><span class="line">    lazy: true,</span><br><span class="line">    filename: &#x27;bundle.js&#x27;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ç°åœ¨åªæœ‰åœ¨è¯·æ±‚äº†bundle.jsæ—¶ï¼Œæ‰ä¼šå»ç¼–è¯‘bundleã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>webpackçš„åŠŸèƒ½ç¡®å®å¾ˆå¼ºå¤§ï¼Œå¯ä»¥é’ˆå¯¹ä»£ç è¿›è¡Œå„ç§æ“ä½œï¼Œæœ€ç»ˆç”Ÿæˆå‡ºå¯ä»¥é€‚åº”å„ç§åœºæ™¯çš„ä»£ç ï¼Œä½¿å¼€å‘å’Œéƒ¨ç½²å½»åº•åˆ†ç¦»å¼€æ¥ï¼Œå¼€å‘è€…å¯ä»¥æ›´åŠ ä¸“æ³¨é¡¹ç›®ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç»™Archlinuxå¼€å¯BFQå’ŒMuQSS</title>
      <link href="/2019/10/24/%E7%BB%99Archlinux%E5%BC%80%E5%90%AFBFQ%E5%92%8CMuQSS/"/>
      <url>/2019/10/24/%E7%BB%99Archlinux%E5%BC%80%E5%90%AFBFQ%E5%92%8CMuQSS/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨Archä¸Šæ›´æ–°ç³»ç»Ÿçš„æ—¶å€™ï¼Œæ€»æ˜¯é‡åˆ°å›¾å½¢å®Œå…¨å¡ä½çš„æƒ…å†µï¼Œä»Šå¤©ä¸Šåˆçªç„¶æƒ³èµ·æ¥è‡ªå·±æ›¾ç»è®¾ç½®äº†ä½¿ç”¨noopçš„IOè°ƒåº¦ï¼ŒçŒœæµ‹æ˜¯å› ä¸ºè¿™ä¸ªã€‚ç„¶åæœ¬ç€ä¸æŠ˜è…¾ä¸èˆ’æœçš„åŸåˆ™ï¼Œæ‰“ç®—ä½¿ç”¨ckå†…æ ¸ä¸ŠMuQSSçš„è¿›ç¨‹è°ƒåº¦å’ŒBFQçš„IOè°ƒåº¦ã€‚</p><span id="more"></span><p>ckå†…æ ¸å¹¶æ²¡æœ‰åœ¨archçš„ä»“åº“ï¼Œä½†æ˜¯auræœ‰linux-ckçš„åŒ…ï¼Œå®‰è£…ä¸€ä¸‹å°±å¯ä»¥äº†ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">yay -S linux-ck linux-ck-headers</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘éœ€è¦ä¸€äº›æ—¶é—´ï¼Œåœ¨æˆ‘çš„ç ´æœ¬å­i7-8550Uç¼–è¯‘äº†ä¸€é¡¿è¿‡æ¡¥ç±³çº¿çš„æ—¶é—´ï¼Œç„¶åæˆåŠŸä½¿ç”¨äº†ckå†…æ ¸ã€‚</p><h3 id="å¼€å¯MuQSS"><a href="#å¼€å¯MuQSS" class="headerlink" title="å¼€å¯MuQSS"></a>å¼€å¯MuQSS</h3><p>ckå†…æ ¸é»˜è®¤ä½¿ç”¨çš„å°±æ˜¯MuQSSè°ƒåº¦ï¼Œå¹¶ä¸éœ€è¦ä¿®æ”¹ä»€ä¹ˆï¼Œå¼€æœºå³å¯ã€‚</p><h3 id="å¼€å¯BFQ"><a href="#å¼€å¯BFQ" class="headerlink" title="å¼€å¯BFQ"></a>å¼€å¯BFQ</h3><p>å¼€å¯BFQéœ€è¦ä¸€äº›æ‰‹åŠ¨è®¾ç½®ã€‚åˆ†ä¸ºä¸¤æ­¥ï¼š</p><ol><li>ä¿®æ”¹grubï¼Œç»™å†…æ ¸æä¾›æ–°çš„å‚æ•°</li><li>ä½¿ç”¨udevå¼€å¯åŠ¨æ€è°ƒæ•´</li></ol><p><strong>ä¿®æ”¹grub</strong></p><p>ç¼–è¾‘<code>/etc/default/grub</code>ä¸­<code>GRUB_CMDLINE_LINUX_DEFAULT</code>ï¼Œå¢åŠ ä¸€è¡Œå†…å®¹:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GRUB_CMDLINE_LINUX_DEFAULT=&quot;quiet scsi_mod.use_blk_mq=1&quot;</span><br></pre></td></tr></table></figure><p>ç„¶åæ›´æ–°grubé…ç½®æ–‡ä»¶:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo grub-mkconfig -o /boot/grub/grub.cfg</span><br></pre></td></tr></table></figure><p><strong>åˆ›å»ºudevè§„åˆ™</strong></p><p>åˆ›å»ºå¹¶ç¼–è¾‘<code>/etc/udev/rules.d/60-scheduler.rules</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># set deadline scheduler for non-rotating disks</span><br><span class="line">ACTION==&quot;add|change&quot;, KERNEL==&quot;sd[a-z]&quot;, TEST!=&quot;queue/rotational&quot;, ATTR&#123;queue/scheduler&#125;=&quot;deadline&quot;</span><br><span class="line">ACTION==&quot;add|change&quot;, KERNEL==&quot;sd[a-z]&quot;, ATTR&#123;queue/rotational&#125;==&quot;0&quot;, ATTR&#123;queue/scheduler&#125;=&quot;bfq&quot;</span><br><span class="line"></span><br><span class="line"># set cfq scheduler for rotating disks</span><br><span class="line">ACTION==&quot;add|change&quot;, KERNEL==&quot;sd[a-z]&quot;, ATTR&#123;queue/rotational&#125;==&quot;1&quot;, ATTR&#123;queue/scheduler&#125;=&quot;bfq&quot;</span><br><span class="line">ACTION==&quot;add|change&quot;, KERNEL==&quot;nvme[0-9]n1&quot;, ATTR&#123;queue/rotational&#125;==&quot;0&quot;, ATTR&#123;queue/scheduler&#125;=&quot;bfq&quot;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„é…ç½®æ˜¯ç»™å›ºæ€ç¡¬ç›˜ä½¿ç”¨deadlineï¼Œç»™æœºæ¢°ç›˜ä½¿ç”¨bfqï¼Œç»™nvmeç›˜bfqã€‚</p><p>æœ¬ç€ç”µè„‘åªæœ‰ssdï¼Œæ‰€ä»¥å¤©ä¸æ€•åœ°ä¸æ€•çš„åŸåˆ™ï¼Œæˆ‘é€‰æ‹©å…¨éƒ¨ä½¿ç”¨bfqã€‚</p><p>ç„¶åé‡å¯ç”µè„‘ï¼ŒæŸ¥çœ‹æ‰€æœ‰ç¡¬ç›˜çš„è°ƒåº¦å™¨ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># justforlxz @ archlinux in ~ [13:29:04]</span><br><span class="line">$ cat /sys/block/*/queue/scheduler</span><br><span class="line">mq-deadline kyber [bfq] none</span><br><span class="line">mq-deadline kyber [bfq] none</span><br></pre></td></tr></table></figure><p>é€šè¿‡dmesgæŸ¥çœ‹MuQSSæ˜¯å¦å¼€å¯ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ sudo dmesg | grep -i scheduler</span><br><span class="line">Alias tip: _ dmesg | grep -i scheduler</span><br><span class="line">[    0.295872] rcu: RCU calculated value of scheduler-enlistment delay is 10 jiffies.</span><br><span class="line">[    1.223982] io scheduler mq-deadline registered</span><br><span class="line">[    1.223984] io scheduler kyber registered</span><br><span class="line">[    1.224038] io scheduler bfq registered</span><br><span class="line">[    1.586191] MuQSS CPU scheduler v0.193 by Con Kolivas.</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>MuQSSæ˜¯BFS(è„‘æ®‹è°ƒåº¦å™¨)çš„è¿›åŒ–ç‰ˆï¼Œä¸»è¦æ˜¯æ”¹è¿›äº†BFSçš„O(n)å¤æ‚åº¦ï¼ŒBFSé€‚ç”¨äºæ¡Œé¢ç¯å¢ƒç”¨æˆ·ï¼Œå¯ä»¥æä¾›è¾ƒå¥½çš„è¿›ç¨‹åˆ‡æ¢å’Œå»¶è¿Ÿã€‚<br>BFQæ˜¯é’ˆå¯¹ç¡¬ç›˜çš„IOè°ƒåº¦ï¼Œå®ƒé€šè¿‡é¢„å…ˆåˆ†é…ä¸€å®šçš„IOååé‡æ¥åˆç†å®‰æ’æ¯ä¸ªè¿›ç¨‹çš„IOæ“ä½œã€‚æˆ‘éœ€è¦ç”¨å‡ å¤©æ¥æ„Ÿå—ä¸€ä¸‹MuQSSå’ŒCFQçš„å¥½å¤„ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨webpackæ‰“åŒ…Vueå’ŒTypeScript</title>
      <link href="/2019/10/22/%E4%BD%BF%E7%94%A8webpack%E6%89%93%E5%8C%85Vue%E5%92%8CTypeScript/"/>
      <url>/2019/10/22/%E4%BD%BF%E7%94%A8webpack%E6%89%93%E5%8C%85Vue%E5%92%8CTypeScript/</url>
      
        <content type="html"><![CDATA[<p>æœ¬æ–‡å°†ä¼šä»‹ç»å¦‚ä½•é€šè¿‡Webpackå°†åŸºäºTypeScriptçš„Vueé¡¹ç›®è¿›è¡Œæ‰“åŒ…ã€‚</p><span id="more"></span><h2 id="webpackåŸºç¡€é…ç½®"><a href="#webpackåŸºç¡€é…ç½®" class="headerlink" title="webpackåŸºç¡€é…ç½®"></a>webpackåŸºç¡€é…ç½®</h2><p>é¦–å…ˆåˆ›å»ºä¸€ä¸ªåŸºæœ¬çš„webpack.config.jsæ–‡ä»¶:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const path = require( &#x27;path&#x27; );</span><br><span class="line"></span><br><span class="line">module.exports = &#123;</span><br><span class="line">    entry: &#123;</span><br><span class="line">        index: &quot;./src/index.ts&quot;,</span><br><span class="line">    &#125;,</span><br><span class="line">    output: &#123;</span><br><span class="line">        path: path.resolve( __dirname, &#x27;dist&#x27; ),</span><br><span class="line">        publicPath: &#x27;/dist/&#x27;,</span><br><span class="line">        filename: &#x27;[name].js&#x27;</span><br><span class="line">    &#125;,</span><br><span class="line">    devtool: &#x27;inline-source-map&#x27;,</span><br><span class="line">    mode: &#x27;development&#x27;,</span><br><span class="line">    module: &#123;</span><br><span class="line">        rules: [</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    resolve: &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶webpackåªèƒ½å°†src&#x2F;index.tsæ–‡ä»¶ç›´æ¥è¾“å‡ºä¸ºindex.jsï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ typescriptçš„loaderï¼Œè¿›è¡Œtypescriptçš„è½¬æ¢ã€‚</p><p>å°†ä»¥ä¸‹ä»£ç åŠ å…¥rulesèŠ‚:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    test: /\.ts?$/,</span><br><span class="line">    loader: &#x27;ts-loader&#x27;,</span><br><span class="line">    exclude: /node_modules/,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p>é€šè¿‡ts-loaderè¿›è¡Œtsæ–‡ä»¶çš„è½¬æ¢ï¼Œæˆ‘ä»¬è¿˜éœ€è¦åˆ›å»ºtypescriptçš„ä¸€ä¸ªé…ç½®æ–‡ä»¶ã€‚</p><h2 id="æ·»åŠ typescriptæ”¯æŒ"><a href="#æ·»åŠ typescriptæ”¯æŒ" class="headerlink" title="æ·»åŠ typescriptæ”¯æŒ"></a>æ·»åŠ typescriptæ”¯æŒ</h2><p>åˆ›å»ºtsconfig.json</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;compilerOptions&quot;: &#123;</span><br><span class="line">        &quot;outDir&quot;: &quot;./dist/&quot;,</span><br><span class="line">        &quot;sourceMap&quot;: true,</span><br><span class="line">        &quot;strict&quot;: true,</span><br><span class="line">        &quot;module&quot;: &quot;commonjs&quot;,</span><br><span class="line">        &quot;moduleResolution&quot;: &quot;node&quot;,</span><br><span class="line">        &quot;target&quot;: &quot;es5&quot;,</span><br><span class="line">        &quot;skipLibCheck&quot;: true,</span><br><span class="line">        &quot;esModuleInterop&quot;: true,</span><br><span class="line">        &quot;experimentalDecorators&quot;: true</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;include&quot;: [</span><br><span class="line">        &quot;./src/**/*&quot;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿˜éœ€è¦åœ¨webpackçš„é…ç½®ä¸­æ·»åŠ tsæ–‡ä»¶ï¼Œåœ¨resolveèŠ‚ä¸­æ·»åŠ :</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">extensions: [ &#x27;.ts&#x27;, &#x27;.js&#x27; ],</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬æŒ‡å®štsè½¬æ¢å‡ºçš„jsä»£ç æ˜¯es5çš„ã€‚</p><p>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬è¿è¡Œwebpackï¼Œå°†ä¼šçœ‹åˆ°æ­£å¸¸çš„è½¬æ¢è¾“å‡ºã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Hash: c3a0ae2c47032de12eec</span><br><span class="line">Version: webpack 4.41.0</span><br><span class="line">Time: 1880ms</span><br><span class="line">Built at: 10/22/2019 3:40:59 PM</span><br><span class="line">   Asset      Size  Chunks             Chunk Names</span><br><span class="line">index.js  11.8 KiB   index  [emitted]  index</span><br><span class="line">Entrypoint index = index.js</span><br><span class="line">[./src/index.ts] 269 bytes &#123;index&#125; [built]</span><br></pre></td></tr></table></figure><p>å…¥å£æ–‡ä»¶å°±æ˜¯index.tsäº†ï¼Œä¹‹åæˆ‘ä»¬å°±æ­£å¸¸çš„åœ¨index.tsä¸­å†™æˆ‘ä»¬çš„ä»£ç ï¼Œwebpackå°±ä¼šæŸ¥æ‰¾æ‰€æœ‰çš„ä¾èµ–ï¼Œå¹¶æ‰“åŒ…è¾“å‡ºåˆ°index.jsä¸­ã€‚</p><h2 id="æ·»åŠ Vueå•æ–‡ä»¶çš„æ”¯æŒ"><a href="#æ·»åŠ Vueå•æ–‡ä»¶çš„æ”¯æŒ" class="headerlink" title="æ·»åŠ Vueå•æ–‡ä»¶çš„æ”¯æŒ"></a>æ·»åŠ Vueå•æ–‡ä»¶çš„æ”¯æŒ</h2><p>Vueå•æ–‡ä»¶ç»„ä»¶(SFC)è§„èŒƒæ˜¯æŒ‡åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œæä¾›htmlã€csså’Œscriptä»£ç ï¼Œä¸‰è€…åŒ…å«åœ¨é¡¶çº§è¯­è¨€å— <code>&lt;template&gt;</code>ã€<code>&lt;script&gt;</code> å’Œ <code>&lt;style&gt;</code><br> ä¸­ï¼Œè¿˜å…è®¸æ·»åŠ å¯é€‰çš„è‡ªå®šä¹‰å—ã€‚</p><p>è¿™æ˜¯ä¸€ä¸ªç®€å•çš„vueå•æ–‡ä»¶ä¾‹å­:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;example&quot;&gt;&#123;&#123; msg &#125;&#125;&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  data () &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      msg: &#x27;Hello world!&#x27;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line">.example &#123;</span><br><span class="line">  color: red;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br><span class="line">&lt;custom1&gt;</span><br><span class="line">  This could be e.g. documentation for the component.</span><br><span class="line">&lt;/custom1&gt;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬é€šè¿‡vue-loaderæ¥è§£æè¯¥æ–‡ä»¶ï¼Œæå–æ¯ä¸€ä¸ªè¯­è¨€å—ï¼Œå¦‚æœ‰éœ€è¦ï¼Œä¼šä¼ é€’ç»™å…¶ä»–loaderè¿›è¡Œå¤„ç†ï¼Œæœ€åç»„è£…ä¸ºä¸€ä¸ªES Moduleã€‚</p><p>æˆ‘ä»¬åœ¨webpackçš„rulesèŠ‚ä¸­æ·»åŠ vue-loader:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  test: /\.vue$/,</span><br><span class="line">  loader: &#x27;vue-loader&#x27;,</span><br><span class="line">  options: &#123;</span><br><span class="line">    loaders: &#123;</span><br><span class="line">      // Since sass-loader (weirdly) has SCSS as its default parse mode, we map</span><br><span class="line">      // the &quot;scss&quot; and &quot;sass&quot; values for the lang attribute to the right configs here.</span><br><span class="line">      // other preprocessors should work out of the box, no loader config like this necessary.</span><br><span class="line">      &#x27;scss&#x27;: &#x27;vue-style-loader!css-loader!sass-loader&#x27;,</span><br><span class="line">      &#x27;sass&#x27;: &#x27;vue-style-loader!css-loader!sass-loader?indentedSyntax&#x27;,</span><br><span class="line">    &#125;</span><br><span class="line">    // other vue-loader options go here</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><h2 id="å¦‚æœvueæ˜¯typescriptä»£ç ï¼Ÿ"><a href="#å¦‚æœvueæ˜¯typescriptä»£ç ï¼Ÿ" class="headerlink" title="å¦‚æœvueæ˜¯typescriptä»£ç ï¼Ÿ"></a>å¦‚æœvueæ˜¯typescriptä»£ç ï¼Ÿ</h2><p>å…¶å®è¿™å¾ˆç®€å•ï¼Œts-loaderæœ‰ä¸€ä¸ªappendTsSuffixToçš„åŠŸèƒ½ï¼Œå¯ä»¥ç»™æŸä¸ªæ–‡ä»¶å¢åŠ .tsçš„åç¼€ï¼Œä»è€Œè¯†åˆ«è¿™ä¸ªæ–‡ä»¶ä¸ºtsæ–‡ä»¶ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  test: /\.tsx?$/,</span><br><span class="line">  loader: &#x27;ts-loader&#x27;,</span><br><span class="line">  exclude: /node_modules/,</span><br><span class="line">  options: &#123;</span><br><span class="line">    appendTsSuffixTo: [/\.vue$/],</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬è¿˜éœ€è¦åœ¨é¡¹ç›®ä¸­æ·»åŠ ä¸€ä¸ªvue-shim.d.tsæ¥è®©tsæ­£ç¡®çš„è¯†åˆ«vueã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">declare module &#x27;*.vue&#x27; &#123;</span><br><span class="line">  import Vue from &#x27;vue&#x27;</span><br><span class="line">  export default Vue</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿˜éœ€è¦åœ¨webpackçš„resolveèŠ‚è¿½åŠ vueçš„åç¼€:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">resolve: &#123;</span><br><span class="line">  extensions: [ &#x27;.tsx&#x27;, &#x27;.ts&#x27;, &#x27;.js&#x27; , &#x27;.vue&#x27;],</span><br><span class="line">  alias: &#123;</span><br><span class="line">    &#x27;vue&#x27;: &#x27;vue/dist/vue.js&#x27;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p>vue-loaderç°åœ¨éœ€è¦æ‰‹åŠ¨å¤„ç†ä¸€ä¸‹æ’ä»¶ï¼Œåœ¨webpack.config.jsçš„å¤´éƒ¨å¯¼å…¥vue-loaderï¼Œå¹¶åœ¨pluginsèŠ‚åˆ›å»ºå¯¹è±¡ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const &#123; VueLoaderPlugin &#125; = require(&#x27;vue-loader&#x27;)</span><br><span class="line"></span><br><span class="line">.......</span><br><span class="line"></span><br><span class="line">plugins: [</span><br><span class="line">  new VueLoaderPlugin()</span><br><span class="line">],</span><br></pre></td></tr></table></figure><p>å¦åˆ™å°†ä¸èƒ½æ­£ç¡®å·¥ä½œã€‚</p><p>æ­¤æ—¶å·²ç»å®Œæˆäº†webpack+vue+typescriptçš„å…¨éƒ¨å·¥ä½œã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Hash: 320d4ed3f55f52872694</span><br><span class="line">Version: webpack 4.41.0</span><br><span class="line">Time: 2494ms</span><br><span class="line">Built at: 10/22/2019 4:00:50 PM</span><br><span class="line">      Asset       Size    Chunks             Chunk Names</span><br><span class="line">  bundle.js   1.12 MiB    bundle  [emitted]  bundle</span><br><span class="line">electron.js   12.2 KiB  electron  [emitted]  electron</span><br><span class="line"> index.html  194 bytes            [emitted]</span><br><span class="line">Entrypoint bundle = bundle.js</span><br><span class="line">Entrypoint electron = electron.js</span><br><span class="line">[./node_modules/css-loader/dist/cjs.js!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/sass-loader/dist/cjs.js!./node_modules/vue-loader/lib/index.js?!./src/app.vue?vue&amp;type=style&amp;index=0&amp;id=5ef48958&amp;rel=stylesheet%2Fscss&amp;lang=scss&amp;scoped=true&amp;] ./node_modules/css-loader/dist/cjs.js!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/sass-loader/dist/cjs.js!./node_modules/vue-loader/lib??vue-loader-options!./src/app.vue?vue&amp;type=style&amp;index=0&amp;id=5ef48958&amp;rel=stylesheet%2Fscss&amp;lang=scss&amp;scoped=true&amp; 542 bytes &#123;bundle&#125; [built]</span><br><span class="line">[./node_modules/ts-loader/index.js?!./node_modules/vue-loader/lib/index.js?!./src/Components/About.vue?vue&amp;type=script&amp;lang=ts&amp;] ./node_modules/ts-loader??ref--1!./node_modules/vue-loader/lib??vue-loader-options!./src/Components/About.vue?vue&amp;type=script&amp;lang=ts&amp; 305 bytes &#123;bundle&#125; [built]</span><br><span class="line">[./node_modules/vue-loader/lib/loaders/templateLoader.js?!./node_modules/vue-loader/lib/index.js?!./src/Components/About.vue?vue&amp;type=template&amp;id=aa9c95a6&amp;] ./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/vue-loader/lib??vue-loader-options!./src/Components/About.vue?vue&amp;type=template&amp;id=aa9c95a6&amp; 235 bytes &#123;bundle&#125; [built]</span><br><span class="line">[./node_modules/vue-loader/lib/loaders/templateLoader.js?!./node_modules/vue-loader/lib/index.js?!./src/app.vue?vue&amp;type=template&amp;id=5ef48958&amp;scoped=true&amp;] ./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/vue-loader/lib??vue-loader-options!./src/app.vue?vue&amp;type=template&amp;id=5ef48958&amp;scoped=true&amp; 589 bytes &#123;bundle&#125; [built]</span><br><span class="line">[./node_modules/vue-style-loader/index.js!./node_modules/css-loader/dist/cjs.js!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/sass-loader/dist/cjs.js!./node_modules/vue-loader/lib/index.js?!./src/app.vue?vue&amp;type=style&amp;index=0&amp;id=5ef48958&amp;rel=stylesheet%2Fscss&amp;lang=scss&amp;scoped=true&amp;] ./node_modules/vue-style-loader!./node_modules/css-loader/dist/cjs.js!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/sass-loader/dist/cjs.js!./node_modules/vue-loader/lib??vue-loader-options!./src/app.vue?vue&amp;type=style&amp;index=0&amp;id=5ef48958&amp;rel=stylesheet%2Fscss&amp;lang=scss&amp;scoped=true&amp; 1.64 KiB &#123;bundle&#125; [built]</span><br><span class="line">[./src/Components/About.vue] 1.06 KiB &#123;bundle&#125; [built]</span><br><span class="line">[./src/Components/About.vue?vue&amp;type=script&amp;lang=ts&amp;] 350 bytes &#123;bundle&#125; [built]</span><br><span class="line">[./src/Components/About.vue?vue&amp;type=template&amp;id=aa9c95a6&amp;] 203 bytes &#123;bundle&#125; [built]</span><br><span class="line">[./src/app.vue] 1.08 KiB &#123;bundle&#125; [built]</span><br><span class="line">[./src/app.vue?vue&amp;type=style&amp;index=0&amp;id=5ef48958&amp;rel=stylesheet%2Fscss&amp;lang=scss&amp;scoped=true&amp;] 716 bytes &#123;bundle&#125; [built]</span><br><span class="line">[./src/app.vue?vue&amp;type=template&amp;id=5ef48958&amp;scoped=true&amp;] 207 bytes &#123;bundle&#125; [built]</span><br><span class="line">[./src/entry.ts] 538 bytes &#123;bundle&#125; [built]</span><br><span class="line">[./src/main.ts] 1.11 KiB &#123;electron&#125; [built]</span><br><span class="line">[./src/route.ts] 1.35 KiB &#123;bundle&#125; [built]</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
            <tag> Webpack </tag>
            
            <tag> TypeScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webpackå…¥é—¨</title>
      <link href="/2019/10/14/webpack%E5%85%A5%E9%97%A8/"/>
      <url>/2019/10/14/webpack%E5%85%A5%E9%97%A8/</url>
      
        <content type="html"><![CDATA[<p>ç°åœ¨å‰ç«¯å¼€å‘ä¸åƒä»¥å‰ä¸€æ ·ï¼Œåªéœ€è¦å†™htmlã€csså’Œjavascriptæ–‡ä»¶å°±å¯ä»¥äº†ã€‚ç°ä»£å‰ç«¯å¼€å‘è®²ç©¶å·¥ç¨‹åŒ–ã€‚</p><p><strong>ä»€ä¹ˆæ˜¯å·¥ç¨‹åŒ–ï¼Ÿ</strong></p><p>å·¥ç¨‹åŒ–å³ç³»ç»ŸåŒ–ã€æ¨¡å—åŒ–ã€è§„èŒƒåŒ–çš„ä¸€ä¸ªè¿‡ç¨‹ã€‚</p><p><strong>ä¸ºä»€ä¹ˆè¦å·¥ç¨‹åŒ–ï¼Ÿ</strong></p><p>å·¥ç¨‹åŒ–æ˜¯è®©å¼€å‘ã€æµ‹è¯•å’Œç»´æŠ¤éƒ½å˜å¾—æ›´åŠ å¯é å’Œæé«˜æ•ˆç‡çš„æ–¹å¼ã€‚</p><ol><li>åˆ¶å®šè§„èŒƒ</li><li>ç‰ˆæœ¬ç®¡ç†</li><li>å•å…ƒæµ‹è¯•</li><li>è‡ªåŠ¨åŒ–</li></ol><p>é€šè¿‡åˆ¶å®šæµç¨‹çš„æ–¹å¼ï¼Œè§„èŒƒäº†å¼€å‘å’Œæµ‹è¯•çš„æµç¨‹ï¼Œè®©å·¥ä½œæœ‰ç« å¯å¾ªï¼Œæ–¹ä¾¿å›¢é˜Ÿåä½œã€‚</p><span id="more"></span><p>æœ€åˆçš„ç½‘é¡µå¼€å‘ï¼Œæ˜¯å†™å¥½å‡ ä»½çš„javascriptä»£ç å’Œcssæ–‡ä»¶ï¼Œæ‰‹åŠ¨åœ¨htmlä¸­å¼•å…¥çš„ã€‚è¿™æ ·ä¸é€‚åˆå¤šäººåä½œå¼€å‘ï¼Œä¸€æ—¦å¼€å‘äººå‘˜å¤šäº†ï¼Œä¸å¯é¿å…çš„ä¼šé€ æˆæ–‡ä»¶å’Œå‘½åå†²çªã€‚<br>ä¸ºäº†é¿å…è¿™äº›äº‹æƒ…çš„å‘ç”Ÿï¼Œjavascriptå¢åŠ äº†æ¨¡å—çš„æ¦‚å¿µã€‚</p><p>æœ‰å¥½çš„äº‹æƒ…å‡ºç°ï¼Œå°±ä¼šæœ‰åçš„äº‹æƒ…å‘ç”Ÿã€‚</p><p>è¿‡å¤šçš„æ¨¡å—å¯¼è‡´jsæ–‡ä»¶ä¸‹è½½å¾ˆæ…¢ï¼Œè€Œä¸”æœ‰å†—ä½™ï¼Œä¸ºäº†é¿å…è¿™ä»¶äº‹æƒ…å½±å“ç”¨æˆ·ä½“éªŒï¼Œwebpackæ¨ªç©ºå‡ºä¸–äº†ã€‚</p><p>webpackæ˜¯ä¸€ä¸ªç°ä»£javascriptçš„é™æ€æ¨¡å—æ‰“åŒ…å™¨ã€‚å®ƒä¼šé€’å½’çš„æ„å»ºå‡ºä¾èµ–å›¾ï¼Œå¹¶æ ¹æ®ä¾èµ–å›¾æ¥è¾“å‡ºåº”ç”¨ç¨‹åºéœ€è¦çš„æ¯ä¸ªæ¨¡å—ï¼Œç„¶åå°†æ‰€æœ‰è¿™äº›æ¨¡å—æ‰“åŒ…æˆä¸€ä¸ªæˆ–å¤šä¸ª bundleã€‚</p><p>webpackæœ‰å››ä¸ªæ ¸å¿ƒæ¦‚å¿µ:</p><ul><li>å…¥å£(entry)</li><li>è¾“å‡º(output)</li><li>loader</li><li>æ’ä»¶</li></ul><p>å…¥å£å†³å®šäº†webpackè¦ä»å“ªä¸ªæ–‡ä»¶å¼€å§‹æ„å»ºä¾èµ–å›¾ã€‚</p><p>çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">    entry: &#x27;./src/index.js&#x27;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>outputåˆ™å†³å®šäº†webpackä¼šåœ¨å“ªé‡Œè¾“å‡ºç”Ÿæˆçš„bundlesï¼Œä»¥åŠå¦‚ä½•å‘½åè¿™äº›bundlesã€‚è¾“å‡ºç›®å½•é»˜è®¤ä¸º <code>./dist/</code> ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const path = require(&#x27;path&#x27;);</span><br><span class="line"></span><br><span class="line">module.exports = &#123;</span><br><span class="line">    entry: &#x27;./src/index.js&#x27;,</span><br><span class="line">    output: &#123;</span><br><span class="line">        path: path.resolve(__dirname, &#x27;dist&#x27;),</span><br><span class="line">        filename: &#x27;bundle.js&#x27;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>loaderå¯ä»¥è®©webpackæ‰“åŒ…éjavascriptæ–‡ä»¶ï¼Œloaderå¯ä»¥å°†æ‰€æœ‰ç±»å‹çš„æ–‡ä»¶è½¬æ¢ä¸ºwebpackå¯ä»¥è¯†åˆ«çš„æœ‰æ•ˆæ¨¡å—ï¼Œç„¶ååˆ©ç”¨webpackçš„æ‰“åŒ…èƒ½åŠ›ï¼Œå¯¹ä»–ä»¬è¿›è¡Œå¤„ç†ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const path = require(&#x27;path&#x27;);</span><br><span class="line"></span><br><span class="line">module.exports = &#123;</span><br><span class="line">    entry: &#x27;./src/index.js&#x27;,</span><br><span class="line">    output: &#123;</span><br><span class="line">        path: path.resolve(__dirname, &#x27;dist&#x27;),</span><br><span class="line">        filename: &#x27;bundle.js&#x27;</span><br><span class="line">    &#125;,</span><br><span class="line">    module: &#123;</span><br><span class="line">        rules: &#123;</span><br><span class="line">            test: /\.css$/,</span><br><span class="line">            use: &#x27;css-loader&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>rulesä¸­çš„æ„æ€æ˜¯ï¼Œå½“require()&#x2F;impotä¸­è¢«è§£æä¸º.cssçš„è·¯å¾„æ—¶ï¼Œå…ˆä½¿ç”¨css-loaderè½¬æ¢ä¸€ä¸‹ã€‚</p><p>æˆ‘ä»¬å¯ä»¥å¼€å‘æ–°çš„loaderå»åŠ è½½ä¸åŒçš„æ–‡ä»¶ï¼Œæœ€ç»ˆéƒ½é€šè¿‡webpackæ¥æ‰“åŒ…åˆ°ä¸€èµ·ã€‚</p><p>loaderç”¨äºè½¬æ¢æŸäº›ç±»å‹çš„æ¨¡å—ï¼Œæ’ä»¶åˆ™å·¥ä½œçš„æ›´åŠ å¹¿æ³›ã€‚æ’ä»¶çš„èŒƒå›´åŒ…æ‹¬ï¼Œä»æ‰“åŒ…ä¼˜åŒ–å’Œå‹ç¼©ï¼Œä¸€ç›´åˆ°é‡æ–°å®šä¹‰ç¯å¢ƒä¸­çš„å˜é‡ã€‚æ’ä»¶æ¥å£åŠŸèƒ½æå…¶å¼ºå¤§ï¼Œå¯ä»¥ç”¨æ¥å¤„ç†å„ç§å„æ ·çš„ä»»åŠ¡ã€‚</p><p>æƒ³è¦ä½¿ç”¨ä¸€ä¸ªæ’ä»¶ï¼Œä½ åªéœ€è¦ require() å®ƒï¼Œç„¶åæŠŠå®ƒæ·»åŠ åˆ° plugins æ•°ç»„ä¸­ã€‚å¤šæ•°æ’ä»¶å¯ä»¥é€šè¿‡é€‰é¡¹(option)è‡ªå®šä¹‰ã€‚ä½ ä¹Ÿå¯ä»¥åœ¨ä¸€ä¸ªé…ç½®æ–‡ä»¶ä¸­å› ä¸ºä¸åŒç›®çš„è€Œå¤šæ¬¡ä½¿ç”¨åŒä¸€ä¸ªæ’ä»¶ï¼Œè¿™æ—¶éœ€è¦é€šè¿‡ä½¿ç”¨ new æ“ä½œç¬¦æ¥åˆ›å»ºå®ƒçš„ä¸€ä¸ªå®ä¾‹ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const path = require(&#x27;path&#x27;);</span><br><span class="line">const HtmlWebpackPlugin = require(&#x27;html-webpack-plugin&#x27;); // é€šè¿‡ npm å®‰è£…</span><br><span class="line">const webpack = require(&#x27;webpack&#x27;);</span><br><span class="line"></span><br><span class="line">module.exports = &#123;</span><br><span class="line">    entry: &#x27;./src/index.js&#x27;,</span><br><span class="line">    output: &#123;</span><br><span class="line">        path: path.resolve(__dirname, &#x27;dist&#x27;),</span><br><span class="line">        filename: &#x27;bundle.js&#x27;</span><br><span class="line">    &#125;,</span><br><span class="line">    module: &#123;</span><br><span class="line">        rules: &#123;</span><br><span class="line">            test: /\.css$/,</span><br><span class="line">            use: &#x27;css-loader&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">        new HtmlWebpackPlugin(&#123;template: &#x27;./src/index.html&#x27;&#125;)</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>é€šè¿‡webpackï¼Œæˆ‘ä»¬å¯ä»¥å°†æ•´ä¸ªé¡¹ç›®éƒ½æ‰“åŒ…ä¸ºä¸€ä¸ªæ–‡ä»¶è¿›è¡Œåˆ†å‘ï¼Œè€Œä¸”è¿˜å¯ä»¥è¿›è¡Œä¼˜åŒ–ã€‚webpackçš„å‡ºç°ï¼Œå°†å‰ç«¯çš„å¼€å‘å’Œå‘å¸ƒå½»åº•çš„åˆ†ç¦»å¼€ï¼Œå¼€å‘äººå‘˜å¯ä»¥ä»¥å„ç§æ–¹å¼è¿›è¡Œå¼€å‘ï¼Œé€šè¿‡webpackæ‰“åŒ…ä»¥åè¾“å‡ºéƒ¨ç½²éœ€è¦çš„æ–‡ä»¶ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Web </category>
          
          <category> webpack </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>wsl2çš„ä½¿ç”¨ä½“éªŒ</title>
      <link href="/2019/06/16/wsl2%E7%9A%84%E4%BD%BF%E7%94%A8%E4%BD%93%E9%AA%8C/"/>
      <url>/2019/06/16/wsl2%E7%9A%84%E4%BD%BF%E7%94%A8%E4%BD%93%E9%AA%8C/</url>
      
        <content type="html"><![CDATA[<p>wsl2å·²ç»æ˜¯è™šæ‹Ÿæœºå¹³å°äº†ã€‚</p><span id="more"></span><p>éœ€è¦Windowsç‰ˆæœ¬åœ¨18917åŠä»¥ä¸Šï¼Œå…ˆå¼€å¯è™šæ‹Ÿæœºå¹³å°æ‰èƒ½ç»§ç»­ï¼Œåœ¨ç®¡ç†å‘˜æƒé™çš„powershellä¸­æ‰§è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Enable-WindowsOptionalFeature -Online -FeatureName VirtualMachinePlatform</span><br></pre></td></tr></table></figure><p>å¯¹å·²å®‰è£…çš„wsl1è¿›è¡Œè½¬æ¢</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wsl --set-version &lt;Distro&gt; 2</span><br></pre></td></tr></table></figure><p>Distroå¯ä»¥é€šè¿‡ <code>wsl --list</code> æŸ¥çœ‹ã€‚</p><p>è½¬æ¢éœ€è¦ç‚¹æ—¶é—´ï¼Œå®Œæˆä»¥åå°±å¯ä»¥æµªèµ·æ¥äº†ã€‚</p><p>wsl2æ–°å¢äº†ä¸€äº›å‚æ•°ï¼š</p><ul><li><code>wsl --set-version &lt;Distro&gt; &lt;Version&gt;</code></li></ul><p>å¯ä»¥è®¾ç½®æŸä¸ªwslçš„ç‰ˆæœ¬ï¼Œ1æ˜¯æ—§ç‰ˆï¼Œ2æ˜¯æ–°ç‰ˆã€‚</p><ul><li><code>wsl --set-default-version &lt;Version&gt;</code></li></ul><p>è®¾ç½®é»˜è®¤çš„wslç‰ˆæœ¬ï¼Œæ¨èè®¾ç½®ä¸€ä¸‹ã€‚</p><ul><li><code>wsl --shutdown</code></li></ul><p>å‡ºäºæŸäº›ç›®çš„ï¼Œæ¯”å¦‚å·²ç»å®Œæˆäº†ä»»åŠ¡ï¼Œä¸å†éœ€è¦wslå·¥ä½œåœ¨åå°ï¼Œå¯ä»¥æ‰‹åŠ¨å…³é—­ã€‚</p><ul><li><code>wsl --list --quiet</code></li></ul><p>ä»…åˆ—å‡ºåˆ†å‘åç§°ï¼Œæ­¤å‘½ä»¤å¯¹äºè„šæœ¬ç¼–å†™å¾ˆæœ‰ç”¨ï¼Œå› ä¸ºå®ƒåªä¼šè¾“å‡ºæ‚¨å·²å®‰è£…çš„å‘è¡Œç‰ˆçš„åç§°ï¼Œè€Œä¸æ˜¾ç¤ºå…¶ä»–ä¿¡æ¯ï¼Œå¦‚é»˜è®¤å‘è¡Œç‰ˆï¼Œç‰ˆæœ¬ç­‰ã€‚</p><ul><li><code>wsl --list --verbose</code></li></ul><p>æ˜¾ç¤ºæœ‰å…³æ‰€æœ‰åˆ†å‘çš„è¯¦ç»†ä¿¡æ¯ã€‚æ­¤å‘½ä»¤åˆ—å‡ºæ¯ä¸ªå‘è¡Œç‰ˆçš„åç§°ï¼Œå‘è¡Œç‰ˆæ‰€å¤„çš„çŠ¶æ€ä»¥åŠæ­£åœ¨è¿è¡Œçš„ç‰ˆæœ¬ã€‚å®ƒè¿˜æ˜¾ç¤ºå“ªäº›åˆ†å‘æ˜¯é»˜è®¤çš„æ˜Ÿå·ã€‚</p><p>å½“ä¸€åˆ‡å‡†å¤‡å°±ç»ªï¼Œæˆ‘å°±å®‰è£…äº†dockerï¼Œæµ‹è¯•ä¸€æ³¢ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo apt install docker-ce</span><br></pre></td></tr></table></figure><p>æ·»åŠ ç”¨æˆ·åˆ°dockerç»„ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo usermod -aG docker $USER</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo service docker --full-restart</span><br></pre></td></tr></table></figure><p>å·²ç»å¯ä»¥è·‘dockeräº†ï¼Œæˆ‘ä»¬æ¥åšä¸ªæµ‹è¯•ï¼Œè¯·å‡ºä¸‡èƒ½çš„hello worldï¼</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker pull hello-world</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker run --rm hello-world</span><br></pre></td></tr></table></figure><p>ç„¶åå°±çœ‹åˆ°äº†æƒ³è¦çš„ç»“æœï¼Œhello worldæˆåŠŸçš„è·‘èµ·æ¥äº†ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Hello from Docker!</span><br><span class="line">This message shows that your installation appears to be working correctly.</span><br><span class="line"></span><br><span class="line">To generate this message, Docker took the following steps:</span><br><span class="line"> 1. The Docker client contacted the Docker daemon.</span><br><span class="line"> 2. The Docker daemon pulled the &quot;hello-world&quot; image from the Docker Hub.</span><br><span class="line">    (amd64)</span><br><span class="line"> 3. The Docker daemon created a new container from that image which runs the</span><br><span class="line">    executable that produces the output you are currently reading.</span><br><span class="line"> 4. The Docker daemon streamed that output to the Docker client, which sent it</span><br><span class="line">    to your terminal.</span><br><span class="line"></span><br><span class="line">To try something more ambitious, you can run an Ubuntu container with:</span><br><span class="line"> $ docker run -it ubuntu bash</span><br><span class="line"></span><br><span class="line">Share images, automate workflows, and more with a free Docker ID:</span><br><span class="line"> https://hub.docker.com/</span><br><span class="line"></span><br><span class="line">For more examples and ideas, visit:</span><br><span class="line"> https://docs.docker.com/get-started/</span><br></pre></td></tr></table></figure><p>æ€»çš„æ¥è¯´ï¼Œå› ä¸ºwsl2æ”¹æˆè™šæ‹Ÿæœºæ–¹æ¡ˆäº†ï¼Œä¸è¿‡wsl2çš„å¯åŠ¨é€Ÿåº¦è¿˜æ˜¯æŒºå¿«çš„ï¼Œå¾®è½¯ä¹ŸåŠªåŠ›è®©wsl2å’Œwsl1ä¹‹é—´åœ¨ä½¿ç”¨ä¸Šæ²¡æœ‰å·®å¼‚ã€‚ç›®å‰å¾®è½¯è¿˜æ²¡æœ‰å®Œæˆwsl2çš„ç½‘ç»œéƒ¨åˆ†ï¼Œwsl2å’Œå®¿ä¸»æœºä¹‹é—´è¿˜éœ€è¦ä½¿ç”¨ä¸“é—¨çš„ipè¿›è¡Œè®¿é—®ï¼Œç­‰å¾®è½¯å®Œæˆwsl2çš„localhostç½‘ç»œä»¥åï¼Œå°±å¯ä»¥åƒä»¥å‰ä¸€æ ·ç›´æ¥è·‘ä¸€äº›ç½‘ç«™æˆ–è€…éœ€è¦ç«¯å£çš„æœåŠ¡äº†ã€‚</p><img src="/2019/06/16/wsl2%E7%9A%84%E4%BD%BF%E7%94%A8%E4%BD%93%E9%AA%8C/Snipaste_2019-06-16_21-52-42.png" class="" title="ç½‘ç»œæˆªå›¾"><p>æ¥ä¸€å¼ åˆç…§</p><img src="/2019/06/16/wsl2%E7%9A%84%E4%BD%BF%E7%94%A8%E4%BD%93%E9%AA%8C/Snipaste_2019-06-16_21-49-15.png" class="" title="åˆç…§"><p><a href="https://devblogs.microsoft.com/commandline/wsl-2-is-now-available-in-windows-insiders/">ç‚¹æˆ‘æŸ¥çœ‹wsl2çš„å‘å¸ƒè¯´æ˜</a></p><p><a href="https://docs.microsoft.com/en-us/windows/wsl/wsl2-install">ç‚¹æˆ‘æŸ¥çœ‹å¦‚ä½•å®‰è£…wsl2</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> Windows </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…¥å‘typescriptäº†</title>
      <link href="/2019/06/15/%E5%85%A5%E5%9D%91typescript%E4%BA%86/"/>
      <url>/2019/06/15/%E5%85%A5%E5%9D%91typescript%E4%BA%86/</url>
      
        <content type="html"><![CDATA[<p>ä»Šå¤©ç®—æ˜¯æ­£å¼å…¥å‘ typescript äº†ï¼ŒåŸºäº vue å†™äº†ç¬¬ä¸€ä¸ªå‡½æ•°ï¼Œç”¨æ¥åšä¸€ä¸ªæ–‡å­—æ•ˆæœã€‚</p><p>æ¼”ç¤ºæ•ˆæœï¼š</p><img src="/2019/06/15/%E5%85%A5%E5%9D%91typescript%E4%BA%86/%E6%B7%B1%E5%BA%A6%E5%BD%95%E5%B1%8F_%E9%80%89%E6%8B%A9%E5%8C%BA%E5%9F%9F_20190615202044.gif" class=""><span id="more"></span><p>æ•´ä½“æ€è·¯å¬ç®€å•çš„ï¼Œå°±æ˜¯ç”¨å®šæ—¶å™¨å’Œå»¶æ—¶å™¨æ¥åšï¼Œé€šè¿‡å®šæ—¶å™¨æ¥é—´éš”çš„å¤„ç†æ–‡æœ¬ï¼Œå»¶æ—¶å™¨æ¥å»¶åæ‰€æœ‰çš„æ–¹æ³•ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">class TextHandle &#123;</span><br><span class="line">    private allDuration: number = 0;</span><br><span class="line">    public appendText(text: string) : void &#123;</span><br><span class="line">        setTimeout(() = &gt;&#123;</span><br><span class="line">            const LeftMessage = document.getElementById(&#x27;LeftMessage&#x27;);</span><br><span class="line">            if (LeftMessage === null) &#123;</span><br><span class="line">                return;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            let index: number = 0;</span><br><span class="line">            const MessageText: string = LeftMessage.innerText;</span><br><span class="line"></span><br><span class="line">            // tslint:disable-next-line:only-arrow-functions</span><br><span class="line">            const interval = setInterval(function() &#123;</span><br><span class="line">                if ((LeftMessage === null) || (index++ === text.length + 1)) &#123;</span><br><span class="line">                    return clearInterval(interval);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                LeftMessage.innerText = MessageText + text.substring(0, index);</span><br><span class="line">            &#125;,</span><br><span class="line">            300);</span><br><span class="line">        &#125;,</span><br><span class="line">        this.AllDuration);</span><br><span class="line">        this.AllDuration += text.length * 300 + 100;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>typescriptç¡®å®æŒºä¸é”™çš„ï¼Œå¹³æ—¶éƒ½åœ¨å†™é™æ€è¯­è¨€ï¼Œå¦‚C++ï¼Œæ‰€ä»¥å½“æˆ‘å¼€å§‹å­¦åŠ¨æ€è¯­è¨€çš„æ—¶å€™ï¼Œå°±ä¼šè§‰å¾—æ°´åœŸä¸æœï¼Œç°åœ¨<br>é€šè¿‡typescriptå°±å¯ä»¥è®©æˆ‘ç»§ç»­ä½¿ç”¨é™æ€è¯­è¨€çš„å¼€å‘æ–¹å¼æ¥å†™webï¼Œè€Œä¸”ä»£ç æ›´å®¹æ˜“ç†è§£ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> typescript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CMake CTests for dde-control-center</title>
      <link href="/2019/05/23/CMake-CTests-for-dde-control-center/"/>
      <url>/2019/05/23/CMake-CTests-for-dde-control-center/</url>
      
        <content type="html"><![CDATA[<p>ä»€ä¹ˆæ˜¯å•å…ƒæµ‹è¯•?</p><blockquote><p>åœ¨è®¡ç®—æœºç¼–ç¨‹ä¸­ï¼Œå•å…ƒæµ‹è¯•åˆç§°ä¸ºæ¨¡å—æµ‹è¯•ï¼Œæ˜¯é’ˆå¯¹ç¨‹åºæ¨¡å—ï¼ˆè½¯ä»¶è®¾è®¡çš„æœ€å°å•ä½ï¼‰æ¥è¿›è¡Œæ­£ç¡®æ€§æ£€éªŒçš„æµ‹è¯•å·¥ä½œã€‚</p></blockquote><p>å•å…ƒæµ‹è¯•å­˜åœ¨çš„æ„ä¹‰åœ¨äºï¼Œå¦‚æœç¨‹åºå‘ç”Ÿäº†å¼‚å¸¸æƒ…å†µï¼Œæ¯”å¦‚æ¥æ”¶äº†é”™è¯¯çš„å€¼ï¼Œä»è€Œå¯¼è‡´ç»“æœä¸æ­£ç¡®ï¼Œå½“ä¿®æ­£ç¨‹åºä¸­çš„é”™è¯¯åï¼Œä¸ºäº†é¿å…å†æ¬¡é‡åˆ°è¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦å¯¹å‡ºé—®é¢˜çš„å€¼å’Œå‡½æ•°&#x2F;åŠŸèƒ½è¿›è¡Œä¸€æ¬¡æµ‹è¯•ï¼Œç¡®ä¿ç»“æœç¬¦åˆé¢„æœŸã€‚</p><p>å•å…ƒæµ‹è¯•å¾ˆé‡è¦ï¼Œå¦‚æœæ˜¯æ–°é¡¹ç›®ï¼Œè¯·ä¸€å®šè¦åˆšå¼€å§‹å°±è§„åˆ’å¥½å•å…ƒæµ‹è¯•ã€‚</p><p>ä¸ºä»€ä¹ˆè¯´å•å…ƒæµ‹è¯•å¾ˆé‡è¦å‘¢ï¼Ÿå› ä¸ºå•å…ƒæµ‹è¯•çš„ç›®çš„æ˜¯éš”ç¦»å…¶ä»–å•å…ƒï¼Œå¹¶è¯æ˜å½“å‰å•å…ƒæ˜¯æ­£ç¡®çš„ã€‚è¿™éœ€è¦å¼€å‘è€…åœ¨è®¾è®¡ç¨‹åºçš„æ—¶å€™å°±è¦è€ƒè™‘å¾ˆå¤šï¼Œåˆç†çš„è®¾è®¡å’Œè§„åˆ’é¡¹ç›®ã€‚å½“æœªæ¥é‡æ„é¡¹ç›®çš„æ—¶å€™ï¼Œå¯ä»¥å±€éƒ¨é‡æ„æ¥ä¼˜åŒ–é¡¹ç›®ï¼Œè€Œä¸æ˜¯ä»é›¶é‡å†™ã€‚</p><p>æœ¬æ–‡æ²¡æœ‰è¯¦ç»†è¯´æ˜Qtçš„å•å…ƒæµ‹è¯•æ˜¯å¦‚ä½•ç¼–å†™çš„ï¼Œç¼–å†™Qtçš„å•å…ƒæµ‹è¯•æ”¾åœ¨ä»¥åå†å†™(<del>å’•å’•å’•</del>)ã€‚</p><span id="more"></span><p>å†™è¿™ç¯‡æ–‡ç« æ˜¯å› ä¸ºæœ€è¿‘åœ¨ç»™æ§åˆ¶ä¸­å¿ƒå†™å•å…ƒæµ‹è¯•ï¼Œæ§åˆ¶ä¸­å¿ƒçš„æ¨¡å—éƒ½æ˜¯MVCçš„ï¼Œæœ¬èº«å°±åšå¥½äº†å¤§æ–¹å‘çš„éš”ç¦»ï¼Œæ¯ä¸ªå‡½æ•°ä¹ŸåŸºæœ¬æ˜¯æ‹†åˆ†å‡ºæ¥çš„æœ€å°åŠŸèƒ½ï¼Œå¯ä»¥å•ç‹¬æ‹¿å‡ºæ¥æµ‹è¯•ã€‚æ§åˆ¶ä¸­å¿ƒç›®å‰å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼ŒWorkerç±»æ˜¯ä»DBusä¸Šæ¥æ”¶æ•°æ®ï¼Œå¤„ç†å®Œæˆåæ”¾å…¥Modelä¸­ï¼Œå¦‚æœæµ‹è¯•Workerç±»ï¼Œéœ€è¦åšå¾ˆå¤šå’ŒDBusç›¸å…³çš„å¤„ç†ï¼Œæ¯”è¾ƒéº»çƒ¦ï¼Œæ‰€ä»¥æœ€å¼€å§‹æˆ‘å…ˆæŠŠé‡å¿ƒæ”¾åœ¨äº†åˆ›å»ºTestså’Œæµ‹è¯•ä¸€ä¸ªåŸºæœ¬çš„è½¬æ¢å‡½æ•°çš„åŠŸèƒ½ï¼ŒéªŒè¯å•å…ƒæµ‹è¯•çš„æµç¨‹ã€‚</p><blockquote><p><a href="https://github.com/linuxdeepin/dde-control-center/pull/171">æ§åˆ¶ä¸­å¿ƒå•å…ƒæµ‹è¯•PR</a></p></blockquote><p>æ§åˆ¶ä¸­å¿ƒé¡¹ç›®ä½¿ç”¨çš„CMakeä½œä¸ºé¡¹ç›®æ„å»ºå·¥å…·ï¼Œæ‰€ä»¥ç”¨åˆ°äº†CTestsï¼Œæ§åˆ¶ä¸­å¿ƒä½¿ç”¨çš„Qtè¿›è¡Œçš„å¼€å‘ï¼ŒQtä¹Ÿæä¾›äº†è‡ªå·±çš„å•å…ƒæµ‹è¯•ï¼Œæˆ‘ä¸¤ä¸ªéƒ½åšäº†æ”¯æŒã€‚</p><p>åœ¨é¡¶å±‚çš„CMakeLists.txtä¸­æ·»åŠ CTestsçš„æ”¯æŒï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># å¯ç”¨CTestæ£€æŸ¥</span><br><span class="line">include(Dart)</span><br><span class="line"></span><br><span class="line"># å¯ç”¨CTest</span><br><span class="line">include(CTest)</span><br></pre></td></tr></table></figure><p>è¿™ä¸¤è¡Œå†…å®¹éœ€è¦åœ¨é¡¶å±‚CMakeLists.txtä¸­æ·»åŠ ï¼Œä¸ç„¶ä¸ä¼šç”Ÿæ•ˆã€‚</p><p>åœ¨å­é¡¹ç›®ä¸­åˆ›å»ºä¸€ä¸ªdcc_test.hï¼Œç”¨æ¥å†™å•å…ƒæµ‹è¯•çš„ç±»ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#ifndef DCC_TEST_H</span><br><span class="line">#define DCC_TEST_H</span><br><span class="line"></span><br><span class="line">#include &lt;QMap&gt;</span><br><span class="line">#include &lt;QString&gt;</span><br><span class="line">#include &lt;QTest&gt;</span><br><span class="line"></span><br><span class="line">#include &quot;modules/display/displaywidget.h&quot;</span><br><span class="line"></span><br><span class="line">namespace Tests &#123;</span><br><span class="line"></span><br><span class="line">class Tests : public QObject &#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"></span><br><span class="line">private Q_SLOTS:</span><br><span class="line">    void testSliderValue_data()</span><br><span class="line">    &#123;</span><br><span class="line">        QTest::addColumn&lt;float&gt;(&quot;value&quot;);</span><br><span class="line">        QTest::addColumn&lt;int&gt;(&quot;result&quot;);</span><br><span class="line"></span><br><span class="line">        QMap&lt;float, int&gt; testMap&#123; &#123; 1.0, 1 &#125;,  &#123; 1.25, 2 &#125;, &#123; 1.5, 3 &#125;,</span><br><span class="line">                                  &#123; 1.75, 4 &#125;, &#123; 2.0, 5 &#125;,  &#123; 2.25, 6 &#125;,</span><br><span class="line">                                  &#123; 2.5, 7 &#125;,  &#123; 2.75, 8 &#125;, &#123; 3.0, 9 &#125; &#125;;</span><br><span class="line"></span><br><span class="line">        for (auto it = testMap.constBegin(); it != testMap.constEnd(); ++it) &#123;</span><br><span class="line">            QTest::newRow(&quot;converToSlider&quot;) &lt;&lt; it.key() &lt;&lt; it.value();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    void testSliderValue()</span><br><span class="line">    &#123;</span><br><span class="line">        QFETCH(float, value);</span><br><span class="line">        QFETCH(int, result);</span><br><span class="line"></span><br><span class="line">        using namespace dcc::display;</span><br><span class="line"></span><br><span class="line">        QCOMPARE(DisplayWidget::convertToSlider(value), result);</span><br><span class="line">        QCOMPARE(DisplayWidget::convertToScale(result), value);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">&#125;  // namespace Tests</span><br><span class="line"></span><br><span class="line">QTEST_MAIN(Tests::Tests)</span><br><span class="line">#endif  // !DCC_TEST_H</span><br></pre></td></tr></table></figure><p>åœ¨å­é¡¹ç›®çš„CMakeLists.txtä¸­æ·»åŠ ä¸€ä¸ªäºŒè¿›åˆ¶ï¼Œç”¨æ¥å½“ä½œå•å…ƒæµ‹è¯•ç¨‹åºã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># è¿™ä¸ªå®æ˜¯Dartæä¾›çš„ï¼Œç”¨æ¥åˆ¤æ–­æ˜¯å¦å¼€å¯CTest</span><br><span class="line">if(BUILD_TESTING)</span><br><span class="line">find_package(Qt5 COMPONENTS</span><br><span class="line">    Test</span><br><span class="line">REQUIRED)</span><br><span class="line"></span><br><span class="line">set(Qt_LIBS</span><br><span class="line">    $&#123;Qt_LIBS&#125;</span><br><span class="line">    Qt5::Test</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">set(TEST_SRCS</span><br><span class="line">tests/dcc_test.h</span><br><span class="line">$&#123;DISPLAY_FILES&#125;</span><br><span class="line">$&#123;WIDGETS_FILES&#125;</span><br><span class="line">$&#123;MODULE_FILES&#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"># æ·»åŠ ä¸€ä¸ªå«unit-testçš„äºŒè¿›åˆ¶</span><br><span class="line">add_executable(unit-test</span><br><span class="line">$&#123;TEST_SRCS&#125;</span><br><span class="line">$&#123;PROJECT_BINARY_DIR&#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">target_include_directories(unit-test PUBLIC</span><br><span class="line">$&#123;TEST_SRCS&#125;</span><br><span class="line">$&#123;PROJECT_BINARY_DIR&#125;</span><br><span class="line">$&#123;DFrameworkDBus_INCLUDE_DIRS&#125;</span><br><span class="line">$&#123;QGSettings_INCLUDE_DIRS&#125;</span><br><span class="line">$&#123;Qt5Gui_PRIVATE_INCLUDE_DIRS&#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">target_link_libraries(unit-test PRIVATE</span><br><span class="line">$&#123;Qt_LIBS&#125;</span><br><span class="line">$&#123;DFrameworkDBus_LIBRARIES&#125;</span><br><span class="line">$&#123;QGSettings_LIBRARIES&#125;</span><br><span class="line">$&#123;DtkWidget_LIBRARIES&#125;</span><br><span class="line">$&#123;XCB_EWMH_LIBRARIES&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>åˆ°è¿™é‡Œï¼Œç›´æ¥ç¼–è¯‘å¯åŠ¨unit-testå°±å¯ä»¥ä½¿ç”¨Qtçš„å•å…ƒæµ‹è¯•äº†ï¼Œä½†æ˜¯åŠ ä¸ŠCTestçš„æ”¯æŒåªéœ€è¦ä¸€è¡Œï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">add_test(ctest unit-test)</span><br><span class="line">endif()</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ctest -j6 -C Debug -T test â€“output-on-failureè·‘CTestï¼Œå¾—åˆ°æ‰§è¡Œç»“æœï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[ctest]    Site: xiaomi-air</span><br><span class="line">[ctest]    Build name: Linux-c++</span><br><span class="line">[ctest] Test project /home/justforlxz/Projects/Deepin/dde-control-center/build</span><br><span class="line">[ctest]     Start 1: ctest</span><br><span class="line">[ctest] 1/1 Test #1: ctest ............................   Passed    0.05 sec</span><br><span class="line">[ctest]</span><br><span class="line">[ctest] 100% tests passed, 0 tests failed out of 1</span><br><span class="line">[ctest]</span><br><span class="line">[ctest] Total Test time (real) =   0.06 sec</span><br><span class="line">[ctest] CTest finished with return code 0</span><br></pre></td></tr></table></figure><p>å¦‚æœæ˜¯è·‘unit-testäºŒè¿›åˆ¶ï¼Œåˆ™ä¼šå¾—åˆ°Qtæ‰“å°çš„ç›¸å…³ä¿¡æ¯ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">********* Start testing of Tests::Tests *********</span><br><span class="line">Config: Using QtTest library 5.12.3, Qt 5.12.3 (x86_64-little_endian-lp64 shared (dynamic) release build; by GCC 8.3.0)</span><br><span class="line">PASS   : Tests::Tests::initTestCase()</span><br><span class="line">PASS   : Tests::Tests::testSliderValue(converToSlider)</span><br><span class="line">PASS   : Tests::Tests::testSliderValue(converToSlider)</span><br><span class="line">PASS   : Tests::Tests::testSliderValue(converToSlider)</span><br><span class="line">PASS   : Tests::Tests::testSliderValue(converToSlider)</span><br><span class="line">PASS   : Tests::Tests::testSliderValue(converToSlider)</span><br><span class="line">PASS   : Tests::Tests::testSliderValue(converToSlider)</span><br><span class="line">PASS   : Tests::Tests::testSliderValue(converToSlider)</span><br><span class="line">PASS   : Tests::Tests::testSliderValue(converToSlider)</span><br><span class="line">PASS   : Tests::Tests::testSliderValue(converToSlider)</span><br><span class="line">PASS   : Tests::Tests::cleanupTestCase()</span><br><span class="line">Totals: 11 passed, 0 failed, 0 skipped, 0 blacklisted, 0ms</span><br><span class="line">********* Finished testing of Tests::Tests *********</span><br></pre></td></tr></table></figure><p>å¯¹æ¯”CTestå’ŒQtçš„å•å…ƒæµ‹è¯•ï¼ŒQtä¼šå‘Šè¯‰ä½ è¯¦ç»†çš„å‡½æ•°è°ƒç”¨å’Œæ‰§è¡Œè¿‡ç¨‹ï¼ŒCTestæ›´æ³¨é‡ç»“æœï¼Œä¸è¿‡åœ¨Qtcreatorçš„å•å…ƒæµ‹è¯•é¢æ¿ä¸­ï¼Œä¼šçœ‹åˆ°æ›´å¥½çš„è¾“å‡ºã€‚</p><p>è¯´åˆ°åº•ï¼ŒCTestæ”¯æŒå¯åŠ¨äº†ä¸€ä¸ªå¸¦æœ‰å•å…ƒæµ‹è¯•çš„ç¨‹åºï¼Œè€Œç¨‹åºè‡ªå·±ä½¿ç”¨äº†Qtæä¾›çš„å•å…ƒæµ‹è¯•ç±»è¿›è¡Œæµ‹è¯•ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CMake Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¦‚ä½•åœ¨Deepinä¸Šä½¿ç”¨LNMP</title>
      <link href="/2019/02/21/how-to-use-LNMP-on-deepin/"/>
      <url>/2019/02/21/how-to-use-LNMP-on-deepin/</url>
      
        <content type="html"><![CDATA[<p>ä¸ºäº†èŠ‚çœè¯»è€…çš„æ—¶é—´ï¼Œæˆ‘å…ˆç®€è¿°ä¸€ä¸‹é˜…è¯»è¿™ç¯‡æ–‡ç« éœ€è¦äº†è§£çš„çŸ¥è¯†ã€‚</p><p>è¿™ç¯‡æ–‡ç« å°†åŸºäºDockeræ¥æ„å»ºnginxã€phpå’Œmysqlæ¥æ­å»ºLNMPç¯å¢ƒï¼Œå’Œå…¶ä»–æ•™ç¨‹æœ‰æ‰€ä¸åŒçš„æ˜¯ï¼Œéœ€è¦æœ‰ä¸€å®šçš„DockeråŸºç¡€ã€‚</p><span id="more"></span><p>Dockeræ˜¯ä¸€ä¸ªä¸é”™çš„å·¥å…·ï¼Œä½¿æˆ‘ä»¬ä¸éœ€è¦è™šæ‹Ÿæœºé‚£æ ·çš„åºç„¶å¤§ç‰©å°±å¯ä»¥è½»æ¾çš„éš”ç¦»è¿è¡Œçš„ç¨‹åºï¼Œè¿™è¦æ„Ÿè°¢Linuxçš„èµ„æºåˆ†ç¦»æœºåˆ¶ï¼Œé¿å…å¯åŠ¨ä¸€ä¸ªè™šæ‹Ÿæœºé€ æˆäº†å¤§é‡èµ„æºæµªè´¹ã€‚</p><p>é¦–å…ˆéœ€è¦åœ¨Deepinä¸Šå®‰è£…Dockerï¼Œæ·»åŠ Dockerçš„debä»“åº“ï¼Œå¹¶å®‰è£…docker-ceã€‚</p><p>åˆ›å»ºæ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo nano /etc/apt/sources.list.d/docker.list</span><br></pre></td></tr></table></figure><p>å†™å…¥</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">deb [arch=amd64] https://download.docker.com/linux/debian jessie edge</span><br></pre></td></tr></table></figure><p>åˆ·æ–°ä¸€ä¸‹ä»“åº“å°±å¯ä»¥å®‰è£…äº†ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo apt update &amp;&amp; sudo apt install docker-ce docker-compose</span><br></pre></td></tr></table></figure><p>å®‰è£…å®Œæˆåé‡å¯ä¸€ä¸‹ç³»ç»Ÿï¼Œå‡†å¤‡å·¥ä½œå°±ç®—å®Œæˆäº†ä¸€åŠäº†ã€‚</p><p>åœ¨å®¶ç›®å½•åˆ›å»ºä¸€ä¸ªProjectsç›®å½•ï¼Œå½“åšæˆ‘ä»¬LNMPçš„å·¥ä½œç›®å½•ï¼Œåˆ›å»ºä¸€ä¸ªåå«<em>docker-compose.yaml</em>çš„æ–‡ä»¶ï¼Œè¿™æ˜¯docker-composeçš„é…ç½®æ–‡ä»¶ï¼Œæˆ‘ä»¬é€šè¿‡docker-composeè¿™ä¸ªå·¥å…·æ¥ç®¡ç†æˆ‘ä»¬çš„Dockerå®¹å™¨ã€‚</p><p>æ‰€æœ‰çš„é•œåƒå‡é‡‡ç”¨æœ€æ–°ç‰ˆæœ¬ï¼Œnginx(1.15.8)ï¼Œphp(7.3.2)ï¼Œmysql(8.0.15)ï¼Œå¦‚æœ‰éœ€è¦ï¼Œè‡ªè¡Œé€‰æ‹©ä¸åŒç‰ˆæœ¬çš„é•œåƒã€‚</p><p>æ³¨æ„PHP7å·²ç»ä¸æ”¯æŒmysqlæ‰©å±•ï¼Œä½¿ç”¨å†…ç½®çš„MySQLndã€‚</p><p>å†™å…¥ä»¥ä¸‹é…ç½®æ–‡ä»¶ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">version: &#x27;3&#x27;</span><br><span class="line"></span><br><span class="line">services:</span><br><span class="line">  nginx:</span><br><span class="line">    # è®¾ç½®å®¹å™¨åå­—</span><br><span class="line">    container_name: &quot;nginx&quot;</span><br><span class="line">    # é‡‡ç”¨æœ€æ–°çš„nginx</span><br><span class="line">    image: nginx:latest</span><br><span class="line">    # ç»‘å®š80ç«¯å£</span><br><span class="line">    ports:</span><br><span class="line">        - &quot;80:80&quot;</span><br><span class="line">    # æ·»åŠ phpå®¹å™¨çš„ä¾èµ–</span><br><span class="line">    depends_on:</span><br><span class="line">        - &quot;php&quot;</span><br><span class="line">    # ç»‘å®šæ•°æ®ç›®å½•</span><br><span class="line">    volumes:</span><br><span class="line">        - &quot;./volumes/nginx/conf.d:/etc/nginx/conf.d&quot;</span><br><span class="line">        - &quot;./volumes/html:/usr/share/nginx/html&quot;</span><br><span class="line">    restart: always</span><br><span class="line"></span><br><span class="line">  php:</span><br><span class="line">    # è®¾ç½®å®¹å™¨åå­—</span><br><span class="line">    container_name: &quot;php&quot;</span><br><span class="line">    # é‡‡ç”¨æœ€æ–°çš„php</span><br><span class="line">    image: php:fpm</span><br><span class="line">    # ç»‘å®šç«¯å£</span><br><span class="line">    ports:</span><br><span class="line">        - &quot;9000:9000&quot;</span><br><span class="line">    # ç»‘å®šæ•°æ®ç›®å½•</span><br><span class="line">    volumes:</span><br><span class="line">        - &quot;./volumes/html:/var/www/html&quot;</span><br><span class="line">    restart: always</span><br><span class="line"></span><br><span class="line">  mysql:</span><br><span class="line">    # è®¾ç½®å®¹å™¨åå­—</span><br><span class="line">    container_name: &quot;mysql&quot;</span><br><span class="line">    # é‡‡ç”¨æœ€æ–°çš„mysql</span><br><span class="line">    image: mysql:latest</span><br><span class="line">    # ç»‘å®šç«¯å£</span><br><span class="line">    ports:</span><br><span class="line">        - &quot;3306:3306&quot;</span><br><span class="line">    # è®¾ç½®ç¯å¢ƒå˜é‡</span><br><span class="line">    environment:</span><br><span class="line">        - MYSQL_ROOT_PASSWORD=(è‡ªå·±è®¾ç½®å¯†ç )</span><br><span class="line">    # ç»‘å®šæ•°æ®ç›®å½•</span><br><span class="line">    volumes:</span><br><span class="line">        - &quot;./volumes/mysql:/var/lib/mysql&quot;</span><br><span class="line">    restart: always</span><br></pre></td></tr></table></figure><p>åˆ›å»ºnginxçš„é…ç½®æ–‡ä»¶ï¼Œç¼–è¾‘ <em>.&#x2F;volumes&#x2F;nginx&#x2F;conf.d&#x2F;nginx.conf</em> ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen       80;</span><br><span class="line">    server_name  localhost;</span><br><span class="line">    location / &#123;</span><br><span class="line">        root   /usr/share/nginx/html;</span><br><span class="line">        index  index.html index.htm index.php;</span><br><span class="line">    &#125;</span><br><span class="line">    error_page   500 502 503 504  /50x.html;</span><br><span class="line">    location = /50x.html &#123;</span><br><span class="line">        root   /usr/share/nginx/html;</span><br><span class="line">    &#125;</span><br><span class="line">    location ~ \.php$ &#123;</span><br><span class="line">        fastcgi_pass   php:9000;</span><br><span class="line">        fastcgi_index  index.php;</span><br><span class="line">        fastcgi_param  SCRIPT_FILENAME /var/www/html/$fastcgi_script_name;</span><br><span class="line">        include        fastcgi_params;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ›å»ºphpæµ‹è¯•æ–‡ä»¶ï¼Œç¼–è¾‘ <em>.&#x2F;volumes&#x2F;html&#x2F;index.php</em> :</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">phpinfo();</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>å¯åŠ¨dockerï¼Œç¬¬ä¸€æ¬¡éœ€è¦æ‹‰å–ä¸€ä¸‹é•œåƒ:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker-compose up --build -d</span><br></pre></td></tr></table></figure><p>ç­‰å…¨éƒ¨ç»“æŸä»¥åï¼Œå°±å¯ä»¥è®¿é—®localhostçœ‹åˆ°phpçš„ä¿¡æ¯äº†ã€‚</p><p>é€šè¿‡Dockerçš„æ–¹æ³•æ¥ä½¿ç”¨LNMPï¼Œä¸æ±¡æŸ“å®¿ä¸»æœºç¯å¢ƒï¼Œä¸ä¼šå†å› ä¸ºå„ç§ä¾èµ–é—®é¢˜è€Œæåç³»ç»Ÿï¼Œè¿™æ°æ°æ˜¯æ–°æ‰‹å®¹æ˜“çŠ¯çš„é”™è¯¯ï¼Œä½¿ç”¨Dockerï¼Œæ–¹ä¾¿ä½ æˆ‘ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Solution </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web </tag>
            
            <tag> Linux </tag>
            
            <tag> LNMP </tag>
            
            <tag> Deepin </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è§£å†³ç”¨äº†xposedåæ·˜å®é—ªé€€</title>
      <link href="/2019/01/23/fuck-taobao/"/>
      <url>/2019/01/23/fuck-taobao/</url>
      
        <content type="html"><![CDATA[<p>åæ­£éƒ½ç”¨xposedäº†ï¼Œè‚¯å®šä¹Ÿæœ‰rootæƒé™ã€‚<br>åˆ é™¤&#x2F;data&#x2F;data&#x2F;com.taobao.taobao&#x2F;files&#x2F;bundleBaseline&#x2F;é‡Œçš„æ–‡ä»¶ï¼Œç„¶åè®¾ç½®è¯¥ç›®å½•ä¸º500ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨swapfileæ¥ä¼‘çœ </title>
      <link href="/2018/12/12/hibernate-for-swapfile/"/>
      <url>/2018/12/12/hibernate-for-swapfile/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘deepinè¦æ·»åŠ ä¼‘çœ åŠŸèƒ½ï¼Œä½†æ˜¯ä¹‹å‰æµ‹è¯•çš„é€šè¿‡swapfileæ¥ä¼‘çœ å¤±è´¥äº†ï¼Œæ‰€ä»¥å¯¹æ­£åœ¨ä½¿ç”¨swapåˆ†åŒºçš„ç”¨æˆ·æä¾›ä¼‘çœ åŠŸèƒ½ã€‚ä½†æ˜¯æ˜¨å¤©æˆ‘åœ¨askubuntuä¸Šçœ‹åˆ°æœ‰äººå‘äº†åœ¨ubuntuä¸‹é€šè¿‡swapfileä¼‘çœ çš„æ–¹æ¡ˆï¼Œä»Šå¤©è¯•äº†ä¸€ä¸‹ï¼Œæ•ˆæœè‰¯å¥½ï¼Œè§‰å¾—å¯ä»¥è€ƒè™‘ç»™deepinä¹ŸåŠ ä¸Šè¿™æ ·çš„åŠŸèƒ½ã€‚</p><span id="more"></span><p>åŸæ–‡é“¾æ¥: <a href="https://askubuntu.com/questions/6769/hibernate-and-resume-from-a-swap-file">Hibernate and resume from a swap file</a></p><p>å…·ä½“æ­¥éª¤æ˜¯é€šè¿‡uswsuspè¿™ä¸ªåŒ…æ¥åšçš„ï¼Œuswsuspæ˜¯ä¸€ç»„ç”¨æˆ·ç©ºé—´å·¥å…·ï¼Œç”¨äºLinuxç³»ç»Ÿä¸Šçš„ä¼‘çœ (æŒ‚èµ·åˆ°ç£ç›˜)å’ŒæŒ‚èµ·(æŒ‚èµ·åˆ°RAMæˆ–å¾…æœº)ã€‚è¯¦ç»†å†…å®¹å¯ä»¥åœ¨ArchWikiä¸Šå‚è€ƒã€‚<a href="https://wiki.archlinux.org/index.php/Uswsusp">ç‚¹è¿™é‡Œ</a></p><p>å…ˆåˆ›å»ºä¸€ä¸ªå’Œå†…å­˜åŒç­‰å¤§å°çš„swapfileï¼Œä¸ºäº†ç¡®ä¿ä¼‘çœ æˆåŠŸï¼Œä¸èƒ½å°äºå†…å­˜çš„å®¹é‡ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo fallocate -l 16g /swapfile # æˆ‘çš„æœºå­æ˜¯16Gï¼Œå…·ä½“è‡ªå·±ä¿®æ”¹</span><br><span class="line">sudo chmod 600 /swapfile</span><br><span class="line">sudo mkswap /swapfile</span><br><span class="line">sudo swapon /swapfile</span><br><span class="line">echo &#x27;/swapfile swap swap defaults 0 0&#x27; | sudo tee -a /etc/fstab</span><br></pre></td></tr></table></figure><p>å®‰è£…ç”¨æˆ·ç©ºé—´è½¯ä¼‘çœ (Userspace Software Suspend)åŒ…</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo apt install uswsusp</span><br></pre></td></tr></table></figure><p>åˆ›å»ºéœ€è¦çš„é…ç½®æ–‡ä»¶ï¼Œåªéœ€è¦åˆ›å»ºæ–‡ä»¶å³å¯ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo touch /etc/uswsusp.conf</span><br><span class="line">sudo dpkg-reconfigure -pmedium uswsusp</span><br></pre></td></tr></table></figure><p>è¿™æ—¶å€™ç»ˆç«¯ä¼šæé†’æ˜¯å¦ç»§ç»­ï¼Œé€‰æ‹©Yesï¼Œç„¶åä¼šè¦æ±‚ä½ åˆ›å»ºä¸€ä¸ªå¯†ç ï¼Œè®¾ç½®ä¸€ä¸ªå¯†ç ç»§ç»­å³å¯ã€‚</p><p>æ­¤æ—¶å°±å¯ä»¥æµ‹è¯•ä¸€ä¸‹åŠŸèƒ½äº†ï¼Œä¸è¿‡æˆ‘æ˜¯è·³è¿‡è¿™ä¸ªæ­¥éª¤äº†(æ¯”è¾ƒå–œæ¬¢ä½œæ­»)ã€‚</p><p>ä¿®æ”¹systemdçš„hibernateæœåŠ¡ï¼Œä½¿ç”¨uswsuspæ¥ä»£æ›¿systemdçš„åŠŸèƒ½ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo systemctl edit systemd-hibernate.service</span><br></pre></td></tr></table></figure><p>å†™å…¥ä»¥ä¸‹å†…å®¹:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[Service]</span><br><span class="line">ExecStart=</span><br><span class="line">ExecStart=/usr/sbin/s2disk</span><br><span class="line">ExecStartPost=/bin/run-parts -a post /lib/systemd/system-sleep</span><br></pre></td></tr></table></figure><p>è¿™æ—¶å€™å¯ä»¥ä½¿ç”¨systemdçš„å‘½ä»¤æ¥æµ‹è¯•çš„ï¼Œæˆ‘è¡¨ç¤ºå·¥ä½œçš„éå¸¸æ­£å¸¸ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">systemctl hibernate</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œä»¥åå¯ä»¥çœ‹åˆ°å±å¹•ä¸Šä¼šæ‰“å°å½“å‰ä¿å­˜çš„è¿›åº¦ï¼Œç„¶åè®¾å¤‡å°±å…³æœºäº†ï¼Œæ­¤æ—¶å†å¼€æœºï¼Œç­‰å¾…ä¸€ä¼šå„¿ä»¥åå°±çœ‹åˆ°äº†èƒŒæ™¯æ˜¯æˆ‘æ¼‚äº®è€å©†çš„é”å±ï¼Œè§£é”ä»¥åçœ‹åˆ°å·¥ä½œåŒºè¿˜æ˜¯æ‰§è¡Œå‘½ä»¤å‰çš„ï¼Œä¸€åˆ‡okã€‚</p><p>å‚è€ƒä»¥ä¸‹å†…å®¹:</p><blockquote><p><a href="https://askubuntu.com/questions/6769/hibernate-and-resume-from-a-swap-file">https://askubuntu.com/questions/6769/hibernate-and-resume-from-a-swap-file</a></p></blockquote><blockquote><p><a href="https://wiki.archlinux.org/index.php/Uswsusp">https://wiki.archlinux.org/index.php/Uswsusp</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C++å¿«é€Ÿæ’åº</title>
      <link href="/2018/11/11/quick-sort-for-cpp/"/>
      <url>/2018/11/11/quick-sort-for-cpp/</url>
      
        <content type="html"><![CDATA[<p>å¿«é€Ÿæ’åºæ˜¯åŸºäºåˆ†æ²»æ€æƒ³çš„æ’åºç®—æ³•ï¼Œé€šè¿‡è¿™ç§ç­–ç•¥æŠŠåˆ—è¡¨åˆ†ä¸ºä¸¤ä¸ªå­åˆ—ï¼Œé‡å¤è¯¥è¿‡ç¨‹ã€‚æ˜¯ç”±ä¸œå°¼Â·éœå°”æå‡ºï¼Œåœ¨å¹³å‡çŠ¶å†µä¸‹ï¼Œæ’åºNä¸ªæ•°æ®è¦O(nlogn)æ¬¡æ¯”è¾ƒï¼Œåœ¨æœ€åæƒ…å†µä¸‹åˆ™éœ€è¦O(n^2)ï¼Œä½†é€€åŒ–æˆå†’æ³¡çš„æƒ…å†µæ¯”è¾ƒå°‘è§ï¼Œå¿«é€Ÿæ’åºæ¯”å…¶ä»–æ’åºç®—æ³•é€šå¸¸æƒ…å†µæ˜¯æœ€ä½³çš„ï¼Œå› ä¸ºå†…éƒ¨ä½¿ç”¨çš„å¾ªç¯åœ¨å¾ˆå¤šå¹³å°éƒ½æœ‰ä¼˜åŒ–ã€‚</p><span id="more"></span><p>å¿«é€Ÿæ’åºçš„æ­¥éª¤å¾ˆç®€å•ï¼š</p><ul><li>é€‰æ‹©ä¸€ä¸ªåŸºå‡†</li><li>éå†åˆ—è¡¨ï¼Œå°†å°äºåŸºå‡†çš„æ”¾åœ¨åˆ—è¡¨å·¦è¾¹ï¼Œå¤§äºåŸºå‡†çš„æ”¾åœ¨åˆ—è¡¨å³è¾¹</li><li>é€’å½’è¿™ä¸ªæ“ä½œ</li></ul><p>åœ¨ç»´åŸºç™¾ç§‘ä¸Šçš„è¿™å¼ å›¾å¯ä»¥å¾ˆç›´è§‚çš„å±•ç¤ºå¿«é€Ÿæ’åºçš„è¿‡ç¨‹ã€‚</p><img src="/2018/11/11/quick-sort-for-cpp/Sorting-quicksort-anim.gif" class="" title="quicksort"><p>ä»£ç å®ç°:</p><p>é¦–å…ˆéœ€è¦ä¸€ä¸ªè¿”å›åŸºå‡†çš„å‡½æ•°ï¼Œè¯¥å‡½æ•°è´Ÿè´£ä»æŒ‡å®šçš„èŒƒå›´ä¸­æŒ‘é€‰ä¸€ä¸ªä½ç½®ä½œä¸ºåŸºå‡†ï¼Œå¹¶å¯¹èŒƒå›´å†…åˆ—è¡¨è¿›è¡Œæ’åºï¼Œå¹¶è¿”å›åŸºå‡†æ‰€åœ¨çš„ä½ç½®ã€‚</p><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">Division</span><span class="params">(<span class="type">int</span> a[], <span class="type">int</span> left, <span class="type">int</span> right)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> base = a[left]; <span class="comment">// å–ç¬¬ä¸€ä¸ªæ•°ä¸ºåŸºå‡†</span></span><br><span class="line">    <span class="keyword">while</span> (left &lt; right) &#123;</span><br><span class="line">        <span class="keyword">while</span> (left &lt; right &amp;&amp; a[left] &gt; base) &#123;</span><br><span class="line">            <span class="comment">// ä»å³å‘å·¦æ‰¾ç¬¬ä¸€ä¸ªæ¯”åŸºå‡†å°çš„å…ƒç´ </span></span><br><span class="line">            --right;</span><br><span class="line">        &#125;</span><br><span class="line">        a[left] = a[right]; <span class="comment">// äº¤æ¢ä½ç½®ï¼ŒæŠŠå°å…ƒç´ æ”¾åœ¨å·¦ä¾§</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (left &lt; right &amp;&amp; a[left] &lt; base) &#123;</span><br><span class="line">            <span class="comment">// ä»å·¦å‘å³æ‰¾ç¬¬ä¸€ä¸ªæ¯”åŸºå‡†å¤§çš„å…ƒç´ </span></span><br><span class="line">            ++left;</span><br><span class="line">        &#125;</span><br><span class="line">        a[right] = a[left]; <span class="comment">// äº¤æ¢ä½ç½®ï¼ŒæŠŠå¤§å…ƒç´ æ”¾åœ¨å³ä¾§</span></span><br><span class="line">    &#125;</span><br><span class="line">    a[left] = base;</span><br><span class="line">    <span class="keyword">return</span> left;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Divisionå‡½æ•°åªåšäº†æœ€ç®€å•çš„äº‹ï¼Œæ‰¾ä¸€ä¸ªåŸºå‡†ï¼Œå¹¶äº¤æ¢å·¦å³çš„å…ƒç´ ï¼Œä½¿åˆ—è¡¨å·¦ä¾§å‡å°äºåŸºå‡†å…ƒç´ ï¼Œä½¿å³ä¾§å‡å¤§äºåŸºå‡†å…ƒç´ ï¼Œæ¥ä¸‹æ¥éœ€è¦ä¸€ä¸ªå‡½æ•°ï¼Œä½¿åˆ—è¡¨è¶‹å‘æœ€å°ï¼Œç›´è‡³åˆ—è¡¨å…ƒç´ å‰©ä¸€(è¿™é‡Œæˆ‘æ„Ÿè§‰å…¶å®æœ‰ç‚¹æé™çš„æ€æƒ³)ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">void quick_sort(int a[], int left, int right) &#123;</span><br><span class="line">    if (left &lt; right) &#123;</span><br><span class="line">        int index = Division(a, left, right); //å¯¹åˆ—è¡¨è¿›è¡Œåˆ†å‰²</span><br><span class="line">        quick_sort(a, left, i -1); //å¯¹å·¦ä¾§è¿›è¡Œæ’åº</span><br><span class="line">        quick_sort(a, i + 1, right); //å¯¹å³ä¾§è¿›è¡Œæ’åº</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é…åˆä¸Šæ–¹çš„gifï¼Œå°±å¯ä»¥å¾ˆæ¸…æ¥šçš„äº†è§£å¿«é€Ÿæ’åºæ˜¯å¦‚ä½•ä½¿ç”¨åˆ†æ²»æ³•æ¥æ’åºçš„ï¼Œé€šè¿‡å°†å¤§ä»»åŠ¡æ‹†åˆ†æˆå°ä»»åŠ¡ï¼Œæœ€ç»ˆè¾¾æˆå®Œæ•´çš„æ’åº.</p>]]></content>
      
      
      
        <tags>
            
            <tag> C++ </tag>
            
            <tag> Program </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨Googleæ—¥å†å®‰æ’å·¥ä½œä»»åŠ¡</title>
      <link href="/2018/11/09/use-google-calendar-to-finishe-work/"/>
      <url>/2018/11/09/use-google-calendar-to-finishe-work/</url>
      
        <content type="html"><![CDATA[<p>ç›®å‰æˆ‘ä»¬æ­£åœ¨å°è¯•æŠŠå·¥ä½œçš„åˆ†é…å’Œè®¨è®ºæ”¾åœ¨githubä¸Šè¿›è¡Œï¼Œè¿™æ ·å¯ä»¥ä½¿æˆ‘ä»¬çš„ç”¨æˆ·å’Œå¼€å‘è€…æ›´å®¹æ˜“æ¥è§¦åˆ°æˆ‘ä»¬ï¼Œå¯ä»¥æbugå’Œå¯¹éœ€æ±‚è¿›è¡Œè®¨ã€‚</p><p>ä½†æ˜¯ä½¿ç”¨èµ·æ¥è¿˜æ˜¯æœ‰äº›ä¸ä¾¿ï¼Œæ¯”å¦‚ä½¿ç”¨towerè¿›è¡Œä»»åŠ¡åˆ†é…çš„æ—¶å€™ï¼Œå¯ä»¥æ–¹ä¾¿çš„ç§»åŠ¨ä¸€ä¸ªä»»åŠ¡åˆ°æŸä¸ªåˆ†ç±»ï¼Œæˆ–è€…æŒ‡æ´¾ä¸€ä¸ªæ—¶é—´ã€‚ä½†æ˜¯githubä¸Šæ˜¯åŸºäºissueçš„ï¼Œå¹¶ä¸æ˜¯ä¸ºäº†åšè¿™ç§äº‹æ¥è®¾è®¡çš„ï¼Œæ‰€ä»¥éœ€æ±‚ä¸Šæœ‰ä¸€äº›å‡ºå…¥ã€‚ä½†æ˜¯<a href="https://github.com/hualet">@hualet</a>å¤§ä½¬æ ¹æ®githubçš„apiå†™äº†ä¸€ä¸ªbotæ¥åšä¸€ç‚¹å¾®å°çš„äº‹ï¼Œå½“ä¸€ä¸ªissueçš„assigneesåªå‰©QAçš„åŒäº‹æ—¶ï¼Œissueä¼šè¢«botç§»åŠ¨åˆ°æµ‹è¯•æ ä¸­ï¼Œåªå‰©ä¸€ä¸ªå¼€å‘åŒäº‹æ—¶(åŸºæœ¬ä¸Šæ˜¯è´Ÿè´£è¯¥ä»»åŠ¡çš„å¼€å‘è€…)ï¼Œä¼šè¢«ç§»åŠ¨åˆ°å¼€å‘æ ä¸­ã€‚</p><p>ä½†æ˜¯å› ä¸ºä¸èƒ½åšåˆ°æ¯”å¦‚ä»Šå¤©ã€æ˜å¤©ã€ä¸‹å‘¨ç­‰æ—¶é—´çš„æ˜¾ç¤ºï¼Œæ‰€ä»¥ä»»åŠ¡åªèƒ½é€šè¿‡æ¯å¤©å¼€ä¼šæ¥å£å¤´å‘ŠçŸ¥æ—¶é—´ï¼Œä½†æ˜¯è¿™å¹¶ä¸å¦¨ç¢æˆ‘è¿›è¡Œè‡ªå·±çš„ä»»åŠ¡æ—¶é—´å®‰æ’ã€‚è¯·å‡ºä¸–ç•Œç¬¬ä¸€çš„ç¥å™¨(æ—¥å†)ã€‚</p><span id="more"></span><p>æˆ‘é€‰æ‹©ä½¿ç”¨è°·æ­Œæ—¥å†ï¼Œ<del>æ‰ä¸æ˜¯å› ä¸ºå®ƒæœ‰ç½‘é¡µè¿˜æœ‰å®‰å“å®¢æˆ·ç«¯ã€å“¼</del></p><p>è°·æ­Œæ—¥å†ä¸Šæ”¯æŒæ–°å»ºä¸‰ç§ç±»å‹ï¼Œåˆ†åˆ«æ˜¯æ´»åŠ¨ã€æé†’å’Œä»»åŠ¡ã€‚æ´»åŠ¨æ˜¯å¼€å§‹æ—¶é—´æ˜ç¡®ï¼Œä½†æ˜¯ç»“æŸæ—¶é—´æœªçŸ¥çš„ç±»å‹ï¼Œé€‚åˆç”¨ä½œå¯¹æ—¶é—´ä¸ä¸¥æ ¼çš„æƒ…å†µã€‚æé†’åˆ™æ˜¯åœ¨æ´»åŠ¨çš„åŸºç¡€ä¸Šæ·»åŠ äº†æä¾›åŠŸèƒ½ï¼Œåœ¨æ´»åŠ¨å³å°†å¼€å§‹æ—¶å‘é€é€šçŸ¥æé†’ã€‚ä»»åŠ¡åˆ™æ˜¯ç†Ÿæ‚‰çš„ToDoListï¼Œé€‚åˆç”¨æ¥åˆ†é…ä»Šå¤©ä¸€å®šè¦åšï¼Œä½†æ˜¯æ—¶é—´æœªçŸ¥çš„äº‹ã€‚</p><p>æˆ‘æ·»åŠ äº†æ¯å¤©çš„å¼€ä¼šæé†’ï¼Œå†å¼€å®Œä¼šä»¥åï¼Œæˆ‘ä¼šæŠŠèº«ä¸Šçš„æ–°ä»»åŠ¡åˆ›å»ºæˆtaskï¼Œç„¶åå†æ·»åŠ å¤§æ¦‚çš„æ´»åŠ¨æ¥ç¡®å®šä¸€ä¸‹è¦å®Œæˆçš„taskã€‚æŠŠä»Šå¤©æ²¡æœ‰æ—¶é—´åšçš„taskç§»åŠ¨åˆ°æ˜å¤©ï¼Œç•™åœ¨å½“å¤©çš„taskå°½é‡è¦å½“å¤©å®Œæˆï¼Œå¯ä»¥å¾—åˆ°ä»Šå¤©çš„ä»»åŠ¡åˆ—è¡¨å’Œå»¶æœŸåˆ—è¡¨ï¼Œè®©æˆ‘å¯¹è¦åšçš„äº‹æœ‰å®Œæ•´çš„æ§åˆ¶ã€‚</p><p>è°·æ­Œæ—¥å†çš„æ—¥è§†å›¾å’Œå‘¨è§†å›¾ä¼šæ˜¾ç¤ºä¸€æ¡çº¿ï¼Œå‘Šè¯‰ä½ ç°åœ¨çš„æ—¶é—´ï¼Œåº”è¯¥è¿›è¡Œä»€ä¹ˆæ´»åŠ¨äº†ã€‚</p><img src="/2018/11/09/use-google-calendar-to-finishe-work/activity.png" class="" title="activity"><img src="/2018/11/09/use-google-calendar-to-finishe-work/task.png" class="" title="task"><img src="/2018/11/09/use-google-calendar-to-finishe-work/week.png" class="" title="week"><p>åœ¨æ‰‹æœºä¸Šéœ€è¦ä½¿ç”¨ä¸¤ä¸ªappï¼ŒGoogle calendarå’ŒGoogle taskï¼Œæ´»åŠ¨å’Œæé†’éœ€è¦calendarï¼Œtaskåˆ™éœ€è¦å•ç‹¬ä½¿ç”¨ä¸€ä¸ªappï¼Œåªæœ‰ç½‘é¡µä¸Šæ‰æ˜¯æ•´åˆçš„ã€‚</p><img src="/2018/11/09/use-google-calendar-to-finishe-work/android-calendar.png" class="" title="android-calendar"><img src="/2018/11/09/use-google-calendar-to-finishe-work/android-task.png" class="" title="android-task"><img src="/2018/11/09/use-google-calendar-to-finishe-work/day.png" class="" title="day"><p>å› ä¸ºæˆ‘ä¹Ÿæ˜¯æ‰å¼€å§‹ç”¨æ—¥å†æ¥åˆ†é…ä»»åŠ¡çš„æ—¶é—´ï¼Œæ‰€ä»¥è®°å½•çš„å†…å®¹å¹¶ä¸å¤šï¼Œæˆ‘ä¹Ÿåœ¨æ‘¸ç´¢å¦‚ä½•ä½¿ç”¨è¿™äº›åŠŸèƒ½ï¼Œä½†æ˜¯æˆ‘è§‰å¾—ä½¿ç”¨æ—¥å†æ¥è®°å½•å’Œç®¡ç†æ—¶é—´æ˜¯éå¸¸ä¸é”™çš„ä¸€ä»¶äº‹ï¼Œæˆ‘å¯ä»¥é€šè¿‡çœ‹æŸå¤©çš„æ´»åŠ¨æ¥å›å¿†å½“å¤©æ‰€åšçš„äº‹ï¼Œä¹Ÿå¯ä»¥æ ¹æ®è®°å½•çš„å†…å®¹æ¥åˆ†æè‡ªå·±åœ¨æŸäº›ä»»åŠ¡ä¸Šä½¿ç”¨äº†å¤šå°‘çš„æ—¶é—´ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>æŠŠåšå®¢è½¬ç§»åˆ°coding</title>
      <link href="/2018/11/09/hexo%20page%20move%20to%20coding/"/>
      <url>/2018/11/09/hexo%20page%20move%20to%20coding/</url>
      
        <content type="html"><![CDATA[<p>ä¸Šå‘¨æœ«æŠ˜è…¾é»‘æœå­çš„æ—¶å€™ï¼Œä¸å°å¿ƒè¢«æœå­å‘çˆ¹çš„ç£ç›˜ç®¡ç†å‘äº†ï¼Œæ•´ä¸ªhomeè¢«ç›´æ¥æ”¹æˆHFS+äº†ï¼Œæœ¬æ¥æ˜¯æ‰“ç®—åˆ†é…ä¸€ä¸ªç©ºé—²åˆ†åŒºå‡ºæ¥çš„ï¼Œå½“æˆ‘æ–°å»ºåˆ†åŒºä»¥åï¼Œä»ç©ºé—´åˆ†åŒºå¼€å§‹åˆ°homeï¼Œåˆ†åŒºå…¨éƒ¨éƒ½å˜æˆHFS+äº†ï¼Œä½†æ˜¯â€¦ ç©ºé—²åˆ†åŒºæ–°å»ºå¤±è´¥ï¼Œæç¤ºæˆ‘ç£ç›˜ç©ºé—´ä¸è¶³ï¼Œæˆ‘å°±é‡å¯è¿›deepinæ‰“ç®—ç›´æ¥æ–°å»ºä¸€ä¸ªç®—äº†ï¼Œç„¶åå°±GGå‡ ç‡äº†ã€‚åœ¨windowsä¸‹çœ‹åˆ°homeå·²ç»æˆæœå­çš„æ–‡ä»¶ç³»ç»Ÿäº†ï¼Œç„¶åæˆ‘ç”¨archçš„å®‰è£…ç›˜çœ‹äº†ä¸€ä¸‹ï¼Œå·²ç»æ— æ³•é‡æ–°æŒ‚è½½äº†(æˆåŠŸGG)ï¼Œç„¶åæ•°æ®å°±éƒ½æ²¡äº†ã€‚</p><p>è¿˜å¥½æˆ‘çš„æ•°æ®åœ¨å…¬å¸è¿˜æœ‰ä¸€ä»½ï¼Œç§é’¥ä¹Ÿéƒ½åœ¨ï¼Œç»è¿‡ä¸€æ˜ŸæœŸçš„åŠªåŠ›å¤åˆ¶ï¼Œå¤§éƒ¨åˆ†æ•°æ®éƒ½æ¢å¤äº†ï¼Œä¸è¿‡topbarçš„æ–°åŠŸèƒ½ä»£ç æ˜¯å½»åº•æ²¡äº†ï¼Œå‘¨äº”æ™šä¸Šå¤ªè‡ªä¿¡äº†ï¼Œæ²¡æœ‰æäº¤åˆ°gayhubä¸Š(çŒ›å¹æ°”)ã€‚</p><p>æˆ‘ä»¬ç°åœ¨æ­£åœ¨å°è¯•æŠŠæ—¥å¸¸å·¥ä½œè½¬å‘githubçš„projectå’Œçœ‹æ¿ï¼Œæ¯å¤©æ—©ä¸Šå¼€ä¸€ä¸‹æ™¨ä¼šï¼Œç®€å•åˆ†é…ä¸€ä¸‹ä»»åŠ¡ï¼Œå¼€å®Œä¼šä»¥åæˆ‘ä¼šæŠŠè‡ªå·±çš„ä»»åŠ¡å†™åœ¨è°·æ­Œæ—¥å†å’Œtaskä¸Šï¼Œç„¶åå®‰æ’ä¸€ä¸‹ä»»åŠ¡çš„å…ˆåé¡ºåºï¼Œæˆ‘å‡†å¤‡æŠŠè‡ªå·±çš„ä¸€äº›åšæ³•å†™åˆ°åšå®¢ä¸Šï¼Œä½†æ˜¯homeå·²ç»ä¸åœ¨äº†ï¼Œæ‰€ä»¥æˆ‘è¦å…ˆæ¢å¤æˆ‘çš„åšå®¢ï¼Œåˆšå¥½å›½å†…æœ‰äººè¯´æˆ‘åšå®¢è®¿é—®çš„å¾ˆæ…¢ï¼Œæˆ‘æ‰“ç®—å›½å†…è§£æåˆ°codingï¼Œå›½å¤–è§£æåˆ°githubã€‚</p><span id="more"></span><p>é¦–å…ˆï¼Œåˆ›å»ºæ–°çš„åšå®¢ç›®å½•ï¼Œç”¨æ¥æ‹‰å–æ—§çš„æ•°æ®ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mkdir blog &amp;&amp; cd blog</span><br></pre></td></tr></table></figure><p>åˆå§‹åŒ–gitç›®å½•ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git init</span><br></pre></td></tr></table></figure><p>æ·»åŠ è¿œç¨‹ä»“åº“ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git remote add origin ä½ çš„åšå®¢gitåœ°å€</span><br></pre></td></tr></table></figure><p>å–å›originçš„backupåˆ†æ”¯ï¼Œå’Œæœ¬åœ°masteråˆå¹¶ã€‚å› ä¸ºhexo-git-backupæ’ä»¶åªæ”¯æŒmasterï¼Œä½†æ˜¯codingåªæ”¯æŒmasteréƒ¨ç½²pageæœåŠ¡ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨å…¶ä»–åˆ†æ”¯ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git pull origin backup:master</span><br></pre></td></tr></table></figure><p>æ‹‰å–äº†ä»£ç ä»¥åï¼Œæˆ‘ä»¬éœ€è¦åšç‚¹å…¶ä»–è®¾ç½®ï¼Œé¦–å…ˆè®¾ç½®ä¸Šæ¸¸åˆ†æ”¯ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git branch --set-upstream-to=origin/backup master</span><br></pre></td></tr></table></figure><p>è®¾ç½®gitçš„é»˜è®¤pushç­–ç•¥ï¼Œå¯ä»¥å‚è€ƒ<a href="http://thekaiway.com/2013/07/30/config-your-git-push-strategy/">thekaiway</a>çš„æ–‡ç« ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git config push.default upstream</span><br></pre></td></tr></table></figure><p>ç„¶åæ·»åŠ codingçš„gitåœ°å€ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git remote add coding ä½ çš„gitåœ°å€</span><br></pre></td></tr></table></figure><p>ä¹‹åå°±æ­£å¸¸ä½¿ç”¨äº†ï¼Œé€šè¿‡npmå®‰è£…hexoï¼Œå†å®‰è£…éœ€è¦çš„æ’ä»¶ï¼Œæœ€åå®Œæˆäº†åœ¨ä¸€å°æ–°ç”µè„‘ä¸Šæ¢å¤hexoåšå®¢ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>æ™ºèƒ½æŒ‡é’ˆ</title>
      <link href="/2018/08/29/cpp-smart-pointer/"/>
      <url>/2018/08/29/cpp-smart-pointer/</url>
      
        <content type="html"><![CDATA[<p>å…¶å®ä¸€ç›´éƒ½å¯¹æ™ºèƒ½æŒ‡é’ˆçš„åº”ç”¨åœºæ™¯ä¸æ¸…æ¥šï¼Œé¡¹ç›®ä¸­ä¹Ÿå¾ˆå°‘ç”¨åˆ°ï¼Œä»Šå¤©åœ¨ <a href="https://zccrs.com/">@zccrs</a> å¤§ä½¬çš„å¸®åŠ©ä¸‹ï¼Œå¤§æ¦‚ç†è§£äº†æ™ºèƒ½æŒ‡é’ˆçš„ä½œç”¨å’Œåº”ç”¨åœºæ™¯ã€‚</p><span id="more"></span><h1 id="è®¾è®¡æ€æƒ³"><a href="#è®¾è®¡æ€æƒ³" class="headerlink" title="è®¾è®¡æ€æƒ³"></a>è®¾è®¡æ€æƒ³</h1><p>æ™ºèƒ½æŒ‡é’ˆä¾èµ–ä¸€ç§å«å¼•ç”¨è®¡æ•°çš„æ‰‹æ®µæ¥ååŠ©ç®¡ç†å¯¹è±¡æŒ‡é’ˆï¼Œé€šè¿‡å¼•ç”¨è®¡æ•°ä¸º0æ—¶åˆ é™¤å¯¹è±¡æŒ‡é’ˆæ¥å®Œæˆå†…å­˜çš„é‡Šæ”¾ï¼Œæœ¬è´¨ä¸Šæ˜¯é€šè¿‡æ ˆå¯¹è±¡æ¥ç®¡ç†å †å¯¹è±¡çš„ä¸€ç§æ–¹æ³•ã€‚</p><h2 id="ä¼ ç»Ÿåšæ³•"><a href="#ä¼ ç»Ÿåšæ³•" class="headerlink" title="ä¼ ç»Ÿåšæ³•"></a>ä¼ ç»Ÿåšæ³•</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">void test() &#123;</span><br><span class="line">    Test* t = new Test;</span><br><span class="line">    ...</span><br><span class="line">    if (...) &#123;</span><br><span class="line">        throw exception();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    delete t;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å½“å‡ºç°å¼‚å¸¸æ—¶ï¼Œdeleteå°†ä¸ä¼šè¢«æ‰§è¡Œåˆ°ï¼Œtä¹Ÿå°±æ³„éœ²äº†ã€‚è™½ç„¶æˆ‘ä»¬å¯ä»¥åœ¨å¼‚å¸¸é‚£é‡ŒæŠŠdeleteç»™åŠ ä¸Šï¼Œä½†æ˜¯åœ¨è¾ƒä¸ºå¤§å‹çš„é¡¹ç›®ä¸­ï¼Œå¦‚æœå¯¹ä»£ç è¿›è¡Œreviewæ¥æ’æŸ¥è¿™ç§é”™è¯¯ï¼Œå°†ä¼šæ˜¯éå¸¸éº»çƒ¦çš„ä¸€ä»¶äº‹ï¼Œæ‰€ä»¥ä¸ºäº†é¿å…å†…å­˜æ³„æ¼ï¼Œå‘æ˜äº†åŸºäºå¼•ç”¨æŠ€æœ¯çš„æ™ºèƒ½æŒ‡é’ˆã€‚</p><h2 id="æ™ºèƒ½æŒ‡é’ˆåšæ³•"><a href="#æ™ºèƒ½æŒ‡é’ˆåšæ³•" class="headerlink" title="æ™ºèƒ½æŒ‡é’ˆåšæ³•"></a>æ™ºèƒ½æŒ‡é’ˆåšæ³•</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">void test() &#123;</span><br><span class="line">    std::unique_ptr&lt;Test&gt; t(new Test);</span><br><span class="line">    ...</span><br><span class="line">    if (...) &#123;</span><br><span class="line">        throw exception();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¦‚æœä¸å…³å¿ƒstd::unique_ptræ˜¯ä»€ä¹ˆï¼Œè¿™æ®µä»£ç æ— æ„æ˜¯ç³Ÿç³•çš„ï¼Œnewå‡ºæ¥çš„Testå¯¹è±¡æ ¹æœ¬æ²¡æœ‰åœ°æ–¹è¢«åˆ é™¤ï¼Œå†…å­˜æ³„éœ²äº†ã€‚</p><p>ä½†æ˜¯ä¸å¿…æ‹…å¿ƒï¼ŒæŒ‡é’ˆå·²ç»ç”±std::unique_ptræ¥ç®¡ç†äº†ï¼Œæ ¹æœ¬ä¸ä¼šå‘ç”Ÿå†…å­˜æ³„æ¼ï¼Œå¯¹è±¡å°†åœ¨ç¦»å¼€å‡½æ•°ä½œç”¨åŸŸä»¥åè¢«åˆ é™¤ã€‚</p><p>è¿™å°±æ˜¯æ™ºèƒ½æŒ‡é’ˆçš„æ–¹ä¾¿ä¹‹å¤„ã€‚</p><h1 id="æ™ºèƒ½æŒ‡é’ˆçš„åŸºæœ¬å®ç°"><a href="#æ™ºèƒ½æŒ‡é’ˆçš„åŸºæœ¬å®ç°" class="headerlink" title="æ™ºèƒ½æŒ‡é’ˆçš„åŸºæœ¬å®ç°"></a>æ™ºèƒ½æŒ‡é’ˆçš„åŸºæœ¬å®ç°</h1><p>æ™ºèƒ½æŒ‡é’ˆéƒ½é€šè¿‡æ¨¡æ¿ç¼–ç¨‹æ¥å®ç°ï¼Œæ¨¡æ¿æ˜¯C++çš„å¦ä¸€å¤§åŠŸèƒ½ï¼Œå¯ä»¥ä½¿æˆ‘ä»¬æ›´å…³å¿ƒå®ç°è€Œä¸éœ€è¦å…³å¿ƒå…·ä½“çš„å¯¹è±¡ï¼Œé€šè¿‡æ›´åŠ æŠ½è±¡çš„æ–¹å¼æ¥ç¼–å†™ç¨‹åºã€‚</p><p>æ™ºèƒ½æŒ‡é’ˆæœ‰ä¸¤å±‚ï¼Œé‡Œå±‚ç”¨æ¥ä¿å­˜å¯¹è±¡çš„æŒ‡é’ˆå’Œå¼•ç”¨è®¡æ•°ï¼Œå¤–å±‚ç”¨æ¥è°ƒç”¨é‡Œå±‚æ¥æ§åˆ¶å¼•ç”¨è®¡æ•°ã€‚</p><p>é‡Œå±‚çš„è¾…åŠ©ç±»</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">template&lt;typename T&gt;</span><br><span class="line">class P_ptr &#123;</span><br><span class="line">    private:</span><br><span class="line">        friend class Pointer&lt;T&gt;;</span><br><span class="line">        P_ptr(T t)</span><br><span class="line">        : pointer(t)</span><br><span class="line">        , count(1)</span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        uint count;</span><br><span class="line">        T pointer;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¤–å±‚çš„æ§åˆ¶ç±»</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">template&lt;typename T&gt;</span><br><span class="line">class Pointer &#123;</span><br><span class="line">    public:</span><br><span class="line">        Pointer(T t)</span><br><span class="line">        : m_ptr(new P_ptr(t))</span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Pointer(const Pointer &amp;pointer)</span><br><span class="line">        : m_ptr(pointer.m_ptr)</span><br><span class="line">        &#123;</span><br><span class="line">            ++m_ptr-&gt;count;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Pointer&amp; operator=(const Pointer &amp;pointer) &#123;</span><br><span class="line">            ++pointer-&gt;count;</span><br><span class="line">            if (--m_ptr-&gt;count == 0) &#123; // åº”å¯¹è‡ªèµ‹å€¼</span><br><span class="line">                delete m_ptr;</span><br><span class="line">            &#125;</span><br><span class="line">            m_ptr = pointer-&gt;m_ptr;</span><br><span class="line">            return *this;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        ~Pointer() &#123;</span><br><span class="line">            if (--m_ptr-&gt;count == 0) &#123;</span><br><span class="line">                delete m_ptr;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    private:</span><br><span class="line">        P_ptr m_ptr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡é‡å†™æ§åˆ¶ç±»çš„æ‹·è´æ„é€ å‡½æ•°å’Œèµ‹å€¼è¿ç®—ç¬¦é‡è½½æ¥æ›´æ–°å¼•ç”¨è®¡æ•°ã€‚</p><p>ä½¿ç”¨å®ä¾‹</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">void test() &#123;</span><br><span class="line">    Pointer&lt;Test&gt; t(new Test); // å¼•ç”¨è®¡æ•°ç›®å‰æ˜¯1</span><br><span class="line">    Pointer&lt;Test&gt; t1 = t; // tçš„å¼•ç”¨è®¡æ•°æ˜¯2ï¼Œt1çš„å¼•ç”¨è®¡æ•°ä¹Ÿæ˜¯2</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// ç¦»å¼€ä½œç”¨åŸŸï¼Œtè¢«åˆ é™¤ï¼Œå¼•ç”¨è®¡æ•°æ˜¯1. t1è¢«åˆ é™¤ï¼Œå¼•ç”¨è®¡æ•°ä¸º0ï¼ŒTestè¢«åˆ é™¤ï¼Œå†…å­˜æ²¡æœ‰æ³„éœ²ã€‚</span><br></pre></td></tr></table></figure><p>è¿™æ ·æˆ‘ä»¬å°±æœ‰ä¸€ä¸ªç®€å•çš„æ™ºèƒ½æŒ‡é’ˆäº†ï¼Œä¸è¿‡ä»–è¿˜å­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œæ¯”å¦‚å¾ªç¯å¼•ç”¨å¯¼è‡´å†…å­˜æ³„æ¼ï¼Œæ²¡æœ‰-&gt;å’Œ*çš„æ“ä½œè¿ç®—ç¬¦ç­‰ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦æ›´å¼ºå¤§çš„æ™ºèƒ½æŒ‡é’ˆæ¥å¸®åŠ©æˆ‘ä»¬ã€‚</p><h1 id="å‡ ç§æ™ºèƒ½æŒ‡é’ˆçš„ä»‹ç»"><a href="#å‡ ç§æ™ºèƒ½æŒ‡é’ˆçš„ä»‹ç»" class="headerlink" title="å‡ ç§æ™ºèƒ½æŒ‡é’ˆçš„ä»‹ç»"></a>å‡ ç§æ™ºèƒ½æŒ‡é’ˆçš„ä»‹ç»</h1><p>æ ‡å‡†åº“æä¾›äº†å‡ ä¸ªé’ˆå¯¹ä¸åŒæ–¹é¢ä½¿ç”¨çš„æ™ºèƒ½æŒ‡é’ˆï¼Œä»¥æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ã€‚</p><ul><li>unique_ptr<blockquote><p>åªå…è®¸ä¸€ä¸ªæ‰€æœ‰è€…ï¼Œé™¤éç¡®ä¿¡ä½ éœ€è¦å…±äº«è¯¥æŒ‡é’ˆï¼Œåˆ™åº”è¯¥ä½¿ç”¨<code>shared_ptr</code>ã€‚å¯ä»¥è½¬ç§»åˆ°æ–°çš„æ‰€æœ‰è€…ï¼Œä½†æ˜¯ä¸ä¼šå¤åˆ¶å’Œå…±äº«ã€‚</p></blockquote></li><li>shared_ptr<blockquote><p>é‡‡ç”¨å¼•ç”¨è®¡æ•°çš„æ™ºèƒ½æŒ‡é’ˆï¼Œå¦‚æœä½ æƒ³å°†ä¸€ä¸ªåŸå§‹æŒ‡é’ˆåˆ†é…ç»™å¤šä¸ªæ‰€æœ‰è€…ï¼Œè¯·ä½¿ç”¨è¯¥æ™ºèƒ½æŒ‡é’ˆï¼Œç›´åˆ°<code>shared_ptr</code>æ‰€æœ‰è€…è¶…å‡ºäº†èŒƒå›´æˆ–æ”¾å¼ƒæ‰€æœ‰æƒï¼Œæ‰ä¼šåˆ é™¤åŸå§‹æŒ‡é’ˆï¼Œå¤§å°ä¸ºä¸¤ä¸ªæŒ‡é’ˆï¼Œä¸€ä¸ªç”¨äºå¯¹è±¡ï¼Œä¸€ä¸ªç”¨äºå¼•ç”¨è®¡æ•°ã€‚</p></blockquote></li><li>weak_ptr<blockquote><p>ç»“åˆ<code>shared_ptr</code>ä½¿ç”¨çš„ç‰¹æ®Šæ™ºèƒ½æŒ‡é’ˆï¼Œæä¾›ä¸€ä¸ªæˆ–å¤šä¸ª<code>shared_ptr</code>å®ä¾‹æ‰€æ‹¥æœ‰çš„å¯¹è±¡çš„è®¿é—®ï¼Œä½†æ˜¯ä¸ä¼šå¢åŠ å¼•ç”¨è®¡æ•°ã€‚å¦‚æœä½ æƒ³è§‚å¯ŸæŸä¸ªå¯¹è±¡ï¼Œä½†æ˜¯ä¸éœ€è¦ä¿æŒæ´»åŠ¨çŠ¶æ€ï¼Œåˆ™å¯ä»¥ä½¿ç”¨è¯¥æ™ºèƒ½æŒ‡é’ˆã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œéœ€è¦æ–­å¼€<code>shared_ptr</code>å®ä¾‹é—´çš„å¾ªç¯å¼•ç”¨ã€‚</p></blockquote></li></ul><h1 id="å¦‚ä½•æ­£ç¡®çš„é€‰æ‹©æ™ºèƒ½æŒ‡é’ˆ"><a href="#å¦‚ä½•æ­£ç¡®çš„é€‰æ‹©æ™ºèƒ½æŒ‡é’ˆ" class="headerlink" title="å¦‚ä½•æ­£ç¡®çš„é€‰æ‹©æ™ºèƒ½æŒ‡é’ˆ"></a>å¦‚ä½•æ­£ç¡®çš„é€‰æ‹©æ™ºèƒ½æŒ‡é’ˆ</h1><p>æ™ºèƒ½æŒ‡é’ˆåªéœ€è¦åŒºåˆ†éœ€ä¸éœ€è¦å…±äº«ä½¿ç”¨ï¼Œå¦‚æœå¤–éƒ¨éœ€è¦ä½¿ç”¨è¿™ä¸ªå¯¹è±¡ï¼Œä½¿ç”¨<code>shared_ptr</code>ï¼Œå¦åˆ™å°±ä½¿ç”¨unique_ptrè¿›è¡Œç‹¬å ä½¿ç”¨ã€‚</p><h1 id="é™·é˜±å’Œå‘"><a href="#é™·é˜±å’Œå‘" class="headerlink" title="é™·é˜±å’Œå‘"></a>é™·é˜±å’Œå‘</h1><ul><li>ä¸è¦ä½¿ç”¨ç›¸åŒçš„å†…ç½®æŒ‡é’ˆæ¥åˆå§‹åŒ–å¤šä¸ªæ™ºèƒ½æŒ‡é’ˆ</li><li>ä¸è¦ä¸»åŠ¨å›æ”¶æ™ºèƒ½æŒ‡é’ˆå†…åŸå§‹æŒ‡é’ˆçš„å†…å­˜</li><li>ä¸è¦ä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆçš„getæ¥åˆå§‹åŒ–æˆ–è€…resetå¦ä¸€ä¸ªæ™ºèƒ½æŒ‡é’ˆ</li><li>æ™ºèƒ½æŒ‡é’ˆç®¡ç†çš„èµ„æºåªä¼šé»˜è®¤åˆ é™¤newåˆ†é…çš„å†…å­˜ï¼Œå¦‚æœä¸æ˜¯newåˆ†é…çš„ï¼Œåˆ™éœ€è¦ä½¿ç”¨åˆ é™¤å™¨</li></ul>]]></content>
      
      
      <categories>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å·ç§¯ç¥ç»ç½‘ç»œç®€è¿°</title>
      <link href="/2018/07/14/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%AE%80%E8%BF%B0/"/>
      <url>/2018/07/14/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%AE%80%E8%BF%B0/</url>
      
        <content type="html"><![CDATA[<p>å‰è¨€ï¼š æˆ‘å¤ªèœäº†â€¦ æœ¬æ¥æƒ³ç€å†™ä¸ªå°ä¾‹å­ï¼Œç»“æœå†™åˆ°ä¸€åŠå‘ç°è‡ªå·±å…¶å®æ ¹æœ¬ä¸ä¼šï¼Œæˆ‘è¿˜æ˜¯æ’¸C++å»å§ã€‚</p><p>å·ç§¯ç¥ç»ç½‘ç»œ(Convolutional Neural Network)æ˜¯ä¸€ç§å‰é¦ˆç¥ç»ç½‘ç»œã€‚å®ƒçš„äººå·¥ç¥ç»å…ƒå¯ä»¥å“åº”ä¸€éƒ¨åˆ†è¦†ç›–èŒƒå›´å†…çš„å‘¨å›´å•å…ƒï¼Œå¯¹äºå¤§å‹å›¾åƒå¤„ç†æœ‰å‡ºè‰²çš„è¡¨ç°ã€‚</p><p>å·ç§¯ç¥ç»ç½‘ç»œç”±ä¸€ä¸ªæˆ–å¤šä¸ªå·ç§¯å±‚å’Œé¡¶ç«¯çš„å…¨è¿é€šå±‚ç»„æˆï¼ŒåŒæ—¶ä¹ŸåŒ…å«å…³è”æƒé‡å’Œæ± åŒ–å±‚ã€‚è¿™ä¸€ç»“æ„å¯ä»¥ä½¿å¾—å·ç§¯ç¥ç»ç½‘ç»œèƒ½å¤Ÿåˆ©ç”¨è¾“å…¥æ•°æ®çš„äºŒç»´ç»“æ„ã€‚ä¸å…¶ä»–æ·±åº¦å­¦ä¹ ç»“æ„ç›¸æ¯”ï¼Œå·ç§¯ç¥ç»ç½‘ç»œåœ¨å›¾åƒå’Œå£°éŸ³ä¸Šèƒ½å¤Ÿç»™å‡ºæ›´å¥½çš„ç»“æœï¼Œè¿™ä¸€æ¨¡å‹ä¹Ÿå¯ä»¥ç”¨åå‘ä¼ æ’­ç®—æ³•è¿›è¡Œè®­ç»ƒã€‚ç›¸æ¯”è¾ƒäºå…¶ä»–ç¥ç»ç½‘ç»œã€å‰é¦ˆç¥ç»ç½‘ç»œï¼Œå·ç§¯ç¥ç»ç½‘ç»œéœ€è¦è€ƒè™‘çš„å‚æ•°æ›´å°‘ï¼Œä½¿ä¹‹æˆä¸ºä¸€ç§é¢‡å…·å¸å¼•åŠ›çš„æ·±åº¦å­¦ä¹ ç»“æ„ã€‚</p><span id="more"></span><h2 id="ç»“æ„"><a href="#ç»“æ„" class="headerlink" title="ç»“æ„"></a>ç»“æ„</h2><h3 id="å·ç§¯å±‚"><a href="#å·ç§¯å±‚" class="headerlink" title="å·ç§¯å±‚"></a>å·ç§¯å±‚</h3><p>å·ç§¯ç¥ç»ç½‘ç»œä¸­æ¯å±‚å·ç§¯å±‚ç”±è‹¥å¹²å·ç§¯å•å…ƒæ„æˆã€‚æ¯ä¸ªå·ç§¯å•å…ƒçš„å‚æ•°éƒ½å¯ä»¥ç”±åå‘ä¼ æ’­ç®—æ³•æ¥è°ƒæ•´ã€‚å·ç§¯è¿ç®—çš„ç›®çš„æ˜¯æå–è¾“å…¥çš„ä¸åŒç‰¹å¾ï¼Œç¬¬ä¸€å±‚å·ç§¯å¯èƒ½åªæå–éå¸¸å°çš„ç‰¹å¾ï¼Œæ›´å¤šå±‚çš„ç½‘ç»œåªèƒ½ä»ä½çº§ç‰¹å¾ä¸­æå–æ›´å¤æ‚çš„ç‰¹å¾ã€‚</p><h3 id="æ¿€æ´»å‡½æ•°"><a href="#æ¿€æ´»å‡½æ•°" class="headerlink" title="æ¿€æ´»å‡½æ•°"></a>æ¿€æ´»å‡½æ•°</h3><p>è¿è¡Œæ—¶æ¿€æ´»ç¥ç»ç½‘ç»œä¸­æŸä¸€éƒ¨åˆ†ç¥ç»å…ƒï¼Œå°†æ¿€æ´»ä¿¡æ¯å‘åä¼ å…¥ä¸‹ä¸€å±‚ç¥ç»ç½‘ç»œã€‚ç¥ç»ç½‘ç»œä¹‹æ‰€ä»¥èƒ½è§£å†³éçº¿æ€§é—®é¢˜ï¼Œå¦‚è¯­éŸ³å’Œå›¾åƒï¼Œæœ¬è´¨ä¸Šå°±æ˜¯æ¿€æ´»å‡½æ•°åŠ å…¥äº†éçº¿æ€§çš„å› ç´ ï¼Œå¼¥è¡¥äº†çº¿æ€§æ¨¡å‹çš„è¡¨è¾¾åŠ›ï¼ŒæŠŠâ€œæ¿€æ´»çš„ç¥ç»å…ƒçš„ç‰¹å¾â€é€šè¿‡å‡½æ•°ä¿ç•™å¹¶æ˜ å°„åˆ°ä¸‹ä¸€å±‚ã€‚</p><p>å› ä¸ºç¥ç»ç½‘ç»œçš„æ•°å­¦åŸºç¡€æ˜¯å¤„å¤„å¯å¾®ï¼Œæ‰€ä»¥é€‰å–çš„æ¿€æ´»å‡½æ•°è¦èƒ½ä¿è¯æ•°æ®è¾“å…¥ä¸è¾“å‡ºä¹Ÿæ˜¯å¯å¾®çš„ï¼Œä»‹ç»å››ç§å‡½æ•°ï¼š</p><ul><li>sigmoid</li></ul><img src="/2018/07/14/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%AE%80%E8%BF%B0/sigmoid.svg" class="" title="sigmoid"><img src="/2018/07/14/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%AE%80%E8%BF%B0/sigmoid.png" class="" title="sigmoid"><p>sigmoidå‡½æ•°æ˜¯ä¼ ç»Ÿç¥ç»ç½‘ç»œä¸­æœ€å¸¸ç”¨çš„æ¿€æ´»å‡½æ•°ä¹‹ä¸€ï¼Œå®ƒçš„ä¼˜ç‚¹åœ¨äºï¼Œå®ƒçš„è¾“å‡ºæ˜ å°„åœ¨(0, 1)å†…ï¼Œå•è°ƒè¿ç»­ï¼Œéå¸¸é€‚åˆä½œä¸ºè¾“å‡ºå±‚ï¼Œå¹¶ä¸”æ±‚å¯¼æ¯”è¾ƒå®¹æ˜“ï¼Œç¼ºç‚¹ä¹Ÿæ¯”è¾ƒæ˜æ˜¾ï¼Œå› ä¸ºè½¯é¥±å’Œæ€§ï¼Œä¸€æ—¦è½å…¥é¥±å’ŒåŒºï¼Œfâ€™(x)å°±ä¼šå˜å¾—æ¥è¿‘0ï¼Œå¾ˆå®¹æ˜“äº§ç”Ÿé˜¶æ¢¯æ¶ˆå¤±ã€‚</p><ul><li>tanh</li></ul><img src="/2018/07/14/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%AE%80%E8%BF%B0/tanh.jpg" class=""><img src="/2018/07/14/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%AE%80%E8%BF%B0/TanhReal.gif" class=""><p>tanhå‡½æ•°ä¹Ÿå…·æœ‰è½¯é¥±å’Œæ€§ï¼Œå› ä¸ºå®ƒçš„è¾“å‡ºä»¥0ä¸ºä¸­å¿ƒï¼Œæ”¶æ•›é€Ÿåº¦æ¯”sigmoidè¦å¿«ï¼Œä½†æ˜¯ä»ç„¶æ— æ³•è§£å†³æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ã€‚</p><ul><li>relu</li></ul><img src="/2018/07/14/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%AE%80%E8%BF%B0/relu.svg" class=""><img src="/2018/07/14/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%AE%80%E8%BF%B0/relu.png" class=""><p>reluæ˜¯ç›®å‰æœ€å—æ¬¢è¿çš„æ¿€æ´»å‡½æ•°ï¼Œsoftpluså¯ä»¥çœ‹åšæ˜¯reluçš„å¹³æ»‘ç‰ˆæœ¬ã€‚ä½¿ç”¨çº¿æ€§æ•´æµï¼ˆRectified Linear Units, ReLUï¼‰f(x)&#x3D;max(0,x)ä½œä¸ºè¿™ä¸€å±‚ç¥ç»çš„æ¿€åŠ±å‡½æ•°ï¼ˆActivation functionï¼‰ã€‚å®ƒå¯ä»¥å¢å¼ºåˆ¤å®šå‡½æ•°å’Œæ•´ä¸ªç¥ç»ç½‘ç»œçš„éçº¿æ€§ç‰¹æ€§ï¼Œè€Œæœ¬èº«å¹¶ä¸ä¼šæ”¹å˜å·ç§¯å±‚ã€‚</p><ul><li>dropout</li></ul><p>ä¸€ä¸ªç¥ç»å…ƒå°†ä»¥æ¦‚ç‡å†³å®šæ˜¯å¦è¦è¢«æŠ‘åˆ¶ï¼Œè¢«æŠ‘åˆ¶çš„ç¥ç»å…ƒä¼šè¢«æš‚æ—¶è®¤ä¸ºä¸å±äºç½‘ç»œï¼Œä½†æ˜¯å®ƒçš„æƒé‡å°†ä¼šè¢«ä¿ç•™ã€‚</p><h3 id="æ± åŒ–å±‚"><a href="#æ± åŒ–å±‚" class="headerlink" title="æ± åŒ–å±‚"></a>æ± åŒ–å±‚</h3><p>æ± åŒ–æ˜¯å·ç§¯ç¥ç»ç½‘ç»œä¸­å¦å¤–ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µã€‚å®ƒå®é™…ä¸Šæ˜¯å½¢å¼çš„é™é‡‡æ ·ã€‚æœ‰å¤šç§ä¸åŒå½¢å¼çš„éçº¿æ€§æ± åŒ–å‡½æ•°ï¼Œè€Œå…¶ä¸­â€œæœ€å¤§æ± åŒ–â€æ˜¯æœ€ä¸ºå¸¸è§çš„ã€‚å®ƒæ˜¯å°†è¾“å…¥çš„å›¾åƒåˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªçŸ©å½¢åŒºåŸŸï¼Œå¯¹æ¯ä¸ªå­åŒºåŸŸè¾“å‡ºæœ€å¤§å€¼ã€‚ç›´è§‰ä¸Šï¼Œè¿™ç§æœºåˆ¶èƒ½å¤Ÿæœ‰æ•ˆåœ°åŸå› åœ¨äºï¼Œåœ¨å‘ç°ä¸€ä¸ªç‰¹å¾ä¹‹åï¼Œå®ƒçš„ç²¾ç¡®ä½ç½®è¿œä¸åŠå®ƒå’Œå…¶ä»–ç‰¹å¾çš„ç›¸å¯¹ä½ç½®çš„å…³ç³»é‡è¦ã€‚æ± åŒ–å±‚ä¼šä¸æ–­åœ°å‡å°æ•°æ®çš„ç©ºé—´å¤§å°ï¼Œå› æ­¤å‚æ•°çš„æ•°é‡å’Œè®¡ç®—é‡ä¹Ÿä¼šä¸‹é™ï¼Œè¿™åœ¨ä¸€å®šç¨‹åº¦ä¸Šä¹Ÿæ§åˆ¶äº†è¿‡æ‹Ÿåˆã€‚é€šå¸¸æ¥è¯´ï¼ŒCNNçš„å·ç§¯å±‚ä¹‹é—´éƒ½ä¼šå‘¨æœŸæ€§åœ°æ’å…¥æ± åŒ–å±‚ã€‚</p><p>æ± åŒ–å±‚é€šå¸¸ä¼šåˆ†åˆ«ä½œç”¨äºæ¯ä¸ªè¾“å…¥çš„ç‰¹å¾å¹¶å‡å°å…¶å¤§å°ã€‚ç›®å‰æœ€å¸¸ç”¨å½¢å¼çš„æ± åŒ–å±‚æ˜¯æ¯éš”2ä¸ªå…ƒç´ ä»å›¾åƒåˆ’åˆ†å‡º2x2çš„åŒºå—ï¼Œç„¶åå¯¹æ¯ä¸ªåŒºå—ä¸­çš„4ä¸ªæ•°å–æœ€å¤§å€¼ã€‚è¿™å°†ä¼šå‡å°‘75%çš„æ•°æ®é‡ã€‚</p><p>é™¤äº†æœ€å¤§æ± åŒ–ä¹‹å¤–ï¼Œæ± åŒ–å±‚ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–æ± åŒ–å‡½æ•°ï¼Œä¾‹å¦‚â€œå¹³å‡æ± åŒ–â€ç”šè‡³â€œL2-èŒƒæ•°æ± åŒ–â€ç­‰ã€‚è¿‡å»ï¼Œå¹³å‡æ± åŒ–çš„ä½¿ç”¨æ›¾ç»è¾ƒä¸ºå¹¿æ³›ï¼Œä½†æ˜¯æœ€è¿‘ç”±äºæœ€å¤§æ± åŒ–åœ¨å®è·µä¸­çš„è¡¨ç°æ›´å¥½ï¼Œå¹³å‡æ± åŒ–å·²ç»ä¸å¤ªå¸¸ç”¨ã€‚</p><p>ç”±äºæ± åŒ–å±‚è¿‡å¿«åœ°å‡å°‘äº†æ•°æ®çš„å¤§å°ï¼Œç›®å‰æ–‡çŒ®ä¸­çš„è¶‹åŠ¿æ˜¯ä½¿ç”¨è¾ƒå°çš„æ± åŒ–æ»¤é•œï¼Œç”šè‡³ä¸å†ä½¿ç”¨æ± åŒ–å±‚ã€‚</p><h3 id="æŸå¤±å‡½æ•°å±‚"><a href="#æŸå¤±å‡½æ•°å±‚" class="headerlink" title="æŸå¤±å‡½æ•°å±‚"></a>æŸå¤±å‡½æ•°å±‚</h3><p>æŸå¤±å‡½æ•°å±‚ç”¨äºå†³å®šè®­ç»ƒè¿‡ç¨‹å¦‚ä½•æ¥â€œæƒ©ç½šâ€ç½‘ç»œçš„é¢„æµ‹ç»“æœå’ŒçœŸå®ç»“æœä¹‹é—´çš„å·®å¼‚ï¼Œå®ƒé€šå¸¸æ˜¯ç½‘ç»œçš„æœ€åä¸€å±‚ã€‚å„ç§ä¸åŒçš„æŸå¤±å‡½æ•°é€‚ç”¨äºä¸åŒç±»å‹çš„ä»»åŠ¡ã€‚ä¾‹å¦‚ï¼ŒSoftmaxäº¤å‰ç†µæŸå¤±å‡½æ•°å¸¸å¸¸è¢«ç”¨äºåœ¨Kä¸ªç±»åˆ«ä¸­é€‰å‡ºä¸€ä¸ªï¼Œè€ŒSigmoidäº¤å‰ç†µæŸå¤±å‡½æ•°å¸¸å¸¸ç”¨äºå¤šä¸ªç‹¬ç«‹çš„äºŒåˆ†ç±»é—®é¢˜ã€‚æ¬§å‡ é‡Œå¾·æŸå¤±å‡½æ•°å¸¸å¸¸ç”¨äºç»“æœå–å€¼èŒƒå›´ä¸ºä»»æ„å®æ•°çš„é—®é¢˜ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Deep Learning </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Deep Learning </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ·±åº¦å­¦ä¹ ç¬”è®°</title>
      <link href="/2018/07/14/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
      <url>/2018/07/14/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<p>æœºå™¨å­¦ä¹ ï¼Œé¡¾åæ€ä¹‰å½“ç„¶æ˜¯ç”¨æœºå™¨æ¥å­¦ä¹ ã€‚æœ¬æ–‡å®Œã€‚</p><span id="more"></span><p>ä¸Šé¢çš„è¯æ˜¯å¼€ç©ç¬‘ï¼Œå„ä½å®¢å®˜ä¸è¦èµ°â€¦</p><h2 id="äººå·¥æ™ºèƒ½"><a href="#äººå·¥æ™ºèƒ½" class="headerlink" title="äººå·¥æ™ºèƒ½"></a><strong>äººå·¥æ™ºèƒ½</strong></h2><p>äººå·¥æ™ºèƒ½å…¶å®ä¸ç®—æ–°åè¯ï¼Œåœ¨äººç±»å†å²çš„é•¿æ²³ä¸­ï¼Œå°±æœ‰è¿‡å¾ˆå¤šå…³äºæŠ€è‰ºé«˜è¶…çš„å·¥åŒ åˆ¶é€ äººé€ äººï¼Œå¹¶èµ‹äºˆæ™ºæ…§ã€‚ç°ä»£çš„äººå·¥æ™ºèƒ½åˆ™å§‹äºå¤å…¸å“²å­¦å®¶ç”¨æœºæ¢°ç¬¦å·çš„è§‚ç‚¹æ¥è§£é‡Šäººç±»æ€è€ƒè¿‡ç¨‹çš„å°è¯•ã€‚</p><p>20ä¸–çºª50å¹´ä»£ï¼Œäººç±»ä¿¡å¿ƒæ»¡æ»¡çš„å¼€å§‹äº†äººå·¥æ™ºèƒ½çš„å¾é€”ï¼Œä½†æ˜¯è¿™è¶Ÿæ—…ç¨‹å¹¶ä¸å¹³å¦ï¼Œ1973å¹´ç¾è‹±ä¸¤å›½æ”¿åºœåœæ­¢äº†æ²¡æœ‰æ˜ç¡®ç›®æ ‡çš„äººå·¥æ™ºèƒ½é¡¹ç›®çš„ç ”ç©¶ã€‚ä¸ƒå¹´ååˆå—åˆ°æ—¥æœ¬æ”¿åºœç ”ç©¶è§„åˆ’çš„åˆºæ¿€ï¼Œåˆæ¢å¤äº†æ‹¨æ¬¾ï¼Œä½†æ˜¯åœ¨80å¹´ä»£æœ«å†æ¬¡åœæ­¢äº†æ‹¨æ¬¾ã€‚äººå·¥æ™ºèƒ½çš„ç ”ç©¶å°±è¿™æ ·åœ¨è·Œå®•èµ·ä¼ä¸­ä¸æ–­çš„å‰è¿›ã€‚</p><p>æ—¶å…‰èè‹’ï¼Œäººç±»è¿›å…¥äº†21ä¸–çºªï¼Œè¿™æ¬¡äººå·¥æ™ºèƒ½é¢†åŸŸç»ˆäºè¿æ¥äº†æ–°çš„äººç”Ÿï¼Œè®¡ç®—æœºå·²ç»å¾—åˆ°äº†å……è¶³çš„å‘å±•ï¼Œè®¡ç®—èƒ½åŠ›ä¸æ—¥ä¿±å¢ï¼Œæ›¾ç»å› ä¸ºè®¡ç®—èƒ½åŠ›ä¸è¶³å¯¼è‡´æ— æ³•ç ”ç©¶çš„é¡¹ç›®å’Œç®—æ³•ä¹Ÿå¯ä»¥å¾—åˆ°é‡æ–°çš„éªŒè¯ï¼Œå½“ç„¶é™¤äº†è®¡ç®—èƒ½åŠ›æå‡å¸¦æ¥çš„æå‡ï¼Œæ›´å¤šçš„æ˜¯å¹•åçš„å·¥ä½œè€…ä¸æ–­çš„æ”¹è¿›å’Œå®Œå–„å„ç§ç®—æ³•ï¼Œå¯¹ä¸åŒçš„è¯¾é¢˜è¿›è¡Œé•¿æœŸæ·±åº¦çš„ç ”ç©¶ã€‚</p><p>äººå·¥æ™ºèƒ½å†æ¬¡è¿›å…¥å¤§ä¼—è§†é‡æ˜¯2016å¹´ï¼Œæ¥è‡ªGoogleå…¬å¸çš„AlphaGoæˆåŠŸå‡»è´¥äº†éŸ©å›½é€‰æ‰‹æä¸–çŸ³ï¼Œæˆä¸ºç¬¬ä¸€ä¸ªåœ¨å›´æ£‹ä¸Šæˆ˜èƒœäººç±»çš„äººå·¥æ™ºèƒ½ï¼Œç«‹ä¸‹äº†é‡Œç¨‹ç¢‘ã€‚åœ¨AlphaGoè¿›è¡Œæ¯”èµ›å‰ï¼Œäººç±»è¿˜è‡ªä¿¡çš„è®¤ä¸ºæœºå™¨æ— æ³•åœ¨å›´æ£‹èµ¢å¾—èƒœåˆ©(<del>äººç±»ç–¯ç‹‚çš„å¥¶è‡ªå·±â€¦</del>)ã€‚</p><p>AlphaGoé‡‡ç”¨äº†è’™ç‰¹å¡æ´›æ ‘æœç´¢å’Œä¸¤ä¸ªæ·±åº¦ç¥ç»ç½‘ç»œç»“åˆçš„åŠæ³•ï¼Œè’™ç‰¹å¡æ´›æ ‘æœç´¢æ˜¯åŸºäºæŸç§å†³ç­–è¿‡ç¨‹çš„å¯å‘å¼æœç´¢ç®—æ³•ï¼Œä¸¤ä¸ªæ·±åº¦ç¥ç»ç½‘ç»œä¸€ä¸ªä»¥ä¼°å€¼ç½‘ç»œæ¥è¯„ä¼°å¤§é‡çš„é€‰ç‚¹ï¼Œä¸€ä¸ªåˆ™ä»¥èµ°æ£‹ç½‘ç»œæ¥é€‰æ‹©è½å­ï¼Œåœ¨è¿™ç§è®¾è®¡ä¸‹ï¼Œç³»ç»Ÿå¯ä»¥ç»“åˆæ ‘æœç´¢æ¥é•¿è¿œæ¨æ–­ï¼Œå°±åƒäººè„‘ä¸€æ ·è¯„ä¼°è½ç‚¹ï¼Œæé«˜ä¸‹æ£‹èƒ½åŠ›ã€‚</p><h2 id="äººå·¥æ™ºèƒ½ã€æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ çš„åŒºåˆ«"><a href="#äººå·¥æ™ºèƒ½ã€æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ çš„åŒºåˆ«" class="headerlink" title="äººå·¥æ™ºèƒ½ã€æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ çš„åŒºåˆ«"></a><strong>äººå·¥æ™ºèƒ½ã€æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ çš„åŒºåˆ«</strong></h2><p>æˆ‘ä¹Ÿå¯¹è¿™ä¸‰ä¸ªåè¯äº§ç”Ÿè¿‡ç–‘é—®ï¼Œå…¶å®å¾ˆç®€å•ï¼š</p><ul><li>äººå·¥æ™ºèƒ½ï¼š äººå·¥å®ç°çš„æ™ºèƒ½</li><li>æœºå™¨å­¦ä¹ ï¼š ä¸€ç§äººå·¥æ™ºèƒ½çš„å®ç°æ–¹æ³•</li><li>æ·±åº¦å­¦ä¹ ï¼š ä¸€ç§æœºå™¨å­¦ä¹ çš„å®ç°æ–¹æ³•</li></ul><h3 id="æœºå™¨å­¦ä¹ "><a href="#æœºå™¨å­¦ä¹ " class="headerlink" title="æœºå™¨å­¦ä¹ "></a>æœºå™¨å­¦ä¹ </h3><p>æœºå™¨å­¦ä¹ æ˜¯äººå·¥æ™ºèƒ½çš„ä¸€ä¸ªåˆ†æ”¯ï¼Œäººå·¥æ™ºèƒ½çš„ç ”ç©¶å†å²ä¸­æœ‰ä¸€æ¡ä»¥â€œæ¨ç†â€ä¸ºé‡ç‚¹ï¼Œåˆ°ä»¥â€œçŸ¥è¯†â€ä¸ºé‡ç‚¹ï¼Œå†åˆ°ä»¥â€œå­¦ä¹ â€ä¸ºé‡ç‚¹çš„è‡ªç„¶ã€æ¸…æ™°çš„è„‰ç»œã€‚æ˜¾ç„¶æœºå™¨å­¦ä¹ æ˜¯æ˜¯å®ç°äººå·¥æ™ºèƒ½çš„ä¸€æ¡é€”å¾„ï¼Œå³ä»¥æœºå™¨å­¦ä¹ ä¸ºæ‰‹æ®µè§£å†³äººå·¥æ™ºèƒ½ä¸­çš„é—®é¢˜ã€‚</p><p>æœºå™¨å­¦ä¹ åœ¨è¿‘30å¤šå¹´å·²å‘å±•ä¸ºä¸€é—¨å¤šé¢†åŸŸäº¤å‰å­¦ç§‘ï¼Œæ¶‰åŠæ¦‚ç‡è®ºã€ç»Ÿè®¡å­¦ã€é€¼è¿‘è®ºã€å‡¸åˆ†æã€è®¡ç®—å¤æ‚æ€§ç†è®ºç­‰å¤šé—¨å­¦ç§‘ã€‚æœºå™¨å­¦ä¹ ç†è®ºä¸»è¦æ˜¯è®¾è®¡å’Œåˆ†æä¸€äº›è®©è®¡ç®—æœºå¯ä»¥è‡ªåŠ¨â€œå­¦ä¹ â€çš„ç®—æ³•ã€‚æœºå™¨å­¦ä¹ ç®—æ³•æ˜¯ä¸€ç±»ä»æ•°æ®ä¸­è‡ªåŠ¨åˆ†æè·å¾—è§„å¾‹ï¼Œå¹¶åˆ©ç”¨è§„å¾‹å¯¹æœªçŸ¥æ•°æ®è¿›è¡Œé¢„æµ‹çš„ç®—æ³•ã€‚å› ä¸ºå­¦ä¹ ç®—æ³•ä¸­æ¶‰åŠäº†å¤§é‡çš„ç»Ÿè®¡å­¦ç†è®ºï¼Œæœºå™¨å­¦ä¹ ä¸æ¨æ–­ç»Ÿè®¡å­¦è”ç³»å°¤ä¸ºå¯†åˆ‡ï¼Œä¹Ÿè¢«ç§°ä¸ºç»Ÿè®¡å­¦ä¹ ç†è®ºã€‚ç®—æ³•è®¾è®¡æ–¹é¢ï¼Œæœºå™¨å­¦ä¹ ç†è®ºå…³æ³¨å¯ä»¥å®ç°çš„ï¼Œè¡Œä¹‹æœ‰æ•ˆçš„å­¦ä¹ ç®—æ³•ã€‚å¾ˆå¤šæ¨è®ºé—®é¢˜å±äºæ— ç¨‹åºå¯å¾ªéš¾åº¦ï¼Œæ‰€ä»¥éƒ¨åˆ†çš„æœºå™¨å­¦ä¹ ç ”ç©¶æ˜¯å¼€å‘å®¹æ˜“å¤„ç†çš„è¿‘ä¼¼ç®—æ³•ã€‚</p><h3 id="æœºå™¨å­¦ä¹ çš„åº”ç”¨"><a href="#æœºå™¨å­¦ä¹ çš„åº”ç”¨" class="headerlink" title="æœºå™¨å­¦ä¹ çš„åº”ç”¨"></a>æœºå™¨å­¦ä¹ çš„åº”ç”¨</h3><p>æœºå™¨å­¦ä¹ å·²å¹¿æ³›åº”ç”¨äºæ•°æ®æŒ–æ˜ã€è®¡ç®—æœºè§†è§‰ã€è‡ªç„¶è¯­è¨€å¤„ç†ã€ç”Ÿç‰©ç‰¹å¾è¯†åˆ«ã€æœç´¢å¼•æ“ã€åŒ»å­¦è¯Šæ–­ã€æ£€æµ‹ä¿¡ç”¨å¡æ¬ºè¯ˆã€è¯åˆ¸å¸‚åœºåˆ†æã€DNAåºåˆ—æµ‹åºã€è¯­éŸ³å’Œæ‰‹å†™è¯†åˆ«ã€æˆ˜ç•¥æ¸¸æˆå’Œæœºå™¨äººç­‰é¢†åŸŸã€‚</p><h3 id="æœºå™¨å­¦ä¹ çš„å®šä¹‰"><a href="#æœºå™¨å­¦ä¹ çš„å®šä¹‰" class="headerlink" title="æœºå™¨å­¦ä¹ çš„å®šä¹‰"></a>æœºå™¨å­¦ä¹ çš„å®šä¹‰</h3><p>æœºå™¨å­¦ä¹ æœ‰ä¸‹é¢å‡ ç§å®šä¹‰ï¼š</p><ul><li>æœºå™¨å­¦ä¹ æ˜¯ä¸€é—¨äººå·¥æ™ºèƒ½çš„ç§‘å­¦ï¼Œè¯¥é¢†åŸŸçš„ä¸»è¦ç ”ç©¶å¯¹è±¡æ˜¯äººå·¥æ™ºèƒ½ï¼Œç‰¹åˆ«æ˜¯å¦‚ä½•åœ¨ç»éªŒå­¦ä¹ - ä¸­æ”¹å–„å…·ä½“ç®—æ³•çš„æ€§èƒ½ã€‚</li><li>æœºå™¨å­¦ä¹ æ˜¯å¯¹èƒ½é€šè¿‡ç»éªŒè‡ªåŠ¨æ”¹è¿›çš„è®¡ç®—æœºç®—æ³•çš„ç ”ç©¶ã€‚</li><li>æœºå™¨å­¦ä¹ æ˜¯ç”¨æ•°æ®æˆ–ä»¥å¾€çš„ç»éªŒï¼Œä»¥æ­¤ä¼˜åŒ–è®¡ç®—æœºç¨‹åºçš„æ€§èƒ½æ ‡å‡†ã€‚</li></ul><h3 id="æœºå™¨å­¦ä¹ çš„åˆ†ç±»"><a href="#æœºå™¨å­¦ä¹ çš„åˆ†ç±»" class="headerlink" title="æœºå™¨å­¦ä¹ çš„åˆ†ç±»"></a>æœºå™¨å­¦ä¹ çš„åˆ†ç±»</h3><p>æœºå™¨å­¦ä¹ å¯ä»¥å¤§æ¦‚åˆ†ä¸ºä»¥ä¸‹å‡ ç±»ï¼š</p><ul><li>ç›‘ç£å­¦ä¹ ï¼šä»ç»™å®šçš„è®­ç»ƒæ•°æ®é›†ä¸­å­¦ä¹ å‡ºä¸€ä¸ªå‡½æ•°ï¼Œå½“æ–°çš„æ•°æ®åˆ°æ¥æ—¶ï¼Œå¯ä»¥æ ¹æ®è¿™ä¸ªå‡½æ•°é¢„æµ‹ç»“æœã€‚ç›‘ç£å­¦ä¹ çš„è®­ç»ƒé›†è¦æ±‚æ˜¯åŒ…æ‹¬è¾“å…¥å’Œè¾“å‡ºï¼Œä¹Ÿå¯ä»¥è¯´æ˜¯ç‰¹å¾å’Œç›®æ ‡ã€‚è®­ç»ƒé›†ä¸­çš„ç›®æ ‡æ˜¯ç”±äººæ ‡æ³¨çš„ã€‚å¸¸è§çš„ç›‘ç£å­¦ä¹ ç®—æ³•åŒ…æ‹¬å›å½’åˆ†æå’Œç»Ÿè®¡åˆ†ç±»ã€‚</li><li>åŠç›‘ç£å­¦ä¹ ï¼š ä»‹äºç›‘ç£å­¦ä¹ ä¸æ— ç›‘ç£å­¦ä¹ ä¹‹é—´ã€‚</li><li>æ— ç›‘ç£å­¦ä¹ ï¼š ä¸ç›‘ç£å­¦ä¹ ç›¸æ¯”ï¼Œè®­ç»ƒé›†æ²¡æœ‰äººä¸ºæ ‡æ³¨çš„ç»“æœã€‚å¸¸è§çš„æ— ç›‘ç£å­¦ä¹ ç®—æ³•æœ‰ç”Ÿæˆå¯¹æŠ—ç½‘ç»œï¼ˆGANï¼‰ã€èšç±»ã€‚</li><li>å¼ºåŒ–å­¦ä¹ ï¼š é€šè¿‡è§‚å¯Ÿæ¥å­¦ä¹ åšæˆå¦‚ä½•çš„åŠ¨ä½œã€‚æ¯ä¸ªåŠ¨ä½œéƒ½ä¼šå¯¹ç¯å¢ƒæœ‰æ‰€å½±å“ï¼Œå­¦ä¹ å¯¹è±¡æ ¹æ®è§‚å¯Ÿåˆ°çš„å‘¨å›´ç¯å¢ƒçš„åé¦ˆæ¥åšå‡ºåˆ¤æ–­ã€‚</li></ul><p>ç›‘ç£å­¦ä¹ å’Œæ— ç›‘ç£å­¦ä¹ çš„å·®åˆ«åœ¨äºè®­ç»ƒæ•°æ®æ˜¯å¦äººä¸ºæ ‡è®°ï¼Œä»–ä»¬éƒ½æœ‰è®­ç»ƒé›†ï¼Œéƒ½æœ‰è¾“å…¥è¾“å‡ºã€‚</p><h3 id="æœºå™¨å­¦ä¹ çš„ç®—æ³•"><a href="#æœºå™¨å­¦ä¹ çš„ç®—æ³•" class="headerlink" title="æœºå™¨å­¦ä¹ çš„ç®—æ³•"></a>æœºå™¨å­¦ä¹ çš„ç®—æ³•</h3><p>å…·ä½“çš„æœºå™¨å­¦ä¹ ç®—æ³•æœ‰ï¼š</p><ul><li>æ„é€ é—´éš”ç†è®ºåˆ†å¸ƒï¼šèšç±»åˆ†æå’Œæ¨¡å¼è¯†åˆ«<ul><li>äººå·¥ç¥ç»ç½‘ç»œ</li><li>å†³ç­–æ ‘</li><li>æ„ŸçŸ¥å™¨</li><li>æ”¯æŒå‘é‡æœº</li><li>é›†æˆå­¦ä¹ AdaBoost</li><li>é™ç»´ä¸åº¦é‡å­¦ä¹ </li><li>èšç±»</li><li>è´å¶æ–¯åˆ†ç±»å™¨</li></ul></li><li>æ„é€ æ¡ä»¶æ¦‚ç‡ï¼šå›å½’åˆ†æå’Œç»Ÿè®¡åˆ†ç±»<ul><li>é«˜æ–¯è¿‡ç¨‹å›å½’</li><li>çº¿æ€§åˆ¤åˆ«åˆ†æ</li><li>æœ€è¿‘é‚»å±…æ³•</li><li>å¾„å‘åŸºå‡½æ•°æ ¸</li></ul></li><li>é€šè¿‡å†ç”Ÿæ¨¡å‹æ„é€ æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼š<ul><li>æœ€å¤§æœŸæœ›ç®—æ³•</li><li>æ¦‚ç‡å›¾æ¨¡å‹ï¼šåŒ…æ‹¬è´å¶æ–¯ç½‘å’ŒMarkovéšæœºåœº</li><li>Generative Topographic Mapping</li></ul></li><li>è¿‘ä¼¼æ¨æ–­æŠ€æœ¯ï¼š<ul><li>é©¬å°”å¯å¤«é“¾</li><li>è’™ç‰¹å¡ç½—æ–¹æ³•</li><li>å˜åˆ†æ³•</li></ul></li><li>æœ€ä¼˜åŒ–ï¼šå¤§å¤šæ•°ä»¥ä¸Šæ–¹æ³•ï¼Œç›´æ¥æˆ–è€…é—´æ¥ä½¿ç”¨æœ€ä¼˜åŒ–ç®—æ³•ã€‚</li></ul><h2 id="äººå·¥ç¥ç»ç½‘ç»œ"><a href="#äººå·¥ç¥ç»ç½‘ç»œ" class="headerlink" title="äººå·¥ç¥ç»ç½‘ç»œ"></a>äººå·¥ç¥ç»ç½‘ç»œ</h2><p>åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œç›®å‰åº”ç”¨æœ€å¹¿æ³›çš„æ˜¯äººå·¥ç¥ç»ç½‘ç»œ(Artificial Neural Networkï¼ŒANN)ï¼Œç®€ç§°ç¥ç»ç½‘ç»œã€‚æ˜¯ä¸€ç§æ¨¡ä»¿ç”Ÿç‰©ç¥ç»ç½‘ç»œçš„ç»“æ„å’ŒåŠŸèƒ½çš„æ•°å­¦æ¨¡å‹æˆ–è®¡ç®—æ¨¡å‹ï¼Œç”¨äºå¯¹å‡½æ•°è¿›è¡Œä¼°è®¡å’Œè¿‘ä¼¼ã€‚ç¥ç»ç½‘ç»œç”±å¤§é‡çš„äººå·¥ç¥ç»å…ƒè¿ç»“è¿›è¡Œè®¡ç®—ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹äººå·¥ç¥ç»ç½‘ç»œèƒ½åœ¨å¤–ç•Œä¿¡æ¯çš„åŸºç¡€ä¸Šæ”¹å˜å†…éƒ¨ç»“æ„ï¼Œæ˜¯ä¸€ç§è‡ªé€‚åº”ç³»ç»Ÿï¼Œé€šä¿—å«å…·å¤‡å­¦ä¹ èƒ½åŠ›ã€‚</p><h3 id="äººå·¥ç¥ç»ç½‘ç»œçš„ç»„æˆ"><a href="#äººå·¥ç¥ç»ç½‘ç»œçš„ç»„æˆ" class="headerlink" title="äººå·¥ç¥ç»ç½‘ç»œçš„ç»„æˆ"></a>äººå·¥ç¥ç»ç½‘ç»œçš„ç»„æˆ</h3><p>ç°ä»£ç¥ç»ç½‘ç»œæ˜¯ä¸€ç§éçº¿æ€§ç»Ÿè®¡è¡Œæ•°æ®å»ºæ¨¡å·¥å…·ï¼Œå…¸å‹çš„ç¥ç»ç½‘ç»œå…·æœ‰ä»¥ä¸‹ä¸‰ä¸ªéƒ¨åˆ†ï¼š</p><ul><li>ç»“æ„(Architecture): æŒ‡å®šäº†ç½‘ç»œä¸­çš„å˜é‡å’Œå®ƒä»¬çš„æ‹“æ‰‘å…³ç³»ã€‚ä¾‹å¦‚ï¼Œç¥ç»ç½‘ç»œä¸­çš„å˜é‡å¯ä»¥æ˜¯ç¥ç»å…ƒè¿æ¥çš„æƒé‡ï¼ˆweightsï¼‰å’Œç¥ç»å…ƒçš„æ¿€åŠ±å€¼ï¼ˆactivities of the neuronsï¼‰ã€‚</li><li>æ¿€åŠ±å‡½æ•°(Activity Rule): å¤§éƒ¨åˆ†ç¥ç»ç½‘ç»œå…·æœ‰ä¸€ä¸ªçŸ­æ—¶é—´å°ºåº¦çš„åŠ¨åŠ›å­¦è§„åˆ™ï¼Œæ¥å®šä¹‰ç¥ç»å…ƒå¦‚ä½•æ ¹æ®å…¶ä»–ç¥ç»å…ƒçš„æ´»åŠ¨æ¥æ”¹å˜è‡ªå·±çš„æ¿€åŠ±å€¼ã€‚ä¸€èˆ¬æ¿€åŠ±å€¼ä¾èµ–äºç½‘ç»œä¸­çš„æƒé‡(å³è¯¥ç½‘ç»œä¸­çš„å‚æ•°)ã€‚</li><li>å­¦ä¹ è§„åˆ™(Learning Rule): å­¦ä¹ è§„åˆ™æŒ‡å®šäº†ç½‘ç»œä¸­çš„æƒé‡å¦‚ä½•éšç€æ—¶é—´æ¨è¿›è€Œè°ƒæ•´ã€‚è¿™ä¸€èˆ¬è¢«çœ‹åšæ˜¯ä¸€ç§é•¿æ—¶é—´å°ºåº¦çš„åŠ¨åŠ›å­¦è§„åˆ™ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå­¦ä¹ è§„åˆ™ä¾èµ–äºç¥ç»å…ƒçš„æ¿€åŠ±å€¼ã€‚å®ƒä¹Ÿå¯èƒ½ä¾èµ–äºç›‘ç£è€…æä¾›çš„ç›®æ ‡å€¼å’Œå½“å‰æƒé‡çš„å€¼ã€‚ä¾‹å¦‚ï¼Œç”¨äºæ‰‹å†™è¯†åˆ«çš„ä¸€ä¸ªç¥ç»ç½‘ç»œï¼Œæœ‰ä¸€ç»„è¾“å…¥ç¥ç»å…ƒã€‚è¾“å…¥ç¥ç»å…ƒä¼šè¢«è¾“å…¥å›¾åƒçš„æ•°æ®æ‰€æ¿€å‘ã€‚åœ¨æ¿€åŠ±å€¼è¢«åŠ æƒå¹¶é€šè¿‡ä¸€ä¸ªå‡½æ•°ï¼ˆç”±ç½‘ç»œçš„è®¾è®¡è€…ç¡®å®šï¼‰åï¼Œè¿™äº›ç¥ç»å…ƒçš„æ¿€åŠ±å€¼è¢«ä¼ é€’åˆ°å…¶ä»–ç¥ç»å…ƒã€‚è¿™ä¸ªè¿‡ç¨‹ä¸æ–­é‡å¤ï¼Œç›´åˆ°è¾“å‡ºç¥ç»å…ƒè¢«æ¿€å‘ã€‚æœ€åï¼Œè¾“å‡ºç¥ç»å…ƒçš„æ¿€åŠ±å€¼å†³å®šäº†è¯†åˆ«å‡ºæ¥çš„æ˜¯å“ªä¸ªå­—æ¯ã€‚</li></ul><hr><p>åœ¨è¿™é‡Œæˆ‘æ¨èè§‚çœ‹3Blue1Brownçš„ä¸‰æœŸè§†é¢‘ã€‚</p><p><a href="https://www.bilibili.com/video/av15532370">æ·±åº¦å­¦ä¹ ä¹‹ç¥ç»ç½‘ç»œçš„ç»“æ„ Part 1 ver 2.0</a></p><p><a href="https://www.bilibili.com/video/av16144388/">æ·±åº¦å­¦ä¹ ä¹‹æ¢¯åº¦ä¸‹é™æ³• Part 2 ver 0.9 beta</a></p><p><a href="https://www.bilibili.com/video/av16577449/">æ·±åº¦å­¦ä¹ ä¹‹åå‘ä¼ æ’­ç®—æ³• ä¸Š&#x2F;ä¸‹ Part 3 ver 0.9 beta</a></p><hr><h3 id="äººå·¥ç¥ç»ç½‘ç»œçš„åŸºç¡€"><a href="#äººå·¥ç¥ç»ç½‘ç»œçš„åŸºç¡€" class="headerlink" title="äººå·¥ç¥ç»ç½‘ç»œçš„åŸºç¡€"></a>äººå·¥ç¥ç»ç½‘ç»œçš„åŸºç¡€</h3><p>ç¥ç»ç½‘ç»œçš„æ„ç­‘ç†å¿µæ˜¯å—åˆ°ç”Ÿç‰©ï¼ˆäººæˆ–å…¶ä»–åŠ¨ç‰©ï¼‰ç¥ç»ç½‘ç»œåŠŸèƒ½çš„è¿ä½œå¯å‘è€Œäº§ç”Ÿçš„ã€‚äººå·¥ç¥ç»ç½‘ç»œé€šå¸¸æ˜¯é€šè¿‡ä¸€ä¸ªåŸºäºæ•°å­¦ç»Ÿè®¡å­¦ç±»å‹çš„å­¦ä¹ æ–¹æ³•ï¼ˆLearning Methodï¼‰å¾—ä»¥ä¼˜åŒ–ï¼Œæ‰€ä»¥äººå·¥ç¥ç»ç½‘ç»œä¹Ÿæ˜¯æ•°å­¦ç»Ÿè®¡å­¦æ–¹æ³•çš„ä¸€ç§å®é™…åº”ç”¨ï¼Œé€šè¿‡ç»Ÿè®¡å­¦çš„æ ‡å‡†æ•°å­¦æ–¹æ³•æˆ‘ä»¬èƒ½å¤Ÿå¾—åˆ°å¤§é‡çš„å¯ä»¥ç”¨å‡½æ•°æ¥è¡¨è¾¾çš„å±€éƒ¨ç»“æ„ç©ºé—´ï¼Œå¦ä¸€æ–¹é¢åœ¨äººå·¥æ™ºèƒ½å­¦çš„äººå·¥æ„ŸçŸ¥é¢†åŸŸï¼Œæˆ‘ä»¬é€šè¿‡æ•°å­¦ç»Ÿè®¡å­¦çš„åº”ç”¨å¯ä»¥æ¥åšäººå·¥æ„ŸçŸ¥æ–¹é¢çš„å†³å®šé—®é¢˜ï¼ˆä¹Ÿå°±æ˜¯è¯´é€šè¿‡ç»Ÿè®¡å­¦çš„æ–¹æ³•ï¼Œäººå·¥ç¥ç»ç½‘ç»œèƒ½å¤Ÿç±»ä¼¼äººä¸€æ ·å…·æœ‰ç®€å•çš„å†³å®šèƒ½åŠ›å’Œç®€å•çš„åˆ¤æ–­èƒ½åŠ›ï¼‰ï¼Œè¿™ç§æ–¹æ³•æ¯”èµ·æ­£å¼çš„é€»è¾‘å­¦æ¨ç†æ¼”ç®—æ›´å…·æœ‰ä¼˜åŠ¿ã€‚</p><p>å’Œå…¶ä»–æœºå™¨å­¦ä¹ æ–¹æ³•ä¸€æ ·ï¼Œç¥ç»ç½‘ç»œå·²ç»è¢«ç”¨äºè§£å†³å„ç§å„æ ·çš„é—®é¢˜ï¼Œä¾‹å¦‚æœºå™¨è§†è§‰å’Œè¯­éŸ³è¯†åˆ«ã€‚è¿™äº›é—®é¢˜éƒ½æ˜¯å¾ˆéš¾è¢«ä¼ ç»ŸåŸºäºè§„åˆ™çš„ç¼–ç¨‹æ‰€è§£å†³çš„ã€‚</p><p>å¯¹äººç±»ä¸­æ¢ç¥ç»ç³»ç»Ÿçš„è§‚å¯Ÿå¯å‘äº†äººå·¥ç¥ç»ç½‘ç»œè¿™ä¸ªæ¦‚å¿µã€‚åœ¨äººå·¥ç¥ç»ç½‘ç»œä¸­ï¼Œç®€å•çš„äººå·¥èŠ‚ç‚¹ï¼Œç§°ä½œç¥ç»å…ƒï¼ˆneuronsï¼‰ï¼Œè¿æ¥åœ¨ä¸€èµ·å½¢æˆä¸€ä¸ªç±»ä¼¼ç”Ÿç‰©ç¥ç»ç½‘ç»œçš„ç½‘çŠ¶ç»“æ„ã€‚</p><p>äººå·¥ç¥ç»ç½‘ç»œç›®å‰æ²¡æœ‰ä¸€ä¸ªç»Ÿä¸€çš„æ­£å¼å®šä¹‰ã€‚ä¸è¿‡ï¼Œå…·æœ‰ä¸‹åˆ—ç‰¹ç‚¹çš„ç»Ÿè®¡æ¨¡å‹å¯ä»¥è¢«ç§°ä½œæ˜¯â€œç¥ç»åŒ–â€çš„ï¼šå…·æœ‰ä¸€ç»„å¯ä»¥è¢«è°ƒèŠ‚çš„æƒé‡ï¼Œæ¢è¨€ä¹‹ï¼Œè¢«å­¦ä¹ ç®—æ³•è°ƒèŠ‚çš„æ•°å€¼å‚æ•°ï¼Œå¹¶ä¸”<br>å¯ä»¥ä¼°è®¡è¾“å…¥æ•°æ®çš„éçº¿æ€§å‡½æ•°å…³ç³»<br>è¿™äº›å¯è°ƒèŠ‚çš„æƒé‡å¯ä»¥è¢«çœ‹åšç¥ç»å…ƒä¹‹é—´çš„è¿æ¥å¼ºåº¦ã€‚<br>äººå·¥ç¥ç»ç½‘ç»œä¸ç”Ÿç‰©ç¥ç»ç½‘ç»œçš„ç›¸ä¼¼ä¹‹å¤„åœ¨äºï¼Œå®ƒå¯ä»¥é›†ä½“åœ°ã€å¹¶è¡Œåœ°è®¡ç®—å‡½æ•°çš„å„ä¸ªéƒ¨åˆ†ï¼Œè€Œä¸éœ€è¦æè¿°æ¯ä¸€ä¸ªå•å…ƒçš„ç‰¹å®šä»»åŠ¡ã€‚ç¥ç»ç½‘ç»œè¿™ä¸ªè¯ä¸€èˆ¬æŒ‡ç»Ÿè®¡å­¦ã€è®¤çŸ¥å¿ƒç†å­¦å’Œäººå·¥æ™ºèƒ½é¢†åŸŸä½¿ç”¨çš„æ¨¡å‹ï¼Œè€Œæ§åˆ¶ä¸­å¤®ç¥ç»ç³»ç»Ÿçš„ç¥ç»ç½‘ç»œå±äºç†è®ºç¥ç»ç§‘å­¦å’Œè®¡ç®—ç¥ç»ç§‘å­¦ã€‚</p><p>åœ¨ç¥ç»ç½‘ç»œçš„ç°ä»£è½¯ä»¶å®ç°ä¸­ï¼Œè¢«ç”Ÿç‰©å­¦å¯å‘çš„é‚£ç§æ–¹æ³•å·²ç»å¾ˆå¤§ç¨‹åº¦ä¸Šè¢«æŠ›å¼ƒäº†ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯åŸºäºç»Ÿè®¡å­¦å’Œä¿¡å·å¤„ç†çš„æ›´åŠ å®ç”¨çš„æ–¹æ³•ã€‚åœ¨ä¸€äº›è½¯ä»¶ç³»ç»Ÿä¸­ï¼Œç¥ç»ç½‘ç»œæˆ–è€…ç¥ç»ç½‘ç»œçš„ä¸€éƒ¨åˆ†ï¼ˆä¾‹å¦‚äººå·¥ç¥ç»å…ƒï¼‰æ˜¯å¤§å‹ç³»ç»Ÿä¸­çš„ä¸€ä¸ªéƒ¨åˆ†ã€‚è¿™äº›ç³»ç»Ÿç»“åˆäº†é€‚åº”æ€§çš„å’Œéé€‚åº”æ€§çš„å…ƒç´ ã€‚è™½ç„¶è¿™ç§ç³»ç»Ÿä½¿ç”¨çš„è¿™ç§æ›´åŠ æ™®éçš„æ–¹æ³•æ›´é€‚å®œè§£å†³ç°å®ä¸­çš„é—®é¢˜ï¼Œä½†æ˜¯è¿™å’Œä¼ ç»Ÿçš„è¿æ¥ä¸»ä¹‰äººå·¥æ™ºèƒ½å·²ç»æ²¡æœ‰ä»€ä¹ˆå…³è”äº†ã€‚ä¸è¿‡å®ƒä»¬è¿˜æœ‰ä¸€äº›å…±åŒç‚¹ï¼šéçº¿æ€§ã€åˆ†å¸ƒå¼ã€å¹¶è¡ŒåŒ–ï¼Œå±€éƒ¨æ€§è®¡ç®—ä»¥åŠé€‚åº”æ€§ã€‚ä»å†å²çš„è§’åº¦è®²ï¼Œç¥ç»ç½‘ç»œæ¨¡å‹çš„åº”ç”¨æ ‡å¿—ç€äºŒåä¸–çºªå…«åå¹´ä»£åæœŸä»é«˜åº¦ç¬¦å·åŒ–çš„äººå·¥æ™ºèƒ½ï¼ˆä»¥ç”¨æ¡ä»¶è§„åˆ™è¡¨è¾¾çŸ¥è¯†çš„ä¸“å®¶ç³»ç»Ÿä¸ºä»£è¡¨ï¼‰å‘ä½ç¬¦å·åŒ–çš„æœºå™¨å­¦ä¹ ï¼ˆä»¥ç”¨åŠ¨åŠ›ç³»ç»Ÿçš„å‚æ•°è¡¨è¾¾çŸ¥è¯†ä¸ºä»£è¡¨ï¼‰çš„è½¬å˜ã€‚</p><p>ç¥ç»ç½‘ç»œåœ¨æ—©æœŸçš„è¿›å±•éå¸¸ç¼“æ…¢ï¼Œç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯åŸºæœ¬æ„ŸçŸ¥å™¨æ— æ³•è§£å†³å¼‚æˆ–é—®é¢˜ï¼Œç¬¬äºŒä¸ªé—®é¢˜æ˜¯è®¡ç®—æœºæ²¡æœ‰è¶³å¤Ÿçš„èƒ½åŠ›å¤„ç†å¤§å‹ç¥ç»ç½‘ç»œæ‰€éœ€è¦çš„è®¡ç®—æ—¶é—´,ç›´åˆ°è®¡ç®—æœºå…·å¤‡æ›´å¼ºçš„è®¡ç®—èƒ½åŠ›å‰ï¼Œç¥ç»ç½‘ç»œçš„è¿›å±•éƒ½ä¸€ç›´å¾ˆç¼“æ…¢ã€‚</p><h3 id="åå‘ä¼ æ’­ç®—æ³•çš„å‡ºç°"><a href="#åå‘ä¼ æ’­ç®—æ³•çš„å‡ºç°" class="headerlink" title="åå‘ä¼ æ’­ç®—æ³•çš„å‡ºç°"></a>åå‘ä¼ æ’­ç®—æ³•çš„å‡ºç°</h3><p>åæ¥å‡ºç°äº†å…³é”®çš„çš„è¿›å±•: åœ¨1975å¹´ç”±Paul Werbosæå‡ºçš„åå‘ä¼ æ’­ç®—æ³•ã€‚è¯¥ç®—æ³•è§£å†³äº†å¼‚æˆ–çš„é—®é¢˜ï¼Œè¿˜èƒ½æ›´æ™®éçš„è®­ç»ƒå¤šå±‚ç¥ç»ç½‘ç»œã€‚åå‘ä¼ æ’­ç®—æ³•åœ¨3Blue1Brownçš„ç¬¬äºŒæœŸè§†é¢‘ä¸­æœ‰è®²è§£,è§†é¢‘ä¸­é‡‡ç”¨äº†é€šä¿—æ˜“æ‡‚çš„æ–¹å¼æ¥ä»‹ç»åå‘ä¼ æ’­ç®—æ³•æ˜¯å¦‚ä½•è°ƒæ•´ç¥ç»å…ƒçš„ã€‚</p><p>ç¥ç»ç½‘ç»œçš„åˆä¸€ä¸ªå…³é”®è¿›å±•æ˜¯æ˜¾å¡æ€§èƒ½çš„æå‡ã€‚å¤§å®¶éƒ½çŸ¥é“CPUåå‘äºæ§åˆ¶è€Œéè®¡ç®—ï¼Œè¿™å°±é€ æˆæ—©æœŸå¤„ç†è®­ç»ƒç¥ç»ç½‘ç»œçš„ä»£ä»·éå¸¸å¤§ï¼Œä½¿ç”¨CPUæ¥è®­ç»ƒç¥ç»ç½‘ç»œçš„é€Ÿåº¦éå¸¸æ…¢ï¼Œè€Œç°ä»£å›¾å½¢å¤„ç†å™¨æœ‰å¼ºå¤§çš„å¹¶è¡Œå¤„ç†èƒ½åŠ›å’Œå¯ç¼–ç¨‹æµæ°´çº¿ï¼Œä»¤æµå¤„ç†å™¨ä¹Ÿå¯ä»¥å¤„ç†éå›¾å½¢æ•°æ®ã€‚ç‰¹åˆ«æ˜¯åœ¨é¢å¯¹å•æŒ‡ä»¤æµå¤šæ•°æ®æµï¼ˆSIMDï¼‰ä¸”æ•°æ®å¤„ç†çš„è¿ç®—é‡è¿œå¤§äºæ•°æ®è°ƒåº¦å’Œä¼ è¾“çš„éœ€è¦æ—¶ï¼Œé€šç”¨å›¾å½¢å¤„ç†å™¨åœ¨æ€§èƒ½ä¸Šå¤§å¤§è¶…è¶Šäº†ä¼ ç»Ÿçš„ä¸­å¤®å¤„ç†å™¨åº”ç”¨ç¨‹åºã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥è½»æ˜“çš„ä½¿ç”¨Nvidiaçš„CUDAæ–¹æ¡ˆæˆ–è€…OpenCLæ¥ç¼–å†™ä»£ç ï¼Œå¹¶ä½¿ç”¨æ˜¾å¡æ¥è¿›è¡Œè®¡ç®—ã€‚</p><h3 id="å¤šå±‚å‰é¦ˆç½‘ç»œ"><a href="#å¤šå±‚å‰é¦ˆç½‘ç»œ" class="headerlink" title="å¤šå±‚å‰é¦ˆç½‘ç»œ"></a>å¤šå±‚å‰é¦ˆç½‘ç»œ</h3><p>ä¸€ç§å¸¸è§çš„å¤šå±‚ç»“æ„çš„å‰é¦ˆç½‘ç»œï¼ˆMultilayer Feedforward Networkï¼‰ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼š</p><ul><li>è¾“å…¥å±‚: ä¼—å¤šç¥ç»å…ƒæ¥å—å¤§é‡éçº¿æ€§çš„ä¿¡æ¯ï¼Œè¾“å…¥çš„ä¿¡æ¯è¢«ç§°ä¸ºè¾“å…¥å‘é‡ã€‚</li><li>éšå«å±‚: æ˜¯è¾“å…¥å±‚å’Œè¾“å‡ºå±‚ä¹‹é—´ä¼—å¤šç¥ç»å…ƒå’Œé“¾æ¥ç»„æˆçš„å„ä¸ªå±‚é¢ã€‚éšå«å±‚å¯ä»¥æœ‰ä¸€å±‚æˆ–å¤šå±‚ã€‚éšå«å±‚çš„èŠ‚ç‚¹ï¼ˆç¥ç»å…ƒï¼‰æ•°ç›®ä¸å®šï¼Œä½†æ•°ç›®è¶Šå¤šç¥ç»ç½‘ç»œçš„éçº¿æ€§è¶Šæ˜¾è‘—ï¼Œä»è€Œç¥ç»ç½‘ç»œçš„å¼ºå¥æ€§ï¼ˆrobustnessï¼‰ï¼ˆæ§åˆ¶ç³»ç»Ÿåœ¨ä¸€å®šç»“æ„ã€å¤§å°ç­‰çš„å‚æ•°æ‘„åŠ¨ä¸‹ï¼Œç»´æŒæŸäº›æ€§èƒ½çš„ç‰¹æ€§ï¼‰æ›´æ˜¾è‘—ã€‚ä¹ æƒ¯ä¸Šä¼šé€‰è¾“å…¥èŠ‚ç‚¹1.2è‡³1.5å€çš„èŠ‚ç‚¹ã€‚</li><li>è¾“å‡ºå±‚: åœ¨ç¥ç»å…ƒé“¾æ¥ä¸­ä¼ è¾“ã€åˆ†æã€æƒè¡¡ï¼Œå½¢æˆè¾“å‡ºç»“æœã€‚è¾“å‡ºçš„ä¿¡æ¯ç§°ä¸ºè¾“å‡ºå‘é‡ã€‚</li></ul><p>è¿™ç§ç½‘ç»œä¸€èˆ¬ç§°ä¸ºæ„ŸçŸ¥å™¨ï¼ˆå¯¹å•éšè—å±‚ï¼‰æˆ–å¤šå±‚æ„ŸçŸ¥å™¨ï¼ˆå¯¹å¤šéšè—å±‚ï¼‰ï¼Œç¥ç»ç½‘ç»œçš„ç±»å‹å·²ç»æ¼”å˜å‡ºå¾ˆå¤šç§ï¼Œè¿™ç§åˆ†å±‚çš„ç»“æ„ä¹Ÿå¹¶ä¸æ˜¯å¯¹æ‰€æœ‰çš„ç¥ç»ç½‘ç»œéƒ½é€‚ç”¨ã€‚</p><h3 id="ç†è®ºæ€§è´¨"><a href="#ç†è®ºæ€§è´¨" class="headerlink" title="ç†è®ºæ€§è´¨"></a>ç†è®ºæ€§è´¨</h3><h4 id="è®¡ç®—èƒ½åŠ›"><a href="#è®¡ç®—èƒ½åŠ›" class="headerlink" title="è®¡ç®—èƒ½åŠ›"></a>è®¡ç®—èƒ½åŠ›</h4><p>å¤šå±‚æ„ŸçŸ¥å™¨ï¼ˆMLPï¼‰æ˜¯ä¸€ä¸ªé€šç”¨çš„å‡½æ•°é€¼è¿‘å™¨ï¼Œç”±Cybenkoå®šç†è¯æ˜ã€‚ç„¶è€Œï¼Œè¯æ˜ä¸æ˜¯ç”±æ‰€è¦æ±‚çš„ç¥ç»å…ƒæ•°é‡æˆ–æƒé‡æ¥æ¨æ–­çš„ã€‚Hava Siegelmannå’ŒEduardo D. Sontagçš„å·¥ä½œè¯æ˜äº†ï¼Œä¸€ä¸ªå…·æœ‰æœ‰ç†æ•°æƒé‡å€¼çš„ç‰¹å®šé€’å½’ç»“æ„ï¼ˆä¸å…¨ç²¾åº¦å®æ•°æƒé‡å€¼ç›¸å¯¹åº”ï¼‰ç›¸å½“äºä¸€ä¸ªå…·æœ‰æœ‰é™æ•°é‡çš„ç¥ç»å…ƒå’Œæ ‡å‡†çš„çº¿æ€§å…³ç³»çš„é€šç”¨å›¾çµæœºã€‚ä»–ä»¬è¿›ä¸€æ­¥è¡¨æ˜ï¼Œä½¿ç”¨æ— ç†æ•°æƒé‡å€¼ä¼šäº§ç”Ÿä¸€ä¸ªè¶…å›¾çµæœºã€‚</p><h4 id="å®¹é‡"><a href="#å®¹é‡" class="headerlink" title="å®¹é‡"></a>å®¹é‡</h4><p>äººå·¥ç¥ç»ç½‘ç»œæ¨¡å‹æœ‰ä¸€ä¸ªå±æ€§ï¼Œç§°ä¸ºâ€œå®¹é‡â€ï¼Œè¿™å¤§è‡´ç›¸å½“äºä»–ä»¬æ¨¡æ‹Ÿä»»ä½•å‡½æ•°çš„èƒ½åŠ›ã€‚å®ƒä¸ç½‘ç»œä¸­å¯ä»¥å­˜å‚¨çš„ä¿¡æ¯é‡æœ‰å…³ï¼Œä¹Ÿä¸å¤æ‚æ€§æœ‰å…³ã€‚</p><h4 id="æ”¶æ•›æ€§"><a href="#æ”¶æ•›æ€§" class="headerlink" title="æ”¶æ•›æ€§"></a>æ”¶æ•›æ€§</h4><p>æ¨¡å‹å¹¶ä¸æ€»æ˜¯æ”¶æ•›åˆ°å”¯ä¸€è§£ï¼Œå› ä¸ºå®ƒå–å†³äºä¸€äº›å› ç´ ã€‚é¦–å…ˆï¼Œå‡½æ•°å¯èƒ½å­˜åœ¨è®¸å¤šå±€éƒ¨æå°å€¼ï¼Œè¿™å–å†³äºæˆæœ¬å‡½æ•°å’Œæ¨¡å‹ã€‚å…¶æ¬¡ï¼Œåœ¨è¿œç¦»å±€éƒ¨æœ€å°å€¼æ—¶ï¼Œä¼˜åŒ–æ–¹æ³•å¯èƒ½æ— æ³•ä¿è¯æ”¶æ•›ã€‚ç¬¬ä¸‰ï¼Œå¯¹å¤§é‡çš„æ•°æ®æˆ–å‚æ•°ï¼Œä¸€äº›æ–¹æ³•å˜å¾—ä¸åˆ‡å®é™…ã€‚åœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å‘ç°ï¼Œç†è®ºä¿è¯çš„æ”¶æ•›ä¸èƒ½æˆä¸ºå®é™…åº”ç”¨çš„ä¸€ä¸ªå¯é çš„æŒ‡å—ã€‚</p><h4 id="ç»¼åˆç»Ÿè®¡"><a href="#ç»¼åˆç»Ÿè®¡" class="headerlink" title="ç»¼åˆç»Ÿè®¡"></a>ç»¼åˆç»Ÿè®¡</h4><p>åœ¨ç›®æ ‡æ˜¯åˆ›å»ºä¸€ä¸ªæ™®éç³»ç»Ÿçš„åº”ç”¨ç¨‹åºä¸­ï¼Œè¿‡åº¦è®­ç»ƒçš„é—®é¢˜å‡ºç°äº†ã€‚è¿™å‡ºç°åœ¨å›æ—‹æˆ–è¿‡åº¦å…·ä½“çš„ç³»ç»Ÿä¸­å½“ç½‘ç»œçš„å®¹é‡å¤§å¤§è¶…è¿‡æ‰€éœ€çš„è‡ªç”±å‚æ•°ã€‚ä¸ºäº†é¿å…è¿™ä¸ªé—®é¢˜ï¼Œæœ‰ä¸¤ä¸ªæ–¹å‘ï¼šç¬¬ä¸€ä¸ªæ˜¯ä½¿ç”¨äº¤å‰éªŒè¯å’Œç±»ä¼¼çš„æŠ€æœ¯æ¥æ£€æŸ¥è¿‡åº¦è®­ç»ƒçš„å­˜åœ¨å’Œé€‰æ‹©æœ€ä½³å‚æ•°å¦‚æœ€å°åŒ–æ³›åŒ–è¯¯å·®ã€‚äºŒæ˜¯ä½¿ç”¨æŸç§å½¢å¼çš„æ­£è§„åŒ–ã€‚è¿™æ˜¯ä¸€ä¸ªåœ¨æ¦‚ç‡åŒ–ï¼ˆè´å¶æ–¯ï¼‰æ¡†æ¶é‡Œå‡ºç°çš„æ¦‚å¿µï¼Œå…¶ä¸­çš„æ­£åˆ™åŒ–å¯ä»¥é€šè¿‡ä¸ºç®€å•æ¨¡å‹é€‰æ‹©ä¸€ä¸ªè¾ƒå¤§çš„å…ˆéªŒæ¦‚ç‡æ¨¡å‹è¿›è¡Œï¼›è€Œä¸”åœ¨ç»Ÿè®¡å­¦ä¹ ç†è®ºä¸­ï¼Œå…¶ç›®çš„æ˜¯æœ€å¤§é™åº¦åœ°å‡å°‘äº†ä¸¤ä¸ªæ•°é‡ï¼šâ€œé£é™©â€å’Œâ€œç»“æ„é£é™©â€ï¼Œç›¸å½“äºè¯¯å·®åœ¨è®­ç»ƒé›†å’Œç”±äºè¿‡åº¦æ‹Ÿåˆé€ æˆçš„é¢„æµ‹è¯¯å·®ã€‚</p><h3 id="ä¸€ä¸ªå°ä¾‹å­"><a href="#ä¸€ä¸ªå°ä¾‹å­" class="headerlink" title="ä¸€ä¸ªå°ä¾‹å­"></a>ä¸€ä¸ªå°ä¾‹å­</h3><p>ç°åœ¨ä½œä¸ºæ·±åº¦å­¦ä¹ å…¥é—¨çš„æ˜¯æ‰‹å†™æ•°å­—è¯†åˆ«ï¼Œ3Blue1Brownçš„ä¸‰æœŸè§†é¢‘å°±æ˜¯åŸºäºæ­¤ã€‚</p><p>é€šè¿‡ç¥ç»ç½‘ç»œæ¥å­¦ä¹ å¦‚ä½•è¯†åˆ«æ‰‹å†™æ•°å­—ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯äººç±»é€šè¿‡ç®—æ³•æ¥åˆ†è§£å›¾åƒçš„ä¿¡æ¯ï¼Œæ¯”å¦‚æ•°å­—9ï¼Œå®ƒå¯ä»¥è®¤ä¸ºæ˜¯ç«–çº¿å’Œåœ†çš„ç»„åˆï¼Œè¾“å‡ºå±‚æ˜¯9ï¼Œåˆ™éšå«å±‚éœ€è¦å¤„ç†ç«–çº¿å’Œåœ†ï¼Œè¾“å…¥å±‚è¾“å…¥çš„æ˜¯æ‰‹å†™9çš„å…¨éƒ¨åƒç´ ï¼Œéšå«å±‚å°±æ˜¯ç¥ç»ç½‘ç»œçš„æ ¸å¿ƒï¼Œå®ƒéœ€è¦åªè¦ç«–çº¿å’Œåœ†åˆæ˜¯ç”±ä»€ä¹ˆç»„æˆï¼Œæœ€åä¸€æ­¥æ­¥çš„åˆ†è§£ä¸ºä¸€ä¸ªåƒç´ ï¼Œå†é€šè¿‡åå‘ä¼ æ’­ç®—æ³•æ¥è®­ç»ƒå’Œè°ƒèŠ‚éšå«å±‚ä¸­çš„åç½®å’Œæƒå€¼ï¼Œæœ€åæ•´ä¸ªç½‘ç»œå°±å¯ä»¥å­¦ä¹ åˆ°æ­£ç¡®çš„è¯†åˆ«æ‰‹å†™æ•°å­—ã€‚</p><p>æ·±åº¦å­¦ä¹ å°±æ˜¯é€šè¿‡äººå·¥ç¥ç»ç½‘ç»œæ¥å‘Šè¯‰è®¡ç®—æœºç»“æœæ˜¯å¦‚ä½•äº§ç”Ÿçš„ï¼Œä»¥åŠå¦‚ä½•é€šè¿‡ç»“æœæ¥è°ƒæ•´ç½‘ç»œç»“æ„ï¼Œè¾¾åˆ°é¢„æµ‹å’Œå¤„ç†æœªæ ‡è®°çš„ä¿¡æ¯ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Deepin Learning </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Deepin Learning </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C plus plus Iterator ç¬”è®°</title>
      <link href="/2018/07/09/C-plus-plus-Iterator-%E7%AC%94%E8%AE%B0/"/>
      <url>/2018/07/09/C-plus-plus-Iterator-%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<p>æœ¬æ–‡è®°å½•äº†å’±å¯¹è¿­ä»£å™¨çš„ä¸€äº›ç†è§£</p><p>C++ æ ‡å‡†åº“æä¾›äº†ä¸‰ç§ç±»å‹ç»„ä»¶:</p><ul><li>å®¹å™¨</li><li>è¿­ä»£å™¨</li><li>ç®—æ³•</li></ul><p>å®¹å™¨æ˜¯æŒ‡å­˜å‚¨æŸç§ç±»å‹çš„ç»“æ„ï¼Œå®¹å™¨æœ‰ä¸¤ç§:</p><ul><li>é¡ºåºå®¹å™¨ (vectorã€listå’Œstringç­‰ï¼Œæ˜¯å…ƒç´ çš„æœ‰åºé›†åˆã€‚)</li><li>å…³è”å®¹å™¨ (setã€mapç­‰ï¼Œæ˜¯åŒ…å«æŸ¥æ‰¾å…ƒç´ çš„é”®å€¼ã€‚ )</li></ul><p>éå†å®¹å™¨çš„æ–¹å¼ä¹‹ä¸€å°±æ˜¯è¿­ä»£å™¨ï¼Œè¿­ä»£å™¨æ˜¯ä¸€ç§æ³›å‹æŒ‡é’ˆï¼Œæ™®é€šæŒ‡é’ˆæŒ‡å‘ä¸€å—å†…å­˜ï¼Œè¿­ä»£å™¨æŒ‡å‘å®¹å™¨ä¸­çš„ä¸€ä¸ªä½ç½®ã€‚STLçš„æ¯ä¸ªæ¨¡æ¿å®¹å™¨ä¸­ï¼Œéƒ½å®šä¹‰äº†ä¸€ç»„å¯¹åº”çš„è¿­ä»£å™¨ç±»ï¼Œä½¿ç”¨è¿­ä»£å™¨å’Œç®—æ³•ï¼Œå°±å¯ä»¥è®¿é—®å®¹å™¨ä¸­ç‰¹å®šä½ç½®çš„å…ƒç´ ï¼Œè€Œæ— éœ€å…³å¿ƒå…ƒç´ çš„ç±»å‹ã€‚</p><p>æ¯ç§å®¹å™¨éƒ½å®šä¹‰äº†ä¸€å¯¹beginå’Œendçš„å‡½æ•°ï¼Œç”¨äºè¿”å›è¿­ä»£å™¨ã€‚å¦‚æœå®¹å™¨ä¸­æœ‰å…ƒç´ çš„è¯ï¼Œbeginè¿”å›çš„è¿­ä»£å™¨æŒ‡å‘ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚</p><span id="more"></span><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">std::list&lt;<span class="type">int</span>&gt;::iterator it = list.<span class="built_in">begin</span>();</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°è¯­å¥æŠŠitåˆå§‹åŒ–ä¸ºç”±listçš„beginè¿”å›çš„è¿­ä»£å™¨ï¼Œå¦‚æœlistä¸ä¸ºç©ºï¼Œitå°†æŒ‡å‘è¯¥å…ƒç´ list[0]ã€‚</p><p>ç”±endæ“ä½œè¿”å›çš„è¿­ä»£å™¨æŒ‡å‘listçš„æœ«ç«¯å…ƒç´ çš„ä¸‹ä¸€ä¸ªï¼Œé€šå¸¸æŒ‡è¶…å‡ºæœ«ç«¯è¿­ä»£å™¨(off-the-end-iterator)ï¼Œè¡¨æ˜æŒ‡å‘ä¸€ä¸ªä¸å­˜åœ¨çš„å…ƒç´ ï¼Œå¦‚æœå®¹å™¨ä¸ºç©ºï¼Œbeginè¿”å›çš„è¿­ä»£å™¨å°†å’Œendç›¸åŒï¼Œåœ¨ä½¿ç”¨ä¸­ï¼Œå¯ä»¥é€šè¿‡åˆ¤æ–­endæ¥æ£€æŸ¥æ˜¯å¦å¤„ç†å®Œå®¹å™¨ç§æ‰€æœ‰çš„å…ƒç´ ã€‚</p><p>è¿­ä»£å™¨ç±»å‹å®šä¹‰äº†ä¸€äº›æ“ä½œæ¥è·å–è¿­ä»£å™¨æ‰€æŒ‡å‘çš„å…ƒç´ ï¼Œå¹¶å…è®¸ç¨‹åºå‘˜å°†è¿­ä»£å™¨ä»ä¸€ä¸ªå…ƒç´ ç§»åŠ¨åˆ°å¦ä¸€ä¸ªå…ƒç´ ã€‚</p><p>éå†åˆ—è¡¨ï¼š</p><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">std::list&lt;<span class="type">int</span>&gt; list</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">for</span> <span class="params">(std::list&lt;<span class="type">int</span>&gt;::const_iterator it = list.constBegin(); it != list.constEnd(); ++it)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// é€šè¿‡è¿­ä»£å™¨è®¿é—®å…ƒç´ éœ€è¦è§£å¼•ç”¨ã€‚</span></span><br><span class="line">    std::cout &lt;&lt; *it &lt;&lt; std::endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">std::list&lt;<span class="type">int</span>&gt; list;</span><br><span class="line">std::<span class="built_in">sort</span>(list.<span class="built_in">begin</span>(), list.<span class="built_in">end</span>(), [=] (<span class="type">int</span> _i1, <span class="type">int</span> _i2) &#123;</span><br><span class="line">    <span class="keyword">return</span> _i1 &lt; _i2;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ç¤ºä¾‹ä»£ç æ˜¯å¯¹ä¸€ä¸ªintç±»å‹çš„listè¿›è¡Œæ’åºï¼Œ</p>]]></content>
      
      
      <categories>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åœ¨DeepinLinuxä¸‹ä½¿ç”¨nVidia CUDA</title>
      <link href="/2018/06/28/%E5%9C%A8DeepinLinux%E4%B8%8B%E4%BD%BF%E7%94%A8nVidia-CUDA/"/>
      <url>/2018/06/28/%E5%9C%A8DeepinLinux%E4%B8%8B%E4%BD%BF%E7%94%A8nVidia-CUDA/</url>
      
        <content type="html"><![CDATA[<p>CUDAï¼ˆCompute Unified Device Architectureï¼Œç»Ÿä¸€è®¡ç®—æ¶æ„ï¼‰æ˜¯ç”±NVIDIAæ‰€æ¨å‡ºçš„ä¸€ç§é›†æˆæŠ€æœ¯ï¼Œæ˜¯è¯¥å…¬å¸å¯¹äºGPGPUçš„æ­£å¼åç§°ã€‚é€šè¿‡è¿™ä¸ªæŠ€æœ¯ï¼Œç”¨æˆ·å¯åˆ©ç”¨NVIDIAçš„GeForce 8ä»¥åçš„GPUå’Œè¾ƒæ–°çš„Quadro GPUè¿›è¡Œè®¡ç®—ã€‚äº¦æ˜¯é¦–æ¬¡å¯ä»¥åˆ©ç”¨GPUä½œä¸ºC-ç¼–è¯‘å™¨çš„å¼€å‘ç¯å¢ƒã€‚NVIDIAè¥é”€çš„æ—¶å€™ï¼Œå¾€å¾€å°†ç¼–è¯‘å™¨ä¸æ¶æ„æ··åˆæ¨å¹¿ï¼Œé€ æˆæ··ä¹±ã€‚å®é™…ä¸Šï¼ŒCUDAå¯ä»¥å…¼å®¹OpenCLæˆ–è€…è‡ªå®¶çš„C-ç¼–è¯‘å™¨ã€‚æ— è®ºæ˜¯CUDA C-è¯­è¨€æˆ–æ˜¯OpenCLï¼ŒæŒ‡ä»¤æœ€ç»ˆéƒ½ä¼šè¢«é©±åŠ¨ç¨‹åºè½¬æ¢æˆPTXä»£ç ï¼Œäº¤ç”±æ˜¾ç¤ºæ ¸å¿ƒè®¡ç®—ã€‚</p><p>åœ¨è®ºå›ä¸Šçœ‹åˆ°æœ‰äº›ç”¨æˆ·å¸Œæœ›åœ¨deepinä¸‹ä½¿ç”¨CUDAï¼Œä½†æ˜¯ä»–ä»¬é‡‡å–çš„åšæ³•å¾€å¾€æ˜¯æ‰‹åŠ¨ä¸‹è½½nvidiaçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œç›´æ¥è¿›è¡Œå®‰è£…ã€‚</p><p>ä½†æ˜¯è¿™æ ·ä¼šç ´åä¸€éƒ¨åˆ†çš„glxé“¾æ¥ï¼Œå¯¼è‡´å¸è½½çš„æ—¶å€™æ— æ³•å½»åº•æ¢å¤ï¼Œç»“æœå°±æ˜¯ç³»ç»Ÿå› ä¸ºå¸è½½nvidiaé©±åŠ¨è€ŒåºŸæ‰ï¼Œæ‰€ä»¥æˆ‘æ¨èä½¿ç”¨åŒ…ç®¡ç†å™¨çš„æ–¹å¼å®‰è£…nvidiaé©±åŠ¨å’Œcudaç›¸å…³çš„ä¸œè¥¿ï¼Œå°½é‡ä¸è¦æ‰‹åŠ¨ä¿®æ”¹ã€‚</p><span id="more"></span><p>éœ€è¦å®‰è£…çš„å¾ˆå°‘ï¼Œåªæœ‰äº”ä¸ªåŒ…ï¼Œä¸è¿‡ä¼šä¾èµ–å¾ˆå¤šnvidiaçš„åº“ï¼Œæ€»é‡è¿˜æ˜¯æœ‰ä¸€äº›çš„ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo apt install nvidia-cuda-toolkit nvidia-profiler nvidia-visual-profiler nvidia-cuda-doc nvidia-cuda-dev</span><br></pre></td></tr></table></figure><p>nvccæ˜¯cudaçš„ç¼–è¯‘å™¨ï¼Œå®ƒç›®å‰åªæ”¯æŒg++5ï¼Œæ‰€ä»¥è¿˜éœ€è¦å®‰è£…g++5ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo apt install g++-5</span><br></pre></td></tr></table></figure><p>ç„¶åï¼Œé‡å¯ä¸€ä¸‹è®¡ç®—æœºã€‚</p><p><a href="https://bingliu221.gitbooks.io/learn-cuda-the-simple-way/content/chapter2.html/">è¿™é‡Œæœ‰ä¸ªå°æ —å­ï¼Œå¯ä»¥ç”¨æ¥æµ‹è¯•cudaæ˜¯å¦èƒ½å¤ŸæˆåŠŸç¼–è¯‘å’Œè¿è¡Œ</a></p><p><strong>å°†ä»¥ä¸‹ä»£ç ä¿å­˜ä¸º main.cu</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"></span><br><span class="line">__global__ void vector_add(const int *a, const int *b, int *c) &#123;</span><br><span class="line">    *c = *a + *b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int main(void) &#123;</span><br><span class="line">    const int a = 2, b = 5;</span><br><span class="line">    int c = 0;</span><br><span class="line"></span><br><span class="line">    int *dev_a, *dev_b, *dev_c;</span><br><span class="line"></span><br><span class="line">    cudaMalloc((void **)&amp;dev_a, sizeof(int));</span><br><span class="line">    cudaMalloc((void **)&amp;dev_b, sizeof(int));</span><br><span class="line">    cudaMalloc((void **)&amp;dev_c, sizeof(int));</span><br><span class="line"></span><br><span class="line">    cudaMemcpy(dev_a, &amp;a, sizeof(int), cudaMemcpyHostToDevice);</span><br><span class="line">    cudaMemcpy(dev_b, &amp;b, sizeof(int), cudaMemcpyHostToDevice);</span><br><span class="line"></span><br><span class="line">    vector_add&lt;&lt;&lt;1, 1&gt;&gt;&gt;(dev_a, dev_b, dev_c);</span><br><span class="line"></span><br><span class="line">    cudaMemcpy(&amp;c, dev_c, sizeof(int), cudaMemcpyDeviceToHost);</span><br><span class="line"></span><br><span class="line">    printf(&quot;%d + %d = %d, Is that right?\n&quot;, a, b, c);</span><br><span class="line"></span><br><span class="line">    cudaFree(dev_a);</span><br><span class="line">    cudaFree(dev_b);</span><br><span class="line">    cudaFree(dev_c);</span><br><span class="line"></span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nvcc main.cu</span><br></pre></td></tr></table></figure><p>è¿è¡Œ:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">./a.out</span><br></pre></td></tr></table></figure><p>å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œåœ¨ç¼–è¯‘çš„æ—¶å€™å°±ä¸ä¼šæœ‰æŠ¥é”™ï¼Œä¸è¿‡åœ¨æˆ‘çš„ç¯å¢ƒä¸‹nvccä¼šæœ‰æ¶æ„è¢«å¼ƒç”¨çš„è­¦å‘Šï¼Œæœ¬ç€åªè¦ä¸errorå°±ç®—æ²¡äº‹çš„åŸåˆ™ï¼Œæˆ‘ä»¬æ— è§†è¿™æ¡è­¦å‘Šå³å¯ã€‚</p><p>è¾“å‡ºç»“æœ:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">2 + 5 = 0, Is that right?</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> nVidia Cuda </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>deepinå¾…æœºåé”®ç›˜å’Œè§¦æ‘¸æ¿æ— æ³•ä½¿ç”¨çš„è§£å†³æ–¹æ³•</title>
      <link href="/2018/06/25/deepin%E5%BE%85%E6%9C%BA%E5%90%8E%E9%94%AE%E7%9B%98%E5%92%8C%E8%A7%A6%E6%91%B8%E6%9D%BF%E6%97%A0%E6%B3%95%E4%BD%BF%E7%94%A8%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/"/>
      <url>/2018/06/25/deepin%E5%BE%85%E6%9C%BA%E5%90%8E%E9%94%AE%E7%9B%98%E5%92%8C%E8%A7%A6%E6%91%B8%E6%9D%BF%E6%97%A0%E6%B3%95%E4%BD%BF%E7%94%A8%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<p>ç¬”è®°æœ¬ä¸€ç›´ä½¿ç”¨çš„bumblebeeæ¥çœç”µï¼Œæ¯•ç«Ÿæˆ‘ä¹Ÿä¸æƒ³ç¬”è®°æœ¬çš„ç”µåªå¤Ÿä»ä¸€å¼ æ¡Œå­ç§»åŠ¨åˆ°å¦ä¸€å¼ æ¡Œå­ï¼Œä½†æ˜¯ä»Šå¤©åœ¨è°ƒå¾…æœºå”¤é†’ådde-dockå´©æºƒçš„é—®é¢˜ï¼Œæˆ‘éœ€è¦åˆ‡æ¢åˆ°ç§æœ‰é©±åŠ¨ä¸‹ï¼Œå› ä¸ºç¬”è®°æœ¬ä½¿ç”¨bumblebeeéœ€è¦ä½¿ç”¨acpiçš„å‚æ•°ï¼Œå¦åˆ™ä¼šè§å›¾å½¢å°±æ­»ã€‚</p><span id="more"></span><p>ä¸€åˆ‡å‡†å¤‡å°±ç»ªä»¥åï¼Œæˆ‘å¼€å§‹è°ƒè¯•dde-dockï¼Œé€šè¿‡codedumpå·²ç»çŸ¥é“å´©æºƒåœ¨wifiåˆ—è¡¨ä¸ºç©ºæ—¶è®¿é—®äº†firstèŠ‚ç‚¹ï¼Œä½†æ˜¯å½“æˆ‘å¼€å§‹æµ‹è¯•ä¿®å¤çš„ä»£ç æ—¶ï¼Œå‘ç”Ÿäº†å¾ˆæ„å¤–çš„äº‹æƒ…ï¼Œæ¢å¤å¾…æœºä»¥åé”®ç›˜å’Œè§¦æ‘¸æ¿æ— æ³•ä½¿ç”¨äº†ã€‚</p><p>è™½ç„¶ä¹‹å‰æˆ‘ä¹Ÿå¶å°”ä¼šç”¨ç”¨ç§æœ‰é©±åŠ¨ï¼Œä½†æ˜¯è¿˜æ²¡é‡åˆ°è¿‡æ— æ³•é”®ç›˜å’Œè§¦æ‘¸æ¿æ— æ³•ä½¿ç”¨çš„æƒ…å†µã€‚æƒ³åˆ°è®ºå›å¥½åƒä¹Ÿæœ‰äººæŠ¥äº†ç±»ä¼¼çš„é—®é¢˜ï¼Œæ¢å¤å¾…æœºä»¥åæ— wifiå’Œå¤–ç½®é”®ç›˜æ— æ³•ä½¿ç”¨ï¼Œåˆšå¥½å¯ä»¥è¶è¿™ä¸ªæœºä¼šè°ƒè¯•ä¸€ä¸‹ã€‚</p><p>&#x2F;var&#x2F;log&#x2F;Xorg.0.logé‡Œçœ‹åˆ°äº†å¤§é‡çš„synapticsé”™è¯¯ï¼Œç„¶åè¯¥æ¨¡å—è¢«å¸è½½ï¼Œé”®ç›˜åˆ™æ˜¯æ²¡çœ‹åˆ°ä»€ä¹ˆä¿¡æ¯ã€‚</p><p>å°è¯•é‡æ–°modprobe synapticsæ¨¡å—ï¼Œä½†æ˜¯å¤±è´¥äº†ï¼Œç„¶ååœ¨&#x2F;etc&#x2F;modprobe.d&#x2F;nvidia.confé‡Œçœ‹åˆ°äº†å‡ è¡Œé…ç½®ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># These aliases are defined in *all* nvidia modules.</span><br><span class="line"># Duplicating them here sets higher precedence and ensures the selected</span><br><span class="line"># module gets loaded instead of a random first match if more than one</span><br><span class="line"># version is installed. See #798207.</span><br><span class="line">#aliaspci:v000010DEd00000E00sv*sd*bc04sc80i00*nvidia</span><br><span class="line">#aliaspci:v000010DEd00000AA3sv*sd*bc0Bsc40i00*nvidia</span><br><span class="line">#aliaspci:v000010DEd*sv*sd*bc03sc02i00*nvidia</span><br><span class="line">#aliaspci:v000010DEd*sv*sd*bc03sc00i00*nvidia</span><br></pre></td></tr></table></figure><p>ä¼¼ä¹æ˜¯é€šé…å‡ºé”™äº†ï¼ŒåŒ¹é…åˆ°äº†é”®ç›˜å’Œè§¦æ‘¸æ¿ï¼Œç„¶åå°±æ— æ³•ä½¿ç”¨äº†ã€‚åˆšå¥½deepin 15.6å‡çº§äº†nvidiaé©±åŠ¨ï¼Œæ‰€ä»¥æ˜¯ç°åœ¨æ‰ä¼šå‡ºè¿™ä¸ªé—®é¢˜ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>dreamsceneæ’ä»¶å¼€å‘&lt;ç­‰å¾…å¡«å‘&gt;</title>
      <link href="/2018/06/05/dreamscene%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/"/>
      <url>/2018/06/05/dreamscene%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/</url>
      
        <content type="html"><![CDATA[<p>æœ¬ç¯‡ä¼šä»‹ç»ä¸€ä¸‹deepin-dreamsceneçš„æ’ä»¶æœºåˆ¶ã€‚</p><span id="more"></span>]]></content>
      
      
      
        <tags>
            
            <tag> Linux å¡«å‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Dockæ’ä»¶å¼€å‘&lt;ç­‰å¾…å¡«å‘&gt;</title>
      <link href="/2018/05/23/Dock%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/"/>
      <url>/2018/05/23/Dock%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/</url>
      
        <content type="html"><![CDATA[<p>ä»é›¶æ„å»º dde-dock çš„æ’ä»¶<br>æœ¬æ•™ç¨‹å°†å±•ç¤ºä¸€ä¸ªç®€å•çš„ dde-dock æ’ä»¶çš„å¼€å‘è¿‡ç¨‹ï¼Œæ’ä»¶å¼€å‘è€…å¯è·Ÿéšæ­¤æ­¥éª¤ä¸º dde-dock åˆ›é€ å‡ºæ›´å¤šå…·æœ‰ä¸°å¯ŒåŠŸèƒ½çš„æ’ä»¶ã€‚</p><span id="more"></span><p>åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œå°†åˆ›å»ºä¸€ä¸ªå¯ä»¥å®æ—¶æ˜¾ç¤ºç”¨æˆ·å®¶ç›®å½•(~&#x2F;)ä½¿ç”¨æƒ…å†µçš„å°å·¥å…·ã€‚</p><p>æ’ä»¶çš„å·¥ä½œåŸç†<br>dde-dock æ’ä»¶æœ¬è´¨æ˜¯ä¸€ä¸ªæŒ‰ Qt æ’ä»¶æ ‡å‡†æ‰€å¼€å‘çš„å…±äº«åº“æ–‡ä»¶(so)ã€‚é€šè¿‡ dde-dock é¢„å®šçš„è§„èŒƒä¸æä¾›çš„æ¥å£ï¼Œå…±åŒå®Œæˆ dde-dock çš„åŠŸèƒ½æ‰©å±•ã€‚</p><p>å‡†å¤‡ç¯å¢ƒ<br>æ’ä»¶çš„å¼€å‘ç¯å¢ƒå¯ä»¥æ˜¯ä»»æ„çš„ï¼Œåªè¦æ˜¯ç¬¦åˆ Qt æ’ä»¶è§„èŒƒåŠ dde-dock æ’ä»¶è§„èŒƒçš„å…±äº«åº“æ–‡ä»¶ï¼Œéƒ½å¯ä»¥è¢«å½“ä½œ dde-dock æ’ä»¶è½½å…¥ã€‚ä¸‹é¢ä»¥ Qt + qmake ä¸ºä¾‹è¿›è¡Œè¯´æ˜ï¼š</p><p>å®‰è£…ä¾èµ–<br>ä»¥ Deepin 15.5.1 ç¯å¢ƒä¸ºåŸºç¡€ï¼Œè‡³å°‘å…ˆå®‰è£…å¦‚ä¸‹çš„åŒ…ï¼š</p><ul><li>dde-dock-dev</li><li>qt5-qmake</li><li>qtbase5-dev-tools</li><li>libqt5core5a</li><li>libqt5widgets5</li><li>pkg-config</li></ul><p>åŸºæœ¬çš„é¡¹ç›®ç»“æ„<br>åˆ›å»ºå¿…éœ€çš„é¡¹ç›®ç›®å½•ä¸æ–‡ä»¶<br>æ’ä»¶åç§°å«åšhome_monitorï¼Œæ‰€ä»¥åˆ›å»ºä»¥ä¸‹çš„ç›®å½•ç»“æ„ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">home_monitor</span><br><span class="line">â”œâ”€â”€ home_monitor.json</span><br><span class="line">â”œâ”€â”€ homemonitorplugin.cpp</span><br><span class="line">â”œâ”€â”€ homemonitorplugin.h</span><br><span class="line">â””â”€â”€ home_monitor.pro</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linuxçš„PAMæ˜¯ä»€ä¹ˆ</title>
      <link href="/2018/04/01/Linux%E7%9A%84PAM%E6%98%AF%E4%BB%80%E4%B9%88/"/>
      <url>/2018/04/01/Linux%E7%9A%84PAM%E6%98%AF%E4%BB%80%E4%B9%88/</url>
      
        <content type="html"><![CDATA[<p>æœ¬æ–‡ä¼šåŸºç¡€çš„ä»‹ç»ä¸€ä¸‹PAMæ˜¯ä»€ä¹ˆï¼Œè®©ä½ èƒ½å¤Ÿå›ç­”PAMæ˜¯ä»€ä¹ˆã€PAMæœ‰ä»€ä¹ˆç”¨ã€å¦‚ä½•æ ¹æ®éœ€æ±‚è‡ªå·±å¼€å‘PAMæ¨¡å—ã€‚</p><h3 id="PAMæ˜¯ä»€ä¹ˆ"><a href="#PAMæ˜¯ä»€ä¹ˆ" class="headerlink" title="PAMæ˜¯ä»€ä¹ˆ"></a>PAMæ˜¯ä»€ä¹ˆ</h3><p>PAMå³å¯æ’æ‹”è®¤è¯æ¨¡å—ã€‚å®ƒæä¾›äº†ä¸€ä¸ªæ‰€æœ‰æœåŠ¡çš„ä¸­å¿ƒéªŒè¯æœºåˆ¶ï¼Œé€‚ç”¨äºæ™®é€šç™»å½•ã€sshç™»å½•ç­‰éœ€è¦è¿›è¡Œèº«ä»½è®¤è¯çš„ç³»ç»Ÿä¸­ã€‚</p><span id="more"></span><h3 id="ä¸ºä»€ä¹ˆä½¿ç”¨PAM"><a href="#ä¸ºä»€ä¹ˆä½¿ç”¨PAM" class="headerlink" title="ä¸ºä»€ä¹ˆä½¿ç”¨PAM"></a>ä¸ºä»€ä¹ˆä½¿ç”¨PAM</h3><p>ä¸ºäº†å®‰å…¨èµ·è§ï¼Œè®¡ç®—æœºåªèƒ½ç»™é€šè¿‡æˆæƒçš„ç”¨æˆ·è¿›è¡Œä½¿ç”¨ï¼Œåœ¨åˆ›å»ºç”¨æˆ·æ—¶ï¼Œå¯†ç ä¼šè¢«åŠ å¯†ä¿å­˜åœ¨&#x2F;etc&#x2F;passwdä¸­,åœ¨ç”¨æˆ·ç™»å½•æ—¶ï¼Œé‡æ–°è®¡ç®—å¯†ç ï¼Œç„¶ååœ¨&#x2F;etc&#x2F;passwdä¸­è¿›è¡Œå¯¹æ¯”ã€‚</p><p>é™¤äº†ä¸Šé¢è¿™ç§ï¼Œè¿˜æœ‰å…¶ä»–æ–¹å¼çš„éªŒè¯ï¼Œæ¯”å¦‚ç°åœ¨ç»å¸¸ä½¿ç”¨çš„æŒ‡çº¹è®¤è¯ï¼Œå…¶æ ¸å¿ƒæ€æƒ³éƒ½æ˜¯æ£€æŸ¥å†…å®¹æ˜¯å¦åŒ¹é…ã€‚ä½†æ˜¯è¿™äº›æ–¹æ¡ˆéƒ½æœ‰ä¸€äº›é€šç—…ï¼Œé‚£å°±æ˜¯éœ€è¦éšç€åº”ç”¨ç¨‹åºä¸€èµ·ç¼–è¯‘æ¥ä½¿ç”¨ï¼Œå¦‚æœè®¤è¯ç³»ç»Ÿæœ‰é—®é¢˜ï¼Œæˆ–è€…æ›´æ–°äº†ç®—æ³•ï¼Œå°±éœ€è¦é‡æ–°ç¼–è¯‘æ‰èƒ½ä½¿ç”¨ã€‚</p><blockquote><p>é‰´äºä»¥ä¸ŠåŸå› ï¼Œäººä»¬å¼€å§‹å¯»æ‰¾ä¸€ç§æ›´ä½³çš„æ›¿ä»£æ–¹æ¡ˆï¼šä¸€æ–¹é¢ï¼Œå°†é‰´åˆ«åŠŸèƒ½ä»åº”ç”¨ä¸­ç‹¬ç«‹å‡ºæ¥ï¼Œå•ç‹¬è¿›è¡Œæ¨¡å—åŒ–è®¾è®¡ï¼Œå®ç°å’Œç»´æŠ¤ï¼›å¦ä¸€æ–¹é¢ï¼Œä¸ºè¿™äº›é‰´åˆ«æ¨¡å—å»ºç«‹æ ‡å‡† APIï¼Œä»¥ä¾¿å„åº”ç”¨ç¨‹åºèƒ½æ–¹ä¾¿çš„ä½¿ç”¨å®ƒä»¬æä¾›çš„å„ç§åŠŸèƒ½ï¼›åŒæ—¶ï¼Œé‰´åˆ«æœºåˆ¶å¯¹å…¶ä¸Šå±‚ç”¨æˆ·ï¼ˆåŒ…æ‹¬åº”ç”¨ç¨‹åºå’Œæœ€ç»ˆç”¨æˆ·ï¼‰æ˜¯é€æ˜çš„ã€‚</p></blockquote><h3 id="PAMæ˜¯å¦‚ä½•å·¥ä½œçš„"><a href="#PAMæ˜¯å¦‚ä½•å·¥ä½œçš„" class="headerlink" title="PAMæ˜¯å¦‚ä½•å·¥ä½œçš„"></a>PAMæ˜¯å¦‚ä½•å·¥ä½œçš„</h3><img src="/2018/04/01/Linux%E7%9A%84PAM%E6%98%AF%E4%BB%80%E4%B9%88/PAM%E7%BB%93%E6%9E%84.png" class=""><p>PAMé‡‡ç”¨äº†åˆ†å±‚çš„æ¨¡å—å¼å¼€å‘ï¼Œæä¾›äº†å››ç§ç±»å‹çš„æ¨¡å—:</p><ul><li>è®¤è¯ç®¡ç†</li><li>è´¦å·ç®¡ç†</li><li>ä¼šè¯ç®¡ç†</li><li>å£ä»¤ç®¡ç†</li></ul><p>è¿™å››ä¸ªæ¥å£å°±å¯ä»¥æ»¡è¶³ç”¨æˆ·çš„è®¤è¯å’Œç®¡ç†ã€‚ä¸€ä¸ªæ¨¡å—å¯ä»¥åŒæ—¶å±äºå¤šç§ç±»å‹ï¼Œåªéœ€å®ç°å¯¹åº”çš„å‡½æ•°å°±å¯ä»¥ã€‚</p><p>ç›®å‰PAMçš„å®ç°æœ‰ä»¥ä¸‹ä¸‰ç§ï¼š</p><blockquote><ol><li>Linux-PAM: Linux-PAM æ¶µç›–äº†æœ¬æ–‡ä¸­è®¨è®ºçš„æ‰€æœ‰ PAMã€‚åœ¨ä»»ä½•ä¸€ä¸ª Linux å¹³å°ä¸­çš„ PAM çš„ä¸»è¦ç»“æ„éƒ½ç±»ä¼¼äº Linux-PAM ç‰ˆæœ¬ã€‚</li><li>OpenPAM: OpenPAM æ˜¯ç”± NAI å®éªŒå®¤çš„ Dag-Erling Smorgrav å¼€å‘çš„å¦ä¸€ä¸ª PAM å®ç°ï¼Œå±äº DARPA-CHATS ç ”ç©¶é¡¹ç›®ã€‚ç”±äºå®ƒæ˜¯å¼€æºçš„ï¼Œå› æ­¤å®ƒä¸»è¦ç”± FreeBSDã€NetBSD åŠåº”ç”¨ç¨‹åºï¼ˆåŠ ä¸Š Mac OS Xï¼‰ä½¿ç”¨ã€‚</li><li>Javaâ„¢ PAM æˆ– JPam: PAM ä¸»è¦æ˜¯æ”¯æŒ Linux å’Œ UNIX çš„æ ‡å‡†éªŒè¯æ¨¡å—ã€‚JPam å°† Java éƒ¨åˆ†ä¸æ™®é€š PAM è”ç³»äº†èµ·æ¥ã€‚JPam å…è®¸åŸºäº Java çš„åº”ç”¨ç¨‹åºä½¿ç”¨ PAM æ¨¡å—æˆ–å·¥å…·ï¼ˆå¦‚ authã€accountã€passwdã€session ç­‰ï¼‰ã€‚å®ƒæä¾›äº† JAAS å’Œç›´æ¥ APIï¼Œå¹¶ä¸”æ”¯æŒå¤§å¤šæ•° Unix OS å’Œæ¶æ„ã€‚</li></ol></blockquote><p>è™½ç„¶æœ‰ä¸åŒçš„PAMå®ç°ï¼Œä½†æ˜¯ä¸»è¦åŠŸèƒ½éƒ½æ˜¯ç±»ä¼¼çš„ï¼Œå®Œæˆç”¨æˆ·çš„éªŒè¯ã€‚</p><p>æƒ³è¦äº†è§£æ›´å¤šï¼Œå¯æŸ¥çœ‹IBMçš„æ–‡æ¡£åº“ã€‚<br><a href="https://www.ibm.com/developerworks/cn/linux/l-cn-pam/index.html">æ·±å…¥ Linux PAM ä½“ç³»ç»“æ„</a></p><h3 id="å¦‚ä½•è‡ªå·±å¼€å‘PAMæ¨¡å—"><a href="#å¦‚ä½•è‡ªå·±å¼€å‘PAMæ¨¡å—" class="headerlink" title="å¦‚ä½•è‡ªå·±å¼€å‘PAMæ¨¡å—"></a>å¦‚ä½•è‡ªå·±å¼€å‘PAMæ¨¡å—</h3><p>PAMæ¨¡å—ä½¿ç”¨ä¸€ä¸ªpam_handleç±»å‹çš„ç»“æ„å½“åšå¥æŸ„ï¼Œä¹Ÿæ˜¯å”¯ä¸€ä¸€ä¸ªPAMå’Œç¨‹åºè¿›è¡Œé€šä¿¡çš„ç»“æ„ã€‚</p><p>é¦–å…ˆåœ¨ç¼–å†™çš„æœåŠ¡æ¨¡å—çš„æºç¨‹åºé‡Œè¦åŒ…å«ä¸‹åˆ—å¤´æ–‡ä»¶ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#include &lt;security/pam_modules.h&gt;</span><br></pre></td></tr></table></figure><p>PAMæ¨¡å—æ˜¯ä¸€ä¸ªä¸ªçš„soåŠ¨æ€åº“ã€‚PAMä¼šé€šè¿‡dlopenæ¥è£…è½½è¿™äº›soã€‚å››ä¸ªæ¨¡å—åˆ†åˆ«éœ€è¦å®ç°å¯¹åº”çš„æ–¹æ³•ï¼ŒPAMä¼šæ ¹æ®é…ç½®æ–‡ä»¶æ¥è°ƒç”¨è¿™äº›æ–¹æ³•ã€‚</p><p>æ¯ä¸ªPAMæ¨¡å—çš„è®¤è¯ç¨‹åºéƒ½ä»¥pam_startå¼€å§‹ï¼Œä»¥pam_endç»“æŸã€‚PAMè¿˜æä¾›äº†pam_get_itemå’Œpam_set_itemå…±äº«æœ‰å…³è®¤è¯ä¼šè¯çš„æŸäº›å…¬å…±ä¿¡æ¯ï¼Œä¾‹å¦‚ç”¨æˆ·åã€æœåŠ¡åå’Œå¯†ç ã€‚åº”ç”¨ç¨‹åºåœ¨è°ƒç”¨äº†pam_startä»¥åå¯ä»¥ç”¨è¿™äº›APIsæ¥æ”¹å˜çŠ¶æ€ä¿¡æ¯ã€‚å®é™…å·¥ä½œçš„å‡½æ•°æœ‰6ä¸ªï¼š</p><table><thead><tr><th>æ¨¡å—ç±»å‹</th><th>å‡½æ•°</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td>è®¤è¯ç®¡ç†</td><td>PAM_EXTERN int pam_sm_authenticate(pam_handle_t *pamh, int flags, int argc, const char **argv)</td><td>è®¤è¯ç”¨æˆ·</td></tr><tr><td>è®¤è¯ç®¡ç†</td><td>PAM_EXTERN int pam_sm_setcred(pam_handle_t *pamh, int flags, int argc, const char **argv)</td><td>è®¾ç½®ç”¨æˆ·è¯ä¹¦</td></tr><tr><td>è´¦å·ç®¡ç†</td><td>PAM_EXTERN int pam_sm_acct_mgmt(pam_handle_t *pamh, int flags, int argc, const char **argv)</td><td>è´¦å·ç®¡ç†</td></tr><tr><td>ä¼šè¯ç®¡ç†</td><td>PAM_EXTERN int pam_sm_open_session(pam_handle_t *pamh, int flags, int argc, const char **argv)</td><td>æ‰“å¼€ä¼šè¯</td></tr><tr><td>ä¼šè¯ç®¡ç†</td><td>PAM_EXTERN int pam_sm_close_session(pam_handle_t *pamh, int flags, int argc, const char **argv)</td><td>å…³é—­ä¼šè¯</td></tr><tr><td>å£ä»¤ç®¡ç†</td><td>PAM_EXTERN int pam_sm_chauthtok(pam_handle_t *pamh, int flags, int argc, const char **argv)</td><td>è®¾ç½®å£ä»¤</td></tr></tbody></table><p>åŒä¸€ä¸ªæ¨¡å—å¯ä»¥åŒæ—¶æ”¯æŒä¸åŒçš„ç±»å‹ï¼Œå¯ä»¥ä¸€ä¸ªæ¨¡å—å…¨éƒ¨å®ç°è¿™äº›æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥å®ç°éƒ¨åˆ†ã€‚PAMè‡ªå¸¦çš„pam_unix.soå°±æ˜¯æ”¯æŒå››ç§ç±»å‹ã€‚</p><p>åœ¨å‡½æ•°å†…è¿›è¡Œè¯¦ç»†çš„æ“ä½œï¼Œæœ€åè¿”å›ç»“æœï¼Œå³å¯å®Œæˆæ•´ä¸ªéªŒè¯æµç¨‹ã€‚</p><h3 id="é…ç½®PAM"><a href="#é…ç½®PAM" class="headerlink" title="é…ç½®PAM"></a>é…ç½®PAM</h3><p>PAMçš„é…ç½®é€šå¸¸åœ¨&#x2F;etc&#x2F;pam.d&#x2F;ä¸‹ã€‚</p><p>æ¨¡å—å°†æŒ‰ç…§åœ¨é…ç½®æ–‡ä»¶ä¸­åˆ—å‡ºçš„é¡ºåºè¢«è°ƒç”¨ï¼Œè¿™å–å†³äºæ¯ä¸ªæ¡ç›®å…è®¸çš„ Control_flag çš„å€¼ã€‚Control_flag å€¼åŒ…æ‹¬ï¼š</p><blockquote><p>Requiredï¼šå †æ ˆä¸­çš„æ‰€æœ‰ Required æ¨¡å—å¿…é¡»çœ‹ä½œä¸€ä¸ªæˆåŠŸçš„ç»“æœã€‚å¦‚æœä¸€ä¸ªæˆ–å¤šä¸ª Required æ¨¡å—å¤±è´¥ï¼Œåˆ™å®ç°å †æ ˆä¸­çš„æ‰€æœ‰ Required æ¨¡å—ï¼Œä½†æ˜¯å°†è¿”å›ç¬¬ä¸€ä¸ªé”™è¯¯ã€‚</p><p>Sufficientï¼šå¦‚æœæ ‡è®°ä¸º sufficient çš„æ¨¡å—æˆåŠŸå¹¶ä¸”å…ˆå‰æ²¡æœ‰ Required æˆ– sufficient æ¨¡å—å¤±è´¥ï¼Œåˆ™å¿½ç•¥å †æ ˆä¸­çš„æ‰€æœ‰å…¶ä½™æ¨¡å—å¹¶è¿”å›æˆåŠŸã€‚</p><p>Optionalï¼šå¦‚æœå †æ ˆä¸­æ²¡æœ‰ä¸€ä¸ªæ¨¡å—æ˜¯ required å¹¶ä¸”æ²¡æœ‰ä»»ä½•ä¸€ä¸ª sufficient æ¨¡å—æˆåŠŸï¼Œåˆ™æœåŠ¡&#x2F;åº”ç”¨ç¨‹åºè‡³å°‘è¦æœ‰ä¸€ä¸ª optional æ¨¡å—æˆåŠŸã€‚</p></blockquote><h3 id="åœ¨ç¨‹åºä¸­ä½¿ç”¨PAMè¿›è¡ŒéªŒè¯"><a href="#åœ¨ç¨‹åºä¸­ä½¿ç”¨PAMè¿›è¡ŒéªŒè¯" class="headerlink" title="åœ¨ç¨‹åºä¸­ä½¿ç”¨PAMè¿›è¡ŒéªŒè¯"></a>åœ¨ç¨‹åºä¸­ä½¿ç”¨PAMè¿›è¡ŒéªŒè¯</h3><ol><li>å¼€å‘PAMéªŒè¯æ¨¡å—</li></ol><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#include &lt;security/pam_appl.h&gt;</span><br><span class="line">#include &lt;security/pam_modules.h&gt;</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"></span><br><span class="line">// åªå®ç°è´¦æˆ·è®¤è¯</span><br><span class="line">PAM_EXTERN int pam_sm_authenticate(pam_handle_t *pamh, int flags, int argc,</span><br><span class="line">                                   const char **argv) &#123;</span><br><span class="line">  char *username;</span><br><span class="line">  char password[256];</span><br><span class="line"></span><br><span class="line">  //å¾—åˆ°ç”¨æˆ·å</span><br><span class="line">  pam_get_user(pamh, &amp;username, &quot;Username: &quot;);</span><br><span class="line"></span><br><span class="line">  // å¾—åˆ°å¯†ç </span><br><span class="line">  printf(&quot;Password: &quot;);</span><br><span class="line">  gets(password);</span><br><span class="line"></span><br><span class="line">  // æµ‹è¯•åˆ¤æ–­ï¼Œå¦‚æœç”¨æˆ·åå’Œå¯†ç ä¸ç›¸ç­‰ï¼Œå°±è®¤è¯å¤±è´¥</span><br><span class="line">  if (strcmp(username, password) != 0) &#123;</span><br><span class="line">    return PAM_AUTH_ERR;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  printf(&quot;Password is: %s\n&quot;, password);</span><br><span class="line">  return PAM_SUCCESS;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">gcc -fPIC -fno-stack-protector -c pam_test_mod.c</span><br><span class="line">sudo ld -x --shared -o /lib/security/pam_test_mod.so pam_test_mod.o</span><br></pre></td></tr></table></figure><p>è¿˜éœ€è¦ä¿®æ”¹pamçš„é…ç½®ï¼Œæ¥åŠ è½½è¿™ä¸ªsoã€‚ç¼–è¾‘&#x2F;etc&#x2F;pam.d&#x2F;common-auth</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">auth [success=1 default=ignore] pam_test_mod.so</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„successçš„å€¼éœ€è¦æ ¹æ®å®é™…æƒ…å†µæ¥è°ƒæ•´ï¼Œå¿…é¡»æ˜¯æ‰€æœ‰é‡Œé¢çš„æœ€å¤§å€¼ã€‚</p><ol start="2"><li>ä½¿ç”¨æ¨¡å—è¿›è¡ŒéªŒè¯</li></ol><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// PAMå¿…é¡»çš„ä¸¤ä¸ªå¤´æ–‡ä»¶</span><br><span class="line">#include &lt;iostream&gt;</span><br><span class="line">#include &lt;security/pam_appl.h&gt;</span><br><span class="line">#include &lt;security/pam_misc.h&gt;</span><br><span class="line"></span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line">extern int misc_conv(int num_msg, const struct pam_message **msgm,</span><br><span class="line">                     struct pam_response **response, void *appdata_ptr) &#123;</span><br><span class="line"></span><br><span class="line">  return PAM_SUCCESS;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const struct pam_conv conv = &#123;misc_conv, NULL&#125;;</span><br><span class="line"></span><br><span class="line">int main(int argc, char *argv[]) &#123;</span><br><span class="line">  // åˆå§‹åŒ–</span><br><span class="line">  pam_handle_t *pamh = NULL;</span><br><span class="line">  int retval;</span><br><span class="line">  const char *username = argv[1];</span><br><span class="line"></span><br><span class="line">  // åˆå§‹åŒ–PAM è®¾ç½®common-authä¸ºéªŒè¯é…ç½®</span><br><span class="line">  if ((pam_start(&quot;common-auth&quot;, username, &amp;conv, &amp;pamh)) != PAM_SUCCESS) &#123;</span><br><span class="line">    return -1;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // //è®¤è¯ç”¨æˆ·</span><br><span class="line">  retval = pam_authenticate(pamh, 0);</span><br><span class="line"></span><br><span class="line">  cout &lt;&lt; (retval == PAM_SUCCESS ? &quot;SUCCESS\n&quot; : &quot;Failed\n&quot;) &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">  // // ç»“æŸPAM</span><br><span class="line">  if (pam_end(pamh, retval) != PAM_SUCCESS) &#123;</span><br><span class="line">    cout &lt;&lt; &quot;check_user: failed to release authenticator\n&quot; &lt;&lt; endl;</span><br><span class="line">    return -1;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  return retval == PAM_SUCCESS ? 0 : 1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘æµ‹è¯•ä¸€ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">g++ -o pam_test pam_test.cc -lpam -lpam_misc</span><br><span class="line">sudo ./pam_test $USER</span><br></pre></td></tr></table></figure><p>è¾“å‡ºä¸ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ ./pam_test test       </span><br><span class="line">Password: test</span><br><span class="line">Password is: test</span><br><span class="line">SUCCESS</span><br></pre></td></tr></table></figure><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>åŸºäºPAMè®¤è¯ä½“ç³»ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚ä»»æ„çš„æ‰©å±•linuxè´¦æˆ·ï¼Œlinuxä¸‹çš„pbis-openï¼Œå°±æ˜¯åŸºäºPAMæ‰©å±•å‡ºæ¥çš„ä¸€ä¸ªADåŸŸç™»å½•æ¨¡å—ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªpam_lsass.soçš„æ–‡ä»¶ï¼Œæ¥è¿›è¡Œè´¦æˆ·çš„éªŒè¯ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå·±è®¾è®¡ä¸€å¥—è®¤è¯æµç¨‹ï¼Œåªéœ€è¦æ»¡è¶³ä¸Šé¢çš„æ¥å£è¦æ±‚å°±å¯ä»¥ã€‚</p><blockquote><p>æä¾›æœºåˆ¶ï¼Œè€Œéç­–ç•¥</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é‡æ„dde-session-ui</title>
      <link href="/2018/03/11/%E9%87%8D%E6%9E%84dde-session-ui/"/>
      <url>/2018/03/11/%E9%87%8D%E6%9E%84dde-session-ui/</url>
      
        <content type="html"><![CDATA[<p>dde-session-uié‡Œé¢åŒ…å«äº†å¾ˆå¤šé¡¹ç›®ï¼Œæ˜¯ä¸€ä¸ªé›†åˆï¼Œä½†æ˜¯å…¶ä¸­çš„ä»£ç ç¼ºå°‘åˆç†çš„ç»´æŠ¤ï¼Œä»¥è‡³äºå·²ç»åˆ°äº†å¿…é¡»é‡æ„æ‰èƒ½ç»§ç»­å¼€å‘å’Œç»´æŠ¤ï¼Œåœ¨æ”¯æŒADåŸŸç™»å½•çš„æ—¶å€™ï¼Œå¦‚æœå¼ºåˆ¶åŠ ä¸ŠåŠŸèƒ½ï¼Œä»£ç ä¼šå˜å¾—æ›´åŠ ç³Ÿç³•ï¼Œæ‰€ä»¥å’ŒçŸ³åšæ–‡ä¸€å—é‡æ„äº†å…¶ä¸­éå¸¸é‡è¦çš„UserWidgetã€‚</p><span id="more"></span><h2 id="é‡æ„å‰çš„è®¾è®¡"><a href="#é‡æ„å‰çš„è®¾è®¡" class="headerlink" title="é‡æ„å‰çš„è®¾è®¡"></a>é‡æ„å‰çš„è®¾è®¡</h2><p>é‡æ„å‰çš„dde-lockå’Œlightdm-deepin-greeteræ˜¯éå¸¸æ··ä¹±çš„ï¼Œå¤„ç†é€»è¾‘éƒ½æ··æ‚åœ¨ä¸€å—ï¼Œè™½ç„¶èƒ½çœ‹å‡ºæœ‰åŸºæœ¬çš„ç»“æ„ï¼Œä½†æ˜¯æ•´ä½“å¹¶æœªè§£è€¦ã€‚</p><h2 id="é‡æ„åçš„è®¾è®¡"><a href="#é‡æ„åçš„è®¾è®¡" class="headerlink" title="é‡æ„åçš„è®¾è®¡"></a>é‡æ„åçš„è®¾è®¡</h2><ul><li>åŸºäºUserç±»çš„å¤„ç†</li><li>UserWidgetè´Ÿè´£æä¾›å¯¹ç”¨æˆ·çš„å¤„ç†ï¼Œæš´éœ²å‡ºåŸºæœ¬çš„currentUserå’ŒLogindUsersã€‚</li><li>Lockå’ŒGreeterçš„Managerä»UserWidgetã€SessionWidgetä¸­è·å–ç”¨æˆ·å’Œç”¨æˆ·çš„ä¼šè¯ã€‚</li><li>Manageråªè´Ÿè´£æ§ä»¶çš„ä½ç½®å’Œç”¨æˆ·çš„éªŒè¯ã€‚</li><li>èƒŒæ™¯ä¿®æ”¹ä¸ºManageræä¾›æ¨¡ç³Šçš„å£çº¸ï¼ŒFullBackgroundåªæä¾›ç»˜åˆ¶ã€‚</li></ul><p>é‡æ„ä»¥åç”¨äº†å¤§æ¦‚åŸä»£ç çš„1&#x2F;3ï¼Œå¯åŠ¨é€Ÿåº¦ä¹Ÿå¿«äº†ï¼Œæ„Ÿè§‰ä¸–ç•Œå……æ»¡äº†ç¾å¥½â€¦ å°±æ˜¯é‡æ„å†ç¨‹å¤ªè¾›è‹¦â€¦</p><p>æœ¬æ¬¡ä¹Ÿå‘ç°äº†å¾ˆå¤šè‡ªèº«çš„é—®é¢˜ï¼ŒåŸºç¡€å¹¶æ²¡æœ‰å­¦å¥½ï¼Œå¾ˆå¤šåœ°æ–¹éƒ½å¯ä»¥ä½¿ç”¨æ›´å¥½çš„å¤„ç†æ–¹å¼ã€å°±æ˜¯ç®¡ä¸ä½è¿™æ‰‹â€¦ã€‘</p>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨DTKå¼€å‘</title>
      <link href="/2018/01/12/%E4%BD%BF%E7%94%A8DTK%E5%BC%80%E5%8F%91/"/>
      <url>/2018/01/12/%E4%BD%BF%E7%94%A8DTK%E5%BC%80%E5%8F%91/</url>
      
        <content type="html"><![CDATA[<p><strong>åœ¨é˜…è¯»æœ¬ç¯‡æ–‡ç« ä¹‹å‰ï¼Œä½ éœ€è¦æŒæ¡åŸºæœ¬çš„Qt&#x2F;C++å¼€å‘çŸ¥è¯†ã€‚</strong></p><span id="more"></span><blockquote><p><strong>æ³¨æ„ï¼šæœ¬ç¯‡æ–‡ç« åŸºäºDeepinå¹³å°ï¼Œå…¶ä»–å¹³å°è¯·è‡ªè¡Œè¡¥å……ä¾èµ–å…³ç³»ã€‚</strong></p></blockquote><p>å…ˆå®‰è£…DTKçš„ä¾èµ–å…³ç³»ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo apt install libdtkwidget2 libdtkcore2</span><br></pre></td></tr></table></figure><p>æ–°å»ºQté¡¹ç›®ï¼Œç¼–è¾‘proæ–‡ä»¶ï¼Œæ·»åŠ é¡¹ç›®ä¾èµ–ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CONFIG += c++14 link_pkgconfig</span><br><span class="line">PKGCONFIG += dtkwidget</span><br></pre></td></tr></table></figure><p>DTKç›®å‰æœ‰ä¸¤ä¸ªç»„ä»¶ï¼Œä¸€ä¸ªæ˜¯æä¾›åº“åŠŸèƒ½çš„coreï¼Œä¸€ä¸ªæ˜¯æä¾›æ§ä»¶çš„widgetã€‚</p><p>ä¿®æ”¹main.cpp,åˆ é™¤QApplicationçš„ç›¸å…³å†…å®¹ï¼Œæ”¹ä¸ºDApplicationã€‚</p><blockquote><p>æ³¨æ„ï¼š ä½¿ç”¨DTKçš„ç»„ä»¶ï¼Œéœ€è¦ä½¿ç”¨DTKçš„å®,æ ¹æ®ä½¿ç”¨çš„æ–‡ä»¶æ¥é€‰æ‹©å¯¹åº”çš„å®ã€‚</p></blockquote><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">DWIDGET_USE_NAMESPACE</span><br><span class="line">DCORE_USE_NAMESPACE</span><br></pre></td></tr></table></figure><p>DTKä½¿ç”¨äº†deepinè‡ªå·±çš„qtæ’ä»¶ï¼Œéœ€è¦åœ¨DApplicationå‰è°ƒç”¨ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">DApplication::loadDXcbPlugin();</span><br><span class="line">DApplication app(argc, argv);</span><br></pre></td></tr></table></figure><p>DApplicationä¸­æä¾›äº†å¾ˆå¤šæ–¹æ³•æ¥è®¾ç½®ç¨‹åºçš„å„ç§ä¿¡æ¯ï¼Œå…·ä½“è¯·çœ‹å¤´æ–‡ä»¶çš„å®šä¹‰ã€‚</p><p>ä¸»çª—å£ç”±DMainWindowæä¾›ï¼Œæ–°å»ºç±»ï¼Œç„¶åæ·»åŠ DMainWindowçš„å¤´æ–‡ä»¶å’ŒDTKWIDGETçš„å®ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#include &lt;DMainWindow&gt;</span><br><span class="line"></span><br><span class="line">DWIDGET_USE_NAMESPACE</span><br></pre></td></tr></table></figure><p>ç„¶åä¿®æ”¹ç»§æ‰¿å…³ç³»ï¼Œæ”¹ä¸ºç»§æ‰¿DMainWindowã€‚DMainWindowæä¾›äº†ä¸€äº›æˆ‘ä»¬å°è£…çš„æ–¹æ³•ã€‚ç›®å‰ä¸ºæ­¢ï¼Œè¯¥ç¨‹åºçš„ç•Œé¢å·²ç»ç¬¦åˆDeepinç¨‹åºçš„é£æ ¼äº†ï¼Œæˆ‘ä»¬å°è£…äº†ä¸€äº›å…¶ä»–æ§ä»¶ï¼Œä½¿å…¶æ ·å¼ç¬¦åˆæˆ‘ä»¬çš„é£æ ¼ï¼Œå¦‚æœè¦åœ¨å…¶ä»–Qtç¨‹åºä¸­ä½¿ç”¨ï¼Œä¹Ÿæ˜¯åŒæ ·çš„æ­¥éª¤ï¼Œè½½å…¥Qtæ’ä»¶ï¼Œæ·»åŠ å¯¹åº”çš„å¤´æ–‡ä»¶å’ŒDTKçš„å®ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Linux DTK </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è§£å†³IntelliJ IDEAç•Œé¢ççœ¼</title>
      <link href="/2017/12/25/%E8%A7%A3%E5%86%B3IntelliJ-IDEA%E7%95%8C%E9%9D%A2%E7%9E%8E%E7%9C%BC/"/>
      <url>/2017/12/25/%E8%A7%A3%E5%86%B3IntelliJ-IDEA%E7%95%8C%E9%9D%A2%E7%9E%8E%E7%9C%BC/</url>
      
        <content type="html"><![CDATA[<p>ä»Šå¤©åœ¨é€›æ·±åº¦è®ºå›çš„æ—¶å€™ï¼Œæ— æ„é—´çœ‹åˆ°äº†æœ‰ä¸ªå›å¤ï¼Œæ˜¯å¤„ç†IEDAå­—ä½“å¾ˆæŒ«çš„ï¼Œè¯•äº†ä¸€ä¸‹ï¼Œæ•ˆæœéå¸¸æ£’ã€‚</p><p>æˆ‘ä¹‹å‰ä¹Ÿè¯•äº†äº›ç½‘ä¸Šçš„åŠæ³•ï¼Œéƒ½æ²¡æœ‰è§£å†³ï¼Œå­—ä½“æŒ«çš„æ ¹æœ¬çœ‹ä¸äº†ï¼Œè¢«é€¼æ— å¥ˆè·‘åˆ°windowsä¸‹å†™MODäº†ã€‚</p><span id="more"></span><p><a href="https://bbs.deepin.org/forum.php?mod=redirect&goto=findpost&ptid=150634&pid=418410&fromuid=13250">åŸæ–‡é“¾æ¥</a></p><p>åœ¨&#x2F;etc&#x2F;profile.d&#x2F;æ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œç”¨æ¥è®¾ç½®javaçš„ç¯å¢ƒå˜é‡:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo vim /etc/profile.d/z999__java_options.sh</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">opts=&quot; -Dswing.aatext=true  -Dawt.useSystemAAFontSettings=lcd -Djava.net.useSystemProxies=true &quot;</span><br><span class="line">export _JAVA_OPTIONS=&quot;`echo $&#123;_JAVA_OPTIONS&#125; |sed -Ee &#x27;s/-Dawt.useSystemAAFontSettings=\w+//ig&#x27;` $opts&quot;</span><br></pre></td></tr></table></figure><p>ç„¶åæ³¨é”€å†ç™»å½•ï¼Œå°±å¯ä»¥çœ‹åˆ°æ•ˆæœäº†ã€‚</p><p>å…¶å®è¿™ä¸ªè§£å†³åŠæ³•åœ¨archçš„wikiä¸Šæœ‰ï¼Œåªä¸è¿‡ä¼¼ä¹æ˜¯æˆ‘å†™é”™äº†å§ï¼Œåæ­£æ˜¯æ²¡ç”Ÿæ•ˆï¼ŒæŒ‰ç…§è¿™ç§æ–¹æ³•æ˜¯å¯ä»¥çš„ï¼Œå°±è¿™ä¹ˆç”¨å§ã€‚éå¸¸æ„Ÿè§‰@ihipopã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¿®å¤Archlinuxçš„Grub</title>
      <link href="/2017/12/18/%E4%BF%AE%E5%A4%8DArchlinux%E7%9A%84Grub/"/>
      <url>/2017/12/18/%E4%BF%AE%E5%A4%8DArchlinux%E7%9A%84Grub/</url>
      
        <content type="html"><![CDATA[<p>åˆåŒå’å•ä¸çŸ¥é“æ€ä¹ˆæçš„ï¼Œå°±æŠŠarchçš„grubç»™å¼„åäº†ï¼Œä½†æ˜¯åœ¨é‡æ–°å®‰è£…grubçš„æ—¶å€™ï¼Œæç¤ºäº†è¿™ä¹ˆä¸€ä¸ªé”™è¯¯:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Could not prepare Boot variable: No space left on device</span><br></pre></td></tr></table></figure><p>è¯¶ä¸å¯¹å•Šï¼Œbootåˆ†åŒºè¿˜æœ‰800Må‘¢ï¼Œæ€ä¹ˆè¿™ä¹ˆå¿«æ²¡ç©ºé—´äº†ï¼Œæ ¹ç›®å½•ä¹Ÿæœ‰52Gå‘¢ï¼Œäºæ˜¯è°·æ­Œäº†ä¸€æŠŠï¼Œæ‰¾åˆ°äº†è§£å†³åŠæ³•.</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo rm /sys/firmware/efi/efivars/dump-*</span><br></pre></td></tr></table></figure><blockquote><p>æ–°å¼ efivarfs (EFI VARiable FileSystem) æ¥å£ (CONFIG_EFIVAR_FS) - ç”±ä½äº &#x2F;sys&#x2F;firmware&#x2F;efi&#x2F;efivars çš„ efivarfs å†…æ ¸æ¨¡å—æŒ‚è½½ä½¿ç”¨ - è€å¼ sysfs-efivars æ¥å£çš„æ›¿ä»£å“ï¼Œä¸é™åˆ¶å˜é‡æ•°æ®å¤§å°ï¼Œæ”¯æŒ UEFI Secure Boot å˜é‡å¹¶è¢«ä¸Šæ¸¸æ¨èä½¿ç”¨ã€‚åœ¨3.8ç‰ˆçš„å†…æ ¸ä¸­å¼•å…¥ï¼Œæ–°çš„ efivarfs æ¨¡å—åœ¨3.10ç‰ˆå†…æ ¸ä¸­ä»æ—§çš„ efivars å†…æ ¸æ¨¡å—ä¸­åˆ†ç¦»ã€‚</p></blockquote><p>åˆ æ‰dumpæ–‡ä»¶ï¼Œå°±å¯ä»¥æ­£å¸¸å®‰è£…äº†ã€æœ‰ç‚¹è¿·ï¼Œä¸åº”è¯¥å•Šã€‚</p><p>å‚è€ƒèµ„æ–™ : <a href="https://wiki.archlinux.org/index.php/Unified_Extensible_Firmware_Interface_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">Unified_Extensible_Firmware_Interface</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è§£å†³NVIDIAé‡æ–°å¯åŠ¨ä»¥åç³»ç»Ÿå†»ç»“</title>
      <link href="/2017/09/01/%E8%A7%A3%E5%86%B3NVIDIA%E9%87%8D%E6%96%B0%E5%90%AF%E5%8A%A8%E4%BB%A5%E5%90%8E%E7%B3%BB%E7%BB%9F%E5%86%BB%E7%BB%93/"/>
      <url>/2017/09/01/%E8%A7%A3%E5%86%B3NVIDIA%E9%87%8D%E6%96%B0%E5%90%AF%E5%8A%A8%E4%BB%A5%E5%90%8E%E7%B3%BB%E7%BB%9F%E5%86%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<p>åˆ†æœŸä¹°äº†ä¸€å°ç¥èˆŸ Z6-kp5s1ï¼Œé…ç½®è¿˜ä¸é”™ï¼Œå¤Ÿç”¨ä¸‰å¹´äº†ï¼Œä½†æ˜¯åœ¨linuxä¸‹ä½¿ç”¨bumblebeeçš„æ—¶å€™ï¼Œå‘ç”Ÿäº†é—®é¢˜ï¼ŒæŠ˜è…¾äº†å¥½ä¹…ï¼Œç°åœ¨æŠŠè§£å†³æ–¹æ³•å†™å‡ºæ¥ã€‚</p><span id="more"></span><p>å…ˆè¯´ä¸€ä¸‹é—®é¢˜å§ï¼Œæ­£å¸¸å®‰è£…bumblebeeã€bbswitchå’Œnvidiaé©±åŠ¨ï¼Œé‡æ–°å¯åŠ¨ç³»ç»Ÿä»¥åï¼Œç³»ç»Ÿå‡ºç°å†»ç»“ï¼Œæ²¡æœ‰ä»»ä½•çš„è¾“å…¥è¾“å‡ºï¼Œæ²¡æœ‰ä»»ä½•æ—¥å¿—äº§ç”Ÿã€‚é—®é¢˜ä¼¼ä¹æ˜¯å›ºä»¶é”™è¯¯ï¼Œè¯¦æƒ…æŸ¥çœ‹<a href="https://github.com/Bumblebee-Project/Bumblebee/issues/764">è®¨è®º</a>å’ŒLinuxçš„bug<a href="https://bugzilla.kernel.org/show_bug.cgi?id=156341">è®¨è®º</a>ã€‚</p><p>è§£å†³æ–¹æ³•æ˜¯çœ‹çš„<a href="https://witiko.github.io/Optimus-on-Linux/">Witiko</a>çš„åšå®¢ï¼Œé€šè¿‡ç»™å†…æ ¸ä¼ é€’å‚æ•°æ¥é˜²æ­¢ç³»ç»Ÿå‡ºç°å†»ç»“ã€‚ä¿®æ”¹&#x2F;etc&#x2F;default&#x2F;grub,åœ¨æ–‡ä»¶åº•éƒ¨è¿½åŠ ä»¥ä¸‹å†…å®¹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># Bumblebee 3.2.1 fix (see https://github.com/Bumblebee-Project/Bumblebee/issues/764)</span><br><span class="line">GRUB_CMDLINE_LINUX_DEFAULT=&quot;$GRUB_CMDLINE_LINUX_DEFAULT &quot;&#x27;acpi_osi=! acpi_osi=&quot;Windows 2009&quot;&#x27;</span><br></pre></td></tr></table></figure><p>å¦‚æœä¸æ”¾å¿ƒï¼Œè¯·å…ˆç¦ç”¨ç™»å½•ç®¡ç†å™¨ï¼Œé˜²æ­¢å¼€æœºå°±å‡ºç°å†»ç»“ï¼Œç„¶åå°è¯•æ‰‹åŠ¨å¯åŠ¨ç™»å½•ç®¡ç†å™¨ã€‚åœ¨ttyç™»å½•ï¼Œç„¶åæ‰§è¡Œï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo systemctl start display-manager.service</span><br></pre></td></tr></table></figure><p>å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œä½ å°†ä¼šçœ‹åˆ°å›¾å½¢ï¼Œå¹¶ä¸”lspci -vä¸­èƒ½çœ‹åˆ°nvidiaå·²ç»è¢«ç¦ç”¨ï¼Œç„¶åä½¿ç”¨æä¾›çš„æµ‹è¯•æ–¹æ³•è¿›è¡Œæµ‹è¯•ï¼Œå¯ä»¥çœ‹åˆ°nvidiaè¢«å¯ç”¨ï¼Œå…³é—­æµ‹è¯•æˆåŠŸï¼Œnvidiaè¢«ç¦ç”¨ã€‚</p><p>æä¾›ä¸€ä¸‹æˆ‘å…³é—­nvidiaä»¥åçš„ä½¿ç”¨å’Œç»­èˆªæ—¶é—´å§ã€‚äº®åº¦è°ƒèŠ‚ä¸º50%ï¼Œcpuè®¾ç½®ä¸ºpowersaveï¼Œè¿è¡Œäº†ä¸€ä¸‹ç¨‹åºï¼š</p><ul><li>telegram</li><li>chrome</li><li>dde-file-manager</li><li>vs code</li><li>meow</li><li>è‹¥å¹²ss client</li><li>è¿˜æœ‰ä¸€å¤§å †ä¹±ä¸ƒå…«ç³Ÿçš„æœåŠ¡ï¼Œæ‡’å¾—å†™äº†</li></ul><p>ä»14:35å¼€å§‹æ–­ç”µæµ‹è¯•ï¼Œåˆ°17:17è¿˜æœ‰23%çš„ç”µé‡ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æˆ‘çš„ä»£ç†æŠ˜è…¾æ–¹æ¡ˆ</title>
      <link href="/2017/08/31/%E6%88%91%E7%9A%84%E4%BB%A3%E7%90%86%E6%8A%98%E8%85%BE%E6%96%B9%E6%A1%88/"/>
      <url>/2017/08/31/%E6%88%91%E7%9A%84%E4%BB%A3%E7%90%86%E6%8A%98%E8%85%BE%E6%96%B9%E6%A1%88/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨å‡†å¤‡åšæ–°çš„ä»£ç†è®¾ç½®ç•Œé¢ï¼Œç„¶åæƒ³åˆ°è‡ªå·±ä¹Ÿæ”¹æ”¹ä»£ç†çš„é…ç½®ï¼Œå¥½æ–¹ä¾¿çš„ç”¨åœ¨æ–°çš„è®¾ç½®ä¸Šã€‚</p><span id="more"></span><p>æˆ‘ä»¥å‰çš„æ—§æ–¹æ¡ˆæ˜¯ï¼š</p><p>privoxy â€“&gt; nginx â€“&gt; å¤šä¸ªsså®¢æˆ·ç«¯ &#x3D;&#x3D;&#x3D;&#x3D; å¤šä¸ªssæœåŠ¡ç«¯</p><p>privoxyç”¨æ¥å°†socksè½¬æˆhttpï¼Œnginxæ˜¯ç”¨æ¥å¤šä¸ªssè´Ÿè½½å‡è¡¡ã€‚</p><p>è¿™ä¸ªæ–¹æ¡ˆè™½ç„¶æœ‰ç‚¹éº»çƒ¦ï¼Œä½†æ˜¯ç”¨èµ·æ¥è¿˜æ˜¯å¾ˆå¼çš„ã€‚</p><p>ä½†æ˜¯æˆ‘ä»¬æ”¹äº†æ§åˆ¶ä¸­å¿ƒå¯¹ä»£ç†çš„è®¾ç½®ï¼Œåœ¨ç¨‹åºå‰é¢åŠ ä¸Šäº†proxychainsã€‚<br>åˆšå¥½å¯ä»¥å’Œæˆ‘çš„privoxyåœ¨ä½œç”¨ä¸Šå†²çªäº†ã€‚ä½†æ˜¯å…¶å®è¿˜æœ‰ä¸€äº›å…¶ä»–é—®é¢˜ï¼Œæˆ‘æ˜¯æ¯”è¾ƒæ‡’çš„äººï¼Œè·³è¿‡å¤§é™†ipå’Œå±€åŸŸç½‘å¯¹æˆ‘æ¥è¯´æ˜¯æœ‰å¾ˆå¤§å¸®åŠ©çš„ï¼Œè¿™æ ·æˆ‘å°±å¯ä»¥è®¾ç½®ä¸€ä¸ªå…¨å±€ä»£ç†ï¼Œè€Œä¸éœ€è¦ç»™æ¯ä¸ªç¨‹åºå•ç‹¬è®¾ç½®ã€‚</p><p>ä»¥å‰è‚¥çŒ«ç»™æˆ‘ä»‹ç»è¿‡ä¸€äº›æ–¹æ³•ï¼Œå½“åˆæˆ‘å¼„çš„æ—¶å€™ï¼Œè¿˜æ˜¯å¤ªå›¾æ ·ï¼Œæ€»æ˜¯ä¸èƒ½å¥½å¥½çš„ç¨³å®šå·¥ä½œï¼Œæ‰€ä»¥æš‚æ—¶æ”¾å¼ƒäº†å…¨å±€ä»£ç†çš„æ–¹æ¡ˆã€‚provixyå…¶å®æ˜¯å¯ä»¥åšè¿™æ ·çš„äº‹ï¼Œä½†æ˜¯å¥½éº»çƒ¦ï¼Œè¦è‡ªå·±æ·»åŠ å¾ˆå¤šè§„åˆ™ï¼Œgfwlistæ˜¯å¯ä»¥è½¬æˆå®ƒæ”¯æŒçš„actionï¼Œä½†æ˜¯è‡ªå·±å†æ·»åŠ çš„è¯ï¼Œå¾ˆéº»çƒ¦ã€‚ã€è€Œæˆ‘æ˜¯æ ¹æ¯”è¾ƒæ‡’çš„ç«¹å­</p><p>ä»Šå¤©æŠŠprovixyç»™æ’¤ä¸‹æ¥äº†ï¼Œæ¢ä¸Šä»¥å‰ç”¨çš„meowï¼Œæ˜¯ç”¨goå†™çš„ï¼Œä½œç”¨ä¹Ÿæ˜¯è½¬æˆhttpï¼Œä½†æ˜¯å®ƒæ”¯æŒçš„æ–¹æ¡ˆæ¯”è¾ƒå¤šï¼Œå¯ä»¥ç›´æ¥æ·»åŠ ssï¼Œä¹Ÿå¯ä»¥æ­£å‘ä»£ç†ã€‚å½“åˆä¸ç”¨å®ƒçš„åŸå› æ˜¯æˆ‘æƒ³éšæœºä½¿ç”¨ä¸€ä¸ªä»£ç†ï¼Œå½“æ—¶ç”µä¿¡å’Œæˆ‘è¿‡ä¸å»ï¼Œä¸€ä¸ªç«¯å£ç”¨ä¹…äº†ï¼Œå°±å°æˆ‘ä¸€å¤©ï¼Œå®³å¾—æˆ‘æ—©ä¸Šåˆ°å…¬å¸äº†ï¼Œå…ˆè¿œç¨‹åˆ°æœåŠ¡å™¨æ”¹ç«¯å£ï¼Œåæ¥åˆè§‰å¾—éº»çƒ¦ï¼Œç›´æ¥å¼€äº†5ä¸ªç«¯å£ï¼Œæ¯å¤©æ”¹æœ¬æœºï¼Œå†åæ¥å°±æƒ³éšæœºä½¿ç”¨äº†â€¦  ã€è¿˜æœ‰æ¬¡æŠŠæˆ‘çš„sshç«¯å£å°äº†ä¸€å¤©â€¦</p><p>ç°åœ¨çš„è¯ï¼Œå°±æ˜¯å˜æˆäº†è¿™ä¸ªç»“æ„ï¼š</p><p>meow â€“&gt; nginx â€“&gt; å¤šä¸ªsså®¢æˆ·ç«¯ &#x3D;&#x3D;&#x3D;&#x3D; å¤šä¸ªssæœåŠ¡ç«¯</p><p>nginxè¿˜æ˜¯ä»£æ›¿meowåšè´Ÿè½½å‡è¡¡ï¼Œmeowçš„å·¥ä½œå°±å˜æˆäº†è½¬æˆhttpä»£ç†å’Œé»‘ç™½åå•ã€‚</p><p>è™½ç„¶ä¸éœ€è¦æ–°çš„æ§åˆ¶ä¸­å¿ƒçš„ä»£ç†æ–¹æ¡ˆï¼Œç°åœ¨è¿™å¥—å°±å·¥ä½œçš„å¾ˆå¥½äº†ï¼Œä½†æ˜¯æ²¡æœ‰å®ƒï¼Œæˆ‘å°±ä¸ä¼šå†æŠ˜è…¾æ–°çš„ã€ç¬‘å“­</p>]]></content>
      
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¼€å‘topbarä¸­çš„æŠ€æœ¯é—®é¢˜</title>
      <link href="/2017/08/23/%E5%BC%80%E5%8F%91topbar%E4%B8%AD%E7%9A%84%E6%8A%80%E6%9C%AF%E9%97%AE%E9%A2%98/"/>
      <url>/2017/08/23/%E5%BC%80%E5%8F%91topbar%E4%B8%AD%E7%9A%84%E6%8A%80%E6%9C%AF%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<p>è¿™é‡Œè®°å½•äº†å¼€å‘topbarä¸­é‡åˆ°çš„å‘å’Œä¸€äº›é—®é¢˜ã€‚</p><span id="more"></span><p>ä½¿ç”¨Qtæä¾›çš„qxcbæ–¹æ³•æ³¨å†Œé˜´å½±ä¸ºdockç±»å‹ï¼Œåè€Œå¤„äºDESKTOPå’ŒNORMALä¹‹é—´ã€‚å…¶å®å½“åˆå¹¶ä¸æ˜¯æƒ³è®¾ç½®ä¸ºDOCKç±»å‹çš„ï¼Œå› ä¸ºè¿™æ ·é˜´å½±ä¹Ÿä¼šåœ¨çª—å£ä¸Šæ–¹ï¼Œæˆ‘å¸Œæœ›çš„æ˜¯é˜´å½±åœ¨æ™®é€šç¨‹åºä¸‹æ–¹ï¼Œåœ¨æ¡Œé¢ä¸Šæ–¹ã€‚ä»Šå¤©æ›¹å“¥æ¥è®²çª—ç®¡çš„ä¸€äº›å‘ï¼Œè®²åˆ°çª—ç®¡æ˜¯å¦‚ä½•æ§åˆ¶çª—å£çš„ï¼Œæˆ‘çš„é˜´å½±å…¶å®æ˜¯è¢«Qtæ³¨å†Œæˆ_NET_WM_STATE_BELOWäº†ã€‚<br><a href="https://specifications.freedesktop.org/wm-spec/1.3/ar01s05.html">è¿™é‡Œå¯ä»¥çœ‹åˆ°ä¸€äº›typeçš„ä»‹ç»</a>ã€‚</p><p>åœ¨_NET_WM_STATEä¸­ä¸€å…±æœ‰è¿™ä¹ˆå‡ ä¸ªç±»å‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">_NET_WM_STATE_MODAL, ATOM</span><br><span class="line">_NET_WM_STATE_STICKY, ATOM</span><br><span class="line">_NET_WM_STATE_MAXIMIZED_VERT, ATOM</span><br><span class="line">_NET_WM_STATE_MAXIMIZED_HORZ, ATOM</span><br><span class="line">_NET_WM_STATE_SHADED, ATOM</span><br><span class="line">_NET_WM_STATE_SKIP_TASKBAR, ATOM</span><br><span class="line">_NET_WM_STATE_SKIP_PAGER, ATOM</span><br><span class="line">_NET_WM_STATE_HIDDEN, ATOM</span><br><span class="line">_NET_WM_STATE_FULLSCREEN, ATOM</span><br><span class="line">_NET_WM_STATE_ABOVE, ATOM</span><br><span class="line">_NET_WM_STATE_BELOW, ATOM</span><br><span class="line">_NET_WM_STATE_DEMANDS_ATTENTION, ATOM</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¦‚æœç¨‹åºè¢«æ³¨å†Œæˆ_NET_WM_STATE_BELOWï¼Œåˆ™ä¼šè¢«æ”¾ç½®åœ¨DESKTOPä¹‹ä¸Šçš„ä¸€å±‚ã€‚ä¸æ˜¯å¾ˆæ¸…æ¥šQtæ˜¯å‡ºäºä»€ä¹ˆç­–ç•¥ï¼Œæ‰æŠŠæˆ‘çš„é˜´å½±æ³¨å†Œä¸ºè¿™ä¸ªçŠ¶æ€ï¼Œåè€Œæ˜¯åˆšå¥½æ»¡è¶³äº†æˆ‘çš„éœ€æ±‚ã€‚</p><p>è¿™è¦å¤šè°¢æ›¹å“¥äº†ï¼Œæˆ‘æ‰ç»ˆäºæ˜ç™½äº†ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Œä»¥åŠä»¥åå¦‚ä½•æ­£ç¡®çš„è®¾ç½®typeã€‚</p><img src="/2017/08/23/%E5%BC%80%E5%8F%91topbar%E4%B8%AD%E7%9A%84%E6%8A%80%E6%9C%AF%E9%97%AE%E9%A2%98/DeepinScreenshot_%E6%A1%8C%E9%9D%A2_20170823201641.png" class="" title="DESKTOP2">]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>TKLä¸»é¢˜ä¼˜åŒ– -&lt;è½¬&gt;</title>
      <link href="/2017/08/20/TKL%E4%B8%BB%E9%A2%98%E4%BC%98%E5%8C%96-%E8%BD%AC/"/>
      <url>/2017/08/20/TKL%E4%B8%BB%E9%A2%98%E4%BC%98%E5%8C%96-%E8%BD%AC/</url>
      
        <content type="html"><![CDATA[<p><a href="http://suninuni.com/2015/09/30/frontend/hexo/hexo-config/">http://suninuni.com/2015/09/30/frontend/hexo/hexo-config/</a></p><p>è¿™ä¸ªä¸»é¢˜ç¡®å®æŒºå¥½çš„ï¼Œæˆ‘ä¹Ÿé­”æ”¹äº†ä¸€éƒ¨åˆ†æ¥è¾¾æˆè‡ªå·±çš„ç›®çš„ï¼Œæ·»åŠ tagsæ˜¯çœ‹çš„è¿™ç¯‡æ–‡ç« ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>debugäº†ä¸¤å¤©ï¼Œåªåˆ äº†ä¸€è¡Œä»£ç </title>
      <link href="/2017/08/16/debug%E4%BA%86%E4%B8%A4%E5%A4%A9%EF%BC%8C%E5%8F%AA%E5%88%A0%E4%BA%86%E4%B8%80%E8%A1%8C%E4%BB%A3%E7%A0%81/"/>
      <url>/2017/08/16/debug%E4%BA%86%E4%B8%A4%E5%A4%A9%EF%BC%8C%E5%8F%AA%E5%88%A0%E4%BA%86%E4%B8%80%E8%A1%8C%E4%BB%A3%E7%A0%81/</url>
      
        <content type="html"><![CDATA[<p>å‰è¨€ï¼š é¡¹ç›®ä¸€å®šè¦ç•™ä¸€äº›æ–‡æ¡£ï¼ï¼ ä¿®bugå‰ä¸€å®šè¦çŸ¥é“æ‰€æœ‰çš„æµç¨‹ï¼ï¼ï¼</p><span id="more"></span><p>è¿™ä¸¤å¤©ä¸€ç›´åœ¨ä¿®ä¸€ä¸ªç”¨æˆ·åˆ‡æ¢çš„bugï¼Œä¼—æ‰€å‘¨çŸ¥ï¼Œdeepinçš„å¤šç”¨æˆ·åˆ‡æ¢ä¸€ç›´éƒ½ä¸æ˜¯æ­£å¸¸å·¥ä½œçš„ï¼Œç¡®åˆ‡æ¥è¯´æ˜¯å‹æ ¹æ²¡æœ‰æ­£å¸¸å·¥ä½œï¼Œè¿˜å¥½ç”¨æˆ·ä¸æ˜¯ç»å¸¸åˆ‡æ¢ï¼Œä¸ç„¶æ—©å°±æ”¶åˆ°ä¸€å¤§æ³¢çš„æŠ¥å‘Šäº†ã€‚</p><p>dde-session-uié¡¹ç›®ä¸­åŒ…å«äº†ä»¥ä¸‹è½¯ä»¶ï¼š</p><ul><li>dde-lock</li><li>dde-shutdown</li><li>dde-osd</li><li>lightdm-deepin-greeter</li><li>dde-switchtogreeter</li><li>dde-suspend-dialog</li><li>dde-warning-dialog</li><li>dde-welcome</li><li>dde-wm-chooser</li><li>dde-lowpower</li><li>dde-offline-upgrader</li></ul><p>å¤§éƒ¨åˆ†é¡¹ç›®æ ¹æ®åå­—å°±å¯ä»¥çŸ¥é“æ˜¯åšä»€ä¹ˆçš„ï¼Œè¿™æ˜¯ä¸€ä¸ªè½¯ä»¶ç»„çš„é›†åˆã€‚<br>è€Œdde-lockå’Œlightdm-deepin-greeteräºŒè€…æœ‰å¤§é‡é‡å¤çš„åŠŸèƒ½å’Œä»£ç ï¼Œè¿™æ˜¯å®ƒä¿©çš„å·¥ä½œæ€§è´¨å†³å®šçš„ã€‚</p><blockquote><p>lightdm-deepin-greeter: display-managerå¯åŠ¨çš„å®ä½“ï¼Œç™»å½•çš„ç•Œé¢æ˜¯å®ƒè´Ÿè´£çš„ã€‚</p></blockquote><blockquote><p>dde-lockï¼š ç”¨æˆ·å±‚é¢çš„å±å¹•é”å®šï¼ŒåŸºäºæˆ‘ä»¬çš„è®¾è®¡ï¼Œå’Œlightdm-deepin-greeteræ˜¯å¤§è‡´ç›¸åŒçš„å¸ƒå±€ã€‚</p></blockquote><p>è€Œä¸”éƒ½åŒ…å«äº†ç”¨æˆ·å¯†ç çš„éªŒè¯ï¼Œç”¨æˆ·çš„åˆ‡æ¢ï¼Œä½†æ˜¯äºŒè€…å·¥ä½œçš„å±‚é¢æ˜¯ä¸åŒçš„ï¼Œä¸ºäº†æ–¹ä¾¿åˆ‡æ¢ï¼Œå°±æœ‰äº†dde-switchtogreeterï¼Œç”¨æ¥åè°ƒäºŒè€…çš„å·¥ä½œï¼Œåªéœ€è¦æä¾›ç”¨æˆ·åå°±å¯ä»¥åˆ‡æ¢ã€‚</p><p>ç„¶è€Œï¼Œè™½ç„¶è¿™æ ·çš„æƒ³æ³•æ˜¯å¾ˆå¥½çš„ï¼Œå¯æ˜¯å½“åˆå¹¶æ²¡æœ‰äººå†™æ–‡æ¡£ï¼Œéšç€äººå‘˜çš„å˜åŠ¨ï¼Œç°åœ¨å…¬å¸åº”è¯¥æ²¡æœ‰ä¸€ä¸ªäººæ˜¯æ¯”è¾ƒå®Œæ•´äº†è§£æ•´ä¸ªçš„å·¥ä½œæµç¨‹äº†ï¼Œç”¨æˆ·åˆ‡æ¢çš„bugä¹Ÿå°±è¿™æ ·è¢«ç•™ä¸‹æ¥äº†ã€‚</p><p>ä¸Šæ¬¡ä¿®å¤ç”¨æˆ·åˆ‡æ¢çš„é—®é¢˜ï¼Œæ˜¯å‘ç°ç™»å½•ä»¥ålightdm-deepin-greeteræ²¡æœ‰é€€å‡ºï¼Œç”±äºä¸æ˜¯å¾ˆæ¸…æ¥šlinuxçš„ç™»å½•æµç¨‹ï¼Œå†åŠ ä¸Šä»£ç ä¸­æœ‰ä¸å·¥ä½œçš„é€€å‡ºä»£ç ï¼Œå½“æ—¶å°±æ”¹å¥½äº†é€€å‡ºçš„é—®é¢˜ï¼Œè¿™æ ·å°±å¼•å…¥äº†ç¬¬äºŒä¸ªé—®é¢˜ï¼Œè€Œè¿™ä¸ªé—®é¢˜ï¼Œå°±å¯¼è‡´äº†ä¸¤å¤©ä¸‰ä¸ªäººåœ¨ä¸€ç›´æŸ¥æ‰¾é—®é¢˜æ‰€åœ¨ã€‚</p><p>è¿™æ¬¡çš„é—®é¢˜æ˜¯å‘ç°ä¸€ç›´åˆ‡æ¢greeterï¼Œä¼šå¯¼è‡´Xorgä¸€ç›´åœ¨å¼€æ–°çš„displayï¼Œè¿™å°±å¾ˆå¥‡æ€ªäº†ï¼Œæ­£å¸¸æ¥è¯´æ˜¯ä¸ä¼šä¸€ç›´åˆ›å»ºæ‰å¯¹ã€‚</p><p>æœ€å¼€å§‹ä»¥ä¸ºæ˜¯dde-switchtogreeterçš„é—®é¢˜ï¼Œæ¯•ç«Ÿåˆ‡æ¢æ˜¯å®ƒåœ¨åšï¼Œdde-switchtogreeteræ˜¯å•æ–‡ä»¶çš„cä»£ç ï¼Œä»£ç æ²¡æœ‰ä»»ä½•çš„è¯´æ˜ï¼ŒçœŸçš„æ˜¯ä¸ºåˆ‡æ¢è€Œç”Ÿï¼Œæˆ‘ä»mainå‡½æ•°å¼€å§‹è‡ªå·±èµ°äº†å¥½å‡ éçš„æµç¨‹ï¼Œä¸€è¾¹çœ‹ç€d-feetçš„æ•°æ®æ¥éªŒè¯ï¼Œç„¶è€Œåªå‘ç°äº†ä¸€ä¸ªå°é—®é¢˜ï¼Œæ•´ä¸ªä»£ç æ˜¯æ²¡å•¥é—®é¢˜çš„ã€‚</p><p>æœ€ååœ¨åç«¯å¤§ä½¬çš„å¸®åŠ©ä¸‹ï¼ŒçŸ¥é“äº†display-managerä¼šè‡ªå·±é€€æ‰greeterï¼Œä¸éœ€è¦è‡ªå·±é€€ï¼Œç„¶åæˆ‘å°±æƒ³èµ·æ¥äº†ä»¥å‰æ”¹çš„åœ°æ–¹ï¼Œèµ¶ç´§æŠŠé€€å‡ºä»£ç åˆ æ‰ï¼Œé‡æ–°ç¼–è¯‘ï¼Œé—®é¢˜å¾—åˆ°äº†è§£å†³ã€‚</p><p>å¦‚æœæˆ‘çŸ¥é“display-managerçš„å·¥ä½œæµç¨‹ï¼Œä¹Ÿè®¸è¿™ä¸ªé—®é¢˜å°±ä¸ä¼šæ‹–ä¸¤å¤©äº†ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>æ­£å¸¸çš„æµç¨‹åœ¨ç•Œé¢ä¸Šå´æ˜¯bug</title>
      <link href="/2017/08/15/%E6%AD%A3%E5%B8%B8%E7%9A%84%E6%B5%81%E7%A8%8B%E5%9C%A8%E7%95%8C%E9%9D%A2%E4%B8%8A%E5%8D%B4%E6%98%AFbug/"/>
      <url>/2017/08/15/%E6%AD%A3%E5%B8%B8%E7%9A%84%E6%B5%81%E7%A8%8B%E5%9C%A8%E7%95%8C%E9%9D%A2%E4%B8%8A%E5%8D%B4%E6%98%AFbug/</url>
      
        <content type="html"><![CDATA[<p>æ’æŸ¥äº†ä¸€å¤©ï¼Œæœ€åç»ˆäºç¡®è®¤äº†æµç¨‹ï¼ŒçŸ¥é“äº†é—®é¢˜æ‰€åœ¨ï¼Œä¸å¾—ä¸è¯´ï¼Œdde-session-uiè¿™ä¸ªé¡¹ç›®å¤ªéœ€è¦ä¸€ä¸ªæ–‡æ¡£äº†ï¼Œè¦æŠŠå·¥ä½œæµç¨‹å†™çš„éå¸¸è¯¦ç»†æ‰å¯ä»¥ã€‚</p><span id="more"></span><p>ä¸Šåˆæ”¶åˆ°äº†ä¸€æ¡æ–°ä»»åŠ¡ï¼Œæ˜¯é¾™èŠ¯ä¸Šæ–°å®‰è£…çš„ç³»ç»Ÿéœ€è¦è¾“å…¥ä¸¤æ¬¡å¯†ç æ‰å¯ä»¥ç™»å½•ï¼Œæ²¡æœ‰é”™è¯¯æç¤ºã€‚è¿‘æœŸå¹¶æ²¡æœ‰ä»€ä¹ˆå¤ªå¤§çš„æ”¹åŠ¨ï¼Œæ— éæ˜¯ç»™é¾™èŠ¯ä¹Ÿç”¨ä¸Šäº†ç®€å•é‡æ„è¿‡çš„dde-session-uiï¼Œæ€ä¹ˆä¼šå¯¼è‡´è¿™æ ·çš„é—®é¢˜ã€‚</p><p>ç”±äºæ˜¯æ–°å®‰è£…çš„ç³»ç»Ÿæ‰ä¼šå‘ç”Ÿï¼Œè€Œä¸”æ˜¯ç°è±¡ä¸€æ—¦å‘ç”Ÿï¼Œå°±æ— æ³•é‡ç°ï¼Œè¿™è®©æˆ‘å¤´æœ‰ç‚¹å¤§ï¼Œæ€ä¹ˆä¼šæœ‰è¿™æ ·çš„ç¥å¥‡çš„äº‹æƒ…ï¼Œè€Œä¸”æ—¥å¿—ä¸­å¾ˆæ­£å¸¸ï¼Œæ²¡æœ‰æ”¶åˆ°messageå¯¼è‡´å¯†ç æ¡†è¢«æ¸…ç©ºã€‚æˆ‘æäº¤äº†ä¸€ä¸ªæ·»åŠ äº†æ›´å¤šæ—¥å¿—çš„ï¼Œç„¶åé‡è£…çš„é¾™èŠ¯çš„ç³»ç»Ÿ(é¾™èŠ¯é‡è£…ä¸€æ¬¡è¦åŠä¸ªå°æ—¶)ï¼Œç­‰é‡è£…å®Œäº†ï¼Œåˆ‡æ¢åˆ°ttyå»å®‰è£…è¿™ä¸ªåŒ…ï¼Œç„¶åé‡å¯lightdmï¼Œè®©æˆ‘è¾“å…¥å¯†ç å›è½¦ä»¥åï¼Œå¯†ç æ¶ˆå¤±ï¼Œæˆ‘èµ¶ç´§å»çœ‹æ—¥å¿—ï¼Œä½†æ˜¯æ—¥å¿—ä¸­å¹¶æ²¡æœ‰æˆ‘çš„è¾“å‡ºï¼Œå›è½¦ä»¥åè‚¯å®šä¼šæœ‰çš„ä¸€è¡Œè¾“å‡ºä¹Ÿæ²¡æœ‰(å†…å¿ƒOSï¼šWhat the fuck is thatï¼Ÿ)</p><p>æˆ‘åˆå›å»çœ‹éªŒè¯çš„æµç¨‹ï¼Œå¹¶æ²¡æœ‰å‘ç°æœ‰ä»€ä¹ˆä¸å¯¹çš„åœ°æ–¹ï¼Œè€Œä¸”æ˜¯è¿‘æœŸæ‰æœ‰çš„ï¼Œæˆ‘åœ¨è‡ªå·±ç”µè„‘ä¸Šä½¿ç”¨äº†é¾™èŠ¯çš„ç¼–è¯‘å‚æ•°ï¼Œæ‰“äº†ä¸€ä¸ªdebåŒ…ï¼Œå¹¶æ²¡æœ‰å‘ç”Ÿå’Œé¾™èŠ¯ä¸€æ ·çš„æƒ…å†µï¼ˆè¿™é‡Œå¹¶ä¸éœ€è¦ï¼Œæ—¢ç„¶æ˜¯æ–°å®‰è£…çš„ç³»ç»Ÿæ‰ä¼šå‘ç”Ÿï¼Œåœ¨æ—§ç³»ç»Ÿä¸Šæ˜¯æ— æ³•é‡ç°çš„ï¼‰ã€‚</p><p>å†ç„¶åæˆ‘æš‚æ—¶æ²¡æœ‰ç®¡è¿™ä¸ªï¼Œå…ˆå»ä¿®å…¶ä»–bugäº†ã€‚å¿™å®Œä»¥åï¼Œæˆ‘å»é—®äº†ä¸€ä¸‹å…¶ä»–å¤§ä½¬ï¼Œå¤§ä½¬ç»™æˆ‘æäº†å‡ æ¡è®©æˆ‘å»çœ‹çœ‹ï¼Œæ˜¯ä¸æ˜¯èµ·äº†ä¸¤ä¸ªlightdm-deepin-greeterè¿›ç¨‹ï¼Œç¡®è®¤ä¸€ä¸‹ä½¿ç”¨çš„äºŒè¿›åˆ¶æ˜¯ä¸æ˜¯ä½ åŠ äº†logçš„ã€‚ï¼ˆç„¶åæˆ‘åˆé‡è£…é¾™èŠ¯äº†ï¼‰ï¼Œä¹‹åç¡®è®¤äº†æ˜¯æˆ‘çš„äºŒè¿›åˆ¶ï¼Œä¹Ÿæ²¡æœ‰èµ·ä¸¤ä¸ªè¿›ç¨‹ã€‚ä½†æ˜¯psä¸­æœ‰ä¸¤è¡Œè¾“å‡ºï¼Œæˆ‘ä»¥ä¸ºæ˜¯èµ·äº†ä¸¤ä¸ªï¼Œå°±è®©åç«¯å¤§ä½¬çœ‹äº†ä¸€ä¸‹ï¼Œåç«¯å¤§ä½¬å‘Šè¯‰æˆ‘è¯´ä¸€ä¸ªæ˜¯shellçš„è¿›ç¨‹ï¼Œä¸€ä¸ªæ˜¯æœ¬ä½“ï¼Œè¿˜æ˜¯åªæœ‰ä¸€ä¸ªè¿›ç¨‹å­˜åœ¨çš„ã€‚æˆ‘å½»åº•æ‡µé€¼äº†ï¼Œç„¶ååç«¯å¤§ä½¬å‘Šè¯‰æˆ‘ï¼Œæ˜¯ä¸æ˜¯greeterè¿›ç¨‹å†™å…¥ä»€ä¹ˆäº†ï¼Œä¹‹åçš„éªŒè¯ä¸­å†…å®¹å·²ç»å­˜åœ¨ï¼Œæ‰€ä»¥å°±ä¸ä¼šé‡ç°äº†ã€‚</p><p>å…¶å®è¿™ä¸ªæˆ‘ä¹Ÿæƒ³è¿‡ï¼Œä½†æ˜¯æ²¡è€ƒè™‘å¤ªæ·±ï¼Œgreeterå¹¶æ²¡æœ‰æ“ä½œæ–‡ä»¶ï¼Œä½†æ˜¯å¤§ä½¬è¿™ä¹ˆä¸€è¯´ï¼Œæˆ‘æƒ³åˆ°æœ‰ä¸€äº›dbusçš„è°ƒç”¨ï¼Œæ˜¯æœ‰å†™å…¥æ–‡ä»¶çš„ï¼Œç„¶åæˆ‘æŠŠ&#x2F;var&#x2F;lib&#x2F;lightdm&#x2F;lightdm-deepin-greeterç›®å½•ç»™åˆ é™¤äº†ï¼Œå®Œç¾é‡ç°ã€‚</p><p>æˆ‘çš„å¤©å•Šï¼Œæ’æŸ¥äº†å¿«ä¸€å¤©ï¼Œå±…ç„¶æ˜¯è¿™ä¸ªç›®å½•åœ¨æ–°è£…çš„ç³»ç»Ÿä¸Šæ²¡æœ‰ï¼Œæ‰€ä»¥å›è½¦ç™»å½•ä»¥åæ”¶åˆ°äº†æ¥è‡ªdbusçš„switchToUserï¼Œç•Œé¢é‡å¯å¯¼è‡´çš„å†…å®¹æ¶ˆå¤±ï¼Œæ ¹æœ¬ä¸æ˜¯æ”¶åˆ°äº†Messageæ‰è¢«æ¸…ç©ºçš„ï¼Œæ‰€ä»¥æˆ‘çš„logä¹Ÿæ²¡æœ‰æ‰“å°å‡ºæ¥ã€‚</p><p>çŸ¥é“äº†å¦‚ä½•é‡ç°ï¼Œå¯æ˜¯è¦æ€ä¹ˆä¿®å¤å‘¢ï¼Œä¼¼ä¹åœ¨greeterä¸Šå¹¶ä¸èƒ½ä¿®å¤ï¼Œåªèƒ½å»æ”¹dde-daemonä¸­LockServiceï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œå°±ä¸è¦å‘é€userChangedçš„ä¿¡å·ã€‚ï¼ˆæµç¨‹æ˜¯è¯»å–è¿™ä¸ªæ–‡ä»¶çš„ä¿¡æ¯ï¼Œå’Œä¼ å…¥çš„å‚æ•°è¿›è¡Œå¯¹æ¯”ï¼Œä½†æ˜¯æ–‡ä»¶æ˜¯ç©ºçš„ï¼Œæ‰€ä»¥è¢«è®¤ä¸ºä¸æ˜¯åŒä¸€ä¸ªè´¦æˆ·ï¼Œå°±å‘é€äº†ä¿¡å·ï¼Œä¹Ÿå¯¼è‡´äº†ç•Œé¢ä¸Šé‡å¯ï¼Œä»¥åæ— æ³•é‡ç°æ˜¯å› ä¸ºé‡Œé¢å·²ç»æœ‰å†…å®¹äº†ï¼‰ã€‚</p><p>å°±è¿™æ ·ï¼Œä¸€ä¸ªæµç¨‹å¾ˆæ­£ç¡®ï¼Œä½†æ˜¯è¡¨ç°åˆ°ç•Œé¢ä¸Šæ—¶å°±æˆäº†ä¸€ä¸ªbugçš„é—®é¢˜è¢«è§£å†³äº†ã€‚å†™ä¸‹è¿™ç¯‡å†…å®¹æ˜¯ä¸ºäº†è®°å½•æˆ‘å¦‚ä½•è§£å†³å¯¹æˆ‘æ¥è¯´å¾ˆæ£˜æ‰‹çš„é—®é¢˜ï¼Œå…¶å®è¿™ä¸ªé—®é¢˜å¹¶ä¸æ˜¯å¾ˆå›°éš¾ï¼Œä½†æ˜¯å¯¹æ•´ä¸ªå·¥ä½œçš„æµç¨‹ä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼Œå¯¼è‡´æµªè´¹äº†å¤§é‡çš„æ—¶é—´åœ¨éå…³é”®ç‚¹å¤„ç†ï¼Œæœ‰ç©ºè¦å†™ä¸€äº›æ–‡æ¡£äº†ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>åœ¨deepinä¸Šä½¿ç”¨dnsmasqæ¥è§£å†³dnsè§£æç¼“æ…¢</title>
      <link href="/2017/08/11/%E5%9C%A8deepin%E4%B8%8A%E4%BD%BF%E7%94%A8dnsmasq%E6%9D%A5%E8%A7%A3%E5%86%B3dns%E8%A7%A3%E6%9E%90%E7%BC%93%E6%85%A2/"/>
      <url>/2017/08/11/%E5%9C%A8deepin%E4%B8%8A%E4%BD%BF%E7%94%A8dnsmasq%E6%9D%A5%E8%A7%A3%E5%86%B3dns%E8%A7%A3%E6%9E%90%E7%BC%93%E6%85%A2/</url>
      
        <content type="html"><![CDATA[<p>å…¶å®è¿™ä¸ªé—®é¢˜å½±å“å¹¶ä¸æ˜¯å¾ˆå¤§ï¼Œåªæ˜¯ç¨å¾®çš„å¢åŠ ä¸€ç‚¹ç‚¹è®¿é—®é€Ÿåº¦ï¼Œç¼“å­˜è¿™ä¸œè¥¿æœ‰åˆ©æœ‰å¼Šã€‚</p><span id="more"></span><p>åœ¨å†™å®Œè¿™ç¯‡æ–‡ç« ä»¥åï¼Œæˆ‘å°±ä¸ç”¨dnsmasqäº†ï¼Œç°åœ¨ç”¨çš„æ˜¯githubä¸Šçš„<a href="https://github.com/chengr28/Pcap_DNSProxy">Pcap_DNSProxy</a>ã€‚ç”¨æ¥é˜²æ­¢dnsæ±¡æŸ“çš„ã€‚</p><p>æ ¹æ®<a href="https://stackoverflow.com/questions/11020027/dns-caching-in-linux">https://stackoverflow.com/questions/11020027/dns-caching-in-linux</a> ä¸­å›ç­”è€…æä¾›çš„ä¿¡æ¯æ¥çœ‹ï¼Œlinuxå‘è¡Œç‰ˆæ˜¯ä¸æä¾›dnsè§£æç¼“å­˜çš„ï¼Œä¸Šé¢æåˆ°çš„nscdä¹Ÿä¸åœ¨deepinçš„é¢„è£…åˆ—è¡¨ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬åªèƒ½è‡ªå·±åŠ¨æ‰‹ä¸°è¡£è¶³é£Ÿäº†ã€‚</p><p>é¦–å…ˆå®‰è£…å£ç¢‘è¾ƒå¥½çš„dnsmasqï¼Œæ¥ä¸ºæˆ‘ä»¬æä¾›dnsç¼“å­˜ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo apt install dnsmasq</span><br></pre></td></tr></table></figure><p>å¦‚æœæ˜¯deepinæœ€æ–°çš„2015.4.1ç‰ˆæœ¬ä¸­å®‰è£…ï¼Œå®‰è£…ç»“æŸä¼šæé†’ä¸€ä¸ªé”™è¯¯ï¼Œè¿™ä¸ªé”™è¯¯çš„è§£å†³åŠæ³•æ¥è‡ª<a href="https://stackoverflow.com/questions/16939306/i-cant-restart-my-dnsmasq-service-so-my-fog-server-wont-work">https://stackoverflow.com/questions/16939306/i-cant-restart-my-dnsmasq-service-so-my-fog-server-wont-work</a>.<br>è¿™ä¸ªé”™è¯¯ä¼¼ä¹æ˜¯å› ä¸º&#x2F;usr&#x2F;share&#x2F;dns&#x2F;root.dsæ–‡ä»¶æ›´æ–°åç»“æ„å¯¼è‡´çš„é”™è¯¯ã€‚</p><p>ç¼–è¾‘&#x2F;etc&#x2F;init.d&#x2F;dnsmasqï¼Œå¹¶æ‰¾åˆ°</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ROOT_DS=&quot;/usr/share/dns/root.ds&quot;</span><br><span class="line"></span><br><span class="line">if [ -f $ROOT_DS ]; then</span><br><span class="line">   DNSMASQ_OPTS=&quot;$DNSMASQ_OPTS `sed -e s/&quot;. IN DS &quot;/--trust-anchor=.,/ -e s/&quot; &quot;/,/g $ROOT_DS | tr &#x27;\n&#x27; &#x27; &#x27;`&quot; </span><br><span class="line">fi</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ä¸º</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ROOT_DS=&quot;/usr/share/dns/root.ds&quot;</span><br><span class="line"></span><br><span class="line">if [ -f $ROOT_DS ]; then</span><br><span class="line">   DNSMASQ_OPTS=&quot;$DNSMASQ_OPTS `sed -e s/&quot;.*IN[[:space:]]DS[[:space:]]&quot;/--trust-anchor=.,/ -e s/&quot;[[:space:]]&quot;/,/g $ROOT_DS | tr &#x27;\n&#x27; &#x27; &#x27;`&quot; </span><br><span class="line">fi</span><br></pre></td></tr></table></figure><p>å½“é”™è¯¯è§£å†³ä»¥åï¼Œæˆ‘ä»¬æ‰‹åŠ¨é‡å¯ä¸€ä¸‹dnsmasqçš„systemdæœåŠ¡ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo systemctl restart dnsmasq</span><br></pre></td></tr></table></figure><p>deepinçš„&#x2F;etc&#x2F;resolv.confæ¥è‡ª&#x2F;etc&#x2F;NetworkManager&#x2F;resolv.conf.æ˜¯ä¸€ä¸ªè½¯è¿æ¥ã€‚æˆ‘é‡‡å–çš„è¡Œä¸ºæ˜¯åˆ é™¤è¿™ä¸ªæ–‡ä»¶ï¼Œé‡æ–°åˆ›å»ºã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo rm /etc/resolv.conf</span><br><span class="line"></span><br><span class="line">sudo vim /etc/resolv.conf</span><br></pre></td></tr></table></figure><p>ç„¶åå†™å…¥æœ¬åœ°åœ°å€å½“åšdnsåœ°å€ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nameserver 127.0.0.1</span><br></pre></td></tr></table></figure><p>dnsmasqæ˜¯ä¸€ä¸ªæœ¬åœ°çš„dnså’ŒdhcpæœåŠ¡å™¨ï¼Œå½“æˆ‘ä»¬åœ¨ä¸Šé¢æˆåŠŸå¯åŠ¨dnsmasqä»¥åï¼Œä¸ªäººç³»ç»Ÿä¸­å°±å·²ç»åœ¨æä¾›dnsæœåŠ¡äº†ï¼Œæ‰€ä»¥æœ¬æœºä½¿ç”¨å›ç¯åœ°å€æ¥è¡¨æ˜dnsæœåŠ¡å™¨å°±æ˜¯æœ¬æœºï¼Œæ‰€æœ‰çš„dnsæŸ¥è¯¢éƒ½ä¼šå‘é€åˆ°æœ¬æœºçš„dnsmasqä¸­ã€‚</p><p>å¦‚æœéœ€è¦é¢å¤–æ·»åŠ dnsæœåŠ¡å™¨ï¼Œåšæ³•æ¥è‡ª<a href="https://wiki.archlinux.org/index.php/Dnsmasq#More_than_three_nameservers">https://wiki.archlinux.org/index.php/Dnsmasq#More_than_three_nameservers</a>.</p><p>åˆ›å»ºä¸€ä¸ª &#x2F;etc&#x2F;resolv.dnsmasq.confï¼Œå†™å…¥å…¶ä»–dnsæœåŠ¡å™¨çš„åœ°å€ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nameserver 114.114.114.114</span><br></pre></td></tr></table></figure><p>ç„¶åç¼–è¾‘ &#x2F;etc&#x2F;dnsmasq.conf,æ‰¾åˆ°resolv-fileå­—æ®µï¼Œæ”¹ä¸º</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">resolv-file=/etc/resolv.dnsmasq.conf</span><br></pre></td></tr></table></figure><p>ç„¶åé‡å¯dnsmasqã€‚</p><p>éªŒè¯çš„è¯é€šè¿‡digå‘½ä»¤ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dig blog.mkacg.com</span><br></pre></td></tr></table></figure><p>é€šè¿‡æ‰§è¡Œä¸¤æ¬¡æ¥åˆ¤æ–­ï¼ŒQuery timeåœ¨ç¬¬äºŒæ¬¡æŸ¥è¯¢æ˜¯ä¸º0 msecã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>PPA</title>
      <link href="/2017/07/24/PPA/"/>
      <url>/2017/07/24/PPA/</url>
      
        <content type="html"><![CDATA[<p>ä¹Ÿè®¸éœ€è¦å®‰è£…dirmngr</p><p>maybe you need install dirmngr</p><p>è¿½åŠ å†…å®¹åˆ°&#x2F;etc&#x2F;apt&#x2F;sources.list</p><p>Append content to &#x2F;etc&#x2F;apt&#x2F;sources.list</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">deb [arch=amd64] https://packages.mkacg.com panda main </span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¯¼å…¥key </p><p>import key</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 3BBF73EE77F2FB2A</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>topbar PPA</title>
      <link href="/2017/07/20/topbar-PPA/"/>
      <url>/2017/07/20/topbar-PPA/</url>
      
        <content type="html"><![CDATA[<p>è‡ªå·±æ­äº†ä¸€ä¸ªä»“åº“ï¼Œæä¾›deepin-topbaråŠç›¸å…³ä¾èµ–çš„åŒ…ã€‚</p><p>I created a repository,provide deepin-topbar and dependencies.</p><span id="more"></span><p>ä¹Ÿè®¸éœ€è¦å®‰è£…dirmngr</p><p>maybe you need install dirmngr</p><h1 id="è¿½åŠ å†…å®¹åˆ°-etc-apt-sources-list"><a href="#è¿½åŠ å†…å®¹åˆ°-etc-apt-sources-list" class="headerlink" title="è¿½åŠ å†…å®¹åˆ°&#x2F;etc&#x2F;apt&#x2F;sources.list"></a>è¿½åŠ å†…å®¹åˆ°&#x2F;etc&#x2F;apt&#x2F;sources.list</h1><p>Append content to &#x2F;etc&#x2F;apt&#x2F;sources.list</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">deb [arch=amd64] https://packages.mkacg.com panda main </span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="å¯¼å…¥key"><a href="#å¯¼å…¥key" class="headerlink" title="å¯¼å…¥key"></a>å¯¼å…¥key</h1><p>import key</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 3BBF73EE77F2FB2A</span><br></pre></td></tr></table></figure><h1 id="åˆ·æ–°åˆ—è¡¨ï¼Œè¿›è¡Œå®‰è£…"><a href="#åˆ·æ–°åˆ—è¡¨ï¼Œè¿›è¡Œå®‰è£…" class="headerlink" title="åˆ·æ–°åˆ—è¡¨ï¼Œè¿›è¡Œå®‰è£…"></a>åˆ·æ–°åˆ—è¡¨ï¼Œè¿›è¡Œå®‰è£…</h1><p>then, refresh list and install</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo apt update &amp;&amp; sudo apt install deepin-topbar </span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>webhook</title>
      <link href="/2017/07/14/webhook/"/>
      <url>/2017/07/14/webhook/</url>
      
        <content type="html"><![CDATA[<p>blogç°åœ¨æ˜¯ç”¨hexoï¼Œæ”¾åœ¨è‡ªå·±çš„<a href="https://code.mkacg.com/">code</a>ç½‘ç«™ä¸Šã€‚</p><p>codeæ˜¯ç”¨æ— é—»å¤§å¤§çš„gogsæ­å»ºçš„ï¼Œè·‘åœ¨å°å¼æœºçš„dockerä¸­ï¼Œæœ¬æœºè·‘äº†å¾ˆå¤šdockeræœåŠ¡ï¼Œæœ‰hexoï¼Œæœ‰aria2cï¼Œæœ‰gogsï¼Œè¿˜æœ‰ä¸ªwebserver caddyã€‚</p><p>caddyè¿™ä¸œè¥¿è¿˜æ˜¯åŸºå‹ <a href="https://mioto.me/">ä¸çˆ±å†™åšå®¢çš„mioto</a>æ¨èç»™æˆ‘çš„ï¼Œä¹‹å‰æˆ‘ä¸€ç›´æ˜¯ç”¨nginxçš„ï¼Œé‚£é…ç½®æ–‡ä»¶å¤ªå¤æ‚äº†ï¼Œæ ¹æœ¬ç©ä¸æ¥ã€‚</p><p>å†™ä¸€ç¯‡æ–‡ç« ï¼Œä¼šå…ˆæäº¤åˆ°codeï¼Œç„¶åè§¦å‘webhookï¼Œcaddyä¼šæ‹‰å–codeä¸­çš„æ–‡ç« ï¼Œç”±äºæ˜¯é™æ€çš„ï¼Œæ‰€ä»¥ä¸éœ€è¦å¤„ç†å…¶ä»–çš„ï¼Œåªéœ€è¦æ‹‰å–æœ€æ–°çš„å°±å¯ä»¥äº†ã€‚</p><p>caddyçš„é…ç½®</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">blog.mkacg.com &#123;</span><br><span class="line">    gzip</span><br><span class="line">    redir 301 &#123;</span><br><span class="line">    if &#123;&gt;X-Forwarded-Proto&#125; is http</span><br><span class="line">        /  https://&#123;host&#125;&#123;uri&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    tls kirigaya@mkacg.com</span><br><span class="line">    root /srv/www/blog</span><br><span class="line">    git code.mkacg.com/kirigayakazushin/blog &#123;</span><br><span class="line">        path /srv/www/blog</span><br><span class="line">        branch gh-pages</span><br><span class="line">        hook /_webhook xxx</span><br><span class="line">        hook_type gogs</span><br><span class="line">        then git pull</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>gogsä¸Šåªéœ€è¦åˆ›å»ºä¸€ä¸ªwebhookï¼Œåœ°å€å¡«å†™æˆcaddyä¸­çš„hookåœ°å€ï¼ŒåŠ å¯†å¡«å†™hookåçš„xxxå³å¯ï¼ŒåŠ å¯†è‡ªå·±è®¾ç½®ã€‚</p><p>ç„¶åå°±å¯ä»¥æäº¤äº†ã€‚</p><p>æäº¤ä¼šè§¦å‘pushæ“ä½œï¼Œgogsä¼šæ ¹æ®è®¾ç½®çš„webhookä¸­çš„è§„åˆ™ï¼Œæ‰§è¡Œå’Œpushç›¸å…³çš„webhookï¼Œwebhookä¼šå‘æŒ‡å®šçš„urlå‘é€POSTæ“ä½œï¼Œå‘é€çš„å†…å®¹ä¸­åŒ…å«äº†ç›¸å…³ä¿¡æ¯ï¼Œcaddyä¼šæ ¹æ®ç›¸å…³ä¿¡æ¯ï¼Œæ¥å¤„ç†webhookï¼Œæ‰§è¡Œä½ è§„å®šçš„æ“ä½œã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SAOUTILS</title>
      <link href="/2017/07/04/SAOUTILS/"/>
      <url>/2017/07/04/SAOUTILS/</url>
      
        <content type="html"><![CDATA[<p>é¼ æ ‡æ‰‹åŠ¿è¿˜æ²¡æƒ³å¥½è¦æ€ä¹ˆå®ç°ï¼Œæµç¨‹æ— æ³•å®Œå…¨ç¡®è®¤ï¼Œè¿™é¡¹ç¨åå†åšã€‚</p><p>ä¸»ç•Œé¢æœ‰ä¸¤å±‚æ„æˆï¼ŒåŠé€æ˜å…¨å±é»‘è‰²èƒŒæ™¯å’Œèœå•ã€‚</p><p>èœå•è¾ƒä¸ºå¤æ‚ï¼Œé™¤äº†å·¦è¾¹æ˜¯ä¸€ä¸ªå¤§é¢æ¿ï¼Œå…¶ä»–éƒ¨åˆ†å…¨éƒ¨éƒ½å¯ä»¥ä½¿ç”¨ä¸€ç§æ–¹å¼å®ç°ã€‚ä½¿ç”¨Qtçš„QAbstractItemDelegateã€QListViewæ¥åšåˆ—è¡¨å’Œç•Œé¢ç»˜åˆ¶ã€‚</p><p>å³è¾¹åˆ™æ˜¯æ— é™å±•å¼€çš„èœå•ã€‚</p><p>æ¯å±‚èœå•åªæ˜¯ç”¨ä¸€ä¸ªå¯¹è±¡ï¼Œå’Œtopbar dockçš„popup windowä¸€æ ·ã€‚<br>ç‚¹å‡»æ¯å±‚èœå•çš„æ—¶å€™ï¼Œè®¡ç®—ä¸‹ä¸€é¡¹è¦æ˜¾ç¤ºçš„ä½ç½®ã€‚</p><p>ä¸»ç•Œé¢åº”è¯¥æ˜¯åªæœ‰å·¦å³ä¸¤éƒ¨åˆ†ï¼Œé™¤äº†å·¦è¾¹çš„å¤§é¢æ¿ï¼Œå³ä¾§å…¨éƒ¨éƒ½æ˜¯ç›¸åŒç»“æ„çš„èœå•ï¼Œåªä¸è¿‡åœ¨åŠŸèƒ½ä¸Šç•¥æœ‰ä¸åŒã€‚</p><p>ç‚¹å‡»çš„æ—¶å€™ï¼Œæ‰€æœ‰èœå•å¯¹é¼ æ ‡ç‚¹å‡»çš„åœ°ç‚¹è¿›è¡Œåæ ‡è®¡ç®—ï¼Œå¦‚æœåœ¨é¼ æ ‡å³ä¾§ï¼Œåˆ™éšè—ã€‚å¦‚æœè¦æ˜¾ç¤ºçš„èœå•æ˜¯è‡ªå·±ï¼Œä¸éšè—ã€‚ç‚¹å‡»æ—¶å¼€å§‹timerï¼Œæ¾å¼€æ—¶åœæ­¢ï¼Œtimeoutä»¥åæ˜¾ç¤ºé€‰é¡¹ã€‚</p><p>ä¿æŒæœ€åä¸€ä¸ªèœå•åœ¨æœ€ä¸­é—´çš„ä½ç½®ï¼Œä¸»ç•Œé¢å‘å·¦æˆ–å‘å³ç”¨åŠ¨ç”»ç§»åŠ¨å›ºå®šé•¿åº¦ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Topbar</title>
      <link href="/2017/06/26/Topbar/"/>
      <url>/2017/06/26/Topbar/</url>
      
        <content type="html"><![CDATA[<p>ã€€ã€€topbarçš„æ¶æ„å‚è€ƒçš„æ˜¯dde-dockï¼Œå°±æ˜¯ä¸€ä¸ªç²¾ç®€çš„dockï¼Œåªæœ‰ä¸€ä¸ªæ–¹å‘ï¼Œä¸€ä¸ªä½ç½®ï¼Œæ²¡æœ‰å³é”®èœå•ï¼Œåªæœ‰æ’ä»¶ç±»å‹ã€‚</p><span id="more"></span><p><video controls="" autoplay="false" name="media"><source src="https://cache.mkacg.com/t.mp4" type="video/mp4"></video></p><p>ã€€ã€€è®¡åˆ’æ˜¯ç”¨æ¥æ”¯æŒå„ç§å„æ ·çš„æ–¹ä¾¿çš„æ’ä»¶ï¼Œæ¯”å¦‚ï¼š</p><ul><li>æ´»åŠ¨çª—å£æŒ‡ç¤ºå™¨</li><li>å¤šåª’ä½“æ§åˆ¶å™¨</li><li>ç”µæºæ§åˆ¶</li><li>æ—¶é—´æ§åˆ¶</li></ul><p>è®¡åˆ’è¦å®Œæˆæœ‰ï¼š</p><ul><li>shadowsocks</li><li>vpnæ§åˆ¶å™¨</li><li>ç³»ç»Ÿèµ„æºç›‘è§†å™¨</li></ul><p>å‰©ä¸‹çš„è®¡åˆ’å¾…å®Œæˆçš„æ’ä»¶ç”±äºå„ç§åŸå› ï¼Œå¼€å‘æ¯”è¾ƒéš¾ï¼Œè¿˜éœ€è¦å­¦ä¹ ä¸€éƒ¨åˆ†çŸ¥è¯†æ‰å¯ä»¥å®Œæˆã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ArchLinuxè¿è¡Œsteamå‡ºç°ç¼ºå°‘LibGL--steam libGL error: failed to load driver: swrast</title>
      <link href="/2016/07/15/ArchLinux%E8%BF%90%E8%A1%8Csteam%E5%87%BA%E7%8E%B0%E7%BC%BA%E5%B0%91LibGL-steam-libGL-error-failed-to-load-driver-swrast/"/>
      <url>/2016/07/15/ArchLinux%E8%BF%90%E8%A1%8Csteam%E5%87%BA%E7%8E%B0%E7%BC%BA%E5%B0%91LibGL-steam-libGL-error-failed-to-load-driver-swrast/</url>
      
        <content type="html"><![CDATA[<p>å…¶å®archçš„wikiå·²ç»æåˆ°äº†ï¼Œè€Œä¸”è¿™ä¸ªé—®é¢˜æ˜¯æ¯”è¾ƒå¸¸è§çš„ï¼Œåªéœ€è¦åˆ é™¤steamçš„åº“å°±è¡Œã€‚</p><p><a href="https://wiki.archlinux.org/index.php/Steam/Troubleshooting#Deleting_the_runtime_libraries">wikiåŸæ–‡é“¾æ¥</a></p><span id="more"></span><p>åˆ é™¤è¿è¡Œåº“<br>è¿è¡Œæ­¤å‘½ä»¤ï¼Œåˆ é™¤åœ¨issuesä¸Šå·²çŸ¥çš„è¿è¡Œåº“é—®é¢˜:</p><pre><code>find ~/.steam/root/ \( -name &quot;libgcc_s.so*&quot; -o -name &quot;libstdc++.so*&quot; -o -name &quot;libxcb.so*&quot; -o -name &quot;libgpg-error.so*&quot; \) -print -delete</code></pre><p>å¦‚æœä¸Šé¢çš„å‘½ä»¤ä¸å·¥ä½œï¼Œåˆ™å†æ¬¡è¿è¡Œä¸Šé¢çš„å‘½ä»¤ï¼Œç„¶åè¿è¡Œæ­¤å‘½ä»¤ã€‚</p><pre><code>find ~/.local/share/Steam/ \( -name &quot;libgcc_s.so*&quot; -o -name &quot;libstdc++.so*&quot; -o -name &quot;libxcb.so*&quot; -o -name &quot;libgpg-error.so*&quot; \) -print -delete</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> å®éªŒå®¤ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>docker-hexo</title>
      <link href="/2016/07/15/docker-hexo/"/>
      <url>/2016/07/15/docker-hexo/</url>
      
        <content type="html"><![CDATA[<p>å¼•ç”¨ä¸€ä¸‹åŸºå‹çš„è¯</p><blockquote><p>æœ€å¼€å§‹æ¥è§¦ Hexo çš„æ—¶å€™æ˜¯åœ¨ Windows ä¸‹, å®‰è£…è¿‡ç¨‹è¿˜ç®—é¡ºåˆ©, å› æ­¤åœ¨åˆæœŸè¿˜æ•´ç†äº†6ç¯‡å…³äº Hexo åšå®¢çš„æ­å»ºæ•™ç¨‹.</p></blockquote><blockquote><p>åæ¥è½¬æŠ• Linux å¤§æ³•, æœŸé—´é‡è£…ç”µè„‘æ— æ•°æ¬¡, æ¯ä¸€æ¬¡å®‰è£… Hexo æ‰€éœ€è¦çš„ nodejs, å’Œå„ç§æ’ä»¶çš„æ—¶å€™éƒ½æ˜¯é—¹å¿ƒçš„è¿‡ç¨‹, ç©çš„å¤šäº†è‡ªç„¶å°±ç†Ÿäº†, Linux ä¸‹çš„å®‰è£…åŸºæœ¬æ²¡é—®é¢˜äº†.</p></blockquote><span id="more"></span><blockquote><p>ç„¶åå…¥èŒå…¬å¸, å…¬å¸é…äº† Mac Pro åˆéœ€è¦å®‰è£… Nodejs, ä»¥åŠå„ç§æ’ä»¶, äººå‚»æä¸å®šå•Š.., æ™šä¸Šè¿·è¿·ç³Šç³Šçš„è¿˜ rm -rf &#x2F;usr&#x2F;bin äº†.., æ‰€ä»¥å†³å®šæ”¾å¼ƒåœ¨å®ä½“æœºå®‰è£… Nodejs çš„æƒ³æ³•è½¬æˆ˜åˆ°äº† Docker.</p></blockquote><blockquote><p>æ¥è‡ªmashiro.io</p></blockquote><p>ä»–åæ¥æ›´æ–°äº†ä¸€ä¸‹dockerfileï¼Œä»–è§‰å¾—ä»¥å‰çš„æ€è·¯æ˜¯é”™çš„ï¼Œç°åœ¨ä»–è¦æŠŠhexoå°è£…è¿›dockerå½“åšå·¥å…·ï¼Œåˆå†™äº†å‡ ä¸ªaliasã€‚<br>å®‰è£…dockerï¼Œç„¶åpullé•œåƒ</p><pre><code>docker pull kirigayakazushin/docker-hexo</code></pre><p>pullé•œåƒä»¥åï¼Œå†™å…¥aliasï¼Œå°†docker-hexoå½“åšæœ¬åœ°å·¥å…·ã€‚</p><pre><code>alias hexo=&#39;docker run -it --rm -p 4000:4000 -v $PWD:/Hexo -v $HOME/.gitconfig:/home/docker/.gitconfig -v $HOME/.ssh:/home/docker/.ssh kirigayakazushin/docker-hexo hexo&#39;alias npm=&#39;docker run -it --rm -v $PWD:/Hexo kirigayakazushin/docker-hexo npm&#39;alias ddnone=&quot;docker images | grep none | awk &#39;&#123;print \$3&#125;&#39; |xargs docker rmi&quot;</code></pre><p>ç„¶åæ‰§è¡Œä¸€ä¸‹å‘½ä»¤</p><pre><code>npm install hexo-generator-sitemap --save \&amp;&amp; npm install hexo-generator-feed --save \&amp;&amp; npm install hexo-deployer-git --save</code></pre><p>æŠŠä»¥ä¸Šå†…å®¹å†™è¿›rcæ–‡ä»¶ï¼Œæˆ‘æ˜¯ç”¨zshçš„ï¼Œæ‰€ä»¥å†™å…¥~&#x2F;.zshrcã€‚</p><img src="/2016/07/15/docker-hexo/zshrc.png" class="" title="zshrc"><p>æ¥ä¸‹æ¥åŸºæœ¬æ¼”ç¤ºä¸€ä¸‹ä½¿ç”¨æ–¹å¼ã€‚</p><img src="/2016/07/15/docker-hexo/ys1.png" class="" title="ys1"><img src="/2016/07/15/docker-hexo/ys2.png" class="" title="ys2"><img src="/2016/07/15/docker-hexo/ys3.png" class="" title="ys3"><img src="/2016/07/15/docker-hexo/ys4.png" class="" title="ys4"><img src="/2016/07/15/docker-hexo/ys5.png" class="" title="ys5">]]></content>
      
      
      
        <tags>
            
            <tag> å®éªŒå®¤ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>docker-aria2c</title>
      <link href="/2016/05/31/docker-aria2c/"/>
      <url>/2016/05/31/docker-aria2c/</url>
      
        <content type="html"><![CDATA[<p>è¯¥é¡¹ç›®æ˜¯å°†aria2cå°è£…è¿›dockerå¹¶æä¾›æœåŠ¡ã€‚</p><pre><code>docker pull kirigayakazushin/docker-aria2c</code></pre><span id="more"></span><p>ä¸‹è½½å¥½é•œåƒï¼Œç„¶åä¿å­˜ä¸€ä»½è¿è¡Œ</p><pre><code>docker run -p 6800:6800 --name docker-aria2c -d \-v &#123;ä¸‹è½½ç›®å½•çš„ç»å¯¹è·¯å¾„&#125;:/aria2/downloads \imashiro/docker-aria2c</code></pre><p>æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—®<a href="http://yaaw.qiniudn.com/">http://yaaw.qiniudn.com/</a><br>è¾“å…¥</p><pre><code>http://token:secret@127.0.0.1:6800/jsonrpc</code></pre><p>æ³¨æ„ï¼Œæš‚æ—¶è¿˜æ— æ³•å¤„ç†æ–‡ä»¶çš„æ‰€æœ‰æƒï¼Œç›®å‰ä¸‹è½½å¥½çš„æ–‡ä»¶å½’å±rootã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> å®éªŒå®¤ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>aria2é…ç½®</title>
      <link href="/2016/05/25/aria2%E9%85%8D%E7%BD%AE/"/>
      <url>/2016/05/25/aria2%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<p>å®‰è£…å¥½aria2ï¼Œç„¶åæ‰§è¡Œä¸€ä¸‹å†…å®¹</p><pre><code>$ sudo nano /etc/systemd/user/aria2.service  [Unit]Description=Aria2 ServiceAfter=network.target[Service]ExecStart=/usr/bin/aria2c --enable-rpc --rpc-listen-all=true   --rpc-secret=secret  --rpc-allow-origin-all  --conf-path=/home/ç”¨æˆ·åå­—/.config/aria2/aria2.conf  --input-file /home/ç”¨æˆ·åå­—/.config/aria2/session.lock --disk-cache=100M --max-overall-download-limit=0  --split=10 --max-connection-per-server=10 --max-concurrent-downloads=4   --dir=/home/ç”¨æˆ·åå­—/Downloads/[Install]WantedBy=default.target</code></pre><span id="more"></span><h1 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„"></a>æ³¨æ„</h1><p>ä»¥ä¸Šå†…å®¹éœ€è¦æŠŠç”¨æˆ·åå­—æ›´æ”¹æˆè‡ªå·±çš„</p><p>åœ¨ç”¨æˆ·ç›®å½•æ–°å»ºä¸‰ä¸ªæ–‡ä»¶</p><pre><code>touch ~/.config/aria2.conf  touch ~/.config/aria2.session  touch ~/.config/session.lock</code></pre><p>~&#x2F;.config&#x2F;aria2.conf é‡Œé¢éœ€è¦å¡«å†™ä»¥ä¸‹å†…å®¹ï¼Œå…¶ä»–ä¸¤ä¸ªæ–‡ä»¶ä¿æŒç©ºã€‚</p><pre><code>dir=ä¸‹è½½ç›®å½•ã€éœ€è¦è‡ªè¡Œä¿®æ”¹ã€‘enable-rpc=true</code></pre><p>å¯åŠ¨æœåŠ¡  </p><pre><code>systemctl --user enable aria2systemctl --user start aria</code></pre><p>æµè§ˆå™¨æ‰“å¼€ï¼š<a href="http://yaaw.qiniudn.com/" title="aria2">http://yaaw.qiniudn.com/</a><br>å°†æœåŠ¡å™¨åœ°å€æ”¹æˆ</p><pre><code>http://token:secret@127.0.0.1:6800/jsonrpc</code></pre><p>ç„¶ååº”è¯¥é¡µé¢çš„å³ä¸Šè§’å°±æ˜¾ç¤ºç½‘é€Ÿäº†ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ•™ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>linuxä¸‹å®‰è£…vmwareåŠarchlinuxçš„å®‰è£…å’Œé…ç½®</title>
      <link href="/2016/04/10/linux%E4%B8%8B%E5%AE%89%E8%A3%85vmware%E5%8F%8Aarchlinux%E7%9A%84%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE/"/>
      <url>/2016/04/10/linux%E4%B8%8B%E5%AE%89%E8%A3%85vmware%E5%8F%8Aarchlinux%E7%9A%84%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<p>è§†é¢‘ä¸­ç»™å‡ºäº†vmwareçš„ä¸‹è½½åœ°å€å’Œå®‰è£…è¿‡ç¨‹ï¼Œç³»ç»Ÿçš„ä¸‹è½½æˆ‘ä¹Ÿä¼šæ¼”ç¤ºä¸€éã€‚<br>è¿™ç¯‡æ•™ç¨‹ä¼šä¸€ç¯‡å®Œæˆï¼Œä»å®‰è£…åˆ°é…ç½®å’Œç¾åŒ–ï¼Œé¡ºä¾¿ä¹Ÿæ€»ç»“ä¸€ä¸‹æˆ‘çš„æˆæœã€‚<br>ç”±äºæˆ‘å·²ç»å®‰è£…è¿‡ä¸€æ¬¡vmwareäº†ï¼Œæ‰€ä»¥æœ‰ä¸ªè„šæœ¬çš„åœ°æ–¹æ²¡æœ‰å‡ºç°ï¼Œè¾“å…¥ç•Œé¢ä¸Šçš„æç¤ºä¿¡æ¯å³å¯ã€‚<br>å®¿èˆå¤ªä¹±ï¼Œæ‰€ä»¥å°±æ²¡æœ‰å½•éº¦å…‹é£ï¼Œæ“ä½œæˆ‘ä¼šå°½é‡æ…¢ä¸€äº›ï¼Œç„¶åæ‰“å­—è®²è¿°ã€‚<br>è¿™æ¬¡å¤§æ›´ã€‚ã€‚gtkä¸»é¢˜è¿˜æ²¡æ›´æ–°ä¸Šæ¥ï¼Œæ‰€ä»¥ç•Œé¢å¥½ä¸‘ã€‚  &#x3D; &#x3D;ã€‚<br>å®‰è£…å®Œæˆä»¥åå®‰è£…æºé‡Œé¢çš„vmware-patchã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ•™ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Archlinux æ·»åŠ æ¼‚äº®çš„å­—ä½“</title>
      <link href="/2016/04/08/font-config/"/>
      <url>/2016/04/08/font-config/</url>
      
        <content type="html"><![CDATA[<p>è¯¥æ•™ç¨‹ä¸èƒ½ä¿è¯é€‚ç”¨äºæ‰€æœ‰äººçš„æƒ…å†µã€‚<br>å­—ä½“ä¹Ÿä¸æ˜¯é…ç½®ï¼Œè€Œæ˜¯è¡¥å……äº†å­—ä½“ã€‚ä½¿ç”¨çš„æ˜¯ç¬¬ä¸‰æ–¹çš„æºã€‚</p><span id="more"></span><p>æ‰“å¼€&#x2F;etc&#x2F;pacman.confæ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹åˆ°æœ€åº•éƒ¨ã€‚</p><pre><code>[infinality-bundle]SigLevel = NeverServer = http://bohoomil.com/repo/$arch[infinality-bundle-multilib]SigLevel = NeverServer = http://bohoomil.com/repo/multilib/$arch[infinality-bundle-fonts]SigLevel = NeverServer = http://bohoomil.com/repo/fonts</code></pre><p>æ‰§è¡Œå®‰è£…å‘½ä»¤:</p><pre><code>sudo pacman -S infinality-bundle infinality-bundle-multilib ibfonts-meta-extended  #ï¼ˆç”¨äº64ä½ç³»ç»Ÿï¼‰sudo pacman -S infinality-bundle ibfonts-meta-extended #ï¼ˆç”¨äº32ä½ç³»ç»Ÿï¼‰</code></pre><p>å¦‚æœæœ‰é‡åˆ°é”™è¯¯ï¼Œå¯ä»¥æ‰‹åŠ¨æ·»åŠ hostsï¼š</p><pre><code>188.226.219.173 bohoomil.com</code></pre><p>ä¼šå‡ºç°å¾ˆå¤šå†²çªï¼Œé€‰æ‹©Yï¼Œç„¶åå®‰è£…ã€‚å¦‚æœä¸­æ–­äº†ï¼Œé‡æ–°æ‰§è¡Œå®‰è£…å‘½ä»¤ã€‚</p><p>æ¥è‡ªï¼š<a href="https://linux.cn/article-3019-1.html" title="å¦‚ä½•ç»™ä»»æ„ä¸€æ¬¾ Linux å‘è¡Œç‰ˆæ·»åŠ æ¼‚äº®çš„å­—ä½“-æ¡Œé¢åº”ç”¨|Linux.ä¸­å›½-å¼€æºç¤¾åŒº">å¦‚ä½•ç»™ä»»æ„ä¸€æ¬¾ Linux å‘è¡Œç‰ˆæ·»åŠ æ¼‚äº®çš„å­—ä½“-æ¡Œé¢åº”ç”¨|Linux.ä¸­å›½-å¼€æºç¤¾åŒº</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> æ•™ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>My Life</title>
      <link href="/2016/03/25/my-life/"/>
      <url>/2016/03/25/my-life/</url>
      
        <content type="html"><![CDATA[<p>è¿™æ˜¯æˆ‘ç”¨markdownå†™çš„ç¬¬ä¸€ç¯‡æ–‡ç« (æ°´æ–‡)ï¼Œå…ˆæ¥ä¸ªè‡ªæˆ‘ä»‹ç»å§ï¼Œæˆ‘æ˜¯å°ç«¹ï¼Œå¯¹æ²¡é”™ï¼Œæ˜¯å°ç«¹ï¼Œä¸æ˜¯ç«¹å­ï¼Œä¸æ˜¯ç«¹é…±ï¼Œæ›´ä¸æ˜¯ç«¹åŸºã€‚</p><span id="more"></span><p>æˆ‘ç©linuxåº”è¯¥æœ‰äº”å…­å¹´äº†å§ï¼ŒåˆäºŒçš„æ—¶å€™æ¥è§¦çš„ï¼Œä¸è¿‡å¾ˆå¤šå¹´éƒ½ä¿æŒåœ¨æ¢å„ç§å‘è¡Œç‰ˆä¸Šï¼Œå¹¶æ²¡æœ‰çœŸæ­£æ„ä¹‰çš„ç©ã€‚ä¸Šäº†å¤§å­¦ä»¥åï¼Œæ¥è§¦çš„æ›´å¤šäº†ï¼Œç©çš„ä¹Ÿæ›´å—¨äº†ã€‚<br>ç°åœ¨ä¹Ÿç”¨ä¸Šarch+btrfs+uefiäº†ï¼Œå„ç§å¼ç‚¸å¤©ã€‚<br>ircé‡Œé¢ä¹Ÿç»å¸¸å­¦ä¹ ã€çœ‹åˆ«äººè£…é€¼ã€‚<br>ä¾æ—§æ˜¯è‹±è¯­æ¸£æ¸£ï¼Œæ•°å­¦æ¸£æ¸£ï¼Œçœ‹åˆ°win32apiï¼Œæˆ‘ç›´æ¥æ”¾å¼ƒwinç¼–ç¨‹äº†ï¼Œæˆ‘çš„æ™ºå•†ä¹Ÿå°±ç©ç©wpfäº†ã€‚<br>ä¸‹é¢å°±è´´å‡ å¼ æˆ‘çš„æ—¥å¸¸æˆªå›¾ã€‚</p><!-- more --><p><strong>My Computer info</strong></p><pre><code>kirigayaloveyousei@linuserOS: Arch LinuxKernel: x86_64 Linux 4.4.5-1-ARCHackages: 1092Shell: zsh 5.2Resolution: 1366x768WM: Mutter(DeepinGala)WM Theme: AdwaitaGTK Theme: Arc-OSX [GTK2/3]Icon Theme: deepinFont: Noto Sans CJK SC Regular 10CPU: Intel Core i5-4210U CPU @ 2.7GHzRAM: 1980MiB / 3861MiB</code></pre><img src="/2016/03/25/my-life/%E6%B7%B1%E5%BA%A6%E6%88%AA%E5%9B%BE20160403224356.png" class="" title="pic1"><img src="/2016/03/25/my-life/%E6%B7%B1%E5%BA%A6%E6%88%AA%E5%9B%BE20160403224410.png" class="" title="pic1"><img src="/2016/03/25/my-life/%E6%B7%B1%E5%BA%A6%E6%88%AA%E5%9B%BE20160403224524.png" class="" title="pic1"><img src="/2016/03/25/my-life/%E6%B7%B1%E5%BA%A6%E6%88%AA%E5%9B%BE20160403224634.png" class="" title="pic1"><img src="/2016/03/25/my-life/%E6%B7%B1%E5%BA%A6%E6%88%AA%E5%9B%BE20160403233112.png" class="" title="pic1"><img src="/2016/03/25/my-life/%E6%B7%B1%E5%BA%A6%E6%88%AA%E5%9B%BE20160403233229.png" class="" title="pic1">]]></content>
      
      
      
        <tags>
            
            <tag> æ—¥å¸¸ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ ‡é¢˜</title>
      <link href="/2016/03/25/page/"/>
      <url>/2016/03/25/page/</url>
      
        <content type="html"><![CDATA[<span id="more"></span>]]></content>
      
      
      
        <tags>
            
            <tag> æ¨¡æ¿ </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
